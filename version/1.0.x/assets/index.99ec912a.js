import{aC as Ue,ad as fe,aN as qe,ac as Xe,ag as we,j as M,u as te,v as j,aO as re,N as U,s as Ve,a3 as ce,ab as ne,o as Z,h as V,i as me,w as ee,C as ve,au as Ye,ap as ke,ao as Be,c as ge,x as Ge,a4 as Je,a5 as Qe,aa as Ze,aP as et,aw as tt,ar as lt}from"./index.3f21dce0.js";import{I as nt}from"./index.bb89acd9.js";import{h as ot,l as L,e as m,r as he,b as P,P as Ke,k as Y,w as N,A as J,x as oe,bg as st,O as at,v as R,y as g,z as X,i as F,ac as rt,a as G,a0 as Q,a6 as ct,p as Ee,Y as it,a3 as ut}from"./vendor.0e7da6ec.js";import{b as $e}from"./GlobalCodeBox.35a5c9cd.js";import{I as dt}from"./index.d8bb9495.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Te=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Te]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Oe(e,t,l){if(!e||ot(e)&&!e.title)return;let o=l;if(L(t))o=t;else{const n=Ue(t);n&&L(n.children)&&(o=n.children)}return o}function ft(e){return e.key?e.key:e.dataKey&&e.dataKey?fe(e.dataKey).join("-"):e.type?`__IDUX_table_column_key_${e.type}`:qe("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function vt(e,t,l,o){const n=m(()=>{var y;const{columns:S}=e;return S&&S.length>0?ie(e.columns,l.columnBase,l.columnExpandable):ie(Pe((y=t.default)==null?void 0:y.call(t)),l.columnBase,l.columnExpandable)}),{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r}=yt(n,o),c=pt(r),i=m(()=>!!e.ellipsis||a.value.some(S=>S.ellipsis)),u=m(()=>a.value.some(S=>S.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:b}=mt(a,s),{columnOffsets:v,columnOffsetsWithScrollBar:x}=gt(d,h),C=m(()=>bt(n.value,s.value));return{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:b,columnOffsets:v,columnOffsetsWithScrollBar:x,mergedRows:C}}function ie(e,t,l){return e.map(o=>ht(o,t,l))}function Pe(e){const t=[];return Xe(e,{key:Te}).forEach((l,o)=>{const{props:n,children:a}=l,{key:s=o,editable:r,ellipsis:c,...i}=n||{};i.key=s,i.editable=r||r==="",i.ellipsis=c||c==="";const{default:u,cell:d,title:h,expand:b,icon:v}=a||{};u&&(i.children=Pe(u())),d&&(i.customCell=d),h&&(i.customTitle=h),b&&(i.customExpand=b),v&&(i.customIcon=v),t.push(i)}),t}function ht(e,t,l){var a;const{align:o=t.align}=e,n=ft(e);if("type"in e){const{type:s}=e;if(s==="expandable"){const{icon:r=l.icon}=e;return{...e,key:n,align:o,icon:r}}if(s==="selectable"){const r=(a=e.multiple)!=null?a:!0;return{...e,key:n,align:o,multiple:r}}return{...e,key:n,align:o}}else{const{sortable:s,filterable:r,children:c}=e,i={...e,key:n,align:o};return s&&(i.sortable={...t.sortable,...s}),r&&(i.filterable={...t.filterable,...r}),c!=null&&c.length&&(i.children=ie(c,t,l)),i}}function yt(e,t){const l=m(()=>Re(e.value)),o=m(()=>{const a=t.value;if(a===0)return;const s=l.value,r=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:r&&r.fixed,width:a}}),n=m(()=>{const a=l.value;if(a.length===0)return a;const s=o.value;return s?[...a,s]:a});return{flattedColumns:l,scrollBarColumn:o,flattedColumnsWithScrollBar:n}}function Re(e){const t=[];return e.forEach(l=>{const{fixed:o,children:n}=l;if(n!=null&&n.length){let a=Re(n);o&&(a=a.map(s=>({fixed:o,...s}))),t.push(...a)}else t.push(l)}),t}function pt(e){return m(()=>{let t,l;return e.value.forEach(o=>{const{fixed:n,key:a}=o;n==="start"?t=a:n==="end"&&(l||(l=a))}),{lastStartKey:t,firstEndKey:l}})}function mt(e,t){const l=he({}),o=P();Ke(()=>{const r=Object.keys(l),c=e.value;if(r.length!==c.length){o.value=void 0;return}o.value=c.map(i=>l[i.key]).join("-")});const n=m(()=>{const r=o.value;return r?r.split("-").map(Number):[]}),a=m(()=>{const r=n.value;if(r.length===0)return r;const c=t.value;return c?[...r,c.width]:r});return{columnWidths:n,columnWidthsWithScrollBar:a,changeColumnWidth:(r,c)=>{c===!1?delete l[r]:l[r]=c}}}function gt(e,t){const l=m(()=>be(e.value)),o=m(()=>be(t.value));return{columnOffsets:l,columnOffsetsWithScrollBar:o}}function be(e){const t=e.length,l=[],o=[];let n=0,a=0;for(let s=0;s<t;s++){l[s]=n,n+=e[s]||0;const r=t-s-1;o[r]=a,a+=e[r]||0}return{starts:l,ends:o}}function bt(e,t){const l=[];function o(s,r,c){var d;(d=l[c])!=null||(l[c]=[]);let i=r;return s.map(h=>{var S;let b=(S=h.titleColSpan)!=null?S:1,v=!1;const x=h.children;if(x!=null&&x.length){v=!0;const y=o(x,i,c+1);Y(h.titleColSpan)&&(b=y.reduce((f,p)=>f+p))}const C=i+b-1;return l[c].push({...h,titleColSpan:b,colStart:i,colEnd:C,hasChildren:v}),i+=b,b})}const n=t?[...e,t]:e;o(n,0,0);const a=l.length;return l.forEach((s,r)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=a-r)})}),l}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function St(e,t,l,o,n,a,s){const r=m(()=>{const v=t.value,x=l.value;return e.dataSource.map(C=>We(C,x,v))}),c=m(()=>{const v=new Map;return ue(r.value,v),v}),i=m(()=>Fe(r.value,n.value,a.value)),u=m(()=>Ie(i.value,o.value,a.value)),d=m(()=>{const v=s.value,x=u.value;if(v===null||!v.pageSize)return x;{const{total:C}=v;if(C&&x.length<C)return x;const S=v.pageSize,y=(v.pageIndex-1)*S;return x.slice(y,y+S)}}),h=m(()=>{const v=new Map;return ue(d.value,v),v}),b=m(()=>{const v=a.value;return v.length>0?Ae(d.value,v,0):d.value});return{filteredData:i,flattedData:b,mergedMap:c,paginatedMap:h}}function We(e,t,l,o){const n=t(e),a={record:e,rowKey:n,parentKey:o},s=e[l];return s&&(a.children=s.map(r=>We(r,t,l,n))),a}function ue(e,t){e.forEach(l=>{const{rowKey:o,children:n}=l;t.set(o,l),n&&ue(n,t)})}function Ie(e,t,l){const o=t.filter(s=>s.sorter),n=o.length;if(n===0)return e;const a=e.slice();return a.forEach(s=>{l.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=Ie(s.children,t,l))}),a.sort((s,r)=>{for(let c=0;c<n;c++){const{orderBy:i,sorter:u}=o[c],d=u(s.record,r.record);if(d!==0)return i==="ascend"?d:-d}return 0})}function Fe(e,t,l){const o=t.filter(n=>n.filter);return o.length===0?e:e.map(n=>{const a=o.every(({filter:u,filterBy:d})=>u(d,n.record)),{rowKey:s,children:r}=n,c=l.includes(s);let i=n;if(c&&r&&r.length){const u=Fe(r,t,l);u.length!==r.length&&(i={...n,children:u})}return a||c&&i.children&&i.children.length?i:null}).filter(n=>n!==null)}function Ae(e,t,l){return e.reduce((o,n)=>{const{children:a,parentKey:s,record:r,rowKey:c}=n,i=t.includes(c);if(o.push({children:a,parentKey:s,record:r,rowKey:c,level:l,expanded:i}),i&&n.children){const u=Ae(n.children,t,l+1);o.push(...u)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xt(e,t){const l=m(()=>t.value.find(r=>"type"in r&&r.type==="expandable")),[o,n]=we(e,"expandedRowKeys",()=>[]);return{expandable:l,expandedRowKeys:o,setExpandedRowKeys:n,checkExpandDisabled:r=>{if(!l.value)return!0;const{disabled:c,customExpand:i}=l.value,{record:u}=r;return c!=null&&c(u)?!0:!(i||r.children&&r.children.length>0)},handleExpandChange:(r,c)=>{const{onChange:i,onExpand:u}=l.value||{},d=[...o.value],h=d.indexOf(r),b=h>=0;b?d.splice(h,1):d.push(r),M(u,!b,c),n(d),M(i,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e){const t=m(()=>e.value.filter(a=>a.filterable)),l=he({});N(t,(a,s)=>{a.forEach(r=>{const{key:c,filterable:i}=r,u=i.filterBy;if(u||l[c]===void 0){l[c]=u||[];return}const d=s?s.find(b=>b.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(l[c]=[])})},{immediate:!0});const o=m(()=>t.value.map(a=>{const{key:s,filterable:r}=a,{filter:c,filterBy:i=l[s]}=r;return{key:s,filter:c,filterBy:i}}).filter(a=>a.filter&&a.filterBy.length>0));return{activeFilters:o,activeFilterByMap:l,handleFilter:(a,s,r)=>{const{onChange:c}=s;l[a]=r,M(c,r,o.value)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wt(e,t,l){var i,u,d,h,b;const o=te("pagination"),n=m(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),a=P((u=(i=n.value)==null?void 0:i.pageIndex)!=null?u:1),s=P((b=(h=(d=n.value)==null?void 0:d.pageSize)!=null?h:t.pagination.pageSize)!=null?b:o.pageSize),r=(v,x)=>{var C;a.value=v,s.value=x,M((C=n.value)==null?void 0:C.onChange,v,x)};return{mergedPagination:m(()=>{var x,C;const v=n.value;return v===null?null:{...t.pagination,...v,pageIndex:(x=v.pageIndex)!=null?x:a.value,pageSize:(C=v.pageSize)!=null?C:s.value,size:l.value==="sm"?"sm":"md",onChange:r}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function kt(e,t,{setStickyScrollLeft:l}){const o=P(),n=P(),a=P(),s=P(),r=P();N(o,S=>{S&&(a.value=S.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=Bt(n,a,r,l),d=Kt(e,t,a,s),h=m(()=>{var S;return j((S=e.scroll)==null?void 0:S.width)}),b=m(()=>{var y;let S=j((y=e.scroll)==null?void 0:y.height);return!S&&t.value&&(e.virtual||d.value)&&(S="auto"),S}),v=m(()=>re(U(a))),x=m(()=>b.value?v.value:0);return{virtualScrollRef:o,scrollHeadRef:n,scrollBodyRef:a,scrollContentRef:s,scrollFootRef:r,handleScroll:c,scrollTo:S=>{var y;e.virtual?(y=o.value)==null||y.scrollTo(S):typeof S=="number"&&Ve({target:U(a),top:S,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:b,scrollBarSize:v,scrollBarSizeOnFixedHolder:x}}function Bt(e,t,l,o){const n=P(!1),a=P(!1);let s;const r=()=>{s&&(clearTimeout(s),s=void 0)};J(()=>r());const c=P(),i=b=>{c.value=b,r(),s=setTimeout(()=>{c.value=void 0,s=void 0},100)},u=(b,v)=>{!v||v.scrollLeft!==b&&(v.scrollLeft=b)},d=b=>{const v=U(t);if(!v)return;const{clientWidth:x,scrollWidth:C}=v;o(b/C*x||0)};return{handleScroll:(b,v)=>{const x=b==null?void 0:b.currentTarget,C=v!=null?v:x.scrollLeft,S=c.value;if((!S||S===x)&&(i(x),u(C,e.value),u(C,U(t)),u(C,l.value),d(C)),x){const{scrollWidth:y,clientWidth:f}=x;n.value=C>0,a.value=C<y-f}},pingedStart:n,pingedEnd:a}}function Kt(e,t,l,o){const n=P(!0),a=()=>{const c=U(l.value);c?n.value=c.scrollHeight>c.clientHeight:n.value=!1};let s=[];const r=()=>s.forEach(c=>c());return oe(()=>{N([t,()=>e.virtual],([c,i])=>{r(),c&&!i&&(s=[ce(l,a),ce(o,a)])},{immediate:!0})}),J(()=>r()),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e,t,l,o,n,a){const s=m(()=>{var u;return(u=e.scrollToTopOnChange)!=null?u:t.scrollToTopOnChange});let r=[];const c=()=>{r=[N([()=>{var u;return(u=l.value)==null?void 0:u.pageIndex},()=>{var u;return(u=l.value)==null?void 0:u.pageSize}],()=>a(0)),N([n,o],([u,d],[h,b])=>{(!$t(u,h)||!Tt(d,b))&&a(0)})]},i=()=>{r.forEach(u=>u())};N(s,u=>{i(),u&&c()},{immediate:!0})}function $t(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(n=>n.key===l.key);return o?l.filter===o.filter&&l.filterBy.length===o.filterBy.length&&l.filterBy.every(n=>o.filterBy.includes(n)):!1})}function Tt(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(n=>n.key===l.key);return o?l.sorter===o.sorter&&l.orderBy===o.orderBy&&l.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ot(e,t,l,{mergedMap:o,paginatedMap:n}){const a=m(()=>l.value.find(y=>"type"in y&&y.type==="selectable")),[s,r]=we(e,"selectedRowKeys",()=>[]),c=m(()=>{const{disabled:y}=a.value||{},f=[],p=[];return n.value.forEach((w,k)=>{y!=null&&y(w.record)?p.push(k):f.push(k)}),{enabledRowKeys:f,disabledRowKeys:p}}),i=m(()=>{const y=new Set,f=s.value,{disabledRowKeys:p}=c.value,w=o.value;return f.forEach(k=>{const{parentKey:$}=w.get(k)||{};if(!Y($)){let B=w.get($);if(B&&!f.includes(B.rowKey))for(;B&&!Y(B==null?void 0:B.rowKey);)p.includes(B.rowKey)||y.add(B.rowKey),B=Y(B.parentKey)?void 0:w.get(B.parentKey)}}),[...y]}),u=m(()=>{const y=s.value,{disabledRowKeys:f}=c.value;let p=0;return n.value.forEach((w,k)=>{!f.includes(k)&&y.includes(k)&&p++},0),p}),d=m(()=>{const y=n.value.size,f=c.value.disabledRowKeys.length;return y===0||y===f?!1:y===f+u.value}),h=m(()=>!d.value&&u.value>0),b=y=>{r(y);const f=o.value,{onChange:p}=a.value||{};if(p){const w=[];y.forEach(k=>{const $=f.get(k);$&&w.push($.record)}),M(p,y,w)}},v=(y,f)=>{const p=o.value,{disabledRowKeys:w}=c.value,{multiple:k,onSelect:$}=a.value||{};let B=[...s.value];const T=B.indexOf(y),H=T>=0;if(k){const W=p.get(y),E=He(W,w);if(H){B.splice(T,1);const z=Pt(p,W,w);B=B.filter(K=>!z.includes(K)&&!E.includes(K))}else B.push(y),B.push(...E);Rt(p,W,B,w)}else B=H?[]:[y];M($,!H,f),b(B)},x=()=>{const{enabledRowKeys:y}=c.value,f=new Set(s.value);d.value?y.forEach(p=>f.delete(p)):y.forEach(p=>f.add(p)),b([...f])},C=Wt(a,t),S=It(a,o,n,s,b);return{selectable:a,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:v,handleHeadSelectChange:x,mergedSelectableMenus:C,handleSelectableMenuClick:S}}function He(e,t){const l=[],{children:o}=e||{};return o&&o.forEach(n=>{const{rowKey:a}=n;t.includes(a)||l.push(n.rowKey),l.push(...He(n,t))}),l}function Pt(e,t,l){const o=[];for(;t!=null&&t.parentKey;){const{parentKey:n}=t;l.includes(t.parentKey)||o.push(n),t=e.get(n)}return o}function Rt(e,t,l,o){let n=!0;for(;n&&t&&!Y(t.parentKey);){const a=e.get(t.parentKey);if(a&&!o.includes(t.parentKey)){n=a.children.every(r=>o.includes(r.rowKey)||l.includes(r.rowKey));const s=l.findIndex(r=>r===t.parentKey);n?s<0&&l.push(t.parentKey):s>-1&&l.splice(s,1)}t=a}}const _e=Symbol("IDUX_TABLE_KEY_selectable-all"),ze=Symbol("IDUX_TABLE_KEY_selectable-invert"),Me=Symbol("IDUX_TABLE_KEY_selectable-none"),Ne=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Wt(e,t){return m(()=>{const{menus:l}=e.value||{};if(!l||l.length===0)return[];const{selectAll:o,selectInvert:n,selectNone:a,selectPageInvert:s}=t.table;return l.map(r=>L(r)?r==="all"?{type:"item",key:_e,label:o}:r==="invert"?{type:"item",key:ze,label:n}:r==="none"?{type:"item",key:Me,label:a}:r==="pageInvert"?{type:"item",key:Ne,label:s}:{type:"item",key:r,label:r}:r)})}function It(e,t,l,o,n){const a=()=>{const{disabled:u,onSelectAll:d}=e.value||{},h=[];t.value.forEach((b,v)=>{u!=null&&u(b.record)||h.push(v)}),M(d,h),n(h)},s=()=>{const{disabled:u,onSelectInvert:d}=e.value||{},h=[...o.value];t.value.forEach((b,v)=>{if(u!=null&&u(b.record))return;const x=h.indexOf(v);x>=0?h.splice(x,1):h.push(v)}),n(h),M(d,h)},r=()=>{const{onSelectNone:u}=e.value||{};M(u),n([])},c=()=>{const{disabled:u,onSelectPageInvert:d}=e.value||{},h=[],b=o.value;l.value.forEach((v,x)=>{(u==null?void 0:u(v.record))||b.includes(x)||h.push(x)}),M(d,h),n(h)},i=new Map([[_e,a],[ze,s],[Me,r],[Ne,c]]);return u=>{const d=u.key;if(st(d)&&i.has(d)){i.get(d)();return}const{disabled:h,onMenuClick:b}=e.value||{};if(!b)return;const v=[];l.value.forEach((x,C)=>{h!=null&&h(x.record)||v.push(C)}),M(b,u,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ft(e){const t=m(()=>e.value.filter(s=>s.sortable)),l=he({}),o=m(()=>t.value.some(s=>s.sortable.multiple!==void 0));N(t,(s,r)=>{s.forEach(c=>{const{key:i,sortable:u}=c,d=u.orderBy;if(d||l[i]===void 0){l[i]=d;return}const h=r?r.find(v=>v.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(l[i]=void 0)})},{immediate:!0});const n=m(()=>t.value.map(s=>{const{key:r,sortable:c}=s,{multiple:i=0,orderBy:u=l[r],sorter:d}=c;return{key:r,multiple:i,orderBy:u,sorter:d}}).filter(s=>s.orderBy).sort((s,r)=>r.multiple-s.multiple));return{activeSorters:n,activeOrderByMap:l,handleSort:(s,r)=>{const{orders:c,onChange:i}=r,u=l[s],d=u?Se(c,u):Se(c);o.value?l[s]=d:Object.keys(l).forEach(h=>{s===h?l[h]=d:l[h]=void 0}),M(i,d,n.value)}}}function Se(e,t){return t?e[e.indexOf(t)+1]:e[0]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function At(e){const t=m(()=>!!e.sticky),l=m(()=>{const{sticky:a}=e,{offsetTop:s=0,offsetBottom:r=0,offsetScroll:c=0,container:i=window}=at(a)?a:{};return{offsetTop:s,offsetBottom:r,offsetScroll:c,container:i}}),[o,n]=ne(0);return{isSticky:t,mergedSticky:l,stickyScrollLeft:o,setStickyScrollLeft:n}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e,{hasEllipsis:t,hasFixed:l},{scrollWidth:o,scrollHeight:n},a){return m(()=>e.tableLayout?e.tableLayout:n.value&&l.value?o.value==="max-content"?"auto":"fixed":o.value||a.value||t.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const A=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),le=R({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:t,flattedColumnsWithScrollBar:l,columnWidths:o,columnWidthsWithScrollBar:n,mergedSelectableMenus:a,mergedPrefixCls:s}=F(A),r=m(()=>t.value.some(c=>!!c.width||"type"in c));return()=>{const{isFixedHolder:c}=e;let i;if(c){const u=n.value;i=l.value.map((d,h)=>xe(s,a,d,u[h]))}else if(r.value){const u=o.value;i=t.value.map((d,h)=>xe(s,a,d,u[h]))}return g("colgroup",null,[i])}}});function xe(e,t,l,o){var i;const n=e.value,a="type"in l&&l.type,s=X({[`${n}-col-${a}`]:!!a,[`${n}-selectable-with-dropdown`]:a==="selectable"&&t.value.length>0}),r=(i=l.width)!=null?i:o,c=r?{width:j(r)}:void 0;return g("col",{key:l.key,class:s,style:c},null)}const _t=R({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:t}){const{mergedPrefixCls:l,scrollHeadRef:o,handleScroll:n,scrollWidth:a,flattedData:s,isSticky:r,columnWidths:c}=F(A);zt(o,n);const i=m(()=>a.value==="max-content"),u=m(()=>s.value.length>0),d=m(()=>{const v=l.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:r.value}}),h=m(()=>{const v=r.value,{offsetTop:x,offsetBottom:C}=e;return{overflow:"hidden",top:v?j(x):void 0,bottom:v?j(C):void 0}}),b=m(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>g("div",{class:d.value,style:h.value,ref:o},[g("table",{style:b.value},[(u.value||!i.value)&&g(le,{isFixedHolder:!0},null),t.default&&t.default()])])}});function zt(e,t){const l=o=>{const n=o.deltaX,a=o.currentTarget;if(n){const s=a.scrollLeft+n;t(o,s),o.preventDefault()}};oe(()=>Z(e.value,"wheel",l,{passive:!0})),J(()=>V(e.value,"wheel",l))}const Mt=R({setup(){const{mergedPrefixCls:e,scrollBodyRef:t,handleScroll:l,mergedSticky:o,stickyScrollLeft:n,setStickyScrollLeft:a}=F(A),s=P(!1),r=P(!1),c=P(0),i=P(0),u=P(0),d=m(()=>{const f=i.value,p=u.value;return p&&f*(f/p)});Ke(()=>{const f=U(t);if(!!f&&s.value){const{clientWidth:p,scrollWidth:w,scrollLeft:k}=f;a(k/w*p),i.value=p,u.value=w}});const h=m(()=>({height:re(),width:i.value,bottom:o.value.offsetScroll})),b=m(()=>{const f=e.value;return{[`${f}-sticky-scrollbar-thumb`]:!0,[`${f}-sticky-scrollbar-thumb-active`]:r.value}}),v=m(()=>({width:`${d.value}px`,transform:`translate3d(${n.value}px, 0, 0)`})),x=()=>r.value=!1,C=f=>{c.value=f.pageX-n.value,r.value=!0,f.preventDefault()},S=f=>{if(!r.value)return;const{buttons:p}=f||window.event;if(p===0){r.value=!1;return}let w=f.pageX-c.value;w<=0&&(w=0);const k=i.value,$=u.value,B=d.value;w+B>=k&&(w=k-B);const T=w/k*($+2);l(f,T)},y=()=>{const f=U(t),p=me(f).top,w=p+f.offsetHeight,{container:k,offsetScroll:$}=o.value,B=k===window?document.documentElement.scrollTop+window.innerHeight:me(k).top+k.clientHeight;w-re()<=B||p>=B-$?s.value=!1:s.value=!0};return oe(()=>{Z(document.body,"mouseup",x),Z(document.body,"mousemove",S),Z(window,"resize",y),N(()=>o.value.container,(f,p)=>{V(p,"scroll",y),Z(f,"scroll",y)},{immediate:!0}),y()}),J(()=>{V(document.body,"mouseup",x),V(document.body,"mousemove",S),V(window,"resize",y),V(o.value.container,"scroll",y)}),()=>!t.value||!s.value||u.value<=i.value||!d.value?null:g("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[g("div",{class:b.value,style:v.value,onMousedown:C},null)])}}),de=R({props:{isEmpty:Boolean},setup(e,{slots:t}){const{mergedPrefixCls:l,flattedColumns:o,hasFixed:n,scrollWidth:a,scrollBarColumn:s}=F(A),{mainTableWidth:r}=F(pe),c=m(()=>o.value.length);return()=>{let i=t.default();if(e.isEmpty?a.value:n.value){const u=s.value;i=g("div",{class:`${l.value}-fixed-row`,style:{width:j(r.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return g("tr",null,[g("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Nt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:void 0},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Dt={columns:{type:Array,required:!0}},Lt={column:{type:Object,required:!0}},jt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Ut={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},qt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Xt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Vt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},Yt=R({props:qt,setup(e){const t=P();return ce(t,o=>{const{offsetWidth:n}=o.target;e.changeColumnWidth(e.cellKey,n)}),J(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>g("td",{ref:t,style:{padding:0,border:0,height:0}},[g("div",{style:{height:0,overflow:"hidden"}},[rt("\xA0")])])}}),Gt=R({setup(){const{mergedPrefixCls:e,flattedColumns:t}=F(A),{changeColumnWidth:l}=F(pe);return()=>{const o=t.value.map(n=>{const{key:a}=n;return g(Yt,{key:a,cellKey:a,changeColumnWidth:l},null)});return g("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}}),Jt=R({props:Ut,setup(e){const{props:t,slots:l,mergedPrefixCls:o,mergedEmptyCell:n,activeOrderByMap:a,fixedColumnKeys:s,columnOffsets:r,isSticky:c,expandable:i,selectable:u}=F(A),d=m(()=>a[e.column.key]),h=Qt(e),b=m(()=>s.value.lastStartKey===e.column.key),v=m(()=>s.value.firstEndKey===e.column.key),x=m(()=>{const{fixed:y,align:f,ellipsis:p=t.ellipsis}=e.column,w=o.value;let k={[`${w}-cell`]:!0,[`${w}-cell-sorted`]:!!d.value,[`${w}-cell-align-${f}`]:!!f&&f!="start",[`${w}-cell-ellipsis`]:!!p};return y&&(k={...k,[`${w}-fix-start`]:y==="start",[`${w}-fix-start-last`]:b.value,[`${w}-fix-end`]:y==="end",[`${w}-fix-end-first`]:v.value,[`${w}-fix-sticky`]:c.value}),X(k)}),C=m(()=>{const{fixed:y}=e.column;if(!y)return;const{starts:f,ends:p}=r.value,k=j((y==="start"?f:p)[e.colIndex]);return{position:"sticky",left:y==="start"?k:void 0,right:y==="end"?k:void 0}}),S=y=>{y.stopPropagation()};return()=>{var W,E,z;const{column:y}=e,{type:f}=y;let p,w;if(f==="selectable")p=tl(e,l,u,S);else{const{ellipsis:K=t.ellipsis}=y,O=h.value;if(p=Zt(e,l,O),w=Oe(K,p,O),!f&&(Y(p)||p==="")){const I=l.emptyCell||n.value;p=G(I)?I({column:y,record:e.record,rowIndex:e.rowIndex}):I}}const{fixed:k,ellipsis:$=t.ellipsis}=e.column;k&&$&&(b.value||v.value)&&(p=g("span",{class:`${o.value}-cell-content`},[p]));const B=(W=t.customAdditional)==null?void 0:W.bodyCell,T=B?B({column:y,record:e.record,rowIndex:e.rowIndex}):void 0,H=(z=(E=t.customTag)==null?void 0:E.bodyCell)!=null?z:"td";return g(H,Q({class:x.value,style:C.value,title:w},T),{default:()=>[f==="expandable"&&el(e,l,i,o.value),p]})}}});function Qt(e){return m(()=>{const{column:t,record:l}=e,o=fe(t.dataKey);if(o.length<=0)return;let n=l;for(let a=0;a<o.length&&n;a++){const s=o[a];n=n[s]}return n})}function Zt(e,t,l){const{record:o,rowIndex:n,column:a}=e,{customCell:s}=a,r=L(s)?t[s]:s;return r?r({value:l,record:o,rowIndex:n}):l}function el(e,t,l,o){const{icon:n,customIcon:a,indent:s}=l.value,{record:r,expanded:c,level:i=0,disabled:u}=e,d={marginLeft:s?j(i*s):void 0};let h;return u?h=null:G(a)?h=a({expanded:!!c,record:r}):L(a)&&t[a]?h=t[a]({expanded:c,record:r}):h=g(ee,{name:n,rotate:c?90:0},null),g("button",{class:`${o}-expandable-trigger`,style:d,type:"button",onClick:e.handleExpend},[h])}function tl(e,t,l,o){const{selected:n,indeterminate:a,disabled:s,handleSelect:r}=e,{multiple:c,customCell:i}=l.value,u=L(i)?t[i]:i;if(c){const d={checked:n,disabled:s,indeterminate:a,onChange:r,onClick:o};return u?u(d):g(ve,d,null)}else{const d={checked:n,disabled:s,onChange:r,onClick:o};return u?u(d):g($e,d,null)}}const ll=R({props:jt,setup(e){const{props:t,mergedPrefixCls:l,flattedColumns:o,expandable:n,handleExpandChange:a,checkExpandDisabled:s,selectable:r,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:d}=F(A),{expandDisabled:h,handleExpend:b,selectDisabled:v,handleSelect:x,clickEvents:C}=nl(e,n,s,a,r,u,d),S=m(()=>c.value.includes(e.rowKey)),y=m(()=>i.value.includes(e.rowKey)),f=m(()=>{const p=`${l.value}-row`,{level:w,expanded:k}=e;return X({[`${p}`]:!0,[`${p}-level-${w}`]:!!w,[`${p}-selected`]:S.value,[`${p}-expanded`]:k})});return()=>{var $,B,T;const p=($=t.customAdditional)==null?void 0:$.bodyRow,w=p?p({record:e.record,rowIndex:e.rowIndex}):void 0,k=(T=(B=t.customTag)==null?void 0:B.bodyRow)!=null?T:"tr";return g(k,Q({class:f.value},C.value,w),{default:()=>[ol(e,o,h.value,b,S,y,v,x)]})}}});function nl(e,t,l,o,n,a,s){const r=m(()=>l(e.rowData)),c=m(()=>{var C;return(C=t.value)==null?void 0:C.trigger}),i=()=>{const{rowKey:C,record:S}=e;o(C,S)},u=m(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=m(()=>{var C;return(C=n.value)==null?void 0:C.trigger}),h=()=>{const{rowKey:C,record:S}=e;a(C,S)},b=()=>{c.value==="click"&&!r.value&&i(),d.value==="click"&&!u.value&&h()},v=()=>{c.value==="dblclick"&&!r.value&&i(),d.value==="dblclick"&&!u.value&&h()},x=m(()=>{const C=c.value==="click"||d.value==="click"?b:void 0,S=c.value==="dblclick"||d.value==="dblclick"?v:void 0;return{onClick:C,onDblclick:S}});return{expandDisabled:r,handleExpend:i,selectDisabled:u,handleSelect:h,clickEvents:x}}function ol(e,t,l,o,n,a,s,r){const c=[],{rowIndex:i,record:u,level:d}=e;return t.value.forEach((h,b)=>{const{type:v,colSpan:x,rowSpan:C,key:S}=h,y=x==null?void 0:x(u,i),f=C==null?void 0:C(u,i);if(y===0||f===0)return;const p={colSpan:y===1?void 0:y,rowSpan:f===1?void 0:f,rowIndex:i,colIndex:b,record:u,column:h,level:d,key:S};v==="expandable"?(p.expanded=e.expanded,p.disabled=l,p.handleExpend=o):v==="selectable"&&(p.selected=n.value,p.indeterminate=a.value,p.disabled=s.value,p.handleSelect=r),c.push(g(Jt,p,null))}),c}function De(e,t,l,o,n){const{expanded:a,level:s,record:r,rowKey:c}=e,i={key:c,expanded:a,level:s,record:r,rowData:e,rowIndex:t,rowKey:c},u=g(ll,i,null),d=a&&sl(i,l,o,n);return d?[u,d]:u}function sl(e,t,l,o){const{customExpand:n}=l||{},{record:a,rowIndex:s}=e;let r;return G(n)?r=n({record:a,rowIndex:s}):L(n)&&t[n]&&(r=t[n]({record:a,rowIndex:s})),r&&g(de,{class:`${o}-expanded-row`},{default:()=>[r]})}const ae=R({setup(e,{slots:t}){const{props:l,slots:o,mergedPrefixCls:n,flattedData:a,expandable:s,scrollWidth:r,scrollHeight:c,isSticky:i}=F(A),u=m(()=>r.value||c.value||i.value);return()=>{const d=n.value,h=[];o.alert&&h.push(g(de,{class:`${d}-alert-row`},{default:()=>[o.alert()]}));const b=a.value;return b.length>0?t.default?h.push(...t.default()):b.forEach((v,x)=>{h.push(...fe(De(v,x,o,s.value,d)))}):h.push(g(de,{class:`${d}-empty-row`,isEmpty:!0},{default:()=>[g(Ye,{empty:l.empty},o)]})),g("tbody",{class:`${n.value}-tbody`},[u.value&&g(Gt,null,null),h])}}}),al=R({props:Xt,setup(e){const{slots:t,config:l,locale:o,mergedPrefixCls:n}=F(A),a=m(()=>{var f;return(f=e.filterable.multiple)!=null?f:l.columnBase.filterable.multiple}),s=m(()=>{var f;return(f=e.filterable.footer)!=null?f:l.columnBase.filterable.footer}),r=e.activeFilterBy,[c,i]=ne(()=>r);N(()=>e.activeFilterBy,f=>i(f));const[u,d]=ne(!1),h=f=>{d(f),f||e.onUpdateFilterBy(c.value)},b=()=>{d(!1),e.onUpdateFilterBy(c.value)},v=()=>{i(r)},x=f=>{const p=`${n.value}-filterable-menu-label`,w=a.value?ve:$e;return g("span",{class:p},[g(w,{checked:f.selected,disabled:f.disabled},null),g("span",{class:`${p}-content`},[f.label])])},C=()=>{const f=[],{customMenu:p,menus:w}=e.filterable;return G(p)?f.push(p()):L(p)&&t[p]?f.push(t[p]()):f.push(rl(w,a,c,i,x)),s.value&&f.push(cl(o,n,b,v)),f},S=m(()=>{const f=`${n.value}-filterable-trigger`;return X({[f]:!0,[`${f}-active`]:e.activeFilterBy.length>0})}),y=()=>{const{customTrigger:f}=e.filterable;return G(f)?f():L(f)&&t[f]?t[f]():g("span",{class:S.value,onClick:p=>p.stopPropagation()},[g(ee,{name:"filter-filled"},null)])};return()=>{const f={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return g(ke,f,{default:y,overlay:C})}}}),rl=(e,t,l,o,n)=>{const a={dataSource:e,multiple:t.value,selectable:!0,selectedKeys:l.value,"onUpdate:selectedKeys":o};return g(Be,a,{itemLabel:n})},cl=(e,t,l,o)=>{const{filterConfirm:n,filterReset:a}=e.table;return g("div",{class:`${t.value}-filterable-trigger-footer`},[g(ge,{mode:"primary",size:"xs",onClick:l},{default:()=>[n]}),g(ge,{size:"xs",onClick:o},{default:()=>[a]})])},il=R({setup(){const{mergedPrefixCls:e,paginatedMap:t,selectable:l,currentPageRowKeys:o,currentPageAllSelected:n,currentPageSomeSelected:a,handleHeadSelectChange:s,mergedSelectableMenus:r,handleSelectableMenuClick:c}=F(A),i=m(()=>{const C=t.value.size;return C===0||C===o.value.disabledRowKeys.length}),[u,d]=ne(!1),h={"onUpdate:visible":d,trigger:"click"},b=()=>g(Be,{dataSource:r.value,onClick:c},null),v=()=>g(ee,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),x=()=>{if(r.value.length!==0)return g(ke,h,{default:v,overlay:b})};return()=>{const{multiple:C}=l.value;if(!!C)return g("div",{class:`${e.value}-selectable`},[g(ve,{checked:n.value,indeterminate:a.value,disabled:i.value,onChange:s},null),x()])}}}),ul=R({props:Vt,setup(e){const{locale:t,mergedPrefixCls:l}=F(A);return()=>{const{activeOrderBy:o,sortable:n}=e,{orders:a,nextTooltip:s}=n,r=s&&dl(t.table,a,o),c=fl(l,a,o);return r?g(Ge,{title:r},{default:()=>[c]}):c}}});function dl(e,t,l){const o=l?t[t.indexOf(l)+1]:t[0],{sortCancel:n,sortAsc:a,sortDesc:s}=e;return o?o==="ascend"?a:s:n}function fl(e,t,l){const o=e.value,n=`${o}-sortable-trigger-active`,a=t.includes("ascend")&&g(ee,{name:"caret-up-filled",class:l==="ascend"?n:void 0},null),s=t.includes("descend")&&g(ee,{name:"caret-down-filled",class:l==="descend"?n:void 0},null);return g("span",{class:`${o}-sortable-trigger`},[a,s])}const vl=R({props:Lt,setup(e){const{props:t,slots:l,mergedPrefixCls:o,fixedColumnKeys:n,columnOffsetsWithScrollBar:a,isSticky:s,handleSort:r,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(A),d=m(()=>{const{type:S,align:y,ellipsis:f=t.ellipsis,fixed:p,hasChildren:w,key:k,sortable:$,filterable:B}=e.column,T=o.value;let H={[`${T}-cell`]:!0,[`${T}-cell-${S}`]:!!S,[`${T}-cell-filterable`]:!!B,[`${T}-cell-sortable`]:!!$,[`${T}-cell-align-center`]:w||y==="center",[`${T}-cell-align-end`]:!w&&y==="end",[`${T}-cell-ellipsis`]:!!f};if(p){const{lastStartKey:W,firstEndKey:E}=n.value;H={...H,[`${T}-fix-start`]:p==="start",[`${T}-fix-start-last`]:W===k,[`${T}-fix-end`]:p==="end",[`${T}-fix-end-first`]:E===k,[`${T}-fix-sticky`]:s.value}}return X(H)}),h=m(()=>{const{fixed:S,colStart:y,colEnd:f}=e.column;if(!S)return;const{starts:p,ends:w}=a.value,B=j((S==="start"?p:w)[S==="start"?y:f]);return{position:"sticky",left:S==="start"?B:void 0,right:S==="end"?B:void 0}}),b=m(()=>c[e.column.key]),v=m(()=>i[e.column.key]),x=S=>{const{key:y,filterable:f}=e.column;u(y,f,S)},C=()=>{const{key:S,sortable:y}=e.column;y&&r(S,y)};return()=>{var W,E,z;const{column:S}=e,{type:y,titleColSpan:f,titleRowSpan:p}=S;if(y==="scroll-bar")return g("th",{class:d.value,style:h.value,colspan:f===1?void 0:f,rowspan:p===1?void 0:p,onClick:C},null);const w=o.value;let k,$;if(y==="selectable")$=g(il,null,null);else{const{title:K,customTitle:O,ellipsis:I=t.ellipsis,sortable:D,filterable:q}=S;$=hl(K,O,l),k=Oe(I,$,K);const _=yl(D,b,q,v,x);_.length>0?$=g("span",{class:`${w}-cell-triggers`},[g("span",{class:`${w}-cell-title`},[$]),_]):I&&($=g("span",{class:`${w}-cell-title`},[$]))}const B=(W=t.customAdditional)==null?void 0:W.headCell,T=B?B({column:S}):void 0,H=(z=(E=t.customTag)==null?void 0:E.headCell)!=null?z:"th";return g(H,Q({class:d.value,style:h.value,colSpan:f===1?void 0:f,rowSpan:p===1?void 0:p,title:k},T,{onClick:C}),{default:()=>[$]})}}});function hl(e,t,l){let o=e;return G(t)?o=t({title:e}):L(t)&&l[t]&&(o=l[t]({title:e})),o}function yl(e,t,l,o,n){const a=[];return e&&a.push(g(ul,{activeOrderBy:t.value,sortable:e},null)),l&&a.push(g(al,{activeFilterBy:o.value,filterable:l,onUpdateFilterBy:n},null)),a}const pl=R({props:Dt,setup(e){const{props:t,mergedPrefixCls:l}=F(A);return()=>{var r,c,i;const{columns:o}=e,n=(r=t.customAdditional)==null?void 0:r.headRow,a=n?n({columns:o}):void 0,s=(i=(c=t.customTag)==null?void 0:c.headRow)!=null?i:"tr";return g(s,Q({class:`${l.value}-row`},a),{default:()=>[o.filter(u=>u.titleColSpan!==0).map(u=>g(vl,{key:u.key,column:u},null))]})}}}),Ce=R({setup(){const{props:e,mergedRows:t,mergedPrefixCls:l}=F(A);return()=>{var r,c,i;const o=t.value,n=(r=e.customAdditional)==null?void 0:r.head,a=n?n({rows:o}):void 0,s=(i=(c=e.customTag)==null?void 0:c.head)!=null?i:"thead";return g(s,Q({class:`${l.value}-thead`},a),{default:()=>[o.map((u,d)=>g(pl,{key:d,columns:u},null))]})}}});R({setup(){return()=>g("tfoot",null,null)}});const ml={sm:32,md:40,lg:56},gl=R({setup(){const{props:e,slots:t,expandable:l,mergedPrefixCls:o,mergedSize:n,mergedAutoHeight:a,columnWidths:s,changeColumnWidth:r,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:b,handleScroll:v,pingedStart:x,pingedEnd:C,scrollWidth:S,scrollHeight:y,hasFixed:f,tableLayout:p}=F(A),w=P(),k=P(0);Ee(pe,{mainTableWidth:k,changeColumnWidth:(K,O)=>{et(w.value)&&r(K,O)}});const B=()=>{const K=U(h);K&&v({currentTarget:K})},T=K=>{const{offsetWidth:O}=K.target;O!==k.value&&(k.value=O)};oe(()=>{B(),N([()=>e.dataSource,S],([,O])=>{O&&B()}),N(s,ct(()=>{var I;((I=U(h))==null?void 0:I.scrollLeft)===0&&B()},16)),Je(w.value,T)}),J(()=>Qe(w.value,T));const H=m(()=>{const K=o.value;return X({[`${K}-container`]:!0,[`${K}-ping-start`]:x.value,[`${K}-ping-end`]:C.value,[`${K}-fixed-layout`]:p.value==="fixed",[`${K}-fixed-column`]:f.value,[`${K}-scroll-horizontal`]:S.value,[`${K}-scroll-vertical`]:y.value})}),W=m(()=>{var _;const K=S.value,O=y.value,I=K?"auto":void 0,D=e.virtual?"hidden":O?"scroll":K?"hidden":void 0,q=(_=e.scroll)==null?void 0:_.fullHeight;return{overflowX:I,overflowY:D,[q?"height":"maxHeight"]:O}}),E=m(()=>({tableLayout:p.value,width:S.value,minWidth:S.value?"100%":void 0})),z=(K,O,I)=>{M(e.onScrolledChange,K,O,I.map(D=>D.record))};return()=>{const K=t.default?t.default():[],O=o.value;if(y.value||i.value){const{offsetTop:I}=u.value;if(e.headless||K.push(g(_t,{offsetTop:I},{default:()=>[g(Ce,null,null)]})),e.virtual&&(e.scroll||a.value)){const D=({item:se,index:je})=>De(se,je,t,l.value,O),q=se=>g("table",{ref:b,class:`${O}-table`,style:E.value},[g(le,null,null),g(ae,null,{default:()=>[se]}),!1]),{scroll:_,onScrolledBottom:Le}=e;K.push(g(Ze,{ref:d,style:W.value,dataSource:c.value,fullHeight:_==null?void 0:_.fullHeight,getKey:"rowKey",height:a.value?"100%":_==null?void 0:_.height,itemHeight:ml[n.value],itemRender:D,contentRender:q,virtual:!0,onScroll:v,onScrolledBottom:Le,onScrolledChange:z},null))}else K.push(g("div",{ref:h,class:`${O}-content`,style:W.value,onScroll:v},[g("table",{ref:b,class:`${O}-table`,style:E.value},[g(le,null,null),g(ae,null,null),!1])]));i.value&&K.push(g(Mt,null,null))}else K.push(g("div",{ref:h,class:`${O}-content`,style:W.value,onScroll:v},[g("table",{ref:b,class:`${O}-table`,style:E.value},[g(le,null,null),!e.headless&&g(Ce,null,null),g(ae,null,null),!1])]));return g("div",{ref:w,class:H.value},[K])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bl(e,t){return e.footer?g("div",{class:`${t}-footer`},[e.footer()]):null}function Sl(e,t,l){let o=null,n=null;if(e!==null){const{position:a}=e,[s,r]=it(a).split("-"),c=`${l}-pagination ${l}-pagination-${r}`,i=g(dt,Q({class:c,total:t.length},e),null);o=s==="top"?i:null,n=s==="bottom"?i:null}return[o,n]}const xl=R({name:"IxTable",props:Nt,setup(e,{expose:t,slots:l}){const o=te("common"),n=m(()=>`${o.prefixCls}-table`),a=te("locale"),s=te("table"),r=m(()=>{var E;return(E=e.autoHeight)!=null?E:s.autoHeight}),c=m(()=>{var E;return(E=e.childrenKey)!=null?E:s.childrenKey}),i=tt(e,s),u=m(()=>{var E;return(E=e.emptyCell)!=null?E:s.emptyCell}),d=m(()=>{var E;return(E=e.size)!=null?E:s.size}),{mergedPagination:h}=wt(e,s,d),b=At(e),v=kt(e,r,b),x=vt(e,l,s,v.scrollBarSizeOnFixedHolder),C=Ft(x.flattedColumns),S=Ct(x.flattedColumns),y=xt(e,x.flattedColumns),f=Ht(e,x,v,b.isSticky),{activeSorters:p}=C,{activeFilters:w}=S,k=St(e,c,i,p,w,y.expandedRowKeys,h),$=Ot(e,a,x.flattedColumns,k);Et(e,s,h,p,w,v.scrollTo);const B={props:e,slots:l,config:s,locale:a,mergedPrefixCls:n,mergedEmptyCell:u,mergedSize:d,mergedAutoHeight:r,...x,...v,...C,...S,...b,tableLayout:f,mergedPagination:h,...y,...k,...$};Ee(A,B),t({scrollTo:v.scrollTo});const{flattedData:T,filteredData:H}=k,W=m(()=>{const E=n.value,{borderless:z=s.borderless,scroll:K}=e;return X({[E]:!0,[`${E}-auto-height`]:r.value,[`${E}-borderless`]:z,[`${E}-empty`]:T.value.length===0,[`${E}-full-height`]:K==null?void 0:K.fullHeight,[`${E}-${d.value}`]:!0})});return()=>{const E=n.value,z=g(lt,{header:e.header},l),K=bl(l,E),[O,I]=Sl(h.value,H.value,E),D=[z,O,g(gl,null,null),K,I],q=Cl(e.spin),_=q?g(nt,q,{default:()=>[D]}):D;return g("div",{class:W.value},[_])}}});function Cl(e){return ut(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const $l=xl,Tl=ye;export{$l as I,Tl as a,ft as g};
