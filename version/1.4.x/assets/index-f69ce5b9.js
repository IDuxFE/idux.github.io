import{M as ke,N as fe,aI as Je,al as Be,m as _,L as le,aJ as z,aK as ce,o as X,D as ie,U as Qe,K as oe,R as ee,S as G,a3 as ge,A as te,k as ve,aq as Ze,a0 as Ke,$ as Ee,c as me,aa as et,ao as tt,E as lt,G as nt,H as ot,aL as st,ar as at,an as rt,ay as ct}from"./index-7e609792.js";import{j as $e,l as N,L as it,T as ut,f as m,r as he,b as T,w as D,a7 as Te,P as Ie,k as Y,N as Q,x as se,bi as dt,Q as ft,v as H,z as V,y as b,i as F,ad as vt,a as J,a2 as Z,p as Oe,Z as ht,av as yt}from"./vendor-50817465.js";import{b as Re}from"./GlobalCodeBox-e7c7dcff.js";import{I as pt}from"./index-49d85da9.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pe=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Pe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function We(e,l,t){if(!e||$e(e)&&e.title===!1)return;if(N(l)||it(l))return l;const n=ke(l).find(o=>o.type===ut);return n?n.children:t}function gt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Je("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function mt(e,l,t,n){const o=m(()=>{var p;const{columns:w}=e;return Fe(w&&w.length>0?w:He((p=l.default)==null?void 0:p.call(l)),t)}),{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r}=xt(o,n),c=St(r),i=m(()=>!!e.ellipsis||a.value.some(w=>w.ellipsis)),u=m(()=>a.value.some(w=>w.fixed)),{columnWidths:d,columnWidthsWithScrollBar:y,changeColumnWidth:x}=Ct(a,s),{columnOffsets:v,columnOffsetsWithScrollBar:S}=wt(d,y),k=m(()=>kt(o.value,s.value));return{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:d,columnWidthsWithScrollBar:y,changeColumnWidth:x,columnOffsets:v,columnOffsetsWithScrollBar:S,mergedRows:k}}function Fe(e,l){return e.map(t=>bt(t,l))}function He(e){const l=[];return ke(e,{key:Pe}).forEach((t,n)=>{const{props:o,children:a}=t,{key:s=n,editable:r,ellipsis:c,...i}=o||{};i.key=s,i.editable=r||r==="",i.ellipsis=c||c==="";const{default:u,cell:d,title:y,expand:x,icon:v}=a||{};u&&(i.children=He(u())),d&&(i.customCell=d),y&&(i.customTitle=y),x&&(i.customExpand=x),v&&(i.customIcon=v),l.push(i)}),l}function bt(e,l){const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:a}=l,{align:s=t.align}=e,r=gt(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{icon:i=n.icon}=e;return{...e,key:r,align:s,icon:i}}if(c==="selectable"){const{multiple:i=!0,showIndex:u=o.showIndex}=e;return{...e,key:r,align:s,multiple:i,showIndex:u}}if(c==="indexable"){const i=e.align??a.align??t.align;return{...a,...e,align:i,key:r}}return{...e,key:r,align:s}}else{const{sortable:c,filterable:i,children:u}=e,d={...e,key:r,align:s};return c&&(d.sortable={...t.sortable,...c}),i&&(d.filterable={...t.filterable,...i}),u!=null&&u.length&&(d.children=Fe(u,l)),d}}function xt(e,l){const t=m(()=>Ae(e.value)),n=m(()=>{const a=l.value;if(a===0)return;const s=t.value,r=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:r&&r.fixed,width:a}}),o=m(()=>{const a=t.value;if(a.length===0)return a;const s=n.value;return s?[...a,s]:a});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let a=Ae(o);n&&(a=a.map(s=>({fixed:n,...s}))),l.push(...a)}else l.push(t)}),l}function St(e){return m(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:a}=n;o==="start"?l=a:o==="end"&&(t||(t=a))}),{lastStartKey:l,firstEndKey:t}})}function Ct(e,l){const t=he({}),n=T(),o=T([]);D(n,Te(r=>{o.value=r?r.split("-").map(Number):[]},16)),Ie(()=>{const r=Object.keys(t),c=e.value;if(r.length!==c.length){n.value=void 0;return}n.value=c.map(i=>t[i.key]).join("-")});const a=m(()=>{const r=o.value;if(r.length===0)return r;const c=l.value;return c?[...r,c.width]:r});return{columnWidths:o,columnWidthsWithScrollBar:a,changeColumnWidth:(r,c)=>{c===!1?delete t[r]:t[r]=c}}}function wt(e,l){const t=m(()=>be(e.value)),n=m(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,a=0;for(let s=0;s<l;s++){t[s]=o,o+=e[s]||0;const r=l-s-1;n[r]=a,a+=e[r]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(s,r,c){t[c]??(t[c]=[]);let i=r;return s.map(d=>{let y=d.titleColSpan??1,x=!1;const v=d.children;if(v!=null&&v.length){x=!0;const k=n(v,i,c+1);Y(d.titleColSpan)&&(y=k.reduce((w,p)=>w+p))}const S=i+y-1;return t[c].push({...d,titleColSpan:y,colStart:i,colEnd:S,hasChildren:x}),i+=y,y})}const o=l?[...e,l]:e;n(o,0,0);const a=t.length;return t.forEach((s,r)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=a-r)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,l,t,n,o,a,s){const r=m(()=>{const v=l.value,S=t.value;return e.dataSource.map(k=>Me(k,S,v))}),c=m(()=>{const v=new Map;return ue(r.value,v),v}),i=m(()=>ze(r.value,o.value,a.value)),u=m(()=>_e(i.value,n.value,a.value)),d=m(()=>{const v=s.value,S=u.value;if(v===null||!v.pageSize)return S;{const{total:k}=v;if(k&&S.length<k)return S;const w=v.pageSize,p=(v.pageIndex-1)*w;return S.slice(p,p+w)}}),y=m(()=>{const v=new Map;return ue(d.value,v),v}),x=m(()=>{const v=a.value;return v.length>0?De(d.value,v,0):d.value});return{filteredData:i,flattedData:x,mergedMap:c,paginatedMap:y}}function Me(e,l,t,n){const o=l(e),a={record:e,rowKey:o,parentKey:n},s=e[t];return s&&(a.children=s.map(r=>Me(r,l,t,o))),a}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function _e(e,l,t){const n=l.filter(s=>s.sorter),o=n.length;if(o===0)return e;const a=e.slice();return a.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=_e(s.children,l,t))}),a.sort((s,r)=>{for(let c=0;c<o;c++){const{orderBy:i,sorter:u}=n[c],d=u(s.record,r.record);if(d!==0)return i==="ascend"?d:-d}return 0})}function ze(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const a=n.every(({filter:u,filterBy:d})=>u(d,o.record)),{rowKey:s,children:r}=o,c=t.includes(s);let i=o;if(c&&r&&r.length){const u=ze(r,l,t);u.length!==r.length&&(i={...o,children:u})}return a||c&&i.children&&i.children.length?i:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:a,parentKey:s,record:r,rowKey:c}=o,i=l.includes(c);if(n.push({children:a,parentKey:s,record:r,rowKey:c,level:t,expanded:i}),i&&o.children){const u=De(o.children,l,t+1);n.push(...u)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l){const t=m(()=>l.value.find(r=>"type"in r&&r.type==="expandable")),[n,o]=Be(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:r=>{if(!t.value)return!0;const{disabled:c,customExpand:i}=t.value,{record:u}=r;return c!=null&&c(u)?!0:!(i||r.children&&r.children.length>0)},handleExpandChange:(r,c)=>{const{onChange:i,onExpand:u}=t.value||{},d=[...n.value],y=d.indexOf(r),x=y>=0;x?d.splice(y,1):d.push(r),_(u,!x,c),o(d),_(i,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=m(()=>e.value.filter(a=>a.filterable)),t=he({}),n=T([]);return D(l,(a,s)=>{a.forEach(r=>{const{key:c,filterable:i}=r,u=i.filterBy;if(u||t[c]===void 0){t[c]=u||[];return}const d=s?s.find(x=>x.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=xe(a,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(a,s,r)=>{const{onChange:c}=s;t[a]=r,n.value=xe(l.value,t),_(c,r,n.value)}}}function xe(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:a,filterBy:s=l[n]}=o;return{key:n,filter:a,filterBy:s}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l,t){var i,u;const n=le("pagination"),o=m(()=>{const{pagination:d}=e;return d===!1?null:d===!0?{}:d}),a=T(((i=o.value)==null?void 0:i.pageIndex)??1),s=T(((u=o.value)==null?void 0:u.pageSize)??l.pagination.pageSize??n.pageSize),r=(d,y)=>{var x;a.value=d,s.value=y,_((x=o.value)==null?void 0:x.onChange,d,y)};return{mergedPagination:m(()=>{const d=o.value;return d===null?null:{...l.pagination,size:t.value,...d,pageIndex:d.pageIndex??a.value,pageSize:d.pageSize??s.value,onChange:r}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,{setStickyScrollLeft:t}){const n=T(),o=T(),a=T(),s=T(),r=T();D(n,w=>{w&&(a.value=w.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=It(e,o,a,r,t),d=Ot(e,l,a,s),y=m(()=>{var w;return z((w=e.scroll)==null?void 0:w.width)}),x=m(()=>{var p;let w=z((p=e.scroll)==null?void 0:p.height);return!w&&l.value&&(e.virtual||d.value)&&(w="auto"),w}),v=m(()=>ce(X(a))),S=m(()=>x.value?v.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:a,scrollContentRef:s,scrollFootRef:r,handleScroll:c,scrollTo:w=>{var p;e.virtual?(p=n.value)==null||p.scrollTo(w):typeof w=="number"&&Qe({target:X(a),top:w,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:y,scrollHeight:x,scrollBarSize:v,scrollBarSizeOnFixedHolder:S}}function It(e,l,t,n,o){const a=T(!1),s=T(!1);let r;const c=()=>{r&&(clearTimeout(r),r=void 0)};Q(()=>c());const i=T(),u=v=>{i.value=v,c(),r=setTimeout(()=>{i.value=void 0,r=void 0},100)},d=(v,S)=>{S&&S.scrollLeft!==v&&(S.scrollLeft=v)},y=v=>{const S=X(t);if(!S)return;const{clientWidth:k,scrollWidth:w}=S;o(v/w*k||0)};return{handleScroll:(v,S)=>{const k=v==null?void 0:v.currentTarget,w=S??k.scrollLeft,p=i.value;if((!p||p===k)&&(u(k),d(w,l.value),d(w,X(t)),d(w,n.value),y(w)),k){const{scrollWidth:h,clientWidth:f}=k;a.value=w>0,s.value=w<h-f}(v==null?void 0:v.type)==="scroll"&&_(e.onScroll,v)},pingedStart:a,pingedEnd:s}}function Ot(e,l,t,n){const o=T(!0),a=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let s=[];const r=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,i])=>{r(),c&&!i&&(s=[ie(t,a),ie(n,a)])},{immediate:!0})}),Q(()=>r()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Rt(e,l,t,n,o,a){const s=m(()=>e.scrollToTopOnChange??l.scrollToTopOnChange);let r=[];const c=()=>{r=[D([()=>{var u;return(u=t.value)==null?void 0:u.pageIndex},()=>{var u;return(u=t.value)==null?void 0:u.pageSize}],()=>a(0)),D([o,n],([u,d],[y,x])=>{(!Pt(u,y)||!Wt(d,x))&&a(0)})]},i=()=>{r.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function Pt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Wt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ft(e,l,t,{mergedMap:n,paginatedMap:o}){const a=m(()=>t.value.find(p=>"type"in p&&p.type==="selectable")),[s,r]=Be(e,"selectedRowKeys",()=>[]),c=m(()=>{const{disabled:p}=a.value||{},h=[],f=[];return o.value.forEach((g,C)=>{p!=null&&p(g.record)?f.push(C):h.push(C)}),{enabledRowKeys:h,disabledRowKeys:f}}),i=m(()=>{const p=new Set,h=s.value,{disabledRowKeys:f}=c.value,g=n.value;return h.forEach(C=>{const{parentKey:E}=g.get(C)||{};if(!Y(E)){let B=g.get(E);if(B&&!h.includes(B.rowKey))for(;B&&!Y(B==null?void 0:B.rowKey);)f.includes(B.rowKey)||p.add(B.rowKey),B=Y(B.parentKey)?void 0:g.get(B.parentKey)}}),[...p]}),u=m(()=>{const p=s.value,{disabledRowKeys:h}=c.value;let f=0;return o.value.forEach((g,C)=>{!h.includes(C)&&p.includes(C)&&f++},0),f}),d=m(()=>{const p=o.value.size,h=c.value.disabledRowKeys.length;return p===0||p===h?!1:p===h+u.value}),y=m(()=>!d.value&&u.value>0),x=p=>{r(p);const h=n.value,{onChange:f}=a.value||{};if(f){const g=[];p.forEach(C=>{const E=h.get(C);E&&g.push(E.record)}),_(f,p,g)}},v=(p,h)=>{const f=n.value,{disabledRowKeys:g}=c.value,{multiple:C,onSelect:E}=a.value||{};let B=[...s.value];const $=B.indexOf(p),P=$>=0;if(C){const O=f.get(p),A=Ne(O,g);if(P){B.splice($,1);const R=Ht(f,O,g);B=B.filter(K=>!R.includes(K)&&!A.includes(K))}else B.push(p),B.push(...A);At(f,O,B,g)}else B=P?[]:[p];_(E,!P,h),x(B)},S=()=>{const{enabledRowKeys:p}=c.value,h=new Set(s.value);d.value?p.forEach(f=>h.delete(f)):p.forEach(f=>h.add(f)),x([...h])},k=Mt(a,l),w=_t(a,n,o,s,x);return{selectable:a,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:y,handleSelectChange:v,handleHeadSelectChange:S,mergedSelectableMenus:k,handleSelectableMenuClick:w}}function Ne(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:a}=o;l.includes(a)||t.push(o.rowKey),t.push(...Ne(o,l))}),t}function Ht(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function At(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const a=e.get(l.parentKey);if(a&&!n.includes(l.parentKey)){o=a.children.every(r=>n.includes(r.rowKey)||t.includes(r.rowKey));const s=t.findIndex(r=>r===l.parentKey);o?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=a}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Mt(e,l){return m(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:a,selectPageInvert:s}=l.table;return t.map(r=>N(r)?r==="all"?{type:"item",key:Le,label:n}:r==="invert"?{type:"item",key:je,label:o}:r==="none"?{type:"item",key:Ue,label:a}:r==="pageInvert"?{type:"item",key:qe,label:s}:{type:"item",key:r,label:r}:r)})}function _t(e,l,t,n,o){const a=()=>{const{disabled:u,onSelectAll:d}=e.value||{},y=[];l.value.forEach((x,v)=>{u!=null&&u(x.record)||y.push(v)}),_(d,y),o(y)},s=()=>{const{disabled:u,onSelectInvert:d}=e.value||{},y=[...n.value];l.value.forEach((x,v)=>{if(u!=null&&u(x.record))return;const S=y.indexOf(v);S>=0?y.splice(S,1):y.push(v)}),o(y),_(d,y)},r=()=>{const{onSelectNone:u}=e.value||{};_(u),o([])},c=()=>{const{disabled:u,onSelectPageInvert:d}=e.value||{},y=[],x=n.value;t.value.forEach((v,S)=>{u!=null&&u(v.record)||x.includes(S)||y.push(S)}),_(d,y),o(y)},i=new Map([[Le,a],[je,s],[Ue,r],[qe,c]]);return u=>{const d=u.key;if(dt(d)&&i.has(d)){i.get(d)();return}const{disabled:y,onMenuClick:x}=e.value||{};if(!x)return;const v=[];t.value.forEach((S,k)=>{y!=null&&y(S.record)||v.push(k)}),_(x,u,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=m(()=>e.value.filter(s=>s.sortable)),t=m(()=>l.value.some(s=>s.sortable.multiple!==void 0)),n=he({}),o=T([]);return D(l,(s,r)=>{s.forEach(c=>{const{key:i,sortable:u}=c,d=u.orderBy;if(d||n[i]===void 0){n[i]=d;return}const y=r?r.find(v=>v.key===i):void 0;(y==null?void 0:y.sortable.orderBy)&&(n[i]=void 0)}),o.value=Ce(s,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(s,r)=>{const{orders:c,onChange:i}=r,u=n[s],d=u?Se(c,u):Se(c);t.value?n[s]=d:Object.keys(n).forEach(y=>{s===y?n[y]=d:n[y]=void 0}),o.value=Ce(l.value,n),_(i,d,o.value)}}}function Se(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:a=0,orderBy:s=l[n],sorter:r}=o;return{key:n,multiple:a,orderBy:s,sorter:r}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=m(()=>!!e.sticky),t=m(()=>{const{sticky:a}=e,{offsetTop:s=0,offsetBottom:r=0,offsetScroll:c=0,container:i=window}=ft(a)?a:{};return{offsetTop:s,offsetBottom:r,offsetScroll:c,container:i}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Nt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},a,s){return m(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||s.value||a.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const M=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:a}=F(M);return()=>{const{isFixedHolder:s}=e,r=s?t.value:l.value;if(r.every(u=>!u.width&&!u.type))return;const c=a.value,i=r.map((u,d)=>{const{key:y,type:x}=u,v=s?n.value[d]:u.width,S=x?V({[`${c}-col-${x}`]:!0,[`${c}-col-with-dropdown`]:x==="selectable"&&o.value.length>0}):void 0;let k;return s?k=v?`width: ${z(v)}`:void 0:k={width:z(v),minWidth:z(u.minWidth),maxWidth:z(u.maxWidth)},b("col",{key:y,class:S,style:k},null)});return b("colgroup",null,[i])}}}),Lt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:a,flattedData:s,isSticky:r,columnWidths:c}=F(M);jt(n,o);const i=m(()=>a.value==="max-content"),u=m(()=>s.value.length>0),d=m(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:r.value}}),y=m(()=>{const v=r.value,{offsetTop:S,offsetBottom:k}=e;return{overflow:"hidden",top:v?z(S):void 0,bottom:v?z(k):void 0}}),x=m(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:d.value,style:y.value,ref:n},[b("table",{style:x.value},[(u.value||!i.value)&&b(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function jt(e,l){const t=n=>{const o=n.deltaX,a=n.currentTarget;if(o){const s=a.scrollLeft+o;l(n,s),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Q(()=>G(e.value,"wheel",t))}const Ut=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:a}=F(M),s=T(!1),r=T(!1),c=T(0),i=T(0),u=T(0),d=m(()=>{const h=i.value,f=u.value;return f&&h*(h/f)});Ie(()=>{const h=X(l);if(h&&s.value){const{clientWidth:f,scrollWidth:g,scrollLeft:C}=h;a(C/g*f),i.value=f,u.value=g}});const y=m(()=>({height:ce(),width:i.value,bottom:n.value.offsetScroll})),x=m(()=>{const h=e.value;return{[`${h}-sticky-scrollbar-thumb`]:!0,[`${h}-sticky-scrollbar-thumb-active`]:r.value}}),v=m(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),S=()=>r.value=!1,k=h=>{c.value=h.pageX-o.value,r.value=!0,h.preventDefault()},w=h=>{if(!r.value)return;const{buttons:f}=h||window.event;if(f===0){r.value=!1;return}let g=h.pageX-c.value;g<=0&&(g=0);const C=i.value,E=u.value,B=d.value;g+B>=C&&(g=C-B);const $=g/C*(E+2);t(h,$)},p=()=>{const h=X(l),f=ge(h).top,g=f+h.offsetHeight,{container:C,offsetScroll:E}=n.value,B=C===window?document.documentElement.scrollTop+window.innerHeight:ge(C).top+C.clientHeight;g-ce()<=B||f>=B-E?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",S),ee(document.body,"mousemove",w),ee(window,"resize",p),D(()=>n.value.container,(h,f)=>{G(f,"scroll",p),ee(h,"scroll",p)},{immediate:!0}),p()}),Q(()=>{G(document.body,"mouseup",S),G(document.body,"mousemove",w),G(window,"resize",p),G(n.value.container,"scroll",p)}),()=>!l.value||!s.value||u.value<=i.value||!d.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:y.value},[b("div",{class:x.value,style:v.value,onMousedown:k},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:a,scrollBarColumn:s}=F(M),{mainTableWidth:r}=F(pe),c=m(()=>n.value.length);return()=>{let i=l.default();if(e.isEmpty?a.value:o.value){const u=s.value;i=b("div",{class:`${t.value}-fixed-row`,style:{width:z(r.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const qt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Xt={columns:{type:Array,required:!0}},Vt={column:{type:Object,required:!0}},Gt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Yt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Qt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Zt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},el=H({props:Jt,setup(e){const l=T();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[vt("Â ")])])}}),tl=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(M),{changeColumnWidth:t}=F(pe);return()=>{const n=l.value.map(o=>{const{key:a}=o;return b(el,{key:a,cellKey:a,changeColumnWidth:t},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),ll=H({props:Yt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:a,activeOrderByMap:s,fixedColumnKeys:r,columnOffsets:c,isSticky:i,expandable:u,selectable:d,mergedPagination:y}=F(M),x=m(()=>s[e.column.key]),v=nl(e),S=m(()=>r.value.lastStartKey===e.column.key),k=m(()=>r.value.firstEndKey===e.column.key),w=m(()=>{const{type:f,ellipsis:g}=e.column;return f?g:g??l.ellipsis}),p=m(()=>{const{fixed:f,align:g}=e.column,C=o.value;let E={[`${C}-cell`]:!0,[`${C}-cell-sorted`]:!!x.value,[`${C}-cell-align-${g}`]:!!g&&g!="start",[`${C}-cell-ellipsis`]:!!w.value};return f&&(E={...E,[`${C}-fix-start`]:f==="start",[`${C}-fix-start-last`]:S.value,[`${C}-fix-end`]:f==="end",[`${C}-fix-end-first`]:k.value,[`${C}-fix-sticky`]:i.value}),V(E)}),h=m(()=>{const{fixed:f}=e.column;if(!f)return;const{starts:g,ends:C}=c.value,B=z((f==="start"?g:C)[e.colIndex]);return{position:"sticky",left:f==="start"?B:void 0,right:f==="end"?B:void 0}});return()=>{var O,A;const{column:f}=e,{type:g}=f;let C,E;if(g==="selectable")C=al(e,t,d,n,y);else if(g==="indexable")C=Xe(e,t,f,y);else{const R=v.value;if(C=ol(e,t,R),E=We(w.value,C,R),!g&&(Y(C)||C==="")){const K=t.emptyCell||a.value;C=J(K)?K({column:f,record:e.record,rowIndex:e.rowIndex}):K}}e.column.fixed&&w.value&&(S.value||k.value)&&(C=b("span",{class:`${o.value}-cell-content`},[C]));const B=(O=l.customAdditional)==null?void 0:O.bodyCell,$=B?B({column:f,record:e.record,rowIndex:e.rowIndex}):void 0,P=((A=l.customTag)==null?void 0:A.bodyCell)??"td";return b(P,Z({class:p.value,style:h.value,title:E},$),{default:()=>[g==="expandable"&&sl(e,t,u,o.value),C]})}}});function nl(e){return m(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let a=0;a<n.length&&o;a++){const s=n[a];o=o[s]}return o})}function ol(e,l,t){const{record:n,rowIndex:o,column:a}=e,{customCell:s}=a,r=N(s)?l[s]:s;return r?r({value:t,record:n,rowIndex:o}):t}function sl(e,l,t,n){if(e.disabled)return;const{icon:o,customIcon:a,indent:s}=t.value,{record:r,expanded:c,level:i=0}=e,u=s?`margin-left: ${z(i*s)}`:void 0;let d;const y=(N(a)?l[a]:a)??o;return J(y)?d=y({expanded:!!c,record:r}):d=N(y)?b(te,{name:y,rotate:c?90:0},null):y,b("button",{class:`${n}-expandable-trigger`,style:u,type:"button",onClick:e.handleExpend},[d])}function al(e,l,t,n,o){const{selected:a,indeterminate:s,disabled:r,isHover:c,handleSelect:i}=e,{showIndex:u,multiple:d,customCell:y}=t.value,x=S=>{S.stopPropagation(),!d&&a&&!r&&i&&i()};if(!a&&!c&&u)return Xe(e,l,n.columnIndexable,o);const v=N(y)?l[y]:y;if(d){const S={checked:a,disabled:r,indeterminate:s,onChange:i,onClick:x};return v?v(S):b(ve,S,null)}else{const S={checked:a,disabled:r,onChange:i,onClick:x};return v?v(S):b(Re,S,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:a,disabled:s}=e,{customCell:r}=t,{pageIndex:c=1,pageSize:i=0}=n.value||{},u=N(r)?l[r]:r;return u?b("span",{style:s?"cursor: not-allowed":"cursor: pointer"},[u({record:o,rowIndex:a,pageIndex:c,pageSize:i})]):void 0}const rl=H({props:Gt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:a,checkExpandDisabled:s,selectable:r,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:d}=F(M),{expandDisabled:y,handleExpend:x,selectDisabled:v,handleSelect:S,isHover:k,attrs:w}=cl(e,o,s,a,r,u,d),p=m(()=>c.value.includes(e.rowKey)),h=m(()=>i.value.includes(e.rowKey)),f=m(()=>{const g=`${t.value}-row`,{level:C,expanded:E}=e;return V({[`${g}`]:!0,[`${g}-level-${C}`]:!!C,[`${g}-selected`]:p.value,[`${g}-expanded`]:E})});return()=>{var B,$;const g=(B=l.customAdditional)==null?void 0:B.bodyRow,C=g?g({record:e.record,rowIndex:e.rowIndex}):void 0,E=(($=l.customTag)==null?void 0:$.bodyRow)??"tr";return b(E,Z({class:f.value},w.value,C),{default:()=>[il(e,n,y,x,p,h,v,S,k)]})}}});function cl(e,l,t,n,o,a,s){const r=m(()=>t(e.rowData)),c=m(()=>{var f;return(f=l.value)==null?void 0:f.trigger}),i=()=>{const{rowKey:f,record:g}=e;n(f,g)},u=m(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=m(()=>{var f;return(f=o.value)==null?void 0:f.trigger}),y=m(()=>{var f;return(f=o.value)==null?void 0:f.showIndex}),x=T(!1),v=()=>{const{rowKey:f,record:g}=e;a(f,g)},S=()=>{c.value==="click"&&i(),d.value==="click"&&v()},k=()=>{c.value==="dblclick"&&i(),d.value==="dblclick"&&v()},w=()=>x.value=!0,p=()=>x.value=!1,h=m(()=>{const f=r.value,g=c.value,C=u.value,E=d.value,B=!f&&g==="click"||!C&&E==="click",$=!f&&g==="dblclick"||!C&&E==="dblclick",P=!C&&y.value;let O="";return B||$?O="pointer":(f&&g||C&&E)&&(O="not-allowed"),{style:O?`cursor: ${O}`:void 0,onClick:B?S:void 0,onDblclick:$?k:void 0,onMouseenter:P?w:void 0,onMouseleave:P?p:void 0}});return{expandDisabled:r,handleExpend:i,selectDisabled:u,handleSelect:v,isHover:x,attrs:h}}function il(e,l,t,n,o,a,s,r,c){const i=[],{rowIndex:u,record:d,level:y}=e;return l.value.forEach((x,v)=>{const{type:S,colSpan:k,rowSpan:w,key:p}=x,h=k==null?void 0:k(d,u),f=w==null?void 0:w(d,u);if(h===0||f===0)return;const g={colSpan:h===1?void 0:h,rowSpan:f===1?void 0:f,rowIndex:u,colIndex:v,record:d,column:x,level:y,key:p};S==="expandable"?(g.expanded=e.expanded,g.disabled=t.value,g.handleExpend=n):S==="selectable"&&(g.selected=o.value,g.indeterminate=a.value,g.disabled=s.value,g.handleSelect=r,g.isHover=c.value),i.push(b(ll,g,null))}),i}function Ve(e,l,t,n,o){const{expanded:a,level:s,record:r,rowKey:c}=e,i={key:c,expanded:a,level:s,record:r,rowData:e,rowIndex:l,rowKey:c},u=b(rl,i,null),d=a&&ul(i,t,n,o);return d?[u,d]:u}function ul(e,l,t,n){const{customExpand:o}=t||{},{record:a,rowIndex:s}=e;let r;return J(o)?r=o({record:a,rowIndex:s}):N(o)&&l[o]&&(r=l[o]({record:a,rowIndex:s})),r&&b(de,{class:`${n}-expanded-row`},{default:()=>[r]})}const re=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:a,flattedData:s,expandable:r,scrollWidth:c,scrollHeight:i,isSticky:u}=F(M),d=m(()=>a.value||c.value||i.value||u.value);return()=>{const y=o.value,x=[];n.alert&&x.push(b(de,{class:`${y}-alert-row`},{default:()=>[n.alert()]}));const v=s.value;return v.length>0?l.default?x.push(...l.default()):v.forEach((S,k)=>{x.push(...fe(Ve(S,k,n,r.value,y)))}):x.push(b(de,{class:`${y}-empty-row`,isEmpty:!0},{default:()=>[b(Ze,{empty:t.empty},n)]})),b("tbody",{class:`${o.value}-tbody`},[d.value&&b(tl,null,null),x])}}}),dl=H({props:Qt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(M),a=m(()=>e.filterable.multiple??t.columnBase.filterable.multiple),s=m(()=>e.filterable.footer??t.columnBase.filterable.footer),r=e.activeFilterBy,[c,i]=oe(()=>r);D(()=>e.activeFilterBy,h=>i(h));const[u,d]=oe(!1),y=h=>{d(h),h||e.onUpdateFilterBy(c.value)},x=()=>{d(!1),e.onUpdateFilterBy(c.value)},v=()=>{i(r)},S=h=>{const f=`${o.value}-filterable-menu-label`,g=a.value?ve:Re;return b("span",{class:f},[b(g,{checked:h.selected,disabled:h.disabled},null),b("span",{class:`${f}-content`},[h.label])])},k=()=>{const h=[],{customMenu:f,menus:g}=e.filterable;return J(f)?h.push(f()):N(f)&&l[f]?h.push(l[f]()):h.push(fl(g,a,c,i,S)),s.value&&h.push(vl(n,o,x,v)),h},w=m(()=>{const h=`${o.value}-filterable-trigger`;return V({[h]:!0,[`${h}-active`]:e.activeFilterBy.length>0})}),p=()=>{const{customTrigger:h}=e.filterable;return J(h)?h():N(h)&&l[h]?l[h]():b("span",{class:w.value,onClick:f=>f.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const h={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":y};return b(Ke,h,{default:p,overlay:k})}}}),fl=(e,l,t,n,o)=>{const a={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return b(Ee,a,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:a}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),b(me,{size:"xs",onClick:n},{default:()=>[a]})])},hl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:a,handleHeadSelectChange:s,mergedSelectableMenus:r,handleSelectableMenuClick:c}=F(M),i=m(()=>{const k=l.value.size;return k===0||k===n.value.disabledRowKeys.length}),[u,d]=oe(!1),y={"onUpdate:visible":d,trigger:"click"},x=()=>b(Ee,{dataSource:r.value,onClick:c},null),v=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),S=()=>{if(r.value.length!==0)return b(Ke,y,{default:v,overlay:x})};return()=>{const{multiple:k}=t.value;if(k)return b("span",{class:`${e.value}-cell-triggers`},[b(ve,{checked:o.value,indeterminate:a.value,disabled:i.value,onChange:s},null),S()])}}}),yl=H({props:Zt,setup(e){const{locale:l,mergedPrefixCls:t}=F(M);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:a,nextTooltip:s}=o,r=s&&pl(l.table,a,n),c=gl(t,a,n);return r?b(et,{title:r},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:a,sortDesc:s}=e;return n?n==="ascend"?a:s:o}function gl(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,a=l.includes("ascend")&&b(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),s=l.includes("descend")&&b(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return b("span",{class:`${n}-sortable-trigger`},[a,s])}const ml=H({props:Vt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:a,isSticky:s,handleSort:r,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(M),d=m(()=>{const{type:p,ellipsis:h}=e.column,f=p?h:h??l.ellipsis;return $e(f)&&f.head===!1?void 0:f}),y=m(()=>{const{type:p,align:h,fixed:f,hasChildren:g,key:C,sortable:E,filterable:B}=e.column,$=n.value;let P={[`${$}-cell`]:!0,[`${$}-cell-${p}`]:!!p,[`${$}-cell-filterable`]:!!B,[`${$}-cell-sortable`]:!!E,[`${$}-cell-align-center`]:g||h==="center",[`${$}-cell-align-end`]:!g&&h==="end",[`${$}-cell-ellipsis`]:!!d.value};if(f){const{lastStartKey:O,firstEndKey:A}=o.value;P={...P,[`${$}-fix-start`]:f==="start",[`${$}-fix-start-last`]:O===C,[`${$}-fix-end`]:f==="end",[`${$}-fix-end-first`]:A===C,[`${$}-fix-sticky`]:s.value}}return V(P)}),x=m(()=>{const{fixed:p,colStart:h,colEnd:f}=e.column;if(!p)return;const{starts:g,ends:C}=a.value,$=z((p==="start"?g:C)[p==="start"?h:f]);return{position:"sticky",left:p==="start"?$:void 0,right:p==="end"?$:void 0}}),v=m(()=>c[e.column.key]),S=m(()=>i[e.column.key]||tt),k=p=>{const{key:h,filterable:f}=e.column;u(h,f,p)},w=()=>{const{key:p,sortable:h}=e.column;h&&r(p,h)};return()=>{var A,R;const{column:p}=e,{type:h,titleColSpan:f,titleRowSpan:g}=p;if(h==="scroll-bar")return b("th",{class:y.value,style:x.value,colspan:f===1?void 0:f,rowspan:g===1?void 0:g,onClick:w},null);const C=n.value;let E,B;if(h==="selectable")B=b(hl,null,null);else{const{title:K,customTitle:I,sortable:W,filterable:U}=p,L=d.value;B=bl(K,I,t),E=We(L,B,K);const j=xl(W,v,U,S,k);j.length>0?B=b("span",{class:`${C}-cell-triggers`},[b("span",{class:`${C}-cell-title`},[B]),j]):L&&(B=b("span",{class:`${C}-cell-title`},[B]))}const $=(A=l.customAdditional)==null?void 0:A.headCell,P=$?$({column:p}):void 0,O=((R=l.customTag)==null?void 0:R.headCell)??"th";return b(O,Z({class:y.value,style:x.value,colSpan:f===1?void 0:f,rowSpan:g===1?void 0:g,title:E},P,{onClick:w}),{default:()=>[B]})}}});function bl(e,l,t){let n=e;return J(l)?n=l({title:e}):N(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const a=[];return e&&a.push(b(yl,{activeOrderBy:l.value,sortable:e},null)),t&&a.push(b(dl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),a}const Sl=H({props:Xt,setup(e){const{props:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const{columns:n}=e,o=(r=l.customAdditional)==null?void 0:r.headRow,a=o?o({columns:n}):void 0,s=((c=l.customTag)==null?void 0:c.headRow)??"tr";return b(s,Z({class:`${t.value}-row`},a),{default:()=>[n.filter(i=>i.titleColSpan!==0).map(i=>b(ml,{key:i.key,column:i},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const n=l.value,o=(r=e.customAdditional)==null?void 0:r.head,a=o?o({rows:n}):void 0,s=((c=e.customTag)==null?void 0:c.head)??"thead";return b(s,Z({class:`${t.value}-thead`},a),{default:()=>[n.map((i,u)=>b(Sl,{key:u,columns:i},null))]})}}}),Cl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:a,columnWidths:s,changeColumnWidth:r,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:d,scrollBodyRef:y,scrollContentRef:x,handleScroll:v,pingedStart:S,pingedEnd:k,scrollWidth:w,scrollHeight:p,hasFixed:h,tableLayout:f}=F(M),g=T(),C=T(0);Oe(pe,{mainTableWidth:C,changeColumnWidth:(K,I)=>{st(g.value)&&r(K,I)}});const B=()=>{const K=X(y);K&&v({currentTarget:K})},$=K=>{const{offsetWidth:I}=K.target;I!==C.value&&(C.value=I)};se(()=>{B(),D([()=>e.dataSource,w],([,I])=>{I&&B()}),D(s,Te(()=>{var W;((W=X(y))==null?void 0:W.scrollLeft)===0&&B()},16)),lt(g.value,$)}),Q(()=>nt(g.value,$));const P=m(()=>{const K=n.value;return V({[`${K}-container`]:!0,[`${K}-ping-start`]:S.value,[`${K}-ping-end`]:k.value,[`${K}-fixed-layout`]:f.value==="fixed",[`${K}-fixed-column`]:h.value,[`${K}-scroll-horizontal`]:w.value,[`${K}-scroll-vertical`]:p.value})}),O=m(()=>{var j;const K=w.value,I=p.value,W=K?"auto":void 0,U=e.virtual?"hidden":I?"scroll":K?"hidden":void 0,L=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:W,overflowY:U,[L?"height":"maxHeight"]:I}}),A=m(()=>({tableLayout:f.value,width:w.value,minWidth:w.value?"100%":void 0})),R=(K,I,W)=>{_(e.onScrolledChange,K,I,W.map(U=>U.record))};return()=>{const K=n.value,I=a.value,W=l.default?l.default():[];if(I||p.value||i.value){const{offsetTop:U}=u.value;if(e.headless||W.push(b(Lt,{offsetTop:U},{default:()=>[b(we,null,null)]})),e.virtual&&(e.scroll||I)){const L=({item:ae,index:Ye})=>Ve(ae,Ye,l,t.value,K),j=ae=>b("table",{ref:x,class:`${K}-table`,style:A.value},[b(ne,null,null),b(re,null,{default:()=>[ae]}),!1]),{scroll:q,onScrolledBottom:Ge}=e;W.push(b(ot,{ref:d,style:O.value,dataSource:c.value,fullHeight:q==null?void 0:q.fullHeight,getKey:"rowKey",height:a.value?"100%":q==null?void 0:q.height,itemHeight:o.value,itemRender:L,contentRender:j,virtual:!0,onScroll:v,onScrolledBottom:Ge,onScrolledChange:R},null))}else W.push(b("div",{ref:y,class:`${K}-content`,style:O.value,onScroll:v},[b("table",{ref:x,class:`${K}-table`,style:A.value},[b(ne,null,null),b(re,null,null),!1])]));i.value&&W.push(b(Ut,null,null))}else W.push(b("div",{ref:y,class:`${K}-content`,style:O.value,onScroll:v},[b("table",{ref:x,class:`${K}-table`,style:A.value},[b(ne,null,null),!e.headless&&b(we,null,null),b(re,null,null),!1])]));return b("div",{ref:g,class:P.value},[W])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wl(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t){let n=null,o=null;if(e!==null){const{position:a}=e,[s,r]=ht(a).split("-"),c=`${t}-pagination ${t}-pagination-${r}`,i=b(pt,Z({class:c,total:l.length},e),null);n=s==="top"?i:null,o=s==="bottom"?i:null}return[n,o]}const Bl={sm:32,md:40,lg:56},Kl={sm:40,md:48,lg:56},El=H({name:"IxTable",props:qt,setup(e,{expose:l,slots:t}){const n=le("common"),o=m(()=>`${n.prefixCls}-table`),a=le("locale"),s=le("table"),r=m(()=>e.autoHeight??s.autoHeight),c=m(()=>e.childrenKey??s.childrenKey),i=at(e,s),u=m(()=>e.emptyCell??s.emptyCell),d=m(()=>e.size??s.size),y=m(()=>n.theme==="seer"?Bl[d.value]:Kl[d.value]),{mergedPagination:x}=$t(e,s,d),v=Dt(e),S=Tt(e,r,v),k=mt(e,t,s,S.scrollBarSizeOnFixedHolder),w=zt(k.flattedColumns),p=Et(k.flattedColumns),h=Kt(e,k.flattedColumns),f=Nt(e,k,S,v.isSticky,r),{activeSorters:g}=w,{activeFilters:C}=p,E=Bt(e,c,i,g,C,h.expandedRowKeys,x),B=Ft(e,a,k.flattedColumns,E);Rt(e,s,x,g,C,S.scrollTo);const $={props:e,slots:t,config:s,locale:a,mergedPrefixCls:o,mergedEmptyCell:u,mergedVirtualItemHeight:y,mergedAutoHeight:r,...k,...S,...w,...p,...v,tableLayout:f,mergedPagination:x,...h,...E,...B};Oe(M,$),l({scrollTo:S.scrollTo});const{flattedData:P,filteredData:O}=E,A=m(()=>{const R=o.value,{borderless:K=s.borderless,scroll:I}=e;return V({[R]:!0,[`${R}-auto-height`]:r.value,[`${R}-borderless`]:K,[`${R}-empty`]:P.value.length===0,[`${R}-full-height`]:I==null?void 0:I.fullHeight,[`${R}-${d.value}`]:!0})});return()=>{const R=o.value,K=b(rt,{header:e.header},t),I=wl(t,R),[W,U]=kl(x.value,O.value,R),L=[K],j=[W,b(Cl,null,null),I,U].filter(Boolean),q=$l(e.spin);return q?L.push(b(ct,q,{default:()=>[j]})):L.push(...j),b("div",{class:A.value},[L])}}});function $l(e){return yt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pl=El,Wl=ye;export{Pl as I,Wl as a,gt as g,qt as t};
