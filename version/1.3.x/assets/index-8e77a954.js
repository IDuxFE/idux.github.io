import{M as ke,N as fe,aI as Je,al as Be,m as _,L as le,aJ as z,aK as ce,o as X,D as ie,U as Qe,K as oe,R as ee,S as G,a3 as ge,A as te,k as ve,aq as Ze,a1 as Ke,a0 as Ee,c as me,aa as et,ao as tt,E as lt,G as nt,H as ot,aL as st,ar as at,an as rt,ay as ct}from"./index-4edbd2bb.js";import{j as Te,l as N,L as it,T as ut,f as b,r as he,b as I,w as D,a7 as $e,Q as Ie,k as Y,N as Q,x as se,bi as dt,P as ft,v as H,z as V,y as x,i as F,ad as vt,a as J,a2 as Z,p as Re,Z as ht,av as yt}from"./vendor-1c103b38.js";import{b as Oe}from"./GlobalCodeBox-3884ee00.js";import{I as pt}from"./index-45be4d8d.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pe=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Pe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function We(e,l,t){if(!e||Te(e)&&e.title===!1)return;if(N(l)||it(l))return l;const n=ke(l).find(o=>o.type===ut);return n?n.children:t}function gt(e){return e.key?e.key:e.dataKey?fe(e.dataKey).join("-"):e.type?`__IDUX_table_column_key_${e.type}`:Je("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function mt(e,l,t,n){const o=b(()=>{var m;const{columns:w}=e;return Fe(w&&w.length>0?w:He((m=l.default)==null?void 0:m.call(l)),t)}),{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r}=xt(o,n),c=St(r),u=b(()=>!!e.ellipsis||a.value.some(w=>w.ellipsis)),i=b(()=>a.value.some(w=>w.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y}=Ct(a,s),{columnOffsets:v,columnOffsetsWithScrollBar:S}=wt(d,h),C=b(()=>kt(o.value,s.value));return{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r,fixedColumnKeys:c,hasEllipsis:u,hasFixed:i,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y,columnOffsets:v,columnOffsetsWithScrollBar:S,mergedRows:C}}function Fe(e,l){return e.map(t=>bt(t,l))}function He(e){const l=[];return ke(e,{key:Pe}).forEach((t,n)=>{const{props:o,children:a}=t,{key:s=n,editable:r,ellipsis:c,...u}=o||{};u.key=s,u.editable=r||r==="",u.ellipsis=c||c==="";const{default:i,cell:d,title:h,expand:y,icon:v}=a||{};i&&(u.children=He(i())),d&&(u.customCell=d),h&&(u.customTitle=h),y&&(u.customExpand=y),v&&(u.customIcon=v),l.push(u)}),l}function bt(e,l){const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:a}=l,{align:s=t.align}=e,r=gt(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{icon:u=n.icon}=e;return{...e,key:r,align:s,icon:u}}if(c==="selectable"){const{multiple:u=!0,showIndex:i=o.showIndex}=e;return{...e,key:r,align:s,multiple:u,showIndex:i}}if(c==="indexable"){const u=e.align??a.align??t.align;return{...a,...e,align:u,key:r}}return{...e,key:r,align:s}}else{const{sortable:c,filterable:u,children:i}=e,d={...e,key:r,align:s};return c&&(d.sortable={...t.sortable,...c}),u&&(d.filterable={...t.filterable,...u}),i!=null&&i.length&&(d.children=Fe(i,l)),d}}function xt(e,l){const t=b(()=>Ae(e.value)),n=b(()=>{const a=l.value;if(a===0)return;const s=t.value,r=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:r&&r.fixed,width:a}}),o=b(()=>{const a=t.value;if(a.length===0)return a;const s=n.value;return s?[...a,s]:a});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let a=Ae(o);n&&(a=a.map(s=>({fixed:n,...s}))),l.push(...a)}else l.push(t)}),l}function St(e){return b(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:a}=n;o==="start"?l=a:o==="end"&&(t||(t=a))}),{lastStartKey:l,firstEndKey:t}})}function Ct(e,l){const t=he({}),n=I(),o=I([]);D(n,$e(r=>{o.value=r?r.split("-").map(Number):[]},16)),Ie(()=>{const r=Object.keys(t),c=e.value;if(r.length!==c.length){n.value=void 0;return}n.value=c.map(u=>t[u.key]).join("-")});const a=b(()=>{const r=o.value;if(r.length===0)return r;const c=l.value;return c?[...r,c.width]:r});return{columnWidths:o,columnWidthsWithScrollBar:a,changeColumnWidth:(r,c)=>{c===!1?delete t[r]:t[r]=c}}}function wt(e,l){const t=b(()=>be(e.value)),n=b(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,a=0;for(let s=0;s<l;s++){t[s]=o,o+=e[s]||0;const r=l-s-1;n[r]=a,a+=e[r]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(s,r,c){t[c]??(t[c]=[]);let u=r;return s.map(d=>{let h=d.titleColSpan??1,y=!1;const v=d.children;if(v!=null&&v.length){y=!0;const C=n(v,u,c+1);Y(d.titleColSpan)&&(h=C.reduce((w,m)=>w+m))}const S=u+h-1;return t[c].push({...d,titleColSpan:h,colStart:u,colEnd:S,hasChildren:y}),u+=h,h})}const o=l?[...e,l]:e;n(o,0,0);const a=t.length;return t.forEach((s,r)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=a-r)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,l,t,n,o,a,s){const r=b(()=>{const v=l.value,S=t.value;return e.dataSource.map(C=>Me(C,S,v))}),c=b(()=>{const v=new Map;return ue(r.value,v),v}),u=b(()=>ze(r.value,o.value,a.value)),i=b(()=>_e(u.value,n.value,a.value)),d=b(()=>{const v=s.value,S=i.value;if(v===null||!v.pageSize)return S;{const{total:C}=v;if(C&&S.length<C)return S;const w=v.pageSize,m=(v.pageIndex-1)*w;return S.slice(m,m+w)}}),h=b(()=>{const v=new Map;return ue(d.value,v),v}),y=b(()=>{const v=a.value;return v.length>0?De(d.value,v,0):d.value});return{filteredData:u,flattedData:y,mergedMap:c,paginatedMap:h}}function Me(e,l,t,n){const o=l(e),a={record:e,rowKey:o,parentKey:n},s=e[t];return s&&(a.children=s.map(r=>Me(r,l,t,o))),a}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function _e(e,l,t){const n=l.filter(s=>s.sorter),o=n.length;if(o===0)return e;const a=e.slice();return a.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=_e(s.children,l,t))}),a.sort((s,r)=>{for(let c=0;c<o;c++){const{orderBy:u,sorter:i}=n[c],d=i(s.record,r.record);if(d!==0)return u==="ascend"?d:-d}return 0})}function ze(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const a=n.every(({filter:i,filterBy:d})=>i(d,o.record)),{rowKey:s,children:r}=o,c=t.includes(s);let u=o;if(c&&r&&r.length){const i=ze(r,l,t);i.length!==r.length&&(u={...o,children:i})}return a||c&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:a,parentKey:s,record:r,rowKey:c}=o,u=l.includes(c);if(n.push({children:a,parentKey:s,record:r,rowKey:c,level:t,expanded:u}),u&&o.children){const i=De(o.children,l,t+1);n.push(...i)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l){const t=b(()=>l.value.find(r=>"type"in r&&r.type==="expandable")),[n,o]=Be(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:r=>{if(!t.value)return!0;const{disabled:c,customExpand:u}=t.value,{record:i}=r;return c!=null&&c(i)?!0:!(u||r.children&&r.children.length>0)},handleExpandChange:(r,c)=>{const{onChange:u,onExpand:i}=t.value||{},d=[...n.value],h=d.indexOf(r),y=h>=0;y?d.splice(h,1):d.push(r),_(i,!y,c),o(d),_(u,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=b(()=>e.value.filter(a=>a.filterable)),t=he({}),n=I([]);return D(l,(a,s)=>{a.forEach(r=>{const{key:c,filterable:u}=r,i=u.filterBy;if(i||t[c]===void 0){t[c]=i||[];return}const d=s?s.find(y=>y.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=xe(a,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(a,s,r)=>{const{onChange:c}=s;t[a]=r,n.value=xe(l.value,t),_(c,r,n.value)}}}function xe(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:a,filterBy:s=l[n]}=o;return{key:n,filter:a,filterBy:s}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t){var u,i;const n=le("pagination"),o=b(()=>{const{pagination:d}=e;return d===!1?null:d===!0?{}:d}),a=I(((u=o.value)==null?void 0:u.pageIndex)??1),s=I(((i=o.value)==null?void 0:i.pageSize)??l.pagination.pageSize??n.pageSize),r=(d,h)=>{var y;a.value=d,s.value=h,_((y=o.value)==null?void 0:y.onChange,d,h)};return{mergedPagination:b(()=>{const d=o.value;return d===null?null:{...l.pagination,...d,pageIndex:d.pageIndex??a.value,pageSize:d.pageSize??s.value,size:t.value,onChange:r}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l,{setStickyScrollLeft:t}){const n=I(),o=I(),a=I(),s=I(),r=I();D(n,w=>{w&&(a.value=w.holderRef.value)});const{handleScroll:c,pingedStart:u,pingedEnd:i}=It(o,a,r,t),d=Rt(e,l,a,s),h=b(()=>{var w;return z((w=e.scroll)==null?void 0:w.width)}),y=b(()=>{var m;let w=z((m=e.scroll)==null?void 0:m.height);return!w&&l.value&&(e.virtual||d.value)&&(w="auto"),w}),v=b(()=>ce(X(a))),S=b(()=>y.value?v.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:a,scrollContentRef:s,scrollFootRef:r,handleScroll:c,scrollTo:w=>{var m;e.virtual?(m=n.value)==null||m.scrollTo(w):typeof w=="number"&&Qe({target:X(a),top:w,duration:200})},pingedStart:u,pingedEnd:i,scrollWidth:h,scrollHeight:y,scrollBarSize:v,scrollBarSizeOnFixedHolder:S}}function It(e,l,t,n){const o=I(!1),a=I(!1);let s;const r=()=>{s&&(clearTimeout(s),s=void 0)};Q(()=>r());const c=I(),u=y=>{c.value=y,r(),s=setTimeout(()=>{c.value=void 0,s=void 0},100)},i=(y,v)=>{v&&v.scrollLeft!==y&&(v.scrollLeft=y)},d=y=>{const v=X(l);if(!v)return;const{clientWidth:S,scrollWidth:C}=v;n(y/C*S||0)};return{handleScroll:(y,v)=>{const S=y==null?void 0:y.currentTarget,C=v??S.scrollLeft,w=c.value;if((!w||w===S)&&(u(S),i(C,e.value),i(C,X(l)),i(C,t.value),d(C)),S){const{scrollWidth:m,clientWidth:f}=S;o.value=C>0,a.value=C<m-f}},pingedStart:o,pingedEnd:a}}function Rt(e,l,t,n){const o=I(!0),a=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let s=[];const r=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,u])=>{r(),c&&!u&&(s=[ie(t,a),ie(n,a)])},{immediate:!0})}),Q(()=>r()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ot(e,l,t,n,o,a){const s=b(()=>e.scrollToTopOnChange??l.scrollToTopOnChange);let r=[];const c=()=>{r=[D([()=>{var i;return(i=t.value)==null?void 0:i.pageIndex},()=>{var i;return(i=t.value)==null?void 0:i.pageSize}],()=>a(0)),D([o,n],([i,d],[h,y])=>{(!Pt(i,h)||!Wt(d,y))&&a(0)})]},u=()=>{r.forEach(i=>i())};D(s,i=>{u(),i&&c()},{immediate:!0})}function Pt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Wt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ft(e,l,t,{mergedMap:n,paginatedMap:o}){const a=b(()=>t.value.find(m=>"type"in m&&m.type==="selectable")),[s,r]=Be(e,"selectedRowKeys",()=>[]),c=b(()=>{const{disabled:m}=a.value||{},f=[],g=[];return o.value.forEach((p,k)=>{m!=null&&m(p.record)?g.push(k):f.push(k)}),{enabledRowKeys:f,disabledRowKeys:g}}),u=b(()=>{const m=new Set,f=s.value,{disabledRowKeys:g}=c.value,p=n.value;return f.forEach(k=>{const{parentKey:K}=p.get(k)||{};if(!Y(K)){let B=p.get(K);if(B&&!f.includes(B.rowKey))for(;B&&!Y(B==null?void 0:B.rowKey);)g.includes(B.rowKey)||m.add(B.rowKey),B=Y(B.parentKey)?void 0:p.get(B.parentKey)}}),[...m]}),i=b(()=>{const m=s.value,{disabledRowKeys:f}=c.value;let g=0;return o.value.forEach((p,k)=>{!f.includes(k)&&m.includes(k)&&g++},0),g}),d=b(()=>{const m=o.value.size,f=c.value.disabledRowKeys.length;return m===0||m===f?!1:m===f+i.value}),h=b(()=>!d.value&&i.value>0),y=m=>{r(m);const f=n.value,{onChange:g}=a.value||{};if(g){const p=[];m.forEach(k=>{const K=f.get(k);K&&p.push(K.record)}),_(g,m,p)}},v=(m,f)=>{const g=n.value,{disabledRowKeys:p}=c.value,{multiple:k,onSelect:K}=a.value||{};let B=[...s.value];const E=B.indexOf(m),P=E>=0;if(k){const R=g.get(m),A=Ne(R,p);if(P){B.splice(E,1);const O=Ht(g,R,p);B=B.filter(T=>!O.includes(T)&&!A.includes(T))}else B.push(m),B.push(...A);At(g,R,B,p)}else B=P?[]:[m];_(K,!P,f),y(B)},S=()=>{const{enabledRowKeys:m}=c.value,f=new Set(s.value);d.value?m.forEach(g=>f.delete(g)):m.forEach(g=>f.add(g)),y([...f])},C=Mt(a,l),w=_t(a,n,o,s,y);return{selectable:a,selectedRowKeys:s,indeterminateRowKeys:u,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:v,handleHeadSelectChange:S,mergedSelectableMenus:C,handleSelectableMenuClick:w}}function Ne(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:a}=o;l.includes(a)||t.push(o.rowKey),t.push(...Ne(o,l))}),t}function Ht(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function At(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const a=e.get(l.parentKey);if(a&&!n.includes(l.parentKey)){o=a.children.every(r=>n.includes(r.rowKey)||t.includes(r.rowKey));const s=t.findIndex(r=>r===l.parentKey);o?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=a}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Mt(e,l){return b(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:a,selectPageInvert:s}=l.table;return t.map(r=>N(r)?r==="all"?{type:"item",key:Le,label:n}:r==="invert"?{type:"item",key:je,label:o}:r==="none"?{type:"item",key:Ue,label:a}:r==="pageInvert"?{type:"item",key:qe,label:s}:{type:"item",key:r,label:r}:r)})}function _t(e,l,t,n,o){const a=()=>{const{disabled:i,onSelectAll:d}=e.value||{},h=[];l.value.forEach((y,v)=>{i!=null&&i(y.record)||h.push(v)}),_(d,h),o(h)},s=()=>{const{disabled:i,onSelectInvert:d}=e.value||{},h=[...n.value];l.value.forEach((y,v)=>{if(i!=null&&i(y.record))return;const S=h.indexOf(v);S>=0?h.splice(S,1):h.push(v)}),o(h),_(d,h)},r=()=>{const{onSelectNone:i}=e.value||{};_(i),o([])},c=()=>{const{disabled:i,onSelectPageInvert:d}=e.value||{},h=[],y=n.value;t.value.forEach((v,S)=>{i!=null&&i(v.record)||y.includes(S)||h.push(S)}),_(d,h),o(h)},u=new Map([[Le,a],[je,s],[Ue,r],[qe,c]]);return i=>{const d=i.key;if(dt(d)&&u.has(d)){u.get(d)();return}const{disabled:h,onMenuClick:y}=e.value||{};if(!y)return;const v=[];t.value.forEach((S,C)=>{h!=null&&h(S.record)||v.push(C)}),_(y,i,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=b(()=>e.value.filter(s=>s.sortable)),t=b(()=>l.value.some(s=>s.sortable.multiple!==void 0)),n=he({}),o=I([]);return D(l,(s,r)=>{s.forEach(c=>{const{key:u,sortable:i}=c,d=i.orderBy;if(d||n[u]===void 0){n[u]=d;return}const h=r?r.find(v=>v.key===u):void 0;(h==null?void 0:h.sortable.orderBy)&&(n[u]=void 0)}),o.value=Ce(s,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(s,r)=>{const{orders:c,onChange:u}=r,i=n[s],d=i?Se(c,i):Se(c);t.value?n[s]=d:Object.keys(n).forEach(h=>{s===h?n[h]=d:n[h]=void 0}),o.value=Ce(l.value,n),_(u,d,o.value)}}}function Se(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:a=0,orderBy:s=l[n],sorter:r}=o;return{key:n,multiple:a,orderBy:s,sorter:r}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=b(()=>!!e.sticky),t=b(()=>{const{sticky:a}=e,{offsetTop:s=0,offsetBottom:r=0,offsetScroll:c=0,container:u=window}=ft(a)?a:{};return{offsetTop:s,offsetBottom:r,offsetScroll:c,container:u}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Nt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},a,s){return b(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||s.value||a.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const M=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:a}=F(M);return()=>{const{isFixedHolder:s}=e,r=s?t.value:l.value;if(r.every(i=>!i.width&&!i.type))return;const c=a.value,u=r.map((i,d)=>{const{key:h,type:y}=i,v=s?n.value[d]:i.width,S=y?V({[`${c}-col-${y}`]:!0,[`${c}-col-with-dropdown`]:y==="selectable"&&o.value.length>0}):void 0;let C;return s?C=v?`width: ${z(v)}`:void 0:C={width:z(v),minWidth:z(i.minWidth),maxWidth:z(i.maxWidth)},x("col",{key:h,class:S,style:C},null)});return x("colgroup",null,[u])}}}),Lt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:a,flattedData:s,isSticky:r,columnWidths:c}=F(M);jt(n,o);const u=b(()=>a.value==="max-content"),i=b(()=>s.value.length>0),d=b(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:r.value}}),h=b(()=>{const v=r.value,{offsetTop:S,offsetBottom:C}=e;return{overflow:"hidden",top:v?z(S):void 0,bottom:v?z(C):void 0}}),y=b(()=>({tableLayout:"fixed",visibility:i.value&&!c.value.length?"hidden":void 0}));return()=>x("div",{class:d.value,style:h.value,ref:n},[x("table",{style:y.value},[(i.value||!u.value)&&x(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function jt(e,l){const t=n=>{const o=n.deltaX,a=n.currentTarget;if(o){const s=a.scrollLeft+o;l(n,s),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Q(()=>G(e.value,"wheel",t))}const Ut=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:a}=F(M),s=I(!1),r=I(!1),c=I(0),u=I(0),i=I(0),d=b(()=>{const f=u.value,g=i.value;return g&&f*(f/g)});Ie(()=>{const f=X(l);if(f&&s.value){const{clientWidth:g,scrollWidth:p,scrollLeft:k}=f;a(k/p*g),u.value=g,i.value=p}});const h=b(()=>({height:ce(),width:u.value,bottom:n.value.offsetScroll})),y=b(()=>{const f=e.value;return{[`${f}-sticky-scrollbar-thumb`]:!0,[`${f}-sticky-scrollbar-thumb-active`]:r.value}}),v=b(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),S=()=>r.value=!1,C=f=>{c.value=f.pageX-o.value,r.value=!0,f.preventDefault()},w=f=>{if(!r.value)return;const{buttons:g}=f||window.event;if(g===0){r.value=!1;return}let p=f.pageX-c.value;p<=0&&(p=0);const k=u.value,K=i.value,B=d.value;p+B>=k&&(p=k-B);const E=p/k*(K+2);t(f,E)},m=()=>{const f=X(l),g=ge(f).top,p=g+f.offsetHeight,{container:k,offsetScroll:K}=n.value,B=k===window?document.documentElement.scrollTop+window.innerHeight:ge(k).top+k.clientHeight;p-ce()<=B||g>=B-K?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",S),ee(document.body,"mousemove",w),ee(window,"resize",m),D(()=>n.value.container,(f,g)=>{G(g,"scroll",m),ee(f,"scroll",m)},{immediate:!0}),m()}),Q(()=>{G(document.body,"mouseup",S),G(document.body,"mousemove",w),G(window,"resize",m),G(n.value.container,"scroll",m)}),()=>!l.value||!s.value||i.value<=u.value||!d.value?null:x("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[x("div",{class:y.value,style:v.value,onMousedown:C},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:a,scrollBarColumn:s}=F(M),{mainTableWidth:r}=F(pe),c=b(()=>n.value.length);return()=>{let u=l.default();if(e.isEmpty?a.value:o.value){const i=s.value;u=x("div",{class:`${t.value}-fixed-row`,style:{width:z(r.value-(i?i.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return x("tr",null,[x("td",{colSpan:c.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const qt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Xt={columns:{type:Array,required:!0}},Vt={column:{type:Object,required:!0}},Gt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Yt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Qt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Zt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},el=H({props:Jt,setup(e){const l=I();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>x("td",{ref:l,style:{padding:0,border:0,height:0}},[x("div",{style:{height:0,overflow:"hidden"}},[vt("Â ")])])}}),tl=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(M),{changeColumnWidth:t}=F(pe);return()=>{const n=l.value.map(o=>{const{key:a}=o;return x(el,{key:a,cellKey:a,changeColumnWidth:t},null)});return x("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),ll=H({props:Yt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:a,activeOrderByMap:s,fixedColumnKeys:r,columnOffsets:c,isSticky:u,expandable:i,selectable:d,mergedPagination:h}=F(M),y=b(()=>s[e.column.key]),v=nl(e),S=b(()=>r.value.lastStartKey===e.column.key),C=b(()=>r.value.firstEndKey===e.column.key),w=b(()=>{const{type:p,ellipsis:k}=e.column;return p?k:k??l.ellipsis}),m=b(()=>{const{fixed:p,align:k}=e.column,K=o.value;let B={[`${K}-cell`]:!0,[`${K}-cell-sorted`]:!!y.value,[`${K}-cell-align-${k}`]:!!k&&k!="start",[`${K}-cell-ellipsis`]:!!w.value};return p&&(B={...B,[`${K}-fix-start`]:p==="start",[`${K}-fix-start-last`]:S.value,[`${K}-fix-end`]:p==="end",[`${K}-fix-end-first`]:C.value,[`${K}-fix-sticky`]:u.value}),V(B)}),f=b(()=>{const{fixed:p}=e.column;if(!p)return;const{starts:k,ends:K}=c.value,E=z((p==="start"?k:K)[e.colIndex]);return{position:"sticky",left:p==="start"?E:void 0,right:p==="end"?E:void 0}}),g=p=>{p.stopPropagation()};return()=>{var A,O;const{column:p}=e,{type:k}=p;let K,B;if(k==="selectable")K=al(e,t,d,g,n,h);else if(k==="indexable")K=Xe(e,t,p,h);else{const T=v.value;if(K=ol(e,t,T),B=We(w.value,K,T),!k&&(Y(K)||K==="")){const $=t.emptyCell||a.value;K=J($)?$({column:p,record:e.record,rowIndex:e.rowIndex}):$}}e.column.fixed&&w.value&&(S.value||C.value)&&(K=x("span",{class:`${o.value}-cell-content`},[K]));const E=(A=l.customAdditional)==null?void 0:A.bodyCell,P=E?E({column:p,record:e.record,rowIndex:e.rowIndex}):void 0,R=((O=l.customTag)==null?void 0:O.bodyCell)??"td";return x(R,Z({class:m.value,style:f.value,title:B},P),{default:()=>[k==="expandable"&&sl(e,t,i,o.value),K]})}}});function nl(e){return b(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let a=0;a<n.length&&o;a++){const s=n[a];o=o[s]}return o})}function ol(e,l,t){const{record:n,rowIndex:o,column:a}=e,{customCell:s}=a,r=N(s)?l[s]:s;return r?r({value:t,record:n,rowIndex:o}):t}function sl(e,l,t,n){if(e.disabled)return;const{icon:o,customIcon:a,indent:s}=t.value,{record:r,expanded:c,level:u=0}=e,i=s?`margin-left: ${z(u*s)}`:void 0;let d;const h=(N(a)?l[a]:a)??o;return J(h)?d=h({expanded:!!c,record:r}):d=N(h)?x(te,{name:h,rotate:c?90:0},null):h,x("button",{class:`${n}-expandable-trigger`,style:i,type:"button",onClick:e.handleExpend},[d])}function al(e,l,t,n,o,a){const{selected:s,indeterminate:r,disabled:c,isHover:u,handleSelect:i}=e,{showIndex:d,multiple:h,customCell:y,trigger:v}=t.value;if(!s&&!u&&d)return Xe(e,l,o.columnIndexable,a);const S=N(y)?l[y]:y;if(h){const C={checked:s,disabled:c,indeterminate:r},w={...C,onChange:i,onClick:n};return S?S(v?C:w):x(ve,v?C:w,null)}else{const C={checked:s,disabled:c},w={...C,onChange:i,onClick:n};return S?S(w):x(Oe,v?C:w,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:a,disabled:s}=e,{customCell:r}=t,{pageIndex:c=1,pageSize:u=0}=n.value||{},i=N(r)?l[r]:r;return i?x("span",{style:s?"cursor: not-allowed":"cursor: pointer"},[i({record:o,rowIndex:a,pageIndex:c,pageSize:u})]):void 0}const rl=H({props:Gt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:a,checkExpandDisabled:s,selectable:r,selectedRowKeys:c,indeterminateRowKeys:u,handleSelectChange:i,currentPageRowKeys:d}=F(M),{expandDisabled:h,handleExpend:y,selectDisabled:v,handleSelect:S,isHover:C,attrs:w}=cl(e,o,s,a,r,i,d),m=b(()=>c.value.includes(e.rowKey)),f=b(()=>u.value.includes(e.rowKey)),g=b(()=>{const p=`${t.value}-row`,{level:k,expanded:K}=e;return V({[`${p}`]:!0,[`${p}-level-${k}`]:!!k,[`${p}-selected`]:m.value,[`${p}-expanded`]:K})});return()=>{var B,E;const p=(B=l.customAdditional)==null?void 0:B.bodyRow,k=p?p({record:e.record,rowIndex:e.rowIndex}):void 0,K=((E=l.customTag)==null?void 0:E.bodyRow)??"tr";return x(K,Z({class:g.value},w.value,k),{default:()=>[il(e,n,h,y,m,f,v,S,C)]})}}});function cl(e,l,t,n,o,a,s){const r=b(()=>t(e.rowData)),c=b(()=>{var g;return(g=l.value)==null?void 0:g.trigger}),u=()=>{const{rowKey:g,record:p}=e;n(g,p)},i=b(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=b(()=>{var g;return(g=o.value)==null?void 0:g.trigger}),h=b(()=>{var g;return(g=o.value)==null?void 0:g.showIndex}),y=I(!1),v=()=>{const{rowKey:g,record:p}=e;a(g,p)},S=()=>{c.value==="click"&&u(),d.value==="click"&&v()},C=()=>{c.value==="dblclick"&&u(),d.value==="dblclick"&&v()},w=()=>y.value=!0,m=()=>y.value=!1,f=b(()=>{const g=r.value,p=c.value,k=i.value,K=d.value,B=!g&&p==="click"||!k&&K==="click",E=!g&&p==="dblclick"||!k&&K==="dblclick",P=!k&&h.value;let R="";return B||E?R="pointer":(g&&p||k&&K)&&(R="not-allowed"),{style:R?`cursor: ${R}`:void 0,onClick:B?S:void 0,onDblclick:E?C:void 0,onMouseenter:P?w:void 0,onMouseleave:P?m:void 0}});return{expandDisabled:r,handleExpend:u,selectDisabled:i,handleSelect:v,isHover:y,attrs:f}}function il(e,l,t,n,o,a,s,r,c){const u=[],{rowIndex:i,record:d,level:h}=e;return l.value.forEach((y,v)=>{const{type:S,colSpan:C,rowSpan:w,key:m}=y,f=C==null?void 0:C(d,i),g=w==null?void 0:w(d,i);if(f===0||g===0)return;const p={colSpan:f===1?void 0:f,rowSpan:g===1?void 0:g,rowIndex:i,colIndex:v,record:d,column:y,level:h,key:m};S==="expandable"?(p.expanded=e.expanded,p.disabled=t.value,p.handleExpend=n):S==="selectable"&&(p.selected=o.value,p.indeterminate=a.value,p.disabled=s.value,p.handleSelect=r,p.isHover=c.value),u.push(x(ll,p,null))}),u}function Ve(e,l,t,n,o){const{expanded:a,level:s,record:r,rowKey:c}=e,u={key:c,expanded:a,level:s,record:r,rowData:e,rowIndex:l,rowKey:c},i=x(rl,u,null),d=a&&ul(u,t,n,o);return d?[i,d]:i}function ul(e,l,t,n){const{customExpand:o}=t||{},{record:a,rowIndex:s}=e;let r;return J(o)?r=o({record:a,rowIndex:s}):N(o)&&l[o]&&(r=l[o]({record:a,rowIndex:s})),r&&x(de,{class:`${n}-expanded-row`},{default:()=>[r]})}const re=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:a,flattedData:s,expandable:r,scrollWidth:c,scrollHeight:u,isSticky:i}=F(M),d=b(()=>a.value||c.value||u.value||i.value);return()=>{const h=o.value,y=[];n.alert&&y.push(x(de,{class:`${h}-alert-row`},{default:()=>[n.alert()]}));const v=s.value;return v.length>0?l.default?y.push(...l.default()):v.forEach((S,C)=>{y.push(...fe(Ve(S,C,n,r.value,h)))}):y.push(x(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[x(Ze,{empty:t.empty},n)]})),x("tbody",{class:`${o.value}-tbody`},[d.value&&x(tl,null,null),y])}}}),dl=H({props:Qt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(M),a=b(()=>e.filterable.multiple??t.columnBase.filterable.multiple),s=b(()=>e.filterable.footer??t.columnBase.filterable.footer),r=e.activeFilterBy,[c,u]=oe(()=>r);D(()=>e.activeFilterBy,f=>u(f));const[i,d]=oe(!1),h=f=>{d(f),f||e.onUpdateFilterBy(c.value)},y=()=>{d(!1),e.onUpdateFilterBy(c.value)},v=()=>{u(r)},S=f=>{const g=`${o.value}-filterable-menu-label`,p=a.value?ve:Oe;return x("span",{class:g},[x(p,{checked:f.selected,disabled:f.disabled},null),x("span",{class:`${g}-content`},[f.label])])},C=()=>{const f=[],{customMenu:g,menus:p}=e.filterable;return J(g)?f.push(g()):N(g)&&l[g]?f.push(l[g]()):f.push(fl(p,a,c,u,S)),s.value&&f.push(vl(n,o,y,v)),f},w=b(()=>{const f=`${o.value}-filterable-trigger`;return V({[f]:!0,[`${f}-active`]:e.activeFilterBy.length>0})}),m=()=>{const{customTrigger:f}=e.filterable;return J(f)?f():N(f)&&l[f]?l[f]():x("span",{class:w.value,onClick:g=>g.stopPropagation()},[x(te,{name:"filter-filled"},null)])};return()=>{const f={visible:i.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return x(Ke,f,{default:m,overlay:C})}}}),fl=(e,l,t,n,o)=>{const a={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return x(Ee,a,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:a}=e.table;return x("div",{class:`${l.value}-filterable-trigger-footer`},[x(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),x(me,{size:"xs",onClick:n},{default:()=>[a]})])},hl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:a,handleHeadSelectChange:s,mergedSelectableMenus:r,handleSelectableMenuClick:c}=F(M),u=b(()=>{const C=l.value.size;return C===0||C===n.value.disabledRowKeys.length}),[i,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},y=()=>x(Ee,{dataSource:r.value,onClick:c},null),v=()=>x(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:i.value?180:0},null),S=()=>{if(r.value.length!==0)return x(Ke,h,{default:v,overlay:y})};return()=>{const{multiple:C}=t.value;if(C)return x("span",{class:`${e.value}-cell-triggers`},[x(ve,{checked:o.value,indeterminate:a.value,disabled:u.value,onChange:s},null),S()])}}}),yl=H({props:Zt,setup(e){const{locale:l,mergedPrefixCls:t}=F(M);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:a,nextTooltip:s}=o,r=s&&pl(l.table,a,n),c=gl(t,a,n);return r?x(et,{title:r},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:a,sortDesc:s}=e;return n?n==="ascend"?a:s:o}function gl(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,a=l.includes("ascend")&&x(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),s=l.includes("descend")&&x(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return x("span",{class:`${n}-sortable-trigger`},[a,s])}const ml=H({props:Vt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:a,isSticky:s,handleSort:r,activeOrderByMap:c,activeFilterByMap:u,handleFilter:i}=F(M),d=b(()=>{const{type:m,ellipsis:f}=e.column,g=m?f:f??l.ellipsis;return Te(g)&&g.head===!1?void 0:g}),h=b(()=>{const{type:m,align:f,fixed:g,hasChildren:p,key:k,sortable:K,filterable:B}=e.column,E=n.value;let P={[`${E}-cell`]:!0,[`${E}-cell-${m}`]:!!m,[`${E}-cell-filterable`]:!!B,[`${E}-cell-sortable`]:!!K,[`${E}-cell-align-center`]:p||f==="center",[`${E}-cell-align-end`]:!p&&f==="end",[`${E}-cell-ellipsis`]:!!d.value};if(g){const{lastStartKey:R,firstEndKey:A}=o.value;P={...P,[`${E}-fix-start`]:g==="start",[`${E}-fix-start-last`]:R===k,[`${E}-fix-end`]:g==="end",[`${E}-fix-end-first`]:A===k,[`${E}-fix-sticky`]:s.value}}return V(P)}),y=b(()=>{const{fixed:m,colStart:f,colEnd:g}=e.column;if(!m)return;const{starts:p,ends:k}=a.value,E=z((m==="start"?p:k)[m==="start"?f:g]);return{position:"sticky",left:m==="start"?E:void 0,right:m==="end"?E:void 0}}),v=b(()=>c[e.column.key]),S=b(()=>u[e.column.key]||tt),C=m=>{const{key:f,filterable:g}=e.column;i(f,g,m)},w=()=>{const{key:m,sortable:f}=e.column;f&&r(m,f)};return()=>{var A,O;const{column:m}=e,{type:f,titleColSpan:g,titleRowSpan:p}=m;if(f==="scroll-bar")return x("th",{class:h.value,style:y.value,colspan:g===1?void 0:g,rowspan:p===1?void 0:p,onClick:w},null);const k=n.value;let K,B;if(f==="selectable")B=x(hl,null,null);else{const{title:T,customTitle:$,sortable:W,filterable:U}=m,L=d.value;B=bl(T,$,t),K=We(L,B,T);const j=xl(W,v,U,S,C);j.length>0?B=x("span",{class:`${k}-cell-triggers`},[x("span",{class:`${k}-cell-title`},[B]),j]):L&&(B=x("span",{class:`${k}-cell-title`},[B]))}const E=(A=l.customAdditional)==null?void 0:A.headCell,P=E?E({column:m}):void 0,R=((O=l.customTag)==null?void 0:O.headCell)??"th";return x(R,Z({class:h.value,style:y.value,colSpan:g===1?void 0:g,rowSpan:p===1?void 0:p,title:K},P,{onClick:w}),{default:()=>[B]})}}});function bl(e,l,t){let n=e;return J(l)?n=l({title:e}):N(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const a=[];return e&&a.push(x(yl,{activeOrderBy:l.value,sortable:e},null)),t&&a.push(x(dl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),a}const Sl=H({props:Xt,setup(e){const{props:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const{columns:n}=e,o=(r=l.customAdditional)==null?void 0:r.headRow,a=o?o({columns:n}):void 0,s=((c=l.customTag)==null?void 0:c.headRow)??"tr";return x(s,Z({class:`${t.value}-row`},a),{default:()=>[n.filter(u=>u.titleColSpan!==0).map(u=>x(ml,{key:u.key,column:u},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const n=l.value,o=(r=e.customAdditional)==null?void 0:r.head,a=o?o({rows:n}):void 0,s=((c=e.customTag)==null?void 0:c.head)??"thead";return x(s,Z({class:`${t.value}-thead`},a),{default:()=>[n.map((u,i)=>x(Sl,{key:i,columns:u},null))]})}}}),Cl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:a,columnWidths:s,changeColumnWidth:r,flattedData:c,isSticky:u,mergedSticky:i,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:y,handleScroll:v,pingedStart:S,pingedEnd:C,scrollWidth:w,scrollHeight:m,hasFixed:f,tableLayout:g}=F(M),p=I(),k=I(0);Re(pe,{mainTableWidth:k,changeColumnWidth:(T,$)=>{st(p.value)&&r(T,$)}});const B=()=>{const T=X(h);T&&v({currentTarget:T})},E=T=>{const{offsetWidth:$}=T.target;$!==k.value&&(k.value=$)};se(()=>{B(),D([()=>e.dataSource,w],([,$])=>{$&&B()}),D(s,$e(()=>{var W;((W=X(h))==null?void 0:W.scrollLeft)===0&&B()},16)),lt(p.value,E)}),Q(()=>nt(p.value,E));const P=b(()=>{const T=n.value;return V({[`${T}-container`]:!0,[`${T}-ping-start`]:S.value,[`${T}-ping-end`]:C.value,[`${T}-fixed-layout`]:g.value==="fixed",[`${T}-fixed-column`]:f.value,[`${T}-scroll-horizontal`]:w.value,[`${T}-scroll-vertical`]:m.value})}),R=b(()=>{var j;const T=w.value,$=m.value,W=T?"auto":void 0,U=e.virtual?"hidden":$?"scroll":T?"hidden":void 0,L=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:W,overflowY:U,[L?"height":"maxHeight"]:$}}),A=b(()=>({tableLayout:g.value,width:w.value,minWidth:w.value?"100%":void 0})),O=(T,$,W)=>{_(e.onScrolledChange,T,$,W.map(U=>U.record))};return()=>{const T=n.value,$=a.value,W=l.default?l.default():[];if($||m.value||u.value){const{offsetTop:U}=i.value;if(e.headless||W.push(x(Lt,{offsetTop:U},{default:()=>[x(we,null,null)]})),e.virtual&&(e.scroll||$)){const L=({item:ae,index:Ye})=>Ve(ae,Ye,l,t.value,T),j=ae=>x("table",{ref:y,class:`${T}-table`,style:A.value},[x(ne,null,null),x(re,null,{default:()=>[ae]}),!1]),{scroll:q,onScrolledBottom:Ge}=e;W.push(x(ot,{ref:d,style:R.value,dataSource:c.value,fullHeight:q==null?void 0:q.fullHeight,getKey:"rowKey",height:a.value?"100%":q==null?void 0:q.height,itemHeight:o.value,itemRender:L,contentRender:j,virtual:!0,onScroll:v,onScrolledBottom:Ge,onScrolledChange:O},null))}else W.push(x("div",{ref:h,class:`${T}-content`,style:R.value,onScroll:v},[x("table",{ref:y,class:`${T}-table`,style:A.value},[x(ne,null,null),x(re,null,null),!1])]));u.value&&W.push(x(Ut,null,null))}else W.push(x("div",{ref:h,class:`${T}-content`,style:R.value,onScroll:v},[x("table",{ref:y,class:`${T}-table`,style:A.value},[x(ne,null,null),!e.headless&&x(we,null,null),x(re,null,null),!1])]));return x("div",{ref:p,class:P.value},[W])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wl(e,l){return e.footer?x("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t){let n=null,o=null;if(e!==null){const{position:a}=e,[s,r]=ht(a).split("-"),c=`${t}-pagination ${t}-pagination-${r}`,u=x(pt,Z({class:c,total:l.length},e),null);n=s==="top"?u:null,o=s==="bottom"?u:null}return[n,o]}const Bl={sm:32,md:40,lg:56},Kl={sm:40,md:48,lg:56},El=H({name:"IxTable",props:qt,setup(e,{expose:l,slots:t}){const n=le("common"),o=b(()=>`${n.prefixCls}-table`),a=le("locale"),s=le("table"),r=b(()=>e.autoHeight??s.autoHeight),c=b(()=>e.childrenKey??s.childrenKey),u=at(e,s),i=b(()=>e.emptyCell??s.emptyCell),d=b(()=>e.size??s.size),h=b(()=>n.theme==="seer"?Bl[d.value]:Kl[d.value]),{mergedPagination:y}=Tt(e,s,d),v=Dt(e),S=$t(e,r,v),C=mt(e,t,s,S.scrollBarSizeOnFixedHolder),w=zt(C.flattedColumns),m=Et(C.flattedColumns),f=Kt(e,C.flattedColumns),g=Nt(e,C,S,v.isSticky,r),{activeSorters:p}=w,{activeFilters:k}=m,K=Bt(e,c,u,p,k,f.expandedRowKeys,y),B=Ft(e,a,C.flattedColumns,K);Ot(e,s,y,p,k,S.scrollTo);const E={props:e,slots:t,config:s,locale:a,mergedPrefixCls:o,mergedEmptyCell:i,mergedVirtualItemHeight:h,mergedAutoHeight:r,...C,...S,...w,...m,...v,tableLayout:g,mergedPagination:y,...f,...K,...B};Re(M,E),l({scrollTo:S.scrollTo});const{flattedData:P,filteredData:R}=K,A=b(()=>{const O=o.value,{borderless:T=s.borderless,scroll:$}=e;return V({[O]:!0,[`${O}-auto-height`]:r.value,[`${O}-borderless`]:T,[`${O}-empty`]:P.value.length===0,[`${O}-full-height`]:$==null?void 0:$.fullHeight,[`${O}-${d.value}`]:!0})});return()=>{const O=o.value,T=x(rt,{header:e.header},t),$=wl(t,O),[W,U]=kl(y.value,R.value,O),L=[T],j=[W,x(Cl,null,null),$,U].filter(Boolean),q=Tl(e.spin);return q?L.push(x(ct,q,{default:()=>[j]})):L.push(...j),x("div",{class:A.value},[L])}}});function Tl(e){return yt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pl=El,Wl=ye;export{Pl as I,Wl as a,gt as g,qt as t};
