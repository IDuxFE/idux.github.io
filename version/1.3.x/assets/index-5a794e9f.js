import{m as j,aN as I,aa as ae,a7 as ne,r as le,a9 as ue,X as J,R as T,b4 as ie,S as N,L as oe}from"./index-4edbd2bb.js";import{v as U,f as w,y as M,i as K,K as E,P as se,l as re,n as ce,a as Z,B as de,b as $,bj as me,a2 as ve,w as Q,t as fe,G as W,p as he,bm as be}from"./vendor-1c103b38.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const F={ltr:"left",rtl:"right",btt:"bottom",ttb:"top"},X=Symbol("sliderToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const ge={control:{type:[String,Number,Object],default:void 0},value:{type:[Number,Array],default:void 0},disabled:{type:Boolean,default:!1},dots:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!0},marks:{type:Object,default:void 0},max:{type:Number,default:100},min:{type:Number,default:0},range:{type:Boolean,default:!1},reverse:{type:Boolean,default:!1},step:{type:Number,default:1},tooltipFormatter:{type:Function,default:void 0},tooltipPlacement:{type:String,default:void 0},tooltipVisible:{type:Boolean,default:void 0},vertical:{type:Boolean,default:!1},"onUpdate:value":[Function,Array],onChange:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array]},ye={value:{type:Number,default:void 0},onFocus:[Function,Array],onBlur:[Function,Array]},xe={onClickMark:[Function,Array]},Me=U({name:"IxSliderMarks",props:xe,setup(e){const{values:d,marks:h,max:m,min:l,prefixCls:c,range:u,reverse:i,vertical:o}=K(X),v=w(()=>`${c.value}-mark`);return()=>M("div",{class:v.value},[we(e,d.value,h.value,m.value,l.value,v.value,u.value,i.value,o.value)])}});function we(e,d,h,m,l,c,u,i,o){if(E(h))return;const v=m-l;return Object.keys(h).map(parseFloat).sort((s,r)=>s-r).map(s=>{const r=h[s],y=se(r);let x;if(re(r)||ce(r)?x=r:Z(r)?x=r():y&&(x=r.label),E(x))return null;const S=u?!(s<d[0]||s>d[1]):s<=d[0],A={[`${c}-label`]:!0,[`${c}-label-active`]:S},k=o?{marginBottom:"-50%",[i?F.ttb:F.btt]:`${(s-l)/v*100}%`}:{transform:`translateX(${i?"50%":"-50%"})`,[i?F.rtl:F.ltr]:`${(s-l)/v*100}%`},B=y?de([k,r==null?void 0:r.style]):k,R=V=>j(e.onClickMark,V,s);return M("span",{key:s,class:A,style:B,onMousedown:R,onTouchstart:R},[x])})}const ke=U({name:"IxSliderSteps",setup(){const{values:e,dots:d,marks:h,max:m,min:l,prefixCls:c,range:u,reverse:i,step:o,vertical:v}=K(X);return()=>M("div",{class:`${c.value}-step`},[Fe(e.value,d.value,h.value,m.value,l.value,c.value,u.value,i.value,o.value,v.value)])}});function Fe(e,d,h,m,l,c,u,i,o,v){const s=m-l;return Se(d,h,m,l,o).map(r=>{const y=`${Math.abs(r-l)/s*100}%`,x=u?!(r<e[0]||r>e[1]):r<=e[0],S=v?{[i?F.ttb:F.btt]:y}:{[i?F.rtl:F.ltr]:y},A={[`${c}-dot`]:!0,[`${c}-dot-active`]:x,[`${c}-dot-reverse`]:i};return M("span",{key:r,class:A,style:S},null)})}function Se(e,d,h,m,l){const c=Object.keys(d??{}).map(parseFloat).sort((u,i)=>u-i);if(e&&l)for(let u=m;u<=h;u+=l)c.indexOf(u)===-1&&c.push(u);return c}const Ae=U({name:"IxSliderThumb",inheritAttrs:!1,props:ye,setup(e,{attrs:d,expose:h}){const{disabled:m,dragging:l,prefixCls:c,tooltipVisible:u,tooltipPlacement:i,tooltipFormatter:o}=K(X),v=$(u.value??!1),s=$(!1),r=$(null),y=$(null),x=w(()=>`${c.value}-thumb`),S=()=>u.value!==!1&&(v.value=!0),A=()=>u.value!==!0&&(v.value=!1);me(()=>{var b;return v.value&&((b=r.value)==null?void 0:b.updatePopper())});function k(){s.value=!0,S()}function B(){s.value=!1,l.value||A()}function R(b){S(),l.value||j(e.onFocus,b)}function V(b){A(),l.value||j(e.onBlur,b)}return h({tooltipRef:r,thumbRef:y,isHovering:s,showTooltip:S,hideTooltip:A}),()=>M(ae,{ref:r,visible:v.value,placement:i.value,trigger:"manual",onMouseenter:k,onMouseleave:B},{default:()=>[M("div",ve(d,{ref:y,class:x.value,onMouseenter:k,onMouseleave:B,onFocus:m.value?I:R,onBlur:m.value?I:V}),null)],title:()=>Z(o.value)?o.value(e.value):M("span",null,[e.value])})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $e(e){const{elementRef:d,focus:h,blur:m}=ne(),{accessor:l,control:c}=le();ue(c);const u=$([e.min,e.min]),i=$([]),o=$(-1),v=$(null),s=$(!1),r=w(()=>l.disabled),y=w(()=>{const t=[e.min,e.max,e.step].map(a=>{const n=`${a}`.split(".")[1];return n?n.length:0});return Math.max(...t)}),x=w(()=>{const t=`${e.step}`.split(".")[1];return t?t.length:0}),S=w(()=>e.vertical?e.reverse?F.ttb:F.btt:e.reverse?F.rtl:F.ltr);function A(t){return a=>{t===0&&(d.value=a==null?void 0:a.thumbRef),i.value[t]=a}}function k(t){var n,f;const a=i.value.findIndex(g=>(g==null?void 0:g.thumbRef)===t.target);if(a!==-1)t.preventDefault(),o.value=a,(f=(n=i.value[a])==null?void 0:n.thumbRef)==null||f.focus(),V();else{const g=G(t);Y(g),O(g)}}function B(t){if(e.keyboard){const a=i.value.findIndex(n=>(n==null?void 0:n.thumbRef)===t.target);if(a!==-1){let n=null;t.code==="ArrowUp"||t.code==="ArrowRight"?(o.value=a,n=q(1)):(t.code==="ArrowDown"||t.code==="ArrowLeft")&&(o.value=a,n=q(-1)),n!==null&&(t.preventDefault(),O(n),z(n))}}}function R(t,a){t.stopPropagation(),Y(a),O(a)}function V(){s.value||(s.value=!0,T(window,"mousemove",D),T(window,"touchmove",D),T(window,"mouseup",C),T(window,"touchend",C),T(window,"contextmenu",C))}function b(){if(s.value){const t=i.value[o.value];s.value=!1,o.value=-1,t!=null&&t.isHovering||W(()=>t==null?void 0:t.hideTooltip()),N(window,"mousemove",D),N(window,"touchmove",D),N(window,"mouseup",C),N(window,"touchend",C),N(window,"contextmenu",C)}}function D(t){if(!s.value){b();return}const a=G(t);O(a),z(a)}function C(){b()}function _(){var a,n;const{value:t}=o;t!==-1&&((n=(a=i.value[t])==null?void 0:a.thumbRef)==null||n.focus())}function O(t){const{value:a}=o;if(u.value[a]!==t){const n=u.value.slice();n[a]=t;const f=fe(l.value),g=e.range?n:n[0];l.setValue(g),j(e.onChange,g,f),W(()=>L())}}function Y(t){const{value:a}=u;o.value=e.range?Math.abs(a[0]-t)<Math.abs(a[1]-t)?0:1:0}function z(t){var a,n;if(e.range){const{value:f}=u;let g=o.value;t>f[1]?g=1:t<f[0]&&(g=0),g!==o.value&&(o.value=g,(n=(a=i.value[o.value])==null?void 0:a.thumbRef)==null||n.focus())}}function G(t){const a=ie(t),n=v.value.getBoundingClientRect();let f;return e.vertical?f=(n.bottom-a.clientY)/n.height:f=(a.clientX-n.left)/n.width,e.reverse&&(f=1-f),H(f*(e.max-e.min)+e.min)}function H(t){t=Math.max(e.min,Math.min(e.max,t));const a=e.marks??{},n=Object.keys(a).map(parseFloat);if(e.step!==null){const P=Math.pow(10,y.value),p=Math.floor((e.max*P-e.min*P)/(e.step*P)),ee=Math.min((t-e.min)/e.step,p),te=Math.round(ee)*e.step+e.min;n.push(parseFloat(te.toFixed(y.value)))}const f=n.map(P=>Math.abs(t-P)),g=f.indexOf(Math.min(...f));return n[g]??e.min}function q(t){if(e.step!==null){const a=t<0?-e.step:+e.step,n=u.value[o.value];return Math.max(e.min,Math.min(e.max,parseFloat((n+a).toFixed(x.value))))}return e.min}Q(()=>l.value,(t,a)=>{s.value||Array.isArray(t)&&Array.isArray(a)&&t.every((n,f)=>n===a[f])||L()},{immediate:!0}),Q(()=>[e.max,e.min,e.range,e.step],()=>{L()});function L(){if(e.min>e.max)return;const{value:t=0}=l;let a;if(e.range){if(!Array.isArray(t))return;a=[t[0]??e.min,t[1]??e.min]}else{if(!J(t))return;a=[t]}u.value=a.map(n=>J(n)?H(n):e.min).sort((n,f)=>n-f)}return{valuesRef:u,thumbListRef:i,railRef:v,direction:S,isDisabled:r,isDragging:s,focus:h,blur:m,setThumbRefs:A,handleMouseDown:k,handleMouseUp:_,handleKeyDown:B,handleMarkClick:R}}const Be=U({name:"IxSlider",props:ge,setup(e,{expose:d}){const h=oe("common"),{direction:m,isDisabled:l,isDragging:c,valuesRef:u,railRef:i,setThumbRefs:o,handleMouseDown:v,handleMouseUp:s,handleKeyDown:r,handleMarkClick:y,focus:x,blur:S}=$e(e),{trackStyle:A}=Re(e,u,m),k=w(()=>`${h.prefixCls}-slider`),B=w(()=>u.value.slice(0,e.range?2:1)),R=w(()=>e.vertical?e.reverse?"translateY(-50%)":"translateY(50%)":e.reverse?"translateX(50%)":"translateX(-50%)"),V=w(()=>{const b=k.value;return{[b]:!0,[`${b}-disabled`]:l.value,[`${b}-vertical`]:e.vertical,[`${b}-with-marks`]:!E(e.marks)}});return he(X,{...be(e),direction:m,dragging:c,values:u,disabled:l,prefixCls:k}),d({focus:x,blur:S}),()=>M("div",{class:V.value,onMousedown:l.value?I:v,onTouchstart:l.value?I:v,onMouseup:l.value?I:s,onKeydown:l.value?I:r},[M("div",{ref:i,class:`${k.value}-rail`},null),M("div",{class:`${k.value}-track`,style:A.value},null),M(ke,null,null),B.value.map((b,D)=>{const C=(b-e.min)/(e.max-e.min)*100;return M(Ae,{ref:o(D),value:b,role:"slider",tabindex:l.value?-1:0,"aria-label":"Slider","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":b,"aria-readonly":l.value,"aria-orientation":e.vertical?"vertical":"horizontal",onFocus:e.onFocus,onBlur:e.onBlur,style:{transform:R.value,[m.value]:`${C}%`}},null)}),M(Me,{onClickMark:l.value?I:y},null)])}});function Re(e,d,h){const m=w(()=>Math.max(...d.value)),l=w(()=>Math.min(...d.value));return{trackStyle:w(()=>({[h.value]:e.range?`${(l.value-e.min)/(e.max-e.min)*100}%`:"0%",[e.vertical?"height":"width"]:e.range?`${(m.value-l.value)/(e.max-e.min)*100}%`:`${(+d.value[0]-e.min)/(e.max-e.min)*100}%`}))}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ie=Be;export{Ie as I};
