import{O as $e,P as ye,aR as et,ao as Ee,m as M,M as se,aL as z,aS as de,o as V,D as fe,a2 as tt,K as ce,a1 as le,$ as Z,a3 as Se,aT as nt,A as oe,j as ge,av as lt,Z as Ie,Y as Pe,c as xe,ab as ot,at,E as st,G as rt,H as ct,aU as it,L as Ce,N as ut,aw as dt,ar as ft,aG as ht}from"./index-3e39a5c2.js";import{b as Re,f as U,X as vt,T as yt,c as b,y as pe,r as I,w as _,N as Oe,M as We,d as J,_ as ee,m as ie,bq as gt,a0 as pt,l as H,x as W,n as G,p as m,am as mt,i as Q,ac as te,B as He,K as bt,at as St}from"./vendor-3b1049fb.js";import{b as Fe}from"./GlobalCodeBox-2d50abe0.js";import{I as xt}from"./index-d3c536aa.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ae=Symbol("IxTableColumn"),me=()=>{};me.displayName="IxTableColumn";me[Ae]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Le(e,n,t){if(!e||Re(e)&&e.title===!1)return;if(U(n)||vt(n))return n;const l=$e(n).find(o=>o.type===yt);return l?l.children:t}function Ct(e){return"key"in e?e.key:"dataKey"in e?ye(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:et("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wt(e,n,t,l){const o=b(()=>{var w;const{columns:C}=e;return Me(C&&C.length>0?C:Ne((w=n.default)==null?void 0:w.call(n)),t)}),{flattedColumns:s,scrollBarColumn:r,flattedColumnsWithScrollBar:a}=kt(o,l),i=Kt(a),u=b(()=>!!e.ellipsis||s.value.some(C=>C.ellipsis)),c=b(()=>s.value.some(C=>C.fixed)),{columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:g}=Tt(s,r),{columnOffsets:v,columnOffsetsWithScrollBar:p}=$t(f,h),x=b(()=>Et(o.value,r.value));return{flattedColumns:s,scrollBarColumn:r,flattedColumnsWithScrollBar:a,fixedColumnKeys:i,hasEllipsis:u,hasFixed:c,columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:g,columnOffsets:v,columnOffsetsWithScrollBar:p,mergedRows:x}}function Me(e,n){return e.map(t=>Bt(t,n))}function Ne(e){const n=[];return $e(e,{key:Ae}).forEach((t,l)=>{const{props:o,children:s}=t,{key:r=l,editable:a,ellipsis:i,...u}=o||{};u.key=r,u.editable=a||a==="",u.ellipsis=i||i==="";const{default:c,cell:f,title:h,expand:g,icon:v}=s||{};c&&(u.children=Ne(c())),f&&(u.customCell=f),h&&(u.customTitle=h),g&&(u.customExpand=g),v&&(u.customIcon=v),n.push(u)}),n}function Bt(e,n){var i,u;const{columnBase:t,columnExpandable:l,columnSelectable:o,columnIndexable:s}=n,{align:r=t.align}=e,a=Ct(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{showLine:f=l.showLine,icon:h=l.icon}=e;return{...e,key:a,align:r,icon:h,showLine:f}}if(c==="selectable"){const{multiple:f=!0,showIndex:h=o.showIndex}=e;return{...e,key:a,align:r,multiple:f,showIndex:h}}if(c==="indexable"){const f=(u=(i=e.align)!=null?i:s.align)!=null?u:t.align;return{...s,...e,align:f,key:a}}return{...e,key:a,align:r}}else{const{sortable:c,filterable:f,children:h}=e,g={...e,key:a,align:r};return c&&(g.sortable={...t.sortable,...c}),f&&(g.filterable={...t.filterable,...f}),h!=null&&h.length&&(g.children=Me(h,n)),g}}function kt(e,n){const t=b(()=>ze(e.value)),l=b(()=>{const s=n.value;if(s===0)return;const r=t.value,a=r[r.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:s}}),o=b(()=>{const s=t.value;if(s.length===0)return s;const r=l.value;return r?[...s,r]:s});return{flattedColumns:t,scrollBarColumn:l,flattedColumnsWithScrollBar:o}}function ze(e){const n=[];return e.forEach(t=>{const{fixed:l,children:o}=t;if(o!=null&&o.length){let s=ze(o);l&&(s=s.map(r=>({fixed:l,...r}))),n.push(...s)}else n.push(t)}),n}function Kt(e){return b(()=>{let n,t;return e.value.forEach(l=>{const{fixed:o,key:s}=l;o==="start"?n=s:o==="end"&&(t||(t=s))}),{lastStartKey:n,firstEndKey:t}})}function Tt(e,n){const t=pe({}),l=I(),o=I([]);_(l,Oe(a=>{o.value=a?a.split("-").map(Number):[]},16)),We(()=>{const a=Object.keys(t),i=e.value;if(a.length!==i.length){l.value=void 0;return}l.value=i.map(u=>t[u.key]).join("-")});const s=b(()=>{const a=o.value;if(a.length===0)return a;const i=n.value;return i?[...a,i.width]:a});return{columnWidths:o,columnWidthsWithScrollBar:s,changeColumnWidth:(a,i)=>{i===!1?delete t[a]:t[a]=i}}}function $t(e,n){const t=b(()=>we(e.value)),l=b(()=>we(n.value));return{columnOffsets:t,columnOffsetsWithScrollBar:l}}function we(e){const n=e.length,t=[],l=[];let o=0,s=0;for(let r=0;r<n;r++){t[r]=o,o+=e[r]||0;const a=n-r-1;l[a]=s,s+=e[a]||0}return{starts:t,ends:l}}function Et(e,n){const t=[];function l(r,a,i){var f;(f=t[i])!=null||(t[i]=[]);let u=a;return r.map(h=>{var C;let g=(C=h.titleColSpan)!=null?C:1,v=!1;const p=h.children;if(p!=null&&p.length){v=!0;const w=l(p,u,i+1);J(h.titleColSpan)&&(g=w.reduce((d,y)=>d+y))}const x=u+g-1;return t[i].push({...h,titleColSpan:g,colStart:u,colEnd:x,hasChildren:v}),u+=g,g})}const o=n?[...e,n]:e;l(o,0,0);const s=t.length;return t.forEach((r,a)=>{r.forEach(i=>{i.hasChildren||(i.titleRowSpan=s-a)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e,n,t,l,o,s,r){const a=b(()=>{const p=n.value,x=t.value;return e.dataSource.map((C,w)=>_e(C,x,p,w,e.dataSource.length))}),i=b(()=>{const p=new Map;return he(a.value,p),p}),u=b(()=>je(a.value,o.value,s.value)),c=b(()=>De(u.value,l.value,s.value)),f=b(()=>{const p=r.value,x=c.value;if(p===null||!p.pageSize)return x;{const{total:C}=p;if(C&&x.length<C)return x;const w=p.pageSize,d=(p.pageIndex-1)*w;return x.slice(d,d+w)}}),h=b(()=>{const p=new Map;return he(f.value,p),p}),g=b(()=>{const p=s.value;return p.length>0?Ue(f.value,p,0):f.value});return{isTreeData:b(()=>a.value.some(p=>{var x;return(x=p.children)==null?void 0:x.length})),filteredData:u,flattedData:g,mergedMap:i,paginatedMap:h}}function _e(e,n,t,l,o,s){var u;const r=n(e),a={record:e,rowKey:r,parentKey:s==null?void 0:s[0].rowKey,showLineIndentIndexList:(u=[...s!=null?s:[]].reverse())==null?void 0:u.reduce((c,f,h)=>(f.hasNextSibling&&c.push(h),c),[]),hasPrevSibling:l>0,hasNextSibling:l<o-1},i=e[t];return i&&(a.children=i.map((c,f)=>_e(c,n,t,f,i.length,[a,...s!=null?s:[]]))),a}function he(e,n){e.forEach(t=>{const{rowKey:l,children:o}=t;n.set(l,t),o&&he(o,n)})}function De(e,n,t){const l=n.filter(r=>r.sorter),o=l.length;if(o===0)return e;const s=e.slice();return s.forEach(r=>{t.includes(r.rowKey)&&r.children&&r.children.length>0&&(r.children=De(r.children,n,t))}),s.sort((r,a)=>{for(let i=0;i<o;i++){const{orderBy:u,sorter:c}=l[i],f=c(r.record,a.record);if(f!==0)return u==="ascend"?f:-f}return 0})}function je(e,n,t){const l=n.filter(o=>o.filter);return l.length===0?e:e.map(o=>{const s=l.every(({filter:c,filterBy:f})=>c(f,o.record)),{rowKey:r,children:a}=o,i=t.includes(r);let u=o;if(i&&a&&a.length){const c=je(a,n,t);c.length!==a.length&&(u={...o,children:c})}return s||i&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function Ue(e,n,t){return e.reduce((l,o)=>{const{children:s,parentKey:r,record:a,rowKey:i,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:f}=o,h=n.includes(i);if(l.push({children:s,parentKey:r,record:a,rowKey:i,level:t,expanded:h,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:f}),h&&o.children){const g=Ue(o.children,n,t+1);l.push(...g)}return l},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pt(e,n){const t=b(()=>n.value.find(a=>"type"in a&&a.type==="expandable")),[l,o]=Ee(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:l,setExpandedRowKeys:o,checkExpandDisabled:a=>{if(!t.value)return!0;const{disabled:i,customExpand:u}=t.value,{record:c}=a;return i!=null&&i(c)?!0:!(u||a.children&&a.children.length>0)},handleExpandChange:(a,i)=>{const{onChange:u,onExpand:c}=t.value||{},f=[...l.value],h=f.indexOf(a),g=h>=0;g?f.splice(h,1):f.push(a),M(c,!g,i),o(f),M(u,f)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Rt(e){const n=b(()=>e.value.filter(s=>s.filterable)),t=pe({}),l=I([]);return _(n,(s,r)=>{s.forEach(a=>{const{key:i,filterable:u}=a,c=u.filterBy;if(c||t[i]===void 0){t[i]=c||[];return}const f=r?r.find(g=>g.key===i):void 0;(f==null?void 0:f.filterable.filterBy)&&(t[i]=[])}),l.value=Be(s,t)},{immediate:!0}),{activeFilters:l,activeFilterByMap:t,handleFilter:(s,r,a)=>{const{onChange:i}=r;t[s]=a,l.value=Be(n.value,t),M(i,a,l.value)}}}function Be(e,n){return e.map(t=>{const{key:l,filterable:o}=t,{filter:s,filterBy:r=n[l]}=o;return{key:l,filter:s,filterBy:r}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ot(e,n,t){var u,c,f,h,g;const l=se("pagination"),o=b(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),s=I((c=(u=o.value)==null?void 0:u.pageIndex)!=null?c:1),r=I((g=(h=(f=o.value)==null?void 0:f.pageSize)!=null?h:n.pagination.pageSize)!=null?g:l.pageSize),a=(v,p)=>{var x;s.value=v,r.value=p,M((x=o.value)==null?void 0:x.onChange,v,p)};return{mergedPagination:b(()=>{var p,x;const v=o.value;return v===null?null:{...n.pagination,size:t.value,...v,pageIndex:(p=v.pageIndex)!=null?p:s.value,pageSize:(x=v.pageSize)!=null?x:r.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Wt(e,n,{setStickyScrollLeft:t}){const l=I(),o=I(),s=I(),r=I(),a=I();_(l,C=>{C&&(s.value=C.holderRef.value)});const{handleScroll:i,pingedStart:u,pingedEnd:c}=Ht(e,o,s,a,t),f=Ft(e,n,s,r),h=b(()=>{var C;return z((C=e.scroll)==null?void 0:C.width)}),g=b(()=>{var w;let C=z((w=e.scroll)==null?void 0:w.height);return!C&&n.value&&(e.virtual||f.value)&&(C="auto"),C}),v=b(()=>de(V(s))),p=b(()=>g.value?v.value:0);return{virtualScrollRef:l,scrollHeadRef:o,scrollBodyRef:s,scrollContentRef:r,scrollFootRef:a,handleScroll:i,scrollTo:C=>{var w;e.virtual?(w=l.value)==null||w.scrollTo(C):typeof C=="number"&&tt({target:V(s),top:C,duration:200})},pingedStart:u,pingedEnd:c,scrollWidth:h,scrollHeight:g,scrollBarSize:v,scrollBarSizeOnFixedHolder:p}}function Ht(e,n,t,l,o){const s=I(!1),r=I(!1);let a;const i=()=>{a&&(clearTimeout(a),a=void 0)};ee(()=>i());const u=I(),c=v=>{u.value=v,i(),a=setTimeout(()=>{u.value=void 0,a=void 0},100)},f=(v,p)=>{p&&p.scrollLeft!==v&&(p.scrollLeft=v)},h=v=>{const p=V(t);if(!p)return;const{clientWidth:x,scrollWidth:C}=p;o(v/C*x||0)};return{handleScroll:(v,p)=>{const x=v==null?void 0:v.currentTarget,C=p!=null?p:x.scrollLeft,w=u.value;if((!w||w===x)&&(c(x),f(C,n.value),f(C,V(t)),f(C,l.value),h(C)),x){const{scrollWidth:d,clientWidth:y}=x;s.value=C>1,r.value=d-y-C>1}(v==null?void 0:v.type)==="scroll"&&M(e.onScroll,v)},pingedStart:s,pingedEnd:r}}function Ft(e,n,t,l){const o=I(!0),s=()=>{const i=V(t.value);i?o.value=i.scrollHeight>i.clientHeight:o.value=!1};let r=[];const a=()=>r.forEach(i=>i());return ie(()=>{_([n,()=>e.virtual],([i,u])=>{a(),i&&!u&&(r=[fe(t,s),fe(l,s)])},{immediate:!0})}),ee(()=>a()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function At(e,n,t,l,o,s){const r=b(()=>{var c;return(c=e.scrollToTopOnChange)!=null?c:n.scrollToTopOnChange});let a=[];const i=()=>{a=[_([()=>{var c;return(c=t.value)==null?void 0:c.pageIndex},()=>{var c;return(c=t.value)==null?void 0:c.pageSize}],()=>s(0)),_([o,l],([c,f],[h,g])=>{(!Lt(c,h)||!Mt(f,g))&&s(0)})]},u=()=>{a.forEach(c=>c())};_(r,c=>{u(),c&&i()},{immediate:!0})}function Lt(e,n){return e.length===n.length&&e.every(t=>{const l=n.find(o=>o.key===t.key);return l?t.filter===l.filter&&t.filterBy.length===l.filterBy.length&&t.filterBy.every(o=>l.filterBy.includes(o)):!1})}function Mt(e,n){return e.length===n.length&&e.every(t=>{const l=n.find(o=>o.key===t.key);return l?t.sorter===l.sorter&&t.orderBy===l.orderBy&&t.multiple===l.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Nt(e,n,t,{mergedMap:l,paginatedMap:o}){const s=b(()=>t.value.find(d=>"type"in d&&d.type==="selectable")),[r,a]=Ee(e,"selectedRowKeys",()=>[]),i=b(()=>{const{disabled:d}=s.value||{},y=[],S=[];return o.value.forEach((B,k)=>{d!=null&&d(B.record)?S.push(k):y.push(k)}),{enabledRowKeys:y,disabledRowKeys:S}}),u=b(()=>{const d=new Set,y=r.value,{disabledRowKeys:S}=i.value,B=l.value;return y.forEach(k=>{const{parentKey:T}=B.get(k)||{};if(!J(T)){let K=B.get(T);if(K&&!y.includes(K.rowKey))for(;K&&!J(K==null?void 0:K.rowKey);)S.includes(K.rowKey)||d.add(K.rowKey),K=J(K.parentKey)?void 0:B.get(K.parentKey)}}),[...d]}),c=b(()=>{const d=r.value,{disabledRowKeys:y}=i.value;let S=0;return o.value.forEach((B,k)=>{!y.includes(k)&&d.includes(k)&&S++},0),S}),f=b(()=>{const d=o.value.size,y=i.value.disabledRowKeys.length;return d===0||d===y?!1:d===y+c.value}),h=b(()=>!f.value&&c.value>0),g=new Map,v=d=>{a(d);const y=l.value,{onChange:S}=s.value||{};if(S){const B=[];g.forEach((k,T)=>{d.includes(T)||g.delete(T)}),d.forEach(k=>{let T=y.get(k);T?g.set(k,T):T=g.get(k),T&&B.push(T.record)}),M(S,d,B)}},p=(d,y)=>{const S=l.value,{disabledRowKeys:B}=i.value,{multiple:k,onSelect:T}=s.value||{};let K=[...r.value];const P=K.indexOf(d),O=P>=0;if(k){const F=S.get(d),L=qe(F,B);if(O){K.splice(P,1);const D=zt(S,F,B);K=K.filter(E=>!D.includes(E)&&!L.includes(E))}else K.push(d),K.push(...L);_t(S,F,K,B)}else K=O?[]:[d];M(T,!O,y),v(K)},x=()=>{const{enabledRowKeys:d}=i.value,y=new Set(r.value);f.value?d.forEach(S=>y.delete(S)):d.forEach(S=>y.add(S)),v([...y])},C=Dt(s,n),w=jt(s,l,o,r,v);return{selectable:s,selectedRowKeys:r,indeterminateRowKeys:u,currentPageRowKeys:i,currentPageAllSelected:f,currentPageSomeSelected:h,handleSelectChange:p,handleHeadSelectChange:x,mergedSelectableMenus:C,handleSelectableMenuClick:w}}function qe(e,n){const t=[],{children:l}=e||{};return l&&l.forEach(o=>{const{rowKey:s}=o;n.includes(s)||t.push(o.rowKey),t.push(...qe(o,n))}),t}function zt(e,n,t){const l=[];for(;n!=null&&n.parentKey;){const{parentKey:o}=n;t.includes(n.parentKey)||l.push(o),n=e.get(o)}return l}function _t(e,n,t,l){let o=!0;for(;o&&n&&!J(n.parentKey);){const s=e.get(n.parentKey);if(s&&!l.includes(n.parentKey)){o=s.children.every(a=>l.includes(a.rowKey)||t.includes(a.rowKey));const r=t.findIndex(a=>a===n.parentKey);o?r<0&&t.push(n.parentKey):r>-1&&t.splice(r,1)}n=s}}const Ve=Symbol("IDUX_TABLE_KEY_selectable-all"),Xe=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ge=Symbol("IDUX_TABLE_KEY_selectable-none"),Ye=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Dt(e,n){return b(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:l,selectInvert:o,selectNone:s,selectPageInvert:r}=n.table;return t.map(a=>U(a)?a==="all"?{type:"item",key:Ve,label:l}:a==="invert"?{type:"item",key:Xe,label:o}:a==="none"?{type:"item",key:Ge,label:s}:a==="pageInvert"?{type:"item",key:Ye,label:r}:{type:"item",key:a,label:a}:a)})}function jt(e,n,t,l,o){const s=()=>{const{disabled:c,onSelectAll:f}=e.value||{},h=[];n.value.forEach((g,v)=>{c!=null&&c(g.record)||h.push(v)}),M(f,h),o(h)},r=()=>{const{disabled:c,onSelectInvert:f}=e.value||{},h=[...l.value];n.value.forEach((g,v)=>{if(c!=null&&c(g.record))return;const p=h.indexOf(v);p>=0?h.splice(p,1):h.push(v)}),o(h),M(f,h)},a=()=>{const{onSelectNone:c}=e.value||{};M(c),o([])},i=()=>{const{disabled:c,onSelectPageInvert:f}=e.value||{},h=[],g=l.value;t.value.forEach((v,p)=>{c!=null&&c(v.record)||g.includes(p)||h.push(p)}),M(f,h),o(h)},u=new Map([[Ve,s],[Xe,r],[Ge,a],[Ye,i]]);return c=>{const f=c.key;if(gt(f)&&u.has(f)){u.get(f)();return}const{disabled:h,onMenuClick:g}=e.value||{};if(!g)return;const v=[];t.value.forEach((p,x)=>{h!=null&&h(p.record)||v.push(x)}),M(g,c,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ut(e){const n=b(()=>e.value.filter(r=>r.sortable)),t=b(()=>n.value.some(r=>r.sortable.multiple!==void 0)),l=pe({}),o=I([]);return _(n,(r,a)=>{r.forEach(i=>{const{key:u,sortable:c}=i,f=c.orderBy;if(f||l[u]===void 0){l[u]=f;return}const h=a?a.find(v=>v.key===u):void 0;(h==null?void 0:h.sortable.orderBy)&&(l[u]=void 0)}),o.value=Ke(r,l)},{immediate:!0}),{activeSorters:o,activeOrderByMap:l,handleSort:(r,a)=>{const{orders:i,onChange:u}=a,c=l[r],f=c?ke(i,c):ke(i);t.value?l[r]=f:Object.keys(l).forEach(h=>{r===h?l[h]=f:l[h]=void 0}),o.value=Ke(n.value,l),M(u,f,o.value)}}}function ke(e,n){return n?e[e.indexOf(n)+1]:e[0]}function Ke(e,n){return e.map(t=>{const{key:l,sortable:o}=t,{multiple:s=0,orderBy:r=n[l],sorter:a}=o;return{key:l,multiple:s,orderBy:r,sorter:a}}).filter(t=>t.orderBy).sort((t,l)=>l.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function qt(e){const n=b(()=>!!e.sticky),t=b(()=>{const{sticky:s}=e,{offsetTop:r=0,offsetBottom:a=0,offsetScroll:i=0,container:u=window}=pt(s)?s:{};return{offsetTop:r,offsetBottom:a,offsetScroll:i,container:u}}),[l,o]=ce(0);return{isSticky:n,mergedSticky:t,stickyScrollLeft:l,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Vt(e,{hasEllipsis:n,hasFixed:t},{scrollWidth:l,scrollHeight:o},s,r){return b(()=>e.tableLayout?e.tableLayout:l.value&&t.value?l.value==="max-content"?"auto":"fixed":o.value||r.value||s.value||n.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const A=Symbol("TABLE_TOKEN"),be=Symbol("tableBodyToken"),re=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:n,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:l,mergedSelectableMenus:o,mergedPrefixCls:s}=W(A);return()=>{const{isFixedHolder:r}=e,a=r?t.value:n.value;if(a.every(c=>!c.width&&!c.type))return;const i=s.value,u=a.map((c,f)=>{const{key:h,type:g}=c,v=r?l.value[f]:c.width,p=g?G({[`${i}-col-${g}`]:!0,[`${i}-col-with-dropdown`]:g==="selectable"&&o.value.length>0}):void 0;let x;return r?x=v?`width: ${z(v)}`:void 0:x={width:z(v),minWidth:z(c.minWidth),maxWidth:z(c.maxWidth)},m("col",{key:h,class:p,style:x},null)});return m("colgroup",null,[u])}}}),Xt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:n}){const{mergedPrefixCls:t,scrollHeadRef:l,handleScroll:o,scrollWidth:s,flattedData:r,isSticky:a,columnWidths:i}=W(A);Gt(l,o);const u=b(()=>s.value==="max-content"),c=b(()=>r.value.length>0),f=b(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:a.value}}),h=b(()=>{const v=a.value,{offsetTop:p,offsetBottom:x}=e;return{overflow:"hidden",top:v?z(p):void 0,bottom:v?z(x):void 0}}),g=b(()=>({tableLayout:"fixed",visibility:c.value&&!i.value.length?"hidden":void 0}));return()=>m("div",{class:f.value,style:h.value,ref:l},[m("table",{style:g.value},[(c.value||!u.value)&&m(re,{isFixedHolder:!0},null),n.default&&n.default()])])}});function Gt(e,n){const t=l=>{const o=l.deltaX,s=l.currentTarget;if(o){const r=s.scrollLeft+o;n(l,r),l.preventDefault()}};ie(()=>le(e.value,"wheel",t,{passive:!0})),ee(()=>Z(e.value,"wheel",t))}const Yt=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:n,handleScroll:t,mergedSticky:l,stickyScrollLeft:o,setStickyScrollLeft:s}=W(A),r=I(!1),a=I(!1),i=I(0),u=I(0),c=I(0),f=b(()=>{const d=u.value,y=c.value;return y&&d*(d/y)});We(()=>{const d=V(n);if(d&&r.value){const{clientWidth:y,scrollWidth:S,scrollLeft:B}=d;s(B/S*y),u.value=y,c.value=S}});const h=b(()=>({height:de(),width:u.value,bottom:l.value.offsetScroll})),g=b(()=>{const d=e.value;return{[`${d}-sticky-scrollbar-thumb`]:!0,[`${d}-sticky-scrollbar-thumb-active`]:a.value}}),v=b(()=>({width:`${f.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),p=()=>a.value=!1,x=d=>{i.value=d.pageX-o.value,a.value=!0,d.preventDefault()},C=d=>{if(!a.value)return;const{buttons:y}=d||window.event;if(y===0){a.value=!1;return}let S=d.pageX-i.value;S<=0&&(S=0);const B=u.value,k=c.value,T=f.value;S+T>=B&&(S=B-T);const K=S/B*(k+2);t(d,K)},w=()=>{const d=V(n),y=Se(d).top,S=y+d.offsetHeight,{container:B,offsetScroll:k}=l.value,T=B===window?document.documentElement.scrollTop+window.innerHeight:Se(B).top+B.clientHeight;S-de()<=T||y>=T-k?r.value=!1:r.value=!0};return ie(()=>{le(document.body,"mouseup",p),le(document.body,"mousemove",C),le(window,"resize",w),_(()=>l.value.container,(d,y)=>{Z(y,"scroll",w),le(d,"scroll",w)},{immediate:!0}),w()}),ee(()=>{Z(document.body,"mouseup",p),Z(document.body,"mousemove",C),Z(window,"resize",w),Z(l.value.container,"scroll",w)}),()=>!n.value||!r.value||c.value<=u.value||!f.value?null:m("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[m("div",{class:g.value,style:v.value,onMousedown:x},null)])}}),ve=H({props:{isEmpty:Boolean},setup(e,{slots:n}){const{mergedPrefixCls:t,flattedColumns:l,hasFixed:o,scrollWidth:s,scrollBarColumn:r}=W(A),{mainTableWidth:a}=W(be),i=b(()=>l.value.length);return()=>{let u=n.default();if(e.isEmpty?s.value:o.value){const c=r.value;u=m("div",{class:`${t.value}-fixed-row`,style:{width:z(a.value-(c?c.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return m("tr",null,[m("td",{colSpan:i.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Zt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},insetShadow:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Jt={columns:{type:Array,required:!0}},Qt={column:{type:Object,required:!0}},en={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},tn={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},nn={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},ln={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},on={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},an=H({props:nn,setup(e){const n=I();return fe(n,l=>{const{offsetWidth:o}=l.target;e.changeColumnWidth(e.cellKey,o)}),ee(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>m("td",{ref:n,style:{padding:0,border:0,height:0}},[m("div",{style:{height:0,overflow:"hidden"}},[mt(" ")])])}}),sn=H({setup(){const{mergedPrefixCls:e,flattedColumns:n}=W(A),{changeColumnWidth:t}=W(be);return()=>{const l=n.value.map(o=>{const{key:s}=o;return m(an,{key:s,cellKey:s,changeColumnWidth:t},null)});return m("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[l])}}}),rn=H({props:tn,setup(e){const{props:n,slots:t,config:l,mergedPrefixCls:o,mergedEmptyCell:s,activeOrderByMap:r,fixedColumnKeys:a,columnOffsets:i,isSticky:u,isTreeData:c,expandable:f,selectable:h,mergedPagination:g}=W(A),v=b(()=>r[e.column.key]),p=cn(e),x=b(()=>a.value.lastStartKey===e.column.key),C=b(()=>a.value.firstEndKey===e.column.key),w=b(()=>{const{type:S,ellipsis:B}=e.column;return S||B!=null?B:n.ellipsis}),d=b(()=>{const{fixed:S,align:B}=e.column,k=o.value;let T={[`${k}-cell`]:!0,[`${k}-cell-sorted`]:!!v.value,[`${k}-cell-align-${B}`]:!!B&&B!="start",[`${k}-cell-ellipsis`]:!!w.value};return S&&(T={...T,[`${k}-fix-start`]:S==="start",[`${k}-fix-start-last`]:x.value,[`${k}-fix-end`]:S==="end",[`${k}-fix-end-first`]:C.value,[`${k}-fix-sticky`]:u.value}),G(T)}),y=b(()=>{const{fixed:S}=e.column;if(!S)return;const{starts:B,ends:k}=i.value,K=z((S==="start"?B:k)[e.colIndex]);return{position:"sticky",left:S==="start"?K:void 0,right:S==="end"?K:void 0}});return()=>{var L,D,E;const{column:S}=e,{type:B}=S;let k,T;if(B==="selectable")k=fn(e,t,h,l,g);else if(B==="indexable")k=Ze(e,t,S,g);else{const R=p.value;if(k=un(e,t,R),T=Le(w.value,k,R),!B&&(J(k)||k==="")){const $=t.emptyCell||s.value;k=Q($)?$({column:S,record:e.record,rowIndex:e.rowIndex}):$}}e.column.fixed&&w.value&&(x.value||C.value)&&(k=m("span",{class:`${o.value}-cell-content`},[k]));const K=(L=n.customAdditional)==null?void 0:L.bodyCell,P=K?K({column:S,record:e.record,rowIndex:e.rowIndex}):void 0,O=(E=(D=n.customTag)==null?void 0:D.bodyCell)!=null?E:"td",F=B==="expandable"?m("div",{class:`${o.value}-expandable-wrapper`},[dn(e,t,f,c,o.value),!nt(k)&&m("span",{class:`${o.value}-expandable-trigger-gap`},null),k]):k;return m(O,te({class:d.value,style:y.value,title:T},P),{default:()=>[F]})}}});function cn(e){return b(()=>{const{column:n,record:t}=e,l=ye(n.dataKey);if(l.length<=0)return;let o=t;for(let s=0;s<l.length&&o;s++){const r=l[s];o=o[r]}return o})}function un(e,n,t){const{record:l,rowIndex:o,column:s}=e,{customCell:r}=s,a=U(r)?n[r]:r;return a?a({value:t,record:l,rowIndex:o}):t}function dn(e,n,t,l,o){var B;const{icon:s,customIcon:r,indent:a,showLine:i}=t.value,{record:u,expanded:c,level:f=0,hasPrevSibling:h,hasNextSibling:g,showLineIndentIndexList:v}=e,p=f>0,x=l.value&&i&&a;let C;const w=(B=U(r)?n[r]:r)!=null?B:s;Q(w)?C=w({expanded:!!c,record:u}):C=U(w)?m(oe,{name:w,rotate:c?90:0},null):w;const d=a?`width: ${z(a)}`:void 0,y={[`${o}-expandable-trigger`]:!0,[`${o}-expandable-trigger-show-line`]:x,[`${o}-expandable-trigger-disabled`]:e.disabled},S=[];if(a)for(let k=0;k<f;k++)S.push(m("div",{class:{[`${o}-expandable-indent`]:!0,[`${o}-expandable-indent-show-line`]:x&&v.includes(k)},style:d},null));return[...S,m("span",{class:y,style:d},[m("button",{class:`${o}-expandable-trigger-button`,type:"button",onClick:e.disabled?void 0:e.handleExpend},[C]),x&&[m("span",{class:`${o}-expandable-trigger-line-right`},null),(h||p)&&m("span",{class:`${o}-expandable-trigger-line-top`},null),g&&m("span",{class:`${o}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function fn(e,n,t,l,o){const{record:s,rowIndex:r,selected:a,indeterminate:i,disabled:u,isHover:c,handleSelect:f}=e,{showIndex:h,multiple:g,customCell:v}=t.value,p=C=>{C.stopPropagation(),!g&&a&&!u&&f&&f()};if(!a&&!c&&h)return Ze(e,n,l.columnIndexable,o);const x=U(v)?n[v]:v;if(g){const C={checked:a,disabled:u,indeterminate:i,onChange:f,onClick:p};return x?x({...C,record:s,rowIndex:r}):m(ge,C,null)}else{const C={checked:a,disabled:u,onChange:f,onClick:p};return x?x({...C,record:s,rowIndex:r}):m(Fe,C,null)}}function Ze(e,n,t,l){const{record:o,rowIndex:s,disabled:r}=e,{customCell:a}=t,{pageIndex:i=1,pageSize:u=0}=l.value||{},c=U(a)?n[a]:a;return c?m("span",{style:r?"cursor: not-allowed":"cursor: pointer"},[c({record:o,rowIndex:s,pageIndex:i,pageSize:u})]):void 0}const hn=H({props:en,setup(e){const{props:n,mergedPrefixCls:t,flattedColumns:l,expandable:o,handleExpandChange:s,checkExpandDisabled:r,selectable:a,selectedRowKeys:i,indeterminateRowKeys:u,handleSelectChange:c,currentPageRowKeys:f}=W(A),{expandDisabled:h,handleExpend:g,selectDisabled:v,handleSelect:p,isHover:x,attrs:C}=vn(e,o,r,s,a,c,f),w=b(()=>i.value.includes(e.rowKey)),d=b(()=>u.value.includes(e.rowKey)),y=b(()=>{const S=`${t.value}-row`,{level:B,expanded:k}=e;return G({[`${S}`]:!0,[`${S}-level-${B}`]:!!B,[`${S}-selected`]:w.value,[`${S}-expanded`]:k})});return()=>{var T,K,P;const S=(T=n.customAdditional)==null?void 0:T.bodyRow,B=S?S({record:e.record,rowIndex:e.rowIndex}):void 0,k=(P=(K=n.customTag)==null?void 0:K.bodyRow)!=null?P:"tr";return m(k,te({class:y.value},C.value,B),{default:()=>[yn(e,l,h,g,w,d,v,p,x)]})}}});function vn(e,n,t,l,o,s,r){const a=b(()=>t(e.rowData)),i=b(()=>{var y;return(y=n.value)==null?void 0:y.trigger}),u=()=>{const{rowKey:y,record:S}=e;l(y,S)},c=b(()=>r.value.disabledRowKeys.includes(e.rowKey)),f=b(()=>{var y;return(y=o.value)==null?void 0:y.trigger}),h=b(()=>{var y;return(y=o.value)==null?void 0:y.showIndex}),g=I(!1),v=()=>{const{rowKey:y,record:S}=e;s(y,S)},p=()=>{i.value==="click"&&u(),f.value==="click"&&v()},x=()=>{i.value==="dblclick"&&u(),f.value==="dblclick"&&v()},C=()=>g.value=!0,w=()=>g.value=!1,d=b(()=>{const y=a.value,S=i.value,B=c.value,k=f.value,T=!y&&S==="click"||!B&&k==="click",K=!y&&S==="dblclick"||!B&&k==="dblclick",P=!B&&h.value;let O="";return T||K?O="pointer":(y&&S||B&&k)&&(O="not-allowed"),{style:O?`cursor: ${O}`:void 0,onClick:T?p:void 0,onDblclick:K?x:void 0,onMouseenter:P?C:void 0,onMouseleave:P?w:void 0}});return{expandDisabled:a,handleExpend:u,selectDisabled:c,handleSelect:v,isHover:g,attrs:d}}function yn(e,n,t,l,o,s,r,a,i){const u=[],{rowIndex:c,record:f,level:h,hasNextSibling:g,hasPrevSibling:v,showLineIndentIndexList:p}=e;return n.value.forEach((x,C)=>{const{type:w,colSpan:d,rowSpan:y,key:S}=x,B=d==null?void 0:d(f,c),k=y==null?void 0:y(f,c);if(B===0||k===0)return;const T={colSpan:B===1?void 0:B,rowSpan:k===1?void 0:k,rowIndex:c,colIndex:C,record:f,column:x,level:h,hasNextSibling:g,hasPrevSibling:v,showLineIndentIndexList:p,key:S};w==="expandable"?(T.expanded=e.expanded,T.disabled=t.value,T.handleExpend=l):w==="selectable"&&(T.selected=o.value,T.indeterminate=s.value,T.disabled=r.value,T.handleSelect=a,T.isHover=i.value),u.push(m(rn,T,null))}),u}function Je(e,n,t,l,o){const{children:s,expanded:r,level:a,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,record:f,rowKey:h}=e,g={key:h,expanded:r,level:a,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,hasChildren:!!(s!=null&&s.length),record:f,rowData:e,rowIndex:n,rowKey:h},v=m(hn,g,null),p=r&&gn(g,t,l,o);return p?[v,p]:v}function gn(e,n,t,l){const{customExpand:o}=t||{},{record:s,rowIndex:r}=e;let a;return Q(o)?a=o({record:s,rowIndex:r}):U(o)&&n[o]&&(a=n[o]({record:s,rowIndex:r})),a&&m(ve,{class:`${l}-expanded-row`},{default:()=>[a]})}const ue=H({setup(e,{slots:n}){const{props:t,slots:l,mergedPrefixCls:o,mergedAutoHeight:s,flattedData:r,expandable:a,scrollWidth:i,scrollHeight:u,isSticky:c}=W(A),f=b(()=>s.value||i.value||u.value||c.value);return()=>{const h=o.value,g=[];l.alert&&g.push(m(ve,{class:`${h}-alert-row`},{default:()=>[l.alert()]}));const v=r.value;return v.length>0?n.default?g.push(...n.default()):v.forEach((p,x)=>{g.push(...ye(Je(p,x,l,a.value,h)))}):g.push(m(ve,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[m(lt,{empty:t.empty},l)]})),m("tbody",{class:`${o.value}-tbody`},[f.value&&m(sn,null,null),g])}}}),pn=H({props:ln,setup(e){const{slots:n,config:t,locale:l,mergedPrefixCls:o}=W(A),s=b(()=>{var d;return(d=e.filterable.multiple)!=null?d:t.columnBase.filterable.multiple}),r=b(()=>{var d;return(d=e.filterable.footer)!=null?d:t.columnBase.filterable.footer}),a=e.activeFilterBy,[i,u]=ce(()=>a);_(()=>e.activeFilterBy,d=>u(d));const[c,f]=ce(!1),h=d=>{f(d),d||e.onUpdateFilterBy(i.value)},g=()=>{f(!1),e.onUpdateFilterBy(i.value)},v=()=>{u(a)},p=d=>{const y=`${o.value}-filterable-menu-label`,S=s.value?ge:Fe;return m("span",{class:y},[m(S,{checked:d.selected,disabled:d.disabled},null),m("span",{class:`${y}-content`},[d.label])])},x=()=>{const d=[],{customMenu:y,menus:S}=e.filterable;return Q(y)?d.push(y({selectedKeys:i.value,setSelectedKeys:u})):U(y)&&n[y]?d.push(n[y]({selectedKeys:i.value,setSelectedKeys:u})):d.push(mn(S,s,i,u,p)),r.value&&d.push(bn(l,o,g,v)),d},C=b(()=>{const d=`${o.value}-filterable-trigger`;return G({[d]:!0,[`${d}-active`]:e.activeFilterBy.length>0})}),w=()=>{const{customTrigger:d}=e.filterable;return Q(d)?d():U(d)&&n[d]?n[d]():m("span",{class:C.value,onClick:y=>y.stopPropagation()},[m(oe,{name:"filter-filled"},null)])};return()=>{const d={visible:c.value,hideOnClick:!r.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return m(Ie,d,{default:w,overlay:x})}}}),mn=(e,n,t,l,o)=>{const s={dataSource:e,multiple:n.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":l};return m(Pe,s,{itemLabel:o})},bn=(e,n,t,l)=>{const{filterConfirm:o,filterReset:s}=e.table;return m("div",{class:`${n.value}-filterable-trigger-footer`},[m(xe,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),m(xe,{size:"xs",onClick:l},{default:()=>[s]})])},Sn=H({setup(){const{mergedPrefixCls:e,paginatedMap:n,selectable:t,currentPageRowKeys:l,currentPageAllSelected:o,currentPageSomeSelected:s,handleHeadSelectChange:r,mergedSelectableMenus:a,handleSelectableMenuClick:i}=W(A),u=b(()=>{const x=n.value.size;return x===0||x===l.value.disabledRowKeys.length}),[c,f]=ce(!1),h={"onUpdate:visible":f,trigger:"click"},g=()=>m(Pe,{dataSource:a.value,onClick:i},null),v=()=>m(oe,{class:`${e.value}-selectable-trigger`,name:"down",rotate:c.value?180:0},null),p=()=>{if(a.value.length!==0)return m(Ie,h,{default:v,overlay:g})};return()=>{const{multiple:x}=t.value;if(x)return m("span",{class:`${e.value}-cell-triggers`},[m(ge,{checked:o.value,indeterminate:s.value,disabled:u.value,onChange:r},null),p()])}}}),xn=H({props:on,setup(e){const{locale:n,mergedPrefixCls:t}=W(A);return()=>{const{activeOrderBy:l,sortable:o}=e,{orders:s,nextTooltip:r}=o,a=r&&Cn(n.table,s,l),i=wn(t,s,l);return a?m(ot,{title:a},{default:()=>[i]}):i}}});function Cn(e,n,t){const l=t?n[n.indexOf(t)+1]:n[0],{sortCancel:o,sortAsc:s,sortDesc:r}=e;return l?l==="ascend"?s:r:o}function wn(e,n,t){const l=e.value,o=`${l}-sortable-trigger-active`,s=n.includes("ascend")&&m(oe,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),r=n.includes("descend")&&m(oe,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return m("span",{class:`${l}-sortable-trigger`},[s,r])}const Bn=H({props:Qt,setup(e){const{props:n,slots:t,mergedPrefixCls:l,fixedColumnKeys:o,columnOffsetsWithScrollBar:s,isSticky:r,handleSort:a,activeOrderByMap:i,activeFilterByMap:u,handleFilter:c}=W(A),f=b(()=>{const{type:w,ellipsis:d}=e.column,y=w||d!=null?d:n.ellipsis;return Re(y)&&y.head===!1?void 0:y}),h=b(()=>{const{type:w,align:d,fixed:y,hasChildren:S,key:B,sortable:k,filterable:T}=e.column,K=l.value;let P={[`${K}-cell`]:!0,[`${K}-cell-${w}`]:!!w,[`${K}-cell-filterable`]:!!T,[`${K}-cell-sortable`]:!!k,[`${K}-cell-align-center`]:S||d==="center",[`${K}-cell-align-end`]:!S&&d==="end",[`${K}-cell-ellipsis`]:!!f.value};if(y){const{lastStartKey:O,firstEndKey:F}=o.value;P={...P,[`${K}-fix-start`]:y==="start",[`${K}-fix-start-last`]:O===B,[`${K}-fix-end`]:y==="end",[`${K}-fix-end-first`]:F===B,[`${K}-fix-sticky`]:r.value}}return G(P)}),g=b(()=>{const{fixed:w,colStart:d,colEnd:y}=e.column;if(!w)return;const{starts:S,ends:B}=s.value,K=z((w==="start"?S:B)[w==="start"?d:y]);return{position:"sticky",left:w==="start"?K:void 0,right:w==="end"?K:void 0}}),v=b(()=>i[e.column.key]),p=b(()=>u[e.column.key]||at),x=w=>{const{key:d,filterable:y}=e.column;c(d,y,w)},C=()=>{const{key:w,sortable:d}=e.column;d&&a(w,d)};return()=>{var F,L,D;const{column:w}=e,{type:d,titleColSpan:y,titleRowSpan:S}=w;if(d==="scroll-bar")return m("th",{class:h.value,style:g.value,colspan:y===1?void 0:y,rowspan:S===1?void 0:S,onClick:C},null);const B=l.value;let k,T;if(d==="selectable")T=m(Sn,null,null);else{const{title:E,customTitle:R,sortable:$,filterable:j}=w,N=f.value;T=kn(E,R,t),k=Le(N,T,E);const q=Kn($,v,j,p,x);q.length>0?T=m("span",{class:`${B}-cell-triggers`},[m("span",{class:`${B}-cell-title`},[T]),q]):N&&(T=m("span",{class:`${B}-cell-title`},[T]))}const K=(F=n.customAdditional)==null?void 0:F.headCell,P=K?K({column:w}):void 0,O=(D=(L=n.customTag)==null?void 0:L.headCell)!=null?D:"th";return m(O,te({class:h.value,style:g.value,colSpan:y===1?void 0:y,rowSpan:S===1?void 0:S,title:k},P,{onClick:C}),{default:()=>[T]})}}});function kn(e,n,t){let l=e;return Q(n)?l=n({title:e}):U(n)&&t[n]&&(l=t[n]({title:e})),l}function Kn(e,n,t,l,o){const s=[];return e&&s.push(m(xn,{activeOrderBy:n.value,sortable:e},null)),t&&s.push(m(pn,{activeFilterBy:l.value,filterable:t,onUpdateFilterBy:o},null)),s}const Tn=H({props:Jt,setup(e){const{props:n,mergedPrefixCls:t}=W(A);return()=>{var a,i,u;const{columns:l}=e,o=(a=n.customAdditional)==null?void 0:a.headRow,s=o?o({columns:l}):void 0,r=(u=(i=n.customTag)==null?void 0:i.headRow)!=null?u:"tr";return m(r,te({class:`${t.value}-row`},s),{default:()=>[l.filter(c=>c.titleColSpan!==0).map(c=>m(Bn,{key:c.key,column:c},null))]})}}}),Te=H({setup(){const{props:e,mergedRows:n,mergedPrefixCls:t}=W(A);return()=>{var a,i,u;const l=n.value,o=(a=e.customAdditional)==null?void 0:a.head,s=o?o({rows:l}):void 0,r=(u=(i=e.customTag)==null?void 0:i.head)!=null?u:"thead";return m(r,te({class:`${t.value}-thead`},s),{default:()=>[l.map((c,f)=>m(Tn,{key:f,columns:c},null))]})}}}),$n=H({setup(){const{props:e,slots:n,expandable:t,mergedPrefixCls:l,mergedInsetShadow:o,mergedVirtualItemHeight:s,mergedAutoHeight:r,columnWidths:a,changeColumnWidth:i,flattedData:u,isSticky:c,mergedSticky:f,virtualScrollRef:h,scrollBodyRef:g,scrollContentRef:v,handleScroll:p,pingedStart:x,pingedEnd:C,scrollWidth:w,scrollHeight:d,hasFixed:y,tableLayout:S}=W(A),B=I(),k=I(0);He(be,{mainTableWidth:k,changeColumnWidth:(E,R)=>{it(B.value)&&i(E,R)}});const K=()=>{const E=V(g);E&&p({currentTarget:E})},P=E=>{const{offsetWidth:R}=E.target;R!==k.value&&(k.value=R)};ie(()=>{K(),_([()=>e.dataSource,w],([,R])=>{R&&K()}),_(a,Oe(()=>{var $;(($=V(g))==null?void 0:$.scrollLeft)===0&&K()},16)),st(B.value,P)}),ee(()=>rt(B.value,P));const O=b(()=>{const E=l.value;return G({[`${E}-container`]:!0,[`${E}-ping-start`]:x.value,[`${E}-ping-end`]:C.value,[`${E}-fixed-layout`]:S.value==="fixed",[`${E}-fixed-column`]:y.value,[`${E}-inset-shadow`]:o.value,[`${E}-scroll-horizontal`]:w.value,[`${E}-scroll-vertical`]:d.value})}),F=b(()=>{var q;const E=w.value,R=d.value,$=E?"auto":void 0,j=e.virtual?"hidden":R?"scroll":E?"hidden":void 0,N=(q=e.scroll)==null?void 0:q.fullHeight;return{overflowX:$,overflowY:j,[N?"height":"maxHeight"]:R}}),L=b(()=>({tableLayout:S.value,width:w.value,minWidth:w.value?"100%":void 0})),D=(E,R,$)=>{M(e.onScrolledChange,E,R,$.map(j=>j.record))};return()=>{const E=l.value,R=r.value,$=n.default?n.default():[];if(R||d.value||c.value){const{offsetTop:j}=f.value;if(e.headless||$.push(m(Xt,{offsetTop:j},{default:()=>[m(Te,null,null)]})),e.virtual&&(e.scroll||R)){const N=({item:Y,index:ae})=>Je(Y,ae,n,t.value,E),q=Y=>m("table",{ref:v,class:`${E}-table`,style:L.value},[m(re,null,null),m(ue,null,{default:()=>[Y]}),!1]),{scroll:X,onScrolledBottom:ne}=e;$.push(m(ct,{ref:h,style:F.value,dataSource:u.value,fullHeight:X==null?void 0:X.fullHeight,getKey:"rowKey",height:r.value?"100%":X==null?void 0:X.height,itemHeight:s.value,itemRender:N,contentRender:q,virtual:!0,onScroll:p,onScrolledBottom:ne,onScrolledChange:D},null))}else $.push(m("div",{ref:g,class:`${E}-content`,style:F.value,onScroll:p},[m("table",{ref:v,class:`${E}-table`,style:L.value},[m(re,null,null),m(ue,null,null),!1])]));c.value&&$.push(m(Yt,null,null))}else $.push(m("div",{ref:g,class:`${E}-content`,style:F.value,onScroll:p},[m("table",{ref:v,class:`${E}-table`,style:L.value},[m(re,null,null),!e.headless&&m(Te,null,null),m(ue,null,null),!1])]));return m("div",{ref:B,class:O.value},[$])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function En(e,n){return e.footer?m("div",{class:`${n}-footer`},[e.footer()]):null}function In(e,n,t,l){var r,a;let o=null,s=null;if(n!==null){const{position:i}=n,[u,c]=bt(i).split("-"),f=`${l}-pagination ${l}-pagination-${c}`,h=(a=(r=e.pagination)==null?void 0:r.call(e,{total:t.length,...n}))!=null?a:m(xt,te({class:f,total:t.length},n),null);o=u==="top"?h:null,s=u==="bottom"?h:null}return[o,s]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Qe(e,n){const{getGreyColors:t}=n,l=t(),{fontSizeSm:o,heightMd:s,paddingSizeSm:r,paddingSizeMd:a,paddingSizeLg:i,colorTextTitleSecondary:u,colorEmphasizedContainerBg:c,colorBorder:f,colorIconInfo:h,colorPrimary:g,colorContainerBg:v,colorContainerBgHover:p,colorInfoContainerBg:x}=e;return{fontSizeSm:o,fontSizeMd:o,fontSizeLg:o,headRowHeightSm:s,headRowHeightMd:s,headRowHeightLg:s,cellPaddingHorizontalSm:r,cellPaddingHorizontalMd:a,cellPaddingHorizontalLg:i,cellPaddingVerticalSm:6,cellPaddingVerticalMd:10,cellPaddingVerticalLg:18,headColor:u,headBgColor:c,headSeparatorColor:f,headIconColor:h,headIconColorActive:g,headIconBgColorHover:t().l30,insetShadowStart:`inset 10px 0 8px -8px ${Ce(l.d50,.12)}`,insetShadowEnd:`inset -10px 0 8px -8px ${Ce(l.d50,.12)}`,bodyRowBgColorHover:p,bodyRowBgColorSelected:v,bodyRowBgColorExpanded:x,bodyRowBgColorTreeExpanded:x,bodyCellVerticalAlign:"middle",expandableIconColor:h}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pn(e,n){const{getGreyColors:t}=n,l=t();return{...Qe(e,n),insetShadowStart:`inset 10px 0 8px -8px ${l.l50}`,insetShadowEnd:`inset -10px 0 8px -8px ${l.l50}`}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rn=(e,n,t)=>n==="default"?Qe(e,t):Pn(e,t),On={sm:32,md:40,lg:56},Wn=H({name:"IxTable",props:Zt,setup(e,{expose:n,slots:t}){const l=se("common"),{globalHashId:o,hashId:s,registerToken:r}=ut("table");r(Rn);const a=b(()=>`${l.prefixCls}-table`),i=se("locale"),u=se("table"),c=b(()=>{var $;return($=e.autoHeight)!=null?$:u.autoHeight}),f=b(()=>{var $;return($=e.childrenKey)!=null?$:u.childrenKey}),h=dt(e,u),g=b(()=>{var $;return($=e.emptyCell)!=null?$:u.emptyCell}),v=b(()=>{var $;return($=e.insetShadow)!=null?$:u.insetShadow}),p=b(()=>{var $;return($=e.size)!=null?$:u.size}),x=b(()=>{var $;return($=e.virtualItemHeight)!=null?$:On[p.value]}),{mergedPagination:C}=Ot(e,u,p),w=qt(e),d=Wt(e,c,w),y=wt(e,t,u,d.scrollBarSizeOnFixedHolder),S=Ut(y.flattedColumns),B=Rt(y.flattedColumns),k=Pt(e,y.flattedColumns),T=Vt(e,y,d,w.isSticky,c),{activeSorters:K}=S,{activeFilters:P}=B,O=It(e,f,h,K,P,k.expandedRowKeys,C),F=Nt(e,i,y.flattedColumns,O);At(e,u,C,K,P,d.scrollTo);const L={props:e,slots:t,config:u,locale:i,mergedPrefixCls:a,mergedEmptyCell:g,mergedInsetShadow:v,mergedVirtualItemHeight:x,mergedAutoHeight:c,...y,...d,...S,...B,...w,tableLayout:T,mergedPagination:C,...k,...O,...F};He(A,L),n({scrollTo:d.scrollTo});const{flattedData:D,filteredData:E}=O,R=b(()=>{const $=a.value,{borderless:j=u.borderless,scroll:N}=e;return G({[o.value]:!!o.value,[s.value]:!!s.value,[$]:!0,[`${$}-auto-height`]:c.value,[`${$}-borderless`]:j,[`${$}-empty`]:D.value.length===0,[`${$}-full-height`]:N==null?void 0:N.fullHeight,[`${$}-${p.value}`]:!0})});return()=>{const $=a.value,j=m(ft,{header:e.header},t),N=En(t,$),[q,X]=In(t,C.value,E.value,$),ne=[j],Y=[q,m($n,null,null),N,X].filter(Boolean),ae=Hn(e.spin);return ae?ne.push(m(ht,ae,{default:()=>[Y]})):ne.push(...Y),m("div",{class:R.value},[ne])}}});function Hn(e){return St(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Nn=Wn,zn=me;export{Nn as I,zn as a,Ct as g,Zt as t};
