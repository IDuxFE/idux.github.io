import{m as B,ao as te,A as V,at as Pe,j as Te,M as Ce,N as _e,aw as Oe,H as He,aK as qe,av as je}from"./index-55847558.js";import{d as j,U as me,c as x,b as we,r as _,w as Ie,n as Re,f as ze,x as Ke,i as Ue,N as Ve,l as W,y as X,q as L,p as We,a8 as be,D as Ge,Q as Qe}from"./vendor-d701f15d.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ae(e,n,t,r="pre"){const o=(a,l)=>{for(let d=0;d<a.length;d++){const y=a[d];r==="pre"&&t(y,l),y[n]&&o(y[n],[y,...l]),r==="post"&&t(y,l)}};o(e,[])}function Nn(e,n,t,r="or"){const o=(a,l)=>{var y;const d=[];for(let v=0;v<a.length;v++){let m;const b=a[v];b[n]&&(m=o(b[n],[b,...l]));let k=t(b,l,m);const w=m&&m.length>0||!((y=b[n])!=null&&y.length)&&k;k=r==="and"?w&&k:w||k,k&&d.push({...b,[n]:b[n]&&m})}return d};return o(e,[])}function Xe(e,n,t,r){var a;const o=e.map(l=>({...l}));for(const l of n){const d=o.find(y=>{const v=r(l),m=r(y);return!j(v)&&!j(m)&&v===m});if(!d){o.push({...l});continue}for(const y of[...Object.getOwnPropertyNames(l),...Object.getOwnPropertySymbols(l)])y!==t&&(d[y]=l[y]);me(l[t])&&(d[t]=Xe((a=d[t])!=null?a:[],l[t],t,r))}return o}function In(e,n,t,r=!1){const o=[];return ae(e,n,a=>{if(!r||!a[n]||a[n].length<=0){const l=t?t(a):a;l&&o.push(l)}}),o}function pe(e,n,t,r=!1){const o=[];return ae(e,n,a=>{var l;(!r||!((l=a[n])!=null&&l.length))&&o.push(t(a))}),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Se(e,n,t,r){const o=f=>{if(!me(f))return f;const c=new Map,h=new Map,p=new Map;return ae(f,n.value,(i,s)=>{const u=t.value(i),g=s[0];c.set(u,i),p.set(u,s.length),g&&h.set(u,t.value(g))}),{data:f,dataMap:c,parentKeyMap:h,depthMap:p}},a=x(()=>{var f;return(f=r==null?void 0:r.value)!=null?f:"all"}),l=x(()=>o(e.value)),d=(f,c)=>{const{parentKeyMap:h,dataMap:p}=c,i=[];let s=f;for(;h.has(s);){const u=h.get(s),g=p.get(u);g&&i.push(g),s=u}return i},y=()=>{const{data:f,parentKeyMap:c,dataMap:h}=l.value;if(f)return f;const p=[];for(const i of c.keys())!c.has(i)&&h.has(i)&&p.push(h.get(i));return p},v=(f,c,h)=>{if(!c.length)return Array.from(f);if(a.value==="off")return Array.from(new Set([...f,...c]));const{dataMap:p}=h,i=new Set(f);return c.forEach(s=>{if(!p.has(s))return;const u=p.get(s);pe([u],n.value,t.value,a.value==="child").forEach(g=>{i.add(g)})}),a.value==="child"?Array.from(i).filter(s=>{var u,g;return!((g=(u=p.get(s))==null?void 0:u[n.value])!=null&&g.length)}):(c.forEach(s=>{d(s,h).forEach(u=>{var g;(g=u[n.value])!=null&&g.every(S=>i.has(t.value(S)))&&i.add(t.value(u))})}),a.value==="all"||i.forEach(s=>{var g;if(!i.has(s))return;const u=(g=p.get(s))==null?void 0:g[n.value];u&&ae(u,n.value,S=>{i.delete(t.value(S))})}),Array.from(i))},m=(f,c,h)=>{if(!c.length)return Array.from(f);const p=new Set(f);if(a.value==="off")return c.forEach(g=>{p.delete(g)}),Array.from(p);const{dataMap:i}=h,s=new Set,u=g=>{s.add(g),p.delete(g)};return c.forEach(g=>{if(!i.has(g))return;pe([i.get(g)],n.value,t.value).forEach(A=>{u(A)});const S=d(g,h);if(a.value==="parent"){const E=[g,...S.map(t.value)].findIndex(P=>p.has(P));E>-1&&S.slice(0,E).forEach(P=>{P[n.value]&&(P[n.value].forEach(M=>{const $=t.value(M);s.has($)||p.add($)}),u(t.value(P)))})}else S.forEach(A=>{u(t.value(A))})}),Array.from(p)},b=(f,c)=>v(f,c,l.value),k=(f,c)=>m(f,c,l.value),w=(f,c)=>{const h=f!=null?f:y(),p=a.value==="parent"?h.map(t.value):new Set(pe(h,n.value,t.value,a.value==="child"));return m(p,c,f?o(f):l.value)},K=(f,c)=>v([],c,f?o(f):l.value);return{appendKeys:b,removeKeys:k,getAllCheckedKeys:(f,c)=>{const h=(p=>we(p==null?void 0:p[0]))(f);return w(h?f:void 0,c!=null?c:h?[]:f!=null?f:[])},getAllUncheckedKeys:(f,c)=>{const h=(p=>we(p==null?void 0:p[0]))(f);return K(h?f:void 0,c!=null?c:h?[]:f!=null?f:[])}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function oe(e,n,t){if(t){const r=[],o=e.value;n.forEach(a=>{const l=o.get(a);l&&r.push(l.rawNode)}),B(t,n,r)}}function Fe(e,n){const t=[],{children:r}=e||{};return r&&r.forEach(o=>{const{key:a}=o;n!=null&&n.includes(a)||t.push(o.key),t.push(...Fe(o,n))}),t}function Me(e,n,t){const r=[];for(;n&&!j(n.parentKey);){const{parentKey:o}=n;t!=null&&t.includes(n.parentKey)||r.push(o),n=e.get(o)}return r}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ye(e,n,t,r,o){const[a,l]=te(e,"checkedKeys",()=>[]),d=x(()=>({data:n.value,dataMap:t.value,parentKeyMap:r.value,depthMap:o.value})),y=_("children"),v=_(i=>i.key),m=x(()=>e.cascaderStrategy),b=Se(d,y,v,m),k=Se(d,y,v,x(()=>m.value==="off"?"off":"all")),w=x(()=>{const i=new Set;return e.checkable&&t.value.forEach((s,u)=>{s.checkDisabled&&i.add(u)}),i}),K=x(()=>{const i=k.appendKeys([],a.value);return new Set(i)}),N=x(()=>{const i=K.value;if(i.size===0||e.cascaderStrategy==="off")return new Set;const s=new Set,u=t.value;return i.forEach(g=>{const{parentKey:S}=u.get(g)||{};if(!j(S)){let A=u.get(S);if(A&&!i.has(A.key))for(s.add(S);A&&!j(A.parentKey);)s.add(A.parentKey),A=u.get(A.parentKey)}}),s}),F=i=>w.value.has(i),f=i=>K.value.has(i),c=i=>N.value.has(i),h=i=>{var M;const s=i.key;if(i.checkDisabled)return;const u=m.value!=="off"?(M=i.children)!=null?M:[]:[],g=f(s)||!!u.length&&u.every($=>f($.key)||c($.key)||F($.key)),S=b.appendKeys([],a.value),A=b[g?"removeKeys":"appendKeys"](S,[s]),E=g?[...K.value].filter($=>F($)):(m.value==="parent"?k.appendKeys([],A):A).filter($=>F($)&&!K.value.has($)),P=b[g?"appendKeys":"removeKeys"](A,E);p(g,i.rawNode,P)},p=(i,s,u)=>{const{onCheck:g,onCheckedChange:S}=e;B(g,!i,s),l(u),oe(t,u,S)};return Ie(m,()=>{const i=b.appendKeys([],a.value);l(i)}),{checkedKeys:a,isChecked:f,isIndeterminate:c,handleCheck:h}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Je(e,n,t,r){const o=_({}),a=(k,w)=>{o.value[k]=w},l=k=>o.value[k],d=x(()=>{const k=new Map,w=new Map,K=new Map;return{mergedNodes:Be(e.dataSource,l,{props:e,childrenKey:n.value,getKey:t.value,labelKey:r.value,parentKey:void 0,parentLevel:-1,parentsDisabled:[]},{dataKeyMap:k,parentKeyMap:w,depthMap:K}),dataKeyMap:k,parentKeyMap:w,depthMap:K}}),y=x(()=>d.value.mergedNodes),v=x(()=>d.value.dataKeyMap),m=x(()=>d.value.parentKeyMap),b=x(()=>d.value.depthMap);return{mergedNodes:y,mergedNodeMap:v,parentKeyMap:m,depthMap:b,setLoadedNodes:a}}function Ze(e,{expandedKeys:n},t,r){return x(()=>{const{searchValue:o}=t,a=new Map(n.value.map((d,y)=>[d,y])),l=new Map(r.value.map((d,y)=>[d,y]));return o&&!l.size?[]:a.size||l.size?tn(e.value,a,l):e.value.map(d=>({...d,expanded:!1,level:0}))})}function Be(e,n,t,r){const{props:o,childrenKey:a,getKey:l,labelKey:d,parentKey:y,parentLevel:v,parentsDisabled:m}=t,{cascaderStrategy:b,disabled:k,loadChildren:w}=o,{dataKeyMap:K,parentKeyMap:N,depthMap:F}=r,f=!!w;return e.map((c,h)=>{var P,M,$;const p=l(c),i=en(c,k),s=(P=c[a])!=null?P:n(p),u=c[d],g=v+1,S=s&&Be(s,n,{props:o,childrenKey:a,getKey:l,labelKey:d,parentKey:p,parentLevel:g,parentsDisabled:[i,...m!=null?m:[]]},r),A=nn(i,m!=null?m:[],(M=S==null?void 0:S.map(q=>({check:q.checkDisabled,drag:q.dragDisabled,drop:q.dropDisabled,select:q.selectDisabled})))!=null?M:[],b!=="off"),E={label:u,key:p,children:S,isFirst:h===0,isLeaf:($=c.isLeaf)!=null?$:!(s!=null&&s.length||f),isLast:h===e.length-1,parentKey:y,expanded:!1,level:g,rawNode:c,checkDisabled:A.check,dragDisabled:A.drag,dropDisabled:A.drop,selectDisabled:A.select};return K.set(p,E),N.set(p,y),F.set(p,g),E})}function en(e,n){const t=e.disabled||{};if(t===!0)return{check:!0,drag:!0,drop:!0,select:!0};let{check:r,drag:o,drop:a,select:l}=t;if(n){const d=n(e)||{};if(d===!0)return{check:!0,drag:!0,drop:!0,select:!0};r=r||d.check,o=o||d.drag,a=a||d.drop,l=l||d.select}return{check:r,drag:o,drop:a,select:l}}function nn(e,n,t,r){const o=a=>e[a]||r&&(n.some(l=>!!l[a])||!!t.length&&t.every(l=>!!l[a]));return{check:o("check"),drag:o("drag"),drop:o("drop"),select:o("select")}}function $e(e=[],n){const t=[],r=e.length;return e.forEach((o,a)=>{o.isFirst=a===0,o.isLast=a===r-1,n.has(o.key)||n.size==0?(o.hidden=!1,t.push(o)):o.hidden=!0,$e(o.children,n).length>0&&(o.hidden=!1,t.push(o))}),t.length&&(t[0].isFirst=!0,t[t.length-1].isLast=!0),t}function tn(e,n,t){const r=[],o=[];return $e(e,t),e.forEach(a=>{for(o.push(a);o.length;){const l=o.pop();if(l){const{children:d,key:y,hidden:v}=l,m=n.has(y);if(l.expanded=m,!v&&r.push(l),d&&m)for(let b=d.length;b>0;b--)!d[b-1].hidden&&o.push(d[b-1])}}}),r}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function an(e,n,{expandedKeys:t,setExpandedKeys:r}){const o=x(()=>{var s;return(s=e.draggableIcon)!=null?s:n.draggableIcon}),a=_(),l=_(),d=_(),y=_(),v=_();let m;const b=()=>{m&&(clearTimeout(m),m=void 0)};Re(()=>b());const k=()=>{j(a.value)||(a.value=void 0,l.value=void 0)},w=()=>{j(d.value)||(d.value=void 0,y.value=void 0,v.value=void 0)},K=(s,u)=>{var g,S;return{evt:s,node:u.rawNode,dragNode:(g=a.value)==null?void 0:g.rawNode,dropNode:(S=d.value)==null?void 0:S.rawNode,dropType:v.value}},N=s=>{f(s,void 0),window.removeEventListener("dragend",N)},F=(s,u)=>{a.value=u,l.value=Fe(u),rn(u.key,t.value,r),window.addEventListener("dragend",N),B(e.onDragstart,K(s,u))},f=(s,u)=>{u&&B(e.onDragend,K(s,u)),k(),w()},c=async(s,u)=>{const g=a.value;if(g){b(),g.key!==u.key&&(m=setTimeout(()=>{var A;a.value&&((A=u.children)!=null&&A.length)&&on(u.key,t.value,r),m=void 0},1e3));const S=await De(u,g,l.value,s,e.droppable);S?(d.value=u,y.value=S!=="inside"?u.parentKey:void 0,v.value=S):w()}B(e.onDragenter,K(s,u))},h=async(s,u)=>{const g=a.value;if(g){const S=await De(u,g,l.value,s,e.droppable);S?(d.value=u,y.value=S!=="inside"?u.parentKey:void 0,v.value=S):w()}B(e.onDragover,K(s,u))},p=(s,u)=>{const g=d.value;(g==null?void 0:g.key)===u.key&&!s.currentTarget.contains(s.relatedTarget)&&w(),B(e.onDragleave,K(s,u))},i=(s,u)=>{v.value||w(),B(e.onDrop,K(s,u)),k(),w()};return{draggableIcon:o,dragKey:x(()=>{var s;return(s=a.value)==null?void 0:s.key}),dropKey:x(()=>{var s;return(s=d.value)==null?void 0:s.key}),dropParentKey:y,dropType:v,handleDragstart:F,handleDragend:f,handleDragenter:c,handleDragover:h,handleDragleave:p,handleDrop:i}}function on(e,n,t){n.indexOf(e)===-1&&t([...n,e])}function rn(e,n,t){const r=n.indexOf(e);if(r!==-1){const o=[...n];o.splice(r,1),t(o)}}async function De(e,n,t,r,o){const{key:a,children:l=[]}=e;if(n.key===a||t&&t.includes(a))return!1;const{clientY:d}=r,{top:y,height:v}=r.target.getBoundingClientRect(),m=d<y+v/2;let b;if(o){const k={evt:r,isTopHalf:m,dragNode:n.rawNode,dropNode:e.rawNode};b=await o(k)}return(b===void 0||b===!0)&&(l.length>0?b="inside":m?b="before":b="after"),b}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ln(e,n,t,{expandedKeys:r,handleExpand:o},{activeKey:a,handleSelect:l}){const d=_(!1);return{focused:d,handleFocus:k=>{d.value=!0,B(e.onFocus,k)},handleBlur:k=>{d.value=!0,B(e.onBlur,k)},handleKeydown:k=>{switch(k.code){case"ArrowUp":case"ArrowDown":k.preventDefault()}B(e.onKeydown,k)},handleKeyup:k=>{const w=k.code,K=a.value,N=t.value,F=N.length;if(K===void 0)["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].includes(w)&&ye(a,N,0,F);else{const f=t.value,c=f.findIndex(h=>h.key===K);if(c===-1)return;switch(w){case"Enter":case"NumpadEnter":l(K);break;case"ArrowDown":ye(a,f,c+1,F);break;case"ArrowUp":ye(a,f,c-1,0,!0);break;case"ArrowLeft":{const{rawNode:h,key:p,parentKey:i}=f[c];if(h.isLeaf||!r.value.includes(p)){const s=i?n.value.get(i):void 0;s&&(a.value=s.key)}else o(p,h)}break;case"ArrowRight":{const{rawNode:h,key:p}=f[c];if(!r.value.includes(p))o(p,h);else for(let i=c+1;i<F;i++){const s=f[i];a.value=s.key;break}}break}}B(e.onKeyup,k)}}}function ye(e,n,t,r,o=!1){let a=t;for(;o?a>=r:a<r;){const l=n[a];if(l.selectDisabled)o?a--:a++;else{e.value=l.key;return}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function cn(e,n,t,r,o,a){const l=x(()=>{var c;return(c=e.expandIcon)!=null?c:n.expandIcon}),[d,y]=te(e,"expandedKeys",()=>[]),[v,m]=te(e,"loadedKeys",()=>[]),b=_([]),k=({key:c,expanded:h,node:p})=>{if(ze(l.value))return Ke(V,{name:l.value,rotate:h?90:0});if(Ue(l.value))return l.value({key:c,expanded:h,node:p});if(me(l.value))return Ke(V,{name:h?l.value[0]:l.value[1]})},w=c=>{if(!c||c.length<=0)return;const{onExpandedChange:h}=e,p=r.value,i=new Set(d.value);c.forEach(u=>{Me(p,p.get(u)).forEach(g=>i.add(g))});const s=[...i];y(s),oe(r,s,h)};Ie(o,w);const K=async(c,h)=>{var S;const{loadChildren:p}=e;if(b.value.includes(c))return;const i=t.value;if(!((S=h==null?void 0:h[i])!=null&&S.length)){if(!p||b.value.includes(c)||v.value.includes(c))return;b.value.push(c);const A=await p(h);b.value.splice(b.value.indexOf(c),1);const P=r.value.get(c);if(A!=null&&A.length){a(c,A),P.rawNode[i]=A;const M=[...v.value,c];m(M),B(e.onLoaded,M,h)}else return}const s=d.value.indexOf(c),u=s>=0,g=[...d.value];u?g.splice(s,1):g.push(c),N(u,h,g)},N=(c,h,p)=>{const{onExpand:i,onExpandedChange:s}=e;B(i,!c,h),y(p),oe(r,p,s)},F=()=>{const c=[],h=[];r.value.forEach(p=>{p.isLeaf||(c.push(p.key),h.push(p.rawNode))}),B(e.onExpandedChange,c,h),y(c)},f=()=>{B(e.onExpandedChange,[],[]),y([])};return o.value.length&&w(o.value),{expandIconRenderer:k,expandedKeys:d,setExpandedKeys:y,expandAll:F,collapseAll:f,handleExpand:K,loadingKeys:b}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function sn(e,n,t){const r=dn(e,t);return{searchedKeys:x(()=>{const{searchValue:a}=e;if(!a)return Pe;const l=r.value,d=[];return n.value.forEach(y=>{l(y.rawNode,a)&&d.push(y.key)}),d})}}function dn(e,n){return x(()=>{var t;return(t=e.searchFn)!=null?t:un(n.value)})}function un(e){return(n,t)=>{const r=n[e];return r?r.toLowerCase().includes(t.toLowerCase()):!1}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function fn(e,n){const[t,r]=te(e,"selectedKeys",()=>[]),o=x(()=>e.selectable==="multiple"),a=_();Ve(()=>{const v=t.value,m=v.length;a.value=m>0?v[m-1]:void 0});const l=x(()=>{const v=a.value;return v!==void 0?n.value.get(v):void 0}),d=v=>{const b=n.value.get(v);if(!b)return;const k=t.value.indexOf(v),w=k>-1;let K=[...t.value];o.value?w?K.splice(k,1):K.push(v):K=w?[]:[v],y(w,b.rawNode,K)},y=(v,m,b)=>{var N;const{onSelect:k,onSelectedChange:w}=e,K=b.includes((N=m.key)!=null?N:"")?!0:!v;B(k,K,m),r(b),oe(n,b,w)};return{activeKey:a,activeNode:l,selectedKeys:t,handleSelect:d}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const G=Symbol("treeToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const vn={autoHeight:{type:Boolean,default:void 0},checkedKeys:Array,expandedKeys:Array,indeterminateKeys:Array,loadedKeys:Array,selectedKeys:Array,blocked:{type:Boolean,default:void 0},cascaderStrategy:{type:String,default:"off"},checkable:{type:Boolean,default:!1},childrenKey:String,checkOnClick:{type:Boolean,default:!1},customAdditional:{type:Function,default:void 0},dataSource:{type:Array,default:()=>[]},disabled:Function,draggable:{type:Boolean,default:!1},draggableIcon:{type:String,default:void 0},droppable:Function,empty:{type:[String,Object],default:"simple"},expandIcon:{type:[String,Function,Array],default:void 0},getKey:{type:[String,Function],default:void 0},height:Number,labelKey:String,leafLineIcon:String,loadChildren:Function,searchFn:Function,searchValue:String,selectable:{type:[Boolean,String],default:!0},showLine:{type:Boolean,default:void 0},virtual:{type:Boolean,default:!1},virtualScrollMode:{type:String,default:void 0},virtualItemHeight:{type:Number,default:28},"onUpdate:checkedKeys":[Function,Array],"onUpdate:expandedKeys":[Function,Array],"onUpdate:loadedKeys":[Function,Array],"onUpdate:selectedKeys":[Function,Array],onCheck:[Function,Array],onCheckedChange:[Function,Array],onDragstart:[Function,Array],onDragend:[Function,Array],onDragenter:[Function,Array],onDragleave:[Function,Array],onDragover:[Function,Array],onDrop:[Function,Array],onExpand:[Function,Array],onExpandedChange:[Function,Array],onLoaded:[Function,Array],onSelect:[Function,Array],onSelectedChange:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array],onKeydown:[Function,Array],onKeyup:[Function,Array],onNodeClick:[Function,Array],onNodeContextmenu:[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},hn={node:{type:Object,required:!0},isLeaf:{type:Boolean,required:!0},isFirst:{type:Boolean,required:!0},isLast:{type:Boolean,required:!0},label:String,level:{type:Number,required:!0},rawNode:{type:Object,required:!0},expanded:{type:Boolean,required:!0},children:Array,parentKey:[String,Number,Symbol],checkDisabled:{type:Boolean,default:void 0},dragDisabled:{type:Boolean,default:void 0},dropDisabled:{type:Boolean,default:void 0},selectDisabled:{type:Boolean,default:void 0}},gn={node:{type:Object,required:!0},checkDisabled:{type:Boolean,default:void 0}},pn={expanded:{type:Boolean,required:!0},hasTopLine:{type:Boolean,default:void 0},hasBottomLine:{type:Boolean,default:void 0},isLeaf:{type:Boolean,default:void 0},nodeKey:{type:[String,Number,Symbol],required:!0},rawNode:{type:Object,required:!0}},yn={disabled:{type:Boolean,default:void 0},node:{type:Object,required:!0},nodeKey:{type:[String,Number,Symbol],required:!0},label:String,selected:{type:Boolean,default:void 0}},bn=W({props:gn,setup(e){const{mergedPrefixCls:n,isChecked:t,isIndeterminate:r,handleCheck:o}=X(G),a=x(()=>t(e.node.key)),l=x(()=>r(e.node.key)),d=()=>o(e.node);return()=>L(Te,{class:`${n.value}-node-checkbox`,checked:a.value,disabled:e.checkDisabled,indeterminate:l.value,onChange:d},null)}}),mn=W({props:yn,setup(e,{slots:n}){const{props:t,mergedPrefixCls:r,mergedCheckOnClick:o,handleSelect:a,handleCheck:l,searchedKeys:d}=X(G),y=x(()=>d.value.includes(e.nodeKey)),v=b=>{e.disabled||(a(e.nodeKey),o.value&&l(e.node)),B(t.onNodeClick,b,e.node.rawNode)},m=b=>{B(t.onNodeContextmenu,b,e.node.rawNode)};return()=>{var s,u;const{nodeKey:b,label:k,node:w,selected:K}=e,{rawNode:N}=w,{prefix:F,suffix:f}=N,c={key:b,selected:K,node:N},h=((s=n.prefix)==null?void 0:s.call(n,c))||F&&L(V,{name:F},null),p=((u=n.suffix)==null?void 0:u.call(n,c))||f&&L(V,{name:f},null),i=`${r.value}-node-content`;return L("span",{class:i,onClick:v,onContextmenu:m},[h&&L("span",{class:`${i}-prefix`},[h]),L("span",{class:`${i}-label`},[kn(n.label,k,N,t.searchValue,y.value,i)]),p&&L("span",{class:`${i}-suffix`},[p])])}}});function kn(e,n,t,r,o,a){if(e)return e({node:t,searchValue:r,searched:o});if(o&&n&&r){const l=n.toUpperCase().indexOf(r.toUpperCase());if(l>-1){const d=l+r.length,y=n.substring(0,l),v=n.substring(d),m=L("span",{class:`${a}-label-highlight`},[n.substring(l,d)]);return[y,m,v]}}return n}const xn=W({props:pn,setup(e,{slots:n}){const{mergedPrefixCls:t,expandIconRenderer:r,loadingKeys:o,handleExpand:a}=X(G),l=x(()=>o.value.includes(e.nodeKey)),d=x(()=>{const v=`${t.value}-node-expand`;return We({[v]:!0,[`${v}-noop`]:e.isLeaf})}),y=v=>{a(e.nodeKey,e.rawNode),v.stopPropagation()};return()=>{var b,k;const v=`${t.value}-node-expand`;let m;if(l.value)m=L(V,{name:"loading"},null);else if(!e.isLeaf){const{expanded:w,nodeKey:K,rawNode:N}=e;m=(k=(b=n.expandIcon)!=null?b:r)==null?void 0:k({key:K,expanded:w,node:N})}return L("span",{class:d.value,onClick:y},[e.hasTopLine&&L("div",{class:`${v}-top-line`},null),m,e.hasBottomLine&&L("div",{class:`${v}-bottom-line`},null)])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Cn=({level:e,noopIdentUnitArr:n,prefixCls:t})=>{const r=[];for(let o=0;o<e;o++)r.push(L("span",{key:o,class:n.includes(o)?`${t}-node-indent-noop-unit`:`${t}-node-indent-unit`},null));return L("span",{"aria-hidden":!0,class:`${t}-node-indent`},[r])},wn=Cn,Kn=W({setup(e,{slots:n}){const{props:t,mergedPrefixCls:r}=X(G);return()=>{const o=`${r.value}-node-leaf`;let a;return n.leafLineIcon?a=n.leafLineIcon():t.leafLineIcon?a=L(V,{name:t.leafLineIcon},null):a=L("span",{class:`${o}-line`},null),L("span",{class:o},[a])}}}),Ae=W({props:hn,setup(e,{slots:n}){const{props:t,flattedNodes:r,mergedPrefixCls:o,mergedShowLine:a,activeKey:l,selectedKeys:d,draggableIcon:y,dragKey:v,dropKey:m,dropParentKey:b,dropType:k,handleDragstart:w,handleDragend:K,handleDragenter:N,handleDragover:F,handleDragleave:f,handleDrop:c}=X(G),h=x(()=>e.node.key),p=x(()=>l.value===h.value),i=x(()=>a.value&&e.isLast),s=x(()=>a.value&&!e.isLeaf&&(!e.isFirst||e.level!==0)),u=x(()=>a.value&&!e.isLeaf&&!e.isLast),g=x(()=>d.value.includes(h.value)),S=x(()=>e.selectDisabled||!t.selectable),A=x(()=>v.value===h.value),E=x(()=>m.value===h.value),P=x(()=>b.value===h.value),M=x(()=>E.value&&k.value==="before"),$=x(()=>E.value&&k.value==="inside"),q=x(()=>E.value&&k.value==="after"),Y=x(()=>{const D=`${o.value}-node`;return{[D]:!0,[`${D}-active`]:p.value,[`${D}-last`]:i.value,[`${D}-disabled`]:S.value,[`${D}-selected`]:g.value,[`${D}-expanded`]:e.expanded,[`${D}-dragging`]:A.value,[`${D}-dropping`]:E.value,[`${D}-drop-parent`]:P.value,[`${D}-drop-before`]:M.value,[`${D}-drop-inside`]:$.value,[`${D}-drop-after`]:q.value}}),re=D=>{var U;D.stopPropagation(),w(D,e.node),(U=D.dataTransfer)==null||U.setData("text/plain","")},le=D=>{D.stopPropagation(),K(D,e.node)},ce=D=>{D.preventDefault(),D.stopPropagation(),N(D,e.node)},se=D=>{D.preventDefault(),D.stopPropagation(),F(D,e.node)},de=D=>{D.stopPropagation(),f(D,e.node)},ue=D=>{D.stopPropagation(),c(D,e.node)};return()=>{var z,ke;const D=new Map;r.value.forEach(ne=>{D.set(ne.key,ne)});const{isLeaf:U,label:Q,level:J,rawNode:Z,expanded:ie,checkDisabled:fe,dragDisabled:C,dropDisabled:I,node:O}=e,{checkable:H,draggable:R}=t,T=R&&!C,ve=(ke=(z=n.draggableIcon)==null?void 0:z.call(n))!=null?ke:L(V,{name:y.value},null),he=D.get(h.value),ee=[];a.value&&Me(D,he).reverse().forEach((ne,Ee)=>{var xe;(xe=D.get(ne))!=null&&xe.isLast&&ee.push(Ee)});const ge=t.customAdditional?t.customAdditional({node:Z,level:J}):void 0;return L("div",be({class:Y.value,"aria-grabbed":A.value||void 0,"aria-label":Q,"aria-selected":g.value,draggable:T||void 0,title:Q,onDragstart:T?re:void 0,onDragend:T?le:void 0,onDragenter:T?ce:void 0,onDragover:T?se:void 0,onDragleave:T?de:void 0,onDrop:T&&!I?ue:void 0},ge),[L(wn,{level:J,noopIdentUnitArr:ee,prefixCls:o.value},null),T?L("span",{class:`${o.value}-node-draggable-icon`},[ve]):R&&L("span",{class:`${o.value}-node-draggable-icon-noop`},null),U&&a.value?L(Kn,null,n):L(xn,{expanded:ie,hasTopLine:s.value,hasBottomLine:u.value,isLeaf:U,nodeKey:h.value,rawNode:Z},n),H&&L(bn,{checkDisabled:fe,node:O},null),L(mn,{disabled:S.value,node:O,nodeKey:h.value,label:Q,selected:g.value},n)])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Le(e){const{heightMd:n,heightSm:t,marginSizeXs:r,colorPrimaryHover:o,colorPrimaryText:a,colorContainerBgHover:l,colorContainerBg:d,colorIconInfo:y}=e;return{dropLineWidth:2,dropLineColor:o,bgColor:d,nodeBgColorHover:l,nodeBgColorSelected:d,nodeColorSelected:a,nodePaddingHorizontal:r,nodePaddingVertical:"0px",nodeContentHeight:n,nodeContentLabelHighlightColor:a,nodeContentPrefixMarginRight:r,nodeCheckboxMarginRight:r,nodeIconWidth:t,expandIconColor:y}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Sn=(e,n)=>Le(e),Ne={width:0,height:0,display:"flex",overflow:"hidden",opacity:0,border:0,padding:0,margin:0},Dn=W({name:"IxTree",props:vn,setup(e,{attrs:n,expose:t,slots:r}){const o=Ce("common"),{globalHashId:a,hashId:l,registerToken:d}=_e("tree");d(Sn);const y=x(()=>`${o.prefixCls}-tree`),v=Ce("tree"),m=x(()=>{var C;return(C=e.autoHeight)!=null?C:v.autoHeight}),b=x(()=>{var C;return(C=e.childrenKey)!=null?C:v.childrenKey}),k=Oe(e,v),w=x(()=>{var C;return(C=e.labelKey)!=null?C:v.labelKey}),K=x(()=>{var C;return(C=e.showLine)!=null?C:v.showLine}),N=x(()=>{var C;return(C=e.blocked)!=null?C:v.blocked}),F=x(()=>e.checkable&&e.checkOnClick),{mergedNodes:f,mergedNodeMap:c,parentKeyMap:h,depthMap:p,setLoadedNodes:i}=Je(e,b,k,w),{searchedKeys:s}=sn(e,c,w),u=cn(e,v,b,c,s,i),g=Ze(f,u,e,s),S=Ye(e,f,c,h,p),A=an(e,v,u),E=fn(e,c),{handleCheck:P}=S;Ge(G,{props:e,config:v,flattedNodes:g,mergedPrefixCls:y,mergedNodeMap:c,mergedGetKey:k,mergedShowLine:K,mergedCheckOnClick:F,searchedKeys:s,...S,...u,...A,...E});const M=_(),$=_(),{activeKey:q}=E,{focused:Y,handleFocus:re,handleBlur:le,handleKeydown:ce,handleKeyup:se}=ln(e,c,g,u,E),de=x(()=>{const C=y.value;return{[a.value]:!!a.value,[l.value]:!!l.value,[C]:!0,[`${C}-active`]:!j(q.value),[`${C}-blocked`]:N.value,[`${C}-virtual`]:e.virtual,[`${C}-auto-height`]:m.value,[`${C}-focused`]:Y.value,[`${C}-show-line`]:K.value,[`${C}-empty`]:!g.value.length}}),ue=x(()=>{var R,T;const C=q.value;if(j(C))return"";const I=c.value;let O=String(C),H=(R=I.get(C))==null?void 0:R.parentKey;for(;H;)O=`${String(H)} > ${O}`,H=(T=I.get(H))==null?void 0:T.parentKey;return O}),D=C=>{var I;(I=M==null?void 0:M.value)==null||I.focus(C)},U=()=>{var C;(C=M==null?void 0:M.value)==null||C.blur()},Q=C=>{var I;(I=$.value)==null||I.scrollTo(C)},J=C=>{var I;return(I=c.value.get(C))==null?void 0:I.rawNode},Z=()=>g.value,ie=C=>{const I=c.value.get(C);I&&P(I)};t({focus:D,blur:U,expandAll:u.expandAll,collapseAll:u.collapseAll,scrollTo:Q,getNode:J,_getFlattedNodes:Z,_handleCheck:ie});const fe=(C,I,O)=>{B(e.onScrolledChange,C,I,O.map(H=>H.rawNode))};return()=>{var O;const C=g.value;let I;if(C.length>0){const H=({item:z})=>L(Ae,be({node:z},z),r),{height:R,virtual:T,virtualItemHeight:ve,virtualScrollMode:he,onScroll:ee,onScrolledBottom:ge}=e;I=T?L(He,{ref:$,class:`${y.value}-content`,dataSource:C,getKey:"key",height:m.value?"100%":R,rowHeight:ve,rowRender:H,virtual:!0,scrollMode:he,onScroll:ee,onScrolledBottom:ge,onScrolledChange:fe},null):L("div",{class:`${y.value}-content`,style:Qe(m.value?void 0:{maxHeight:qe(R)})},[L("div",{class:`${y.value}-content-inner`},[C.map(z=>L(Ae,be({node:z},z),r))])])}else I=L(je,{empty:e.empty},r);return L("div",{class:de.value,role:"tree"},[Y.value&&L("span",{style:Ne,"aria-live":"assertive"},[ue.value]),L("input",{ref:M,style:Ne,tabindex:(O=n.tabIndex)!=null?O:0,onFocus:re,onBlur:le,onKeydown:ce,onKeyup:se,value:"","aria-label":"for screen reader"},null),I])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Fn=Dn;export{Fn as I,In as a,Nn as f,pe as g,Xe as m,ae as t,Se as u};
