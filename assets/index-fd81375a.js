import{m as H,aU as V,a7 as oe,a3 as ue,r as ie,a6 as re,P as Z,X as O,bb as se,U as j,al as ce,bc as de,M as me,N as ve}from"./index-ab015422.js";import{l as L,y as K,c as M,q as w,X as Y,W as fe,f as he,j as be,i as te,P as ge,r as T,ae as ye,a8 as xe,w as _,t as we,V as p,D as Me,bB as ke}from"./vendor-885c608a.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const k={ltr:"left",rtl:"right",btt:"bottom",ttb:"top"},z=Symbol("sliderToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Be={control:{type:[String,Number,Object,Array],default:void 0},value:{type:[Number,Array],default:void 0},disabled:{type:Boolean,default:!1},dots:{type:Boolean,default:!1},keyboard:{type:Boolean,default:!0},marks:{type:Object,default:void 0},max:{type:Number,default:100},min:{type:Number,default:0},range:{type:Boolean,default:!1},reverse:{type:Boolean,default:!1},step:{type:Number,default:1},tooltipFormatter:{type:Function,default:void 0},tooltipPlacement:{type:String,default:void 0},tooltipVisible:{type:Boolean,default:void 0},vertical:{type:Boolean,default:!1},"onUpdate:value":[Function,Array],onChange:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array]},Ce={value:{type:Number,default:void 0},onFocus:[Function,Array],onBlur:[Function,Array]},Se={onClickMark:[Function,Array]},Ae=L({name:"IxSliderMarks",props:Se,setup(e){const{values:u,marks:v,max:m,min:i,prefixCls:r,range:o,reverse:l,vertical:s}=K(z),f=M(()=>`${r.value}-mark`);return()=>w("div",{class:f.value},[Fe(e,u.value,v.value,m.value,i.value,f.value,o.value,l.value,s.value)])}});function Fe(e,u,v,m,i,r,o,l,s){if(Y(v))return;const f=m-i;return Object.keys(v).map(parseFloat).sort((c,d)=>c-d).map(c=>{const d=v[c],g=fe(d);let y;if(he(d)||be(d)?y=d:te(d)?y=d():g&&(y=d.label),Y(y))return null;const B=o?!(c<u[0]||c>u[1]):c<=u[0],C={[`${r}-label`]:!0,[`${r}-label-active`]:B},F=s?{marginBottom:"-50%",[l?k.ttb:k.btt]:`${(c-i)/f*100}%`}:{transform:`translateX(${l?"50%":"-50%"})`,[l?k.rtl:k.ltr]:`${(c-i)/f*100}%`},$=g?ge([F,d==null?void 0:d.style]):F,D=S=>H(e.onClickMark,S,c);return w("span",{key:c,class:C,style:$,onMousedown:D,onTouchstart:D},[y])})}const Te=L({name:"IxSliderSteps",setup(){const{values:e,dots:u,marks:v,max:m,min:i,prefixCls:r,range:o,reverse:l,step:s,vertical:f}=K(z);return()=>w("div",{class:`${r.value}-step`},[$e(e.value,u.value,v.value,m.value,i.value,r.value,o.value,l.value,s.value,f.value)])}});function $e(e,u,v,m,i,r,o,l,s,f){const c=m-i;return De(u,v,m,i,s).map(d=>{const g=`${Math.abs(d-i)/c*100}%`,y=o?!(d<e[0]||d>e[1]):d<=e[0],B=f?{[l?k.ttb:k.btt]:g}:{[l?k.rtl:k.ltr]:g},C={[`${r}-dot`]:!0,[`${r}-dot-active`]:y,[`${r}-dot-reverse`]:l};return w("span",{key:d,class:C,style:B},null)})}function De(e,u,v,m,i){const r=Object.keys(u!=null?u:{}).map(parseFloat).sort((o,l)=>o-l);if(e&&i)for(let o=m;o<=v;o+=i)r.indexOf(o)===-1&&r.push(o);return r}const Ie=L({name:"IxSliderThumb",inheritAttrs:!1,props:Ce,setup(e,{attrs:u,expose:v}){var R;const{disabled:m,dragging:i,prefixCls:r,tooltipVisible:o,tooltipPlacement:l,tooltipFormatter:s}=K(z),f=T((R=o.value)!=null?R:!1),c=T(!1),d=T(null),g=T(null),y=M(()=>`${r.value}-thumb`),B=()=>o.value!==!1&&(f.value=!0),C=()=>o.value!==!0&&(f.value=!1);ye(()=>{var x;return f.value&&((x=d.value)==null?void 0:x.updatePopper())});function F(){c.value=!0,B()}function $(){c.value=!1,i.value||C()}function D(x){B(),i.value||H(e.onFocus,x)}function S(x){C(),i.value||H(e.onBlur,x)}return v({tooltipRef:d,thumbRef:g,isHovering:c,showTooltip:B,hideTooltip:C}),()=>w(oe,{ref:d,visible:f.value,placement:l.value,trigger:"manual",onMouseenter:F,onMouseleave:$},{default:()=>[w("div",xe(u,{ref:g,class:y.value,onMouseenter:F,onMouseleave:$,onFocus:m.value?V:D,onBlur:m.value?V:S}),null)],title:()=>te(s.value)?s.value(e.value):w("span",null,[e.value])})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e){const{elementRef:u,focus:v,blur:m}=ue(),{accessor:i,control:r}=ie();re(r);const o=T([e.min,e.min]),l=T([]),s=T(-1),f=T(null),c=T(!1),d=M(()=>i.disabled),g=M(()=>{const t=[e.min,e.max,e.step].map(a=>{const n=`${a}`.split(".")[1];return n?n.length:0});return Math.max(...t)}),y=M(()=>{const t=`${e.step}`.split(".")[1];return t?t.length:0}),B=M(()=>e.vertical?e.reverse?k.ttb:k.btt:e.reverse?k.rtl:k.ltr);function C(t){return a=>{t===0&&(u.value=a==null?void 0:a.thumbRef),l.value[t]=a}}function F(t){var n,h;const a=l.value.findIndex(b=>(b==null?void 0:b.thumbRef)===t.target);if(a!==-1)t.preventDefault(),s.value=a,(h=(n=l.value[a])==null?void 0:n.thumbRef)==null||h.focus(),S();else{const b=q(t);U(b),P(b)}}function $(t){if(e.keyboard){const a=l.value.findIndex(n=>(n==null?void 0:n.thumbRef)===t.target);if(a!==-1){let n=null;t.code==="ArrowUp"||t.code==="ArrowRight"?(s.value=a,n=J(1)):(t.code==="ArrowDown"||t.code==="ArrowLeft")&&(s.value=a,n=J(-1)),n!==null&&(t.preventDefault(),P(n),W(n))}}}function D(t,a){t.stopPropagation(),U(a),P(a)}function S(){c.value||(c.value=!0,O(window,"mousemove",x),O(window,"touchmove",x),O(window,"mouseup",I),O(window,"touchend",I),O(window,"contextmenu",I))}function R(){if(c.value){const t=l.value[s.value];c.value=!1,s.value=-1,t!=null&&t.isHovering||p(()=>t==null?void 0:t.hideTooltip()),j(window,"mousemove",x),j(window,"touchmove",x),j(window,"mouseup",I),j(window,"touchend",I),j(window,"contextmenu",I)}}function x(t){if(!c.value){R();return}const a=q(t);P(a),W(a)}function I(){R()}function A(){var a,n;const{value:t}=s;t!==-1&&((n=(a=l.value[t])==null?void 0:a.thumbRef)==null||n.focus())}function P(t){const{value:a}=s;if(o.value[a]!==t){const n=o.value.slice();n[a]=t;const h=we(i.value),b=e.range?n:n[0];i.setValue(b),H(e.onChange,b,h),p(()=>E())}}function U(t){const{value:a}=o;s.value=e.range?Math.abs(a[0]-t)<Math.abs(a[1]-t)?0:1:0}function W(t){var a,n;if(e.range){const{value:h}=o;let b=s.value;t>h[1]?b=1:t<h[0]&&(b=0),b!==s.value&&(s.value=b,(n=(a=l.value[s.value])==null?void 0:a.thumbRef)==null||n.focus())}}function q(t){const a=se(t),n=f.value.getBoundingClientRect();let h;return e.vertical?h=(n.bottom-a.clientY)/n.height:h=(a.clientX-n.left)/n.width,e.reverse&&(h=1-h),G(h*(e.max-e.min)+e.min)}function G(t){var X,Q;t=Math.max(e.min,Math.min(e.max,t));const a=(X=e.marks)!=null?X:{},n=Object.keys(a).map(parseFloat);if(e.step!==null){const N=Math.pow(10,g.value),ae=Math.floor((e.max*N-e.min*N)/(e.step*N)),ne=Math.min((t-e.min)/e.step,ae),le=Math.round(ne)*e.step+e.min;n.push(parseFloat(le.toFixed(g.value)))}const h=n.map(N=>Math.abs(t-N)),b=h.indexOf(Math.min(...h));return(Q=n[b])!=null?Q:e.min}function J(t){if(e.step!==null){const a=t<0?-e.step:+e.step,n=o.value[s.value];return Math.max(e.min,Math.min(e.max,parseFloat((n+a).toFixed(y.value))))}return e.min}_(()=>i.value,(t,a)=>{c.value||Array.isArray(t)&&Array.isArray(a)&&t.every((n,h)=>n===a[h])||E()},{immediate:!0}),_(()=>[e.max,e.min,e.range,e.step],()=>{E()});function E(){var n,h;if(e.min>e.max)return;const{value:t=0}=i;let a;if(e.range){if(!Array.isArray(t))return;a=[(n=t[0])!=null?n:e.min,(h=t[1])!=null?h:e.min]}else{if(!Z(t))return;a=[t]}o.value=a.map(b=>Z(b)?G(b):e.min).sort((b,X)=>b-X)}return{valuesRef:o,thumbListRef:l,railRef:f,direction:B,isDisabled:d,isDragging:c,focus:v,blur:m,setThumbRefs:C,handleMouseDown:F,handleMouseUp:A,handleKeyDown:$,handleMarkClick:D}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ee(e){const{colorPrimary:u,lineType:v,colorText:m,colorTextPlaceholder:i,colorContainerBgDisabled:r,colorSeparator:o}=e,l=de();return{railSize:2,markLabelColor:i,markLabelColorActive:m,dotBgColor:o,dotBgColorDisabled:r,dotBgColorActive:u,railBgColor:o,railBgColorHover:o,trackBgColor:u,trackBgColorHover:u,trackBgColorDisabled:r,thumbBgColor:l.white,thumbBorderColor:u,thumbBorderColorHover:u,thumbBorderColorDisabled:r,thumbBorderWidth:2,thumbBorderType:v,thumbBorderColorFocus:u,thumbBoxShadowFocus:`0 0 0 5px ${ce(u,.12)}`,thumbSize:10}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ve=(e,u)=>ee(e),Pe=L({name:"IxSlider",props:Be,setup(e,{expose:u}){const v=me("common"),{globalHashId:m,hashId:i,registerToken:r}=ve("slider");r(Ve);const{direction:o,isDisabled:l,isDragging:s,valuesRef:f,railRef:c,setThumbRefs:d,handleMouseDown:g,handleMouseUp:y,handleKeyDown:B,handleMarkClick:C,focus:F,blur:$}=Re(e),{trackStyle:D}=Ne(e,f,o),S=M(()=>`${v.prefixCls}-slider`),R=M(()=>f.value.slice(0,e.range?2:1)),x=M(()=>e.vertical?e.reverse?"translateY(-50%)":"translateY(50%)":e.reverse?"translateX(50%)":"translateX(-50%)"),I=M(()=>{const A=S.value;return{[m.value]:!!m.value,[i.value]:!!i.value,[A]:!0,[`${A}-disabled`]:l.value,[`${A}-vertical`]:e.vertical,[`${A}-with-marks`]:!Y(e.marks)}});return Me(z,{...ke(e),direction:o,dragging:s,values:f,disabled:l,prefixCls:S}),u({focus:F,blur:$}),()=>w("div",{class:I.value,onMousedown:l.value?V:g,onTouchstart:l.value?V:g,onMouseup:l.value?V:y,onKeydown:l.value?V:B},[w("div",{ref:c,class:`${S.value}-rail`},null),w("div",{class:`${S.value}-track`,style:D.value},null),w(Te,null,null),R.value.map((A,P)=>{const U=(A-e.min)/(e.max-e.min)*100;return w(Ie,{ref:d(P),value:A,role:"slider",tabindex:l.value?-1:0,"aria-label":"Slider","aria-valuemin":e.min,"aria-valuemax":e.max,"aria-valuenow":A,"aria-readonly":l.value,"aria-orientation":e.vertical?"vertical":"horizontal",onFocus:e.onFocus,onBlur:e.onBlur,style:{transform:x.value,[o.value]:`${U}%`}},null)}),w(Ae,{onClickMark:l.value?V:C},null)])}});function Ne(e,u,v){const m=M(()=>Math.max(...u.value)),i=M(()=>Math.min(...u.value));return{trackStyle:M(()=>({[v.value]:e.range?`${(i.value-e.min)/(e.max-e.min)*100}%`:"0%",[e.vertical?"height":"width"]:e.range?`${(m.value-i.value)/(e.max-e.min)*100}%`:`${(+u.value[0]-e.min)/(e.max-e.min)*100}%`}))}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ue=Pe;export{Ue as I};
