import{ac as we,ad as ve,aN as Ve,af as ke,j as _,u as le,aO as N,aP as ce,N as X,s as Ye,a3 as ue,ab as oe,o as ee,h as G,i as ge,v as te,B as he,at as Ge,ao as Be,an as Ke,c as be,w as Qe,a4 as Ze,a5 as Je,aa as et,aQ as tt,av as lt,aq as nt,aC as ot}from"./index.f300137b.js";import{h as Ee,l as j,M as st,T as at,e as g,r as ye,b as P,w as D,a7 as $e,Q as Te,k as Q,B as Z,x as se,bh as rt,P as ct,v as W,z as Y,y as b,i as I,ad as ut,a as V,a1 as J,p as Oe,Z as it,a4 as dt}from"./vendor.6b73f509.js";import{b as Pe}from"./GlobalCodeBox.fae32426.js";import{I as ft}from"./index.bcdd1519.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const We=Symbol("IxTableColumn"),pe=()=>{};pe.displayName="IxTableColumn";pe[We]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,t,l){if(!e||Ee(e)&&e.title===!1)return;if(j(t)||st(t))return t;const o=we(t).find(n=>n.type===at);return o?o.children:l}function vt(e){return e.key?e.key:e.dataKey?ve(e.dataKey).join("-"):e.type?`__IDUX_table_column_key_${e.type}`:Ve("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ht(e,t,l,o){const n=g(()=>{var m;const{columns:w}=e;return w&&w.length>0?ie(e.columns,l.columnBase,l.columnExpandable):ie(Ie((m=t.default)==null?void 0:m.call(t)),l.columnBase,l.columnExpandable)}),{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a}=pt(n,o),c=mt(a),i=g(()=>!!e.ellipsis||r.value.some(w=>w.ellipsis)),u=g(()=>r.value.some(w=>w.fixed)),{columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:p}=gt(r,s),{columnOffsets:v,columnOffsetsWithScrollBar:S}=bt(f,h),x=g(()=>St(n.value,s.value));return{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:p,columnOffsets:v,columnOffsetsWithScrollBar:S,mergedRows:x}}function ie(e,t,l){return e.map(o=>yt(o,t,l))}function Ie(e){const t=[];return we(e,{key:We}).forEach((l,o)=>{const{props:n,children:r}=l,{key:s=o,editable:a,ellipsis:c,...i}=n||{};i.key=s,i.editable=a||a==="",i.ellipsis=c||c==="";const{default:u,cell:f,title:h,expand:p,icon:v}=r||{};u&&(i.children=Ie(u())),f&&(i.customCell=f),h&&(i.customTitle=h),p&&(i.customExpand=p),v&&(i.customIcon=v),t.push(i)}),t}function yt(e,t,l){var r;const{align:o=t.align}=e,n=vt(e);if("type"in e){const{type:s}=e;if(s==="expandable"){const{icon:a=l.icon}=e;return{...e,key:n,align:o,icon:a}}if(s==="selectable"){const a=(r=e.multiple)!=null?r:!0;return{...e,key:n,align:o,multiple:a}}return{...e,key:n,align:o}}else{const{sortable:s,filterable:a,children:c}=e,i={...e,key:n,align:o};return s&&(i.sortable={...t.sortable,...s}),a&&(i.filterable={...t.filterable,...a}),c!=null&&c.length&&(i.children=ie(c,t,l)),i}}function pt(e,t){const l=g(()=>Fe(e.value)),o=g(()=>{const r=t.value;if(r===0)return;const s=l.value,a=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:r}}),n=g(()=>{const r=l.value;if(r.length===0)return r;const s=o.value;return s?[...r,s]:r});return{flattedColumns:l,scrollBarColumn:o,flattedColumnsWithScrollBar:n}}function Fe(e){const t=[];return e.forEach(l=>{const{fixed:o,children:n}=l;if(n!=null&&n.length){let r=Fe(n);o&&(r=r.map(s=>({fixed:o,...s}))),t.push(...r)}else t.push(l)}),t}function mt(e){return g(()=>{let t,l;return e.value.forEach(o=>{const{fixed:n,key:r}=o;n==="start"?t=r:n==="end"&&(l||(l=r))}),{lastStartKey:t,firstEndKey:l}})}function gt(e,t){const l=ye({}),o=P(),n=P([]);D(o,$e(a=>{n.value=a?a.split("-").map(Number):[]},16)),Te(()=>{const a=Object.keys(l),c=e.value;if(a.length!==c.length){o.value=void 0;return}o.value=c.map(i=>l[i.key]).join("-")});const r=g(()=>{const a=n.value;if(a.length===0)return a;const c=t.value;return c?[...a,c.width]:a});return{columnWidths:n,columnWidthsWithScrollBar:r,changeColumnWidth:(a,c)=>{c===!1?delete l[a]:l[a]=c}}}function bt(e,t){const l=g(()=>Se(e.value)),o=g(()=>Se(t.value));return{columnOffsets:l,columnOffsetsWithScrollBar:o}}function Se(e){const t=e.length,l=[],o=[];let n=0,r=0;for(let s=0;s<t;s++){l[s]=n,n+=e[s]||0;const a=t-s-1;o[a]=r,r+=e[a]||0}return{starts:l,ends:o}}function St(e,t){const l=[];function o(s,a,c){var f;(f=l[c])!=null||(l[c]=[]);let i=a;return s.map(h=>{var w;let p=(w=h.titleColSpan)!=null?w:1,v=!1;const S=h.children;if(S!=null&&S.length){v=!0;const m=o(S,i,c+1);Q(h.titleColSpan)&&(p=m.reduce((d,y)=>d+y))}const x=i+p-1;return l[c].push({...h,titleColSpan:p,colStart:i,colEnd:x,hasChildren:v}),i+=p,p})}const n=t?[...e,t]:e;o(n,0,0);const r=l.length;return l.forEach((s,a)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-a)})}),l}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xt(e,t,l,o,n,r,s){const a=g(()=>{const v=t.value,S=l.value;return e.dataSource.map(x=>Ae(x,S,v))}),c=g(()=>{const v=new Map;return de(a.value,v),v}),i=g(()=>Me(a.value,n.value,r.value)),u=g(()=>He(i.value,o.value,r.value)),f=g(()=>{const v=s.value,S=u.value;if(v===null||!v.pageSize)return S;{const{total:x}=v;if(x&&S.length<x)return S;const w=v.pageSize,m=(v.pageIndex-1)*w;return S.slice(m,m+w)}}),h=g(()=>{const v=new Map;return de(f.value,v),v}),p=g(()=>{const v=r.value;return v.length>0?_e(f.value,v,0):f.value});return{filteredData:i,flattedData:p,mergedMap:c,paginatedMap:h}}function Ae(e,t,l,o){const n=t(e),r={record:e,rowKey:n,parentKey:o},s=e[l];return s&&(r.children=s.map(a=>Ae(a,t,l,n))),r}function de(e,t){e.forEach(l=>{const{rowKey:o,children:n}=l;t.set(o,l),n&&de(n,t)})}function He(e,t,l){const o=t.filter(s=>s.sorter),n=o.length;if(n===0)return e;const r=e.slice();return r.forEach(s=>{l.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=He(s.children,t,l))}),r.sort((s,a)=>{for(let c=0;c<n;c++){const{orderBy:i,sorter:u}=o[c],f=u(s.record,a.record);if(f!==0)return i==="ascend"?f:-f}return 0})}function Me(e,t,l){const o=t.filter(n=>n.filter);return o.length===0?e:e.map(n=>{const r=o.every(({filter:u,filterBy:f})=>u(f,n.record)),{rowKey:s,children:a}=n,c=l.includes(s);let i=n;if(c&&a&&a.length){const u=Me(a,t,l);u.length!==a.length&&(i={...n,children:u})}return r||c&&i.children&&i.children.length?i:null}).filter(n=>n!==null)}function _e(e,t,l){return e.reduce((o,n)=>{const{children:r,parentKey:s,record:a,rowKey:c}=n,i=t.includes(c);if(o.push({children:r,parentKey:s,record:a,rowKey:c,level:l,expanded:i}),i&&n.children){const u=_e(n.children,t,l+1);o.push(...u)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e,t){const l=g(()=>t.value.find(a=>"type"in a&&a.type==="expandable")),[o,n]=ke(e,"expandedRowKeys",()=>[]);return{expandable:l,expandedRowKeys:o,setExpandedRowKeys:n,checkExpandDisabled:a=>{if(!l.value)return!0;const{disabled:c,customExpand:i}=l.value,{record:u}=a;return c!=null&&c(u)?!0:!(i||a.children&&a.children.length>0)},handleExpandChange:(a,c)=>{const{onChange:i,onExpand:u}=l.value||{},f=[...o.value],h=f.indexOf(a),p=h>=0;p?f.splice(h,1):f.push(a),_(u,!p,c),n(f),_(i,f)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wt(e){const t=g(()=>e.value.filter(r=>r.filterable)),l=ye({});D(t,(r,s)=>{r.forEach(a=>{const{key:c,filterable:i}=a,u=i.filterBy;if(u||l[c]===void 0){l[c]=u||[];return}const f=s?s.find(p=>p.key===c):void 0;(f==null?void 0:f.filterable.filterBy)&&(l[c]=[])})},{immediate:!0});const o=g(()=>t.value.map(r=>{const{key:s,filterable:a}=r,{filter:c,filterBy:i=l[s]}=a;return{key:s,filter:c,filterBy:i}}).filter(r=>r.filter&&r.filterBy.length>0));return{activeFilters:o,activeFilterByMap:l,handleFilter:(r,s,a)=>{const{onChange:c}=s;l[r]=a,_(c,a,o.value)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function kt(e,t,l){var i,u,f,h,p;const o=le("pagination"),n=g(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),r=P((u=(i=n.value)==null?void 0:i.pageIndex)!=null?u:1),s=P((p=(h=(f=n.value)==null?void 0:f.pageSize)!=null?h:t.pagination.pageSize)!=null?p:o.pageSize),a=(v,S)=>{var x;r.value=v,s.value=S,_((x=n.value)==null?void 0:x.onChange,v,S)};return{mergedPagination:g(()=>{var S,x;const v=n.value;return v===null?null:{...t.pagination,...v,pageIndex:(S=v.pageIndex)!=null?S:r.value,pageSize:(x=v.pageSize)!=null?x:s.value,size:l.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,t,{setStickyScrollLeft:l}){const o=P(),n=P(),r=P(),s=P(),a=P();D(o,w=>{w&&(r.value=w.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=Kt(n,r,a,l),f=Et(e,t,r,s),h=g(()=>{var w;return N((w=e.scroll)==null?void 0:w.width)}),p=g(()=>{var m;let w=N((m=e.scroll)==null?void 0:m.height);return!w&&t.value&&(e.virtual||f.value)&&(w="auto"),w}),v=g(()=>ce(X(r))),S=g(()=>p.value?v.value:0);return{virtualScrollRef:o,scrollHeadRef:n,scrollBodyRef:r,scrollContentRef:s,scrollFootRef:a,handleScroll:c,scrollTo:w=>{var m;e.virtual?(m=o.value)==null||m.scrollTo(w):typeof w=="number"&&Ye({target:X(r),top:w,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:p,scrollBarSize:v,scrollBarSizeOnFixedHolder:S}}function Kt(e,t,l,o){const n=P(!1),r=P(!1);let s;const a=()=>{s&&(clearTimeout(s),s=void 0)};Z(()=>a());const c=P(),i=p=>{c.value=p,a(),s=setTimeout(()=>{c.value=void 0,s=void 0},100)},u=(p,v)=>{!v||v.scrollLeft!==p&&(v.scrollLeft=p)},f=p=>{const v=X(t);if(!v)return;const{clientWidth:S,scrollWidth:x}=v;o(p/x*S||0)};return{handleScroll:(p,v)=>{const S=p==null?void 0:p.currentTarget,x=v!=null?v:S.scrollLeft,w=c.value;if((!w||w===S)&&(i(S),u(x,e.value),u(x,X(t)),u(x,l.value),f(x)),S){const{scrollWidth:m,clientWidth:d}=S;n.value=x>0,r.value=x<m-d}},pingedStart:n,pingedEnd:r}}function Et(e,t,l,o){const n=P(!0),r=()=>{const c=X(l.value);c?n.value=c.scrollHeight>c.clientHeight:n.value=!1};let s=[];const a=()=>s.forEach(c=>c());return se(()=>{D([t,()=>e.virtual],([c,i])=>{a(),c&&!i&&(s=[ue(l,r),ue(o,r)])},{immediate:!0})}),Z(()=>a()),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,t,l,o,n,r){const s=g(()=>{var u;return(u=e.scrollToTopOnChange)!=null?u:t.scrollToTopOnChange});let a=[];const c=()=>{a=[D([()=>{var u;return(u=l.value)==null?void 0:u.pageIndex},()=>{var u;return(u=l.value)==null?void 0:u.pageSize}],()=>r(0)),D([n,o],([u,f],[h,p])=>{(!Tt(u,h)||!Ot(f,p))&&r(0)})]},i=()=>{a.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function Tt(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(n=>n.key===l.key);return o?l.filter===o.filter&&l.filterBy.length===o.filterBy.length&&l.filterBy.every(n=>o.filterBy.includes(n)):!1})}function Ot(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(n=>n.key===l.key);return o?l.sorter===o.sorter&&l.orderBy===o.orderBy&&l.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pt(e,t,l,{mergedMap:o,paginatedMap:n}){const r=g(()=>l.value.find(m=>"type"in m&&m.type==="selectable")),[s,a]=ke(e,"selectedRowKeys",()=>[]),c=g(()=>{const{disabled:m}=r.value||{},d=[],y=[];return n.value.forEach((C,B)=>{m!=null&&m(C.record)?y.push(B):d.push(B)}),{enabledRowKeys:d,disabledRowKeys:y}}),i=g(()=>{const m=new Set,d=s.value,{disabledRowKeys:y}=c.value,C=o.value;return d.forEach(B=>{const{parentKey:$}=C.get(B)||{};if(!Q($)){let k=C.get($);if(k&&!d.includes(k.rowKey))for(;k&&!Q(k==null?void 0:k.rowKey);)y.includes(k.rowKey)||m.add(k.rowKey),k=Q(k.parentKey)?void 0:C.get(k.parentKey)}}),[...m]}),u=g(()=>{const m=s.value,{disabledRowKeys:d}=c.value;let y=0;return n.value.forEach((C,B)=>{!d.includes(B)&&m.includes(B)&&y++},0),y}),f=g(()=>{const m=n.value.size,d=c.value.disabledRowKeys.length;return m===0||m===d?!1:m===d+u.value}),h=g(()=>!f.value&&u.value>0),p=m=>{a(m);const d=o.value,{onChange:y}=r.value||{};if(y){const C=[];m.forEach(B=>{const $=d.get(B);$&&C.push($.record)}),_(y,m,C)}},v=(m,d)=>{const y=o.value,{disabledRowKeys:C}=c.value,{multiple:B,onSelect:$}=r.value||{};let k=[...s.value];const E=k.indexOf(m),F=E>=0;if(B){const A=y.get(m),H=ze(A,C);if(F){k.splice(E,1);const T=Wt(y,A,C);k=k.filter(K=>!T.includes(K)&&!H.includes(K))}else k.push(m),k.push(...H);Rt(y,A,k,C)}else k=F?[]:[m];_($,!F,d),p(k)},S=()=>{const{enabledRowKeys:m}=c.value,d=new Set(s.value);f.value?m.forEach(y=>d.delete(y)):m.forEach(y=>d.add(y)),p([...d])},x=It(r,t),w=Ft(r,o,n,s,p);return{selectable:r,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:f,currentPageSomeSelected:h,handleSelectChange:v,handleHeadSelectChange:S,mergedSelectableMenus:x,handleSelectableMenuClick:w}}function ze(e,t){const l=[],{children:o}=e||{};return o&&o.forEach(n=>{const{rowKey:r}=n;t.includes(r)||l.push(n.rowKey),l.push(...ze(n,t))}),l}function Wt(e,t,l){const o=[];for(;t!=null&&t.parentKey;){const{parentKey:n}=t;l.includes(t.parentKey)||o.push(n),t=e.get(n)}return o}function Rt(e,t,l,o){let n=!0;for(;n&&t&&!Q(t.parentKey);){const r=e.get(t.parentKey);if(r&&!o.includes(t.parentKey)){n=r.children.every(a=>o.includes(a.rowKey)||l.includes(a.rowKey));const s=l.findIndex(a=>a===t.parentKey);n?s<0&&l.push(t.parentKey):s>-1&&l.splice(s,1)}t=r}}const Ne=Symbol("IDUX_TABLE_KEY_selectable-all"),De=Symbol("IDUX_TABLE_KEY_selectable-invert"),Le=Symbol("IDUX_TABLE_KEY_selectable-none"),je=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function It(e,t){return g(()=>{const{menus:l}=e.value||{};if(!l||l.length===0)return[];const{selectAll:o,selectInvert:n,selectNone:r,selectPageInvert:s}=t.table;return l.map(a=>j(a)?a==="all"?{type:"item",key:Ne,label:o}:a==="invert"?{type:"item",key:De,label:n}:a==="none"?{type:"item",key:Le,label:r}:a==="pageInvert"?{type:"item",key:je,label:s}:{type:"item",key:a,label:a}:a)})}function Ft(e,t,l,o,n){const r=()=>{const{disabled:u,onSelectAll:f}=e.value||{},h=[];t.value.forEach((p,v)=>{u!=null&&u(p.record)||h.push(v)}),_(f,h),n(h)},s=()=>{const{disabled:u,onSelectInvert:f}=e.value||{},h=[...o.value];t.value.forEach((p,v)=>{if(u!=null&&u(p.record))return;const S=h.indexOf(v);S>=0?h.splice(S,1):h.push(v)}),n(h),_(f,h)},a=()=>{const{onSelectNone:u}=e.value||{};_(u),n([])},c=()=>{const{disabled:u,onSelectPageInvert:f}=e.value||{},h=[],p=o.value;l.value.forEach((v,S)=>{(u==null?void 0:u(v.record))||p.includes(S)||h.push(S)}),_(f,h),n(h)},i=new Map([[Ne,r],[De,s],[Le,a],[je,c]]);return u=>{const f=u.key;if(rt(f)&&i.has(f)){i.get(f)();return}const{disabled:h,onMenuClick:p}=e.value||{};if(!p)return;const v=[];l.value.forEach((S,x)=>{h!=null&&h(S.record)||v.push(x)}),_(p,u,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function At(e){const t=g(()=>e.value.filter(s=>s.sortable)),l=ye({}),o=g(()=>t.value.some(s=>s.sortable.multiple!==void 0));D(t,(s,a)=>{s.forEach(c=>{const{key:i,sortable:u}=c,f=u.orderBy;if(f||l[i]===void 0){l[i]=f;return}const h=a?a.find(v=>v.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(l[i]=void 0)})},{immediate:!0});const n=g(()=>t.value.map(s=>{const{key:a,sortable:c}=s,{multiple:i=0,orderBy:u=l[a],sorter:f}=c;return{key:a,multiple:i,orderBy:u,sorter:f}}).filter(s=>s.orderBy).sort((s,a)=>a.multiple-s.multiple));return{activeSorters:n,activeOrderByMap:l,handleSort:(s,a)=>{const{orders:c,onChange:i}=a,u=l[s],f=u?xe(c,u):xe(c);o.value?l[s]=f:Object.keys(l).forEach(h=>{s===h?l[h]=f:l[h]=void 0}),_(i,f,n.value)}}}function xe(e,t){return t?e[e.indexOf(t)+1]:e[0]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e){const t=g(()=>!!e.sticky),l=g(()=>{const{sticky:r}=e,{offsetTop:s=0,offsetBottom:a=0,offsetScroll:c=0,container:i=window}=ct(r)?r:{};return{offsetTop:s,offsetBottom:a,offsetScroll:c,container:i}}),[o,n]=oe(0);return{isSticky:t,mergedSticky:l,stickyScrollLeft:o,setStickyScrollLeft:n}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Mt(e,{hasEllipsis:t,hasFixed:l},{scrollWidth:o,scrollHeight:n},r,s){return g(()=>e.tableLayout?e.tableLayout:o.value&&l.value?o.value==="max-content"?"auto":"fixed":n.value||s.value||r.value||t.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const M=Symbol("TABLE_TOKEN"),me=Symbol("tableBodyToken"),ne=W({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:t,flattedColumnsWithScrollBar:l,columnWidthsWithScrollBar:o,mergedSelectableMenus:n,mergedPrefixCls:r}=I(M);return()=>{const{isFixedHolder:s}=e,a=s?l.value:t.value;if(a.every(u=>!u.width&&!u.type))return;const c=r.value,i=a.map((u,f)=>{const{key:h,type:p}=u,v=s?o.value[f]:u.width,S=p?Y({[`${c}-col-${p}`]:!0,[`${c}-col-with-dropdown`]:p==="selectable"&&n.value.length>0}):void 0;let x;return s?x=v?`width: ${N(v)}`:void 0:x={width:N(v),minWidth:N(u.minWidth),maxWidth:N(u.maxWidth)},b("col",{key:h,class:S,style:x},null)});return b("colgroup",null,[i])}}}),_t=W({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:t}){const{mergedPrefixCls:l,scrollHeadRef:o,handleScroll:n,scrollWidth:r,flattedData:s,isSticky:a,columnWidths:c}=I(M);zt(o,n);const i=g(()=>r.value==="max-content"),u=g(()=>s.value.length>0),f=g(()=>{const v=l.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:a.value}}),h=g(()=>{const v=a.value,{offsetTop:S,offsetBottom:x}=e;return{overflow:"hidden",top:v?N(S):void 0,bottom:v?N(x):void 0}}),p=g(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:f.value,style:h.value,ref:o},[b("table",{style:p.value},[(u.value||!i.value)&&b(ne,{isFixedHolder:!0},null),t.default&&t.default()])])}});function zt(e,t){const l=o=>{const n=o.deltaX,r=o.currentTarget;if(n){const s=r.scrollLeft+n;t(o,s),o.preventDefault()}};se(()=>ee(e.value,"wheel",l,{passive:!0})),Z(()=>G(e.value,"wheel",l))}const Nt=W({setup(){const{mergedPrefixCls:e,scrollBodyRef:t,handleScroll:l,mergedSticky:o,stickyScrollLeft:n,setStickyScrollLeft:r}=I(M),s=P(!1),a=P(!1),c=P(0),i=P(0),u=P(0),f=g(()=>{const d=i.value,y=u.value;return y&&d*(d/y)});Te(()=>{const d=X(t);if(!!d&&s.value){const{clientWidth:y,scrollWidth:C,scrollLeft:B}=d;r(B/C*y),i.value=y,u.value=C}});const h=g(()=>({height:ce(),width:i.value,bottom:o.value.offsetScroll})),p=g(()=>{const d=e.value;return{[`${d}-sticky-scrollbar-thumb`]:!0,[`${d}-sticky-scrollbar-thumb-active`]:a.value}}),v=g(()=>({width:`${f.value}px`,transform:`translate3d(${n.value}px, 0, 0)`})),S=()=>a.value=!1,x=d=>{c.value=d.pageX-n.value,a.value=!0,d.preventDefault()},w=d=>{if(!a.value)return;const{buttons:y}=d||window.event;if(y===0){a.value=!1;return}let C=d.pageX-c.value;C<=0&&(C=0);const B=i.value,$=u.value,k=f.value;C+k>=B&&(C=B-k);const E=C/B*($+2);l(d,E)},m=()=>{const d=X(t),y=ge(d).top,C=y+d.offsetHeight,{container:B,offsetScroll:$}=o.value,k=B===window?document.documentElement.scrollTop+window.innerHeight:ge(B).top+B.clientHeight;C-ce()<=k||y>=k-$?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",S),ee(document.body,"mousemove",w),ee(window,"resize",m),D(()=>o.value.container,(d,y)=>{G(y,"scroll",m),ee(d,"scroll",m)},{immediate:!0}),m()}),Z(()=>{G(document.body,"mouseup",S),G(document.body,"mousemove",w),G(window,"resize",m),G(o.value.container,"scroll",m)}),()=>!t.value||!s.value||u.value<=i.value||!f.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[b("div",{class:p.value,style:v.value,onMousedown:x},null)])}}),fe=W({props:{isEmpty:Boolean},setup(e,{slots:t}){const{mergedPrefixCls:l,flattedColumns:o,hasFixed:n,scrollWidth:r,scrollBarColumn:s}=I(M),{mainTableWidth:a}=I(me),c=g(()=>o.value.length);return()=>{let i=t.default();if(e.isEmpty?r.value:n.value){const u=s.value;i=b("div",{class:`${l.value}-fixed-row`,style:{width:N(a.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Dt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Lt={columns:{type:Array,required:!0}},jt={column:{type:Object,required:!0}},Ut={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},qt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Xt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Vt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Yt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},Gt=W({props:Xt,setup(e){const t=P();return ue(t,o=>{const{offsetWidth:n}=o.target;e.changeColumnWidth(e.cellKey,n)}),Z(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:t,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[ut("\xA0")])])}}),Qt=W({setup(){const{mergedPrefixCls:e,flattedColumns:t}=I(M),{changeColumnWidth:l}=I(me);return()=>{const o=t.value.map(n=>{const{key:r}=n;return b(Gt,{key:r,cellKey:r,changeColumnWidth:l},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}}),Zt=W({props:qt,setup(e){const{props:t,slots:l,mergedPrefixCls:o,mergedEmptyCell:n,activeOrderByMap:r,fixedColumnKeys:s,columnOffsets:a,isSticky:c,expandable:i,selectable:u}=I(M),f=g(()=>r[e.column.key]),h=Jt(e),p=g(()=>s.value.lastStartKey===e.column.key),v=g(()=>s.value.firstEndKey===e.column.key),S=g(()=>{const{type:d,ellipsis:y}=e.column;return d||y!=null?y:t.ellipsis}),x=g(()=>{const{fixed:d,align:y}=e.column,C=o.value;let B={[`${C}-cell`]:!0,[`${C}-cell-sorted`]:!!f.value,[`${C}-cell-align-${y}`]:!!y&&y!="start",[`${C}-cell-ellipsis`]:!!S.value};return d&&(B={...B,[`${C}-fix-start`]:d==="start",[`${C}-fix-start-last`]:p.value,[`${C}-fix-end`]:d==="end",[`${C}-fix-end-first`]:v.value,[`${C}-fix-sticky`]:c.value}),Y(B)}),w=g(()=>{const{fixed:d}=e.column;if(!d)return;const{starts:y,ends:C}=a.value,$=N((d==="start"?y:C)[e.colIndex]);return{position:"sticky",left:d==="start"?$:void 0,right:d==="end"?$:void 0}}),m=d=>{d.stopPropagation()};return()=>{var F,A,H;const{column:d}=e,{type:y}=d;let C,B;if(y==="selectable")C=ll(e,l,u,m);else{const T=h.value;if(C=el(e,l,T),B=Re(S.value,C,T),!y&&(Q(C)||C==="")){const K=l.emptyCell||n.value;C=V(K)?K({column:d,record:e.record,rowIndex:e.rowIndex}):K}}e.column.fixed&&S.value&&(p.value||v.value)&&(C=b("span",{class:`${o.value}-cell-content`},[C]));const $=(F=t.customAdditional)==null?void 0:F.bodyCell,k=$?$({column:d,record:e.record,rowIndex:e.rowIndex}):void 0,E=(H=(A=t.customTag)==null?void 0:A.bodyCell)!=null?H:"td";return b(E,J({class:x.value,style:w.value,title:B},k),{default:()=>[y==="expandable"&&tl(e,l,i,o.value),C]})}}});function Jt(e){return g(()=>{const{column:t,record:l}=e,o=ve(t.dataKey);if(o.length<=0)return;let n=l;for(let r=0;r<o.length&&n;r++){const s=o[r];n=n[s]}return n})}function el(e,t,l){const{record:o,rowIndex:n,column:r}=e,{customCell:s}=r,a=j(s)?t[s]:s;return a?a({value:l,record:o,rowIndex:n}):l}function tl(e,t,l,o){const{icon:n,customIcon:r,indent:s}=l.value,{record:a,expanded:c,level:i=0,disabled:u}=e,f={marginLeft:s?N(i*s):void 0};let h;return u?h=null:V(r)?h=r({expanded:!!c,record:a}):j(r)&&t[r]?h=t[r]({expanded:c,record:a}):(h=V(n)?n({expanded:c,record:a}):n,j(h)&&(h=b(te,{name:h,rotate:c?90:0},null))),b("button",{class:`${o}-expandable-trigger`,style:f,type:"button",onClick:e.handleExpend},[h])}function ll(e,t,l,o){const{selected:n,indeterminate:r,disabled:s,handleSelect:a}=e,{multiple:c,customCell:i}=l.value,u=j(i)?t[i]:i;if(c){const f={checked:n,disabled:s,indeterminate:r,onChange:a,onClick:o};return u?u(f):b(he,f,null)}else{const f={checked:n,disabled:s,onChange:a,onClick:o};return u?u(f):b(Pe,f,null)}}const nl=W({props:Ut,setup(e){const{props:t,mergedPrefixCls:l,flattedColumns:o,expandable:n,handleExpandChange:r,checkExpandDisabled:s,selectable:a,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:f}=I(M),{expandDisabled:h,handleExpend:p,selectDisabled:v,handleSelect:S,clickEvents:x}=ol(e,n,s,r,a,u,f),w=g(()=>c.value.includes(e.rowKey)),m=g(()=>i.value.includes(e.rowKey)),d=g(()=>{const y=`${l.value}-row`,{level:C,expanded:B}=e;return Y({[`${y}`]:!0,[`${y}-level-${C}`]:!!C,[`${y}-selected`]:w.value,[`${y}-expanded`]:B})});return()=>{var $,k,E;const y=($=t.customAdditional)==null?void 0:$.bodyRow,C=y?y({record:e.record,rowIndex:e.rowIndex}):void 0,B=(E=(k=t.customTag)==null?void 0:k.bodyRow)!=null?E:"tr";return b(B,J({class:d.value},x.value,C),{default:()=>[sl(e,o,h.value,p,w,m,v,S)]})}}});function ol(e,t,l,o,n,r,s){const a=g(()=>l(e.rowData)),c=g(()=>{var x;return(x=t.value)==null?void 0:x.trigger}),i=()=>{const{rowKey:x,record:w}=e;o(x,w)},u=g(()=>s.value.disabledRowKeys.includes(e.rowKey)),f=g(()=>{var x;return(x=n.value)==null?void 0:x.trigger}),h=()=>{const{rowKey:x,record:w}=e;r(x,w)},p=()=>{c.value==="click"&&!a.value&&i(),f.value==="click"&&!u.value&&h()},v=()=>{c.value==="dblclick"&&!a.value&&i(),f.value==="dblclick"&&!u.value&&h()},S=g(()=>{const x=c.value==="click"||f.value==="click"?p:void 0,w=c.value==="dblclick"||f.value==="dblclick"?v:void 0;return{onClick:x,onDblclick:w}});return{expandDisabled:a,handleExpend:i,selectDisabled:u,handleSelect:h,clickEvents:S}}function sl(e,t,l,o,n,r,s,a){const c=[],{rowIndex:i,record:u,level:f}=e;return t.value.forEach((h,p)=>{const{type:v,colSpan:S,rowSpan:x,key:w}=h,m=S==null?void 0:S(u,i),d=x==null?void 0:x(u,i);if(m===0||d===0)return;const y={colSpan:m===1?void 0:m,rowSpan:d===1?void 0:d,rowIndex:i,colIndex:p,record:u,column:h,level:f,key:w};v==="expandable"?(y.expanded=e.expanded,y.disabled=l,y.handleExpend=o):v==="selectable"&&(y.selected=n.value,y.indeterminate=r.value,y.disabled=s.value,y.handleSelect=a),c.push(b(Zt,y,null))}),c}function Ue(e,t,l,o,n){const{expanded:r,level:s,record:a,rowKey:c}=e,i={key:c,expanded:r,level:s,record:a,rowData:e,rowIndex:t,rowKey:c},u=b(nl,i,null),f=r&&al(i,l,o,n);return f?[u,f]:u}function al(e,t,l,o){const{customExpand:n}=l||{},{record:r,rowIndex:s}=e;let a;return V(n)?a=n({record:r,rowIndex:s}):j(n)&&t[n]&&(a=t[n]({record:r,rowIndex:s})),a&&b(fe,{class:`${o}-expanded-row`},{default:()=>[a]})}const re=W({setup(e,{slots:t}){const{props:l,slots:o,mergedPrefixCls:n,flattedData:r,expandable:s,scrollWidth:a,scrollHeight:c,isSticky:i}=I(M),u=g(()=>a.value||c.value||i.value);return()=>{const f=n.value,h=[];o.alert&&h.push(b(fe,{class:`${f}-alert-row`},{default:()=>[o.alert()]}));const p=r.value;return p.length>0?t.default?h.push(...t.default()):p.forEach((v,S)=>{h.push(...ve(Ue(v,S,o,s.value,f)))}):h.push(b(fe,{class:`${f}-empty-row`,isEmpty:!0},{default:()=>[b(Ge,{empty:l.empty},o)]})),b("tbody",{class:`${n.value}-tbody`},[u.value&&b(Qt,null,null),h])}}}),rl=W({props:Vt,setup(e){const{slots:t,config:l,locale:o,mergedPrefixCls:n}=I(M),r=g(()=>{var d;return(d=e.filterable.multiple)!=null?d:l.columnBase.filterable.multiple}),s=g(()=>{var d;return(d=e.filterable.footer)!=null?d:l.columnBase.filterable.footer}),a=e.activeFilterBy,[c,i]=oe(()=>a);D(()=>e.activeFilterBy,d=>i(d));const[u,f]=oe(!1),h=d=>{f(d),d||e.onUpdateFilterBy(c.value)},p=()=>{f(!1),e.onUpdateFilterBy(c.value)},v=()=>{i(a)},S=d=>{const y=`${n.value}-filterable-menu-label`,C=r.value?he:Pe;return b("span",{class:y},[b(C,{checked:d.selected,disabled:d.disabled},null),b("span",{class:`${y}-content`},[d.label])])},x=()=>{const d=[],{customMenu:y,menus:C}=e.filterable;return V(y)?d.push(y()):j(y)&&t[y]?d.push(t[y]()):d.push(cl(C,r,c,i,S)),s.value&&d.push(ul(o,n,p,v)),d},w=g(()=>{const d=`${n.value}-filterable-trigger`;return Y({[d]:!0,[`${d}-active`]:e.activeFilterBy.length>0})}),m=()=>{const{customTrigger:d}=e.filterable;return V(d)?d():j(d)&&t[d]?t[d]():b("span",{class:w.value,onClick:y=>y.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const d={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return b(Be,d,{default:m,overlay:x})}}}),cl=(e,t,l,o,n)=>{const r={dataSource:e,multiple:t.value,selectable:!0,selectedKeys:l.value,"onUpdate:selectedKeys":o};return b(Ke,r,{itemLabel:n})},ul=(e,t,l,o)=>{const{filterConfirm:n,filterReset:r}=e.table;return b("div",{class:`${t.value}-filterable-trigger-footer`},[b(be,{mode:"primary",size:"xs",onClick:l},{default:()=>[n]}),b(be,{size:"xs",onClick:o},{default:()=>[r]})])},il=W({setup(){const{mergedPrefixCls:e,paginatedMap:t,selectable:l,currentPageRowKeys:o,currentPageAllSelected:n,currentPageSomeSelected:r,handleHeadSelectChange:s,mergedSelectableMenus:a,handleSelectableMenuClick:c}=I(M),i=g(()=>{const x=t.value.size;return x===0||x===o.value.disabledRowKeys.length}),[u,f]=oe(!1),h={"onUpdate:visible":f,trigger:"click"},p=()=>b(Ke,{dataSource:a.value,onClick:c},null),v=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),S=()=>{if(a.value.length!==0)return b(Be,h,{default:v,overlay:p})};return()=>{const{multiple:x}=l.value;if(!!x)return b("span",{class:`${e.value}-cell-triggers`},[b(he,{checked:n.value,indeterminate:r.value,disabled:i.value,onChange:s},null),S()])}}}),dl=W({props:Yt,setup(e){const{locale:t,mergedPrefixCls:l}=I(M);return()=>{const{activeOrderBy:o,sortable:n}=e,{orders:r,nextTooltip:s}=n,a=s&&fl(t.table,r,o),c=vl(l,r,o);return a?b(Qe,{title:a},{default:()=>[c]}):c}}});function fl(e,t,l){const o=l?t[t.indexOf(l)+1]:t[0],{sortCancel:n,sortAsc:r,sortDesc:s}=e;return o?o==="ascend"?r:s:n}function vl(e,t,l){const o=e.value,n=`${o}-sortable-trigger-active`,r=t.includes("ascend")&&b(te,{name:"caret-up-filled",class:l==="ascend"?n:void 0},null),s=t.includes("descend")&&b(te,{name:"caret-down-filled",class:l==="descend"?n:void 0},null);return b("span",{class:`${o}-sortable-trigger`},[r,s])}const hl=W({props:jt,setup(e){const{props:t,slots:l,mergedPrefixCls:o,fixedColumnKeys:n,columnOffsetsWithScrollBar:r,isSticky:s,handleSort:a,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=I(M),f=g(()=>{const{type:m,ellipsis:d}=e.column,y=m||d!=null?d:t.ellipsis;return Ee(y)&&y.head===!1?void 0:y}),h=g(()=>{const{type:m,align:d,fixed:y,hasChildren:C,key:B,sortable:$,filterable:k}=e.column,E=o.value;let F={[`${E}-cell`]:!0,[`${E}-cell-${m}`]:!!m,[`${E}-cell-filterable`]:!!k,[`${E}-cell-sortable`]:!!$,[`${E}-cell-align-center`]:C||d==="center",[`${E}-cell-align-end`]:!C&&d==="end",[`${E}-cell-ellipsis`]:!!f.value};if(y){const{lastStartKey:A,firstEndKey:H}=n.value;F={...F,[`${E}-fix-start`]:y==="start",[`${E}-fix-start-last`]:A===B,[`${E}-fix-end`]:y==="end",[`${E}-fix-end-first`]:H===B,[`${E}-fix-sticky`]:s.value}}return Y(F)}),p=g(()=>{const{fixed:m,colStart:d,colEnd:y}=e.column;if(!m)return;const{starts:C,ends:B}=r.value,E=N((m==="start"?C:B)[m==="start"?d:y]);return{position:"sticky",left:m==="start"?E:void 0,right:m==="end"?E:void 0}}),v=g(()=>c[e.column.key]),S=g(()=>i[e.column.key]),x=m=>{const{key:d,filterable:y}=e.column;u(d,y,m)},w=()=>{const{key:m,sortable:d}=e.column;d&&a(m,d)};return()=>{var H,T,K;const{column:m}=e,{type:d,titleColSpan:y,titleRowSpan:C}=m;if(d==="scroll-bar")return b("th",{class:h.value,style:p.value,colspan:y===1?void 0:y,rowspan:C===1?void 0:C,onClick:w},null);const B=o.value;let $,k;if(d==="selectable")k=b(il,null,null);else{const{title:O,customTitle:R,sortable:U,filterable:q}=m,L=f.value;k=yl(O,R,l),$=Re(L,k,O);const z=pl(U,v,q,S,x);z.length>0?k=b("span",{class:`${B}-cell-triggers`},[b("span",{class:`${B}-cell-title`},[k]),z]):L&&(k=b("span",{class:`${B}-cell-title`},[k]))}const E=(H=t.customAdditional)==null?void 0:H.headCell,F=E?E({column:m}):void 0,A=(K=(T=t.customTag)==null?void 0:T.headCell)!=null?K:"th";return b(A,J({class:h.value,style:p.value,colSpan:y===1?void 0:y,rowSpan:C===1?void 0:C,title:$},F,{onClick:w}),{default:()=>[k]})}}});function yl(e,t,l){let o=e;return V(t)?o=t({title:e}):j(t)&&l[t]&&(o=l[t]({title:e})),o}function pl(e,t,l,o,n){const r=[];return e&&r.push(b(dl,{activeOrderBy:t.value,sortable:e},null)),l&&r.push(b(rl,{activeFilterBy:o.value,filterable:l,onUpdateFilterBy:n},null)),r}const ml=W({props:Lt,setup(e){const{props:t,mergedPrefixCls:l}=I(M);return()=>{var a,c,i;const{columns:o}=e,n=(a=t.customAdditional)==null?void 0:a.headRow,r=n?n({columns:o}):void 0,s=(i=(c=t.customTag)==null?void 0:c.headRow)!=null?i:"tr";return b(s,J({class:`${l.value}-row`},r),{default:()=>[o.filter(u=>u.titleColSpan!==0).map(u=>b(hl,{key:u.key,column:u},null))]})}}}),Ce=W({setup(){const{props:e,mergedRows:t,mergedPrefixCls:l}=I(M);return()=>{var a,c,i;const o=t.value,n=(a=e.customAdditional)==null?void 0:a.head,r=n?n({rows:o}):void 0,s=(i=(c=e.customTag)==null?void 0:c.head)!=null?i:"thead";return b(s,J({class:`${l.value}-thead`},r),{default:()=>[o.map((u,f)=>b(ml,{key:f,columns:u},null))]})}}});W({setup(){return()=>b("tfoot",null,null)}});const gl=W({setup(){const{props:e,slots:t,expandable:l,mergedPrefixCls:o,mergedVirtualItemHeight:n,mergedAutoHeight:r,columnWidths:s,changeColumnWidth:a,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:f,scrollBodyRef:h,scrollContentRef:p,handleScroll:v,pingedStart:S,pingedEnd:x,scrollWidth:w,scrollHeight:m,hasFixed:d,tableLayout:y}=I(M),C=P(),B=P(0);Oe(me,{mainTableWidth:B,changeColumnWidth:(K,O)=>{tt(C.value)&&a(K,O)}});const k=()=>{const K=X(h);K&&v({currentTarget:K})},E=K=>{const{offsetWidth:O}=K.target;O!==B.value&&(B.value=O)};se(()=>{k(),D([()=>e.dataSource,w],([,O])=>{O&&k()}),D(s,$e(()=>{var R;((R=X(h))==null?void 0:R.scrollLeft)===0&&k()},16)),Ze(C.value,E)}),Z(()=>Je(C.value,E));const F=g(()=>{const K=o.value;return Y({[`${K}-container`]:!0,[`${K}-ping-start`]:S.value,[`${K}-ping-end`]:x.value,[`${K}-fixed-layout`]:y.value==="fixed",[`${K}-fixed-column`]:d.value,[`${K}-scroll-horizontal`]:w.value,[`${K}-scroll-vertical`]:m.value})}),A=g(()=>{var L;const K=w.value,O=m.value,R=K?"auto":void 0,U=e.virtual?"hidden":O?"scroll":K?"hidden":void 0,q=(L=e.scroll)==null?void 0:L.fullHeight;return{overflowX:R,overflowY:U,[q?"height":"maxHeight"]:O}}),H=g(()=>({tableLayout:y.value,width:w.value,minWidth:w.value?"100%":void 0})),T=(K,O,R)=>{_(e.onScrolledChange,K,O,R.map(U=>U.record))};return()=>{const K=o.value,O=r.value,R=t.default?t.default():[];if(O||m.value||i.value){const{offsetTop:U}=u.value;if(e.headless||R.push(b(_t,{offsetTop:U},{default:()=>[b(Ce,null,null)]})),e.virtual&&(e.scroll||O)){const q=({item:ae,index:Xe})=>Ue(ae,Xe,t,l.value,K),L=ae=>b("table",{ref:p,class:`${K}-table`,style:H.value},[b(ne,null,null),b(re,null,{default:()=>[ae]}),!1]),{scroll:z,onScrolledBottom:qe}=e;R.push(b(et,{ref:f,style:A.value,dataSource:c.value,fullHeight:z==null?void 0:z.fullHeight,getKey:"rowKey",height:r.value?"100%":z==null?void 0:z.height,itemHeight:n.value,itemRender:q,contentRender:L,virtual:!0,onScroll:v,onScrolledBottom:qe,onScrolledChange:T},null))}else R.push(b("div",{ref:h,class:`${K}-content`,style:A.value,onScroll:v},[b("table",{ref:p,class:`${K}-table`,style:H.value},[b(ne,null,null),b(re,null,null),!1])]));i.value&&R.push(b(Nt,null,null))}else R.push(b("div",{ref:h,class:`${K}-content`,style:A.value,onScroll:v},[b("table",{ref:p,class:`${K}-table`,style:H.value},[b(ne,null,null),!e.headless&&b(Ce,null,null),b(re,null,null),!1])]));return b("div",{ref:C,class:F.value},[R])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bl(e,t){return e.footer?b("div",{class:`${t}-footer`},[e.footer()]):null}function Sl(e,t,l){let o=null,n=null;if(e!==null){const{position:r}=e,[s,a]=it(r).split("-"),c=`${l}-pagination ${l}-pagination-${a}`,i=b(ft,J({class:c,total:t.length},e),null);o=s==="top"?i:null,n=s==="bottom"?i:null}return[o,n]}const xl={sm:32,md:40,lg:56},Cl={sm:40,md:48,lg:56},wl=W({name:"IxTable",props:Dt,setup(e,{expose:t,slots:l}){const o=le("common"),n=g(()=>`${o.prefixCls}-table`),r=le("locale"),s=le("table"),a=g(()=>{var T;return(T=e.autoHeight)!=null?T:s.autoHeight}),c=g(()=>{var T;return(T=e.childrenKey)!=null?T:s.childrenKey}),i=lt(e,s),u=g(()=>{var T;return(T=e.emptyCell)!=null?T:s.emptyCell}),f=g(()=>{var T;return(T=e.size)!=null?T:s.size}),h=g(()=>o.theme==="seer"?xl[f.value]:Cl[f.value]),{mergedPagination:p}=kt(e,s,f),v=Ht(e),S=Bt(e,a,v),x=ht(e,l,s,S.scrollBarSizeOnFixedHolder),w=At(x.flattedColumns),m=wt(x.flattedColumns),d=Ct(e,x.flattedColumns),y=Mt(e,x,S,v.isSticky,a),{activeSorters:C}=w,{activeFilters:B}=m,$=xt(e,c,i,C,B,d.expandedRowKeys,p),k=Pt(e,r,x.flattedColumns,$);$t(e,s,p,C,B,S.scrollTo);const E={props:e,slots:l,config:s,locale:r,mergedPrefixCls:n,mergedEmptyCell:u,mergedVirtualItemHeight:h,mergedAutoHeight:a,...x,...S,...w,...m,...v,tableLayout:y,mergedPagination:p,...d,...$,...k};Oe(M,E),t({scrollTo:S.scrollTo});const{flattedData:F,filteredData:A}=$,H=g(()=>{const T=n.value,{borderless:K=s.borderless,scroll:O}=e;return Y({[T]:!0,[`${T}-auto-height`]:a.value,[`${T}-borderless`]:K,[`${T}-empty`]:F.value.length===0,[`${T}-full-height`]:O==null?void 0:O.fullHeight,[`${T}-${f.value}`]:!0})});return()=>{const T=n.value,K=b(nt,{header:e.header},l),O=bl(l,T),[R,U]=Sl(p.value,A.value,T),q=[K],L=[R,b(gl,null,null),O,U].filter(Boolean),z=kl(e.spin);return z?q.push(b(ot,z,{default:()=>[L]})):q.push(...L),b("div",{class:H.value},[q])}}});function kl(e){return dt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Tl=wl,Ol=pe;export{Tl as I,Ol as a,vt as g};
