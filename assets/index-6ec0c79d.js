import{c as Te,a as Fe,n as $e,e as Be,Éµ as oe,f as Re,g as ue,u as re}from"./index-5dbf4477.js";import{ak as w,ao as Oe,r as we,a6 as De,aa as Me,ab as He,m as U,an as q,a9 as se,aG as ce,M as z,N as ie,a3 as de,ay as pe}from"./index-cd46e9ff.js";import{c as k,f as Ue,w as N,m as X,U as le,t as ze,l as j,y as J,r as _,ae as fe,q as P,a8 as M,a7 as ve,D as me,p as he}from"./vendor-7ed7823e.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function K(e,n,a){if(n)return e.convert(n,a)}function Ke(e){return e.sort((n,a)=>n?a?n.valueOf()-a.valueOf():0:1)}function be(e){return/[hH]/.test(e)}function ge(e){return/m/.test(e)}function ye(e){return/s/.test(e)}function Y(e){return/[aA]/.test(e)}function Ne(e){return/A/.test(e)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function W(e,n,a,t){const[l,u]=w(void 0),[i,d]=w(!1),[p,o]=w(void 0),{parse:s,format:h}=e,v=k(()=>Te(e,t.value,n.value)),C=k(()=>Ue(t.value)?t.value:v.value?h(v.value,n.value):""),f=k(()=>({hourEnabled:be(n.value)||Y(n.value),minuteEnabled:ge(n.value),secondEnabled:ye(n.value)}));function m(I=!1){(I||!l.value||s(l.value,n.value).valueOf()!==s(C.value,n.value).valueOf())&&u(C.value),o(v.value)}N([t,n],()=>m(),{immediate:!0});function b(I){if(!I||!v.value)return I;const{hourEnabled:A,minuteEnabled:x,secondEnabled:T}=f.value,g=["year","month","date",!A&&"hour",!x&&"minute",!T&&"second","millisecond"].filter(Boolean);return Fe(e,v.value,I,g)}function r(I,A,x){return I?e.parse(I,A,x):void 0}function c(I){return!I||e.isValid(I)}function y(I){const A=I.target.value;u(A);const x=r(A,n.value,v.value);c(x)&&a(l.value?b(x):void 0)}function V(){u("")}function S(){d(!0)}function E(){d(!1)}function B(I){a(I)}return{inputValue:l,panelValue:p,inputFocused:i,setInputValue:u,setPanelValue:o,init:m,handleInput:y,handleInputClear:V,handleInputFocus:S,handleInputBlur:E,handlePanelChange:B}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ie(e,n){return k(()=>{var t;const a=(t=e.allowInput)!=null?t:n.allowInput;return{enableExternalInput:a===!0,enableInternalInput:a==="overlay"}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function je(e,n){return a=>{if(a.code==="Escape"){n(!1);return}if(!e.value&&!["Backspace","Tab"].includes(a.code)){a.preventDefault(),n(!0);return}a.code==="Enter"&&n(!1)}}function _e(e,n,a,t){const{bufferUpdated:l,buffer:u}=e;return i=>{if(i.code==="Escape"){a(!1);return}if(!n.value&&!["Backspace","Tab"].includes(i.code)){i.preventDefault(),a(!0);return}switch(i.code){case"Enter":l.value&&t(u.value),a(!1);break}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ce(e,n){const[a,t]=Oe(e,"open",!1);return X(()=>{e.autofocus&&n()}),{overlayOpened:a,setOverlayOpened:t}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xe(e,n,a,t){const{accessor:l,control:u}=we();De(u);const i=Me(e,n),d=He(e,u),[p,o]=w(!1),s=m=>{const{get:b}=a,r=Y(t.value);return q(m).some(c=>{const y=b(c,"hour"),V=$e(y,r),S=Be(y,!!r),E=b(c,"minute"),B=b(c,"second");return e.disabledHours(V).includes(S)||e.disabledMinutes(S,V).includes(E)||e.disabledSeconds(S,E,V).includes(B)})};function h(m){const b=le(m)?Ke(m):m;if(s(b))return;let r=ze(l.value);r=le(r)?r.map(c=>K(a,c,t.value)):K(a,r,t.value),l.setValue(b),U(e.onChange,b,r)}function v(m){h(void 0),U(e.onClear,m)}function C(m){o(!0),U(e.onFocus,m)}function f(m){o(!1),l.markAsBlurred(),U(e.onBlur,m)}return{accessor:l,mergedSize:i,mergedStatus:d,focused:p,handleChange:h,handleClear:v,handleFocus:C,handleBlur:f}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pe(e){const{props:n,config:a,accessor:t,mergedSize:l,mergedStatus:u,mergedPrefixCls:i,focused:d,handleBlur:p,handleFocus:o,handleClear:s,handleKeyDown:h,overlayOpened:v,setOverlayOpened:C}=e;return k(()=>{var f,m,b,r;return{autofocus:n.autofocus,borderless:n.borderless,value:t.value,clearable:(f=n.clearable)!=null?f:a.clearable,clearIcon:(m=n.clearIcon)!=null?m:a.clearIcon,disabled:t.disabled,focused:d.value,open:v.value,overlayContainer:(b=n.overlayContainer)!=null?b:a.overlayContainer,overlayContainerFallback:`.${i.value}-overlay-container`,readonly:n.readonly,size:l.value,status:u.value,suffix:(r=n.suffix)!=null?r:a.suffix,suffixRotate:!1,"onUpdate:open":C,onClear:s,onFocus:o,onBlur:p,onKeydown:h}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ke(e){return k(()=>{var l,u;const{props:n,config:a,accessor:t}=e;return{borderless:!1,clearable:(l=n.clearable)!=null?l:a.clearable,clearIcon:(u=n.clearIcon)!=null?u:a.clearIcon,disabled:t.disabled,size:"sm"}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Le(e,n,a,t){const l=k(()=>K(n,e.defaultOpenValue,a.value)),[u,i]=w(()=>{var d;return(d=t.value)!=null?d:l.value});return N(t,d=>{i(d!=null?d:l.value)}),{activeValue:u,setActiveValue:i}}function Ge(e,n,a,t){const l=k(()=>q(e.defaultOpenValue).map(o=>K(n,o,a.value))),[u,i]=w(()=>{var o,s;return(s=(o=t.value)==null?void 0:o[0])!=null?s:l.value[0]}),[d,p]=w(()=>{var o,s;return(s=(o=t.value)==null?void 0:o[1])!=null?s:l.value[1]});return N(t,o=>{var s,h;i((s=o==null?void 0:o[0])!=null?s:l.value[0]),p((h=o==null?void 0:o[1])!=null?h:l.value[1])}),{fromActiveValue:u,toActiveValue:d,setFromActiveValue:i,setToActiveValue:p}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ve(e,n){return k(()=>{const{disabledHours:a,disabledMinutes:t,disabledSeconds:l,hideDisabledOptions:u,hourStep:i,minuteStep:d,secondStep:p}=e,o=n.value;return{disabledHours:a,disabledMinutes:t,disabledSeconds:l,hideDisabledOptions:u,hourStep:i,minuteStep:d,secondStep:p,hourEnabled:be(o),minuteEnabled:ge(o),secondEnabled:ye(o),use12Hours:Y(o),amPmCapital:Ne(o)}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Z=Symbol("timePickerContext"),ee=Symbol("timeRangePickerContext"),qe=j({setup(){const e=J(Z),{slots:n,props:a,locale:t,formatRef:l,dateConfig:u,inputRef:i,inputEnableStatus:d,mergedPrefixCls:p,overlayOpened:o,handleClear:s,handleKeyDown:h,controlContext:{inputValue:v,panelValue:C,inputFocused:f,handleInput:m,handleInputFocus:b,handleInputBlur:r,handlePanelChange:c}}=e,y=_(),V=()=>{var x;d.value.enableInternalInput&&(i.value=(x=y.value)==null?void 0:x.getInputElement())};X(V),fe(V);const S=ke(e),E=Ve(a,l),{activeValue:B,setActiveValue:I}=Le(a,u,l,C),A=x=>{x.target instanceof HTMLInputElement||x.preventDefault()};return()=>{var R;const x=`${p.value}-overlay`,T=`${p.value}-board`,g={...E.value,activeValue:B.value,visible:o.value,value:C.value,onChange:c,"onUpdate:activeValue":I},F=[P("div",{class:`${x}-body ${T}`,tabindex:-1,onMousedown:A},[d.value.enableInternalInput&&P(se,M({ref:y,class:`${T}-input`},S.value,{clearVisible:!!v.value,value:v.value,readonly:a.readonly,focused:f.value,placeholder:(R=a.placeholder)!=null?R:t.timePicker.placeholder,onInput:m,onClear:s,onFocus:b,onBlur:r,onKeydown:h}),n),P(oe,M(g,{class:`${T}-panel`,tabindex:-1}),null)]),P(ce,{class:`${x}-footer`,footer:a.footer},n)];return a.overlayRender?a.overlayRender(F):P("div",{onMousedown:A},[F])}}}),Je=j({inheritAttrs:!1,setup(e,{expose:n}){const a=J(Z),{accessor:t,props:l,locale:u,mergedPrefixCls:i,formatRef:d,inputRef:p,inputEnableStatus:o,controlContext:{inputValue:s,handleInput:h}}=a,v=_(),C=k(()=>{var r;return(r=l.placeholder)!=null?r:u.timePicker.placeholder}),f=k(()=>Math.max(10,d.value.length)+2),m=r=>{h(r),U(l.onInput,r)};return n({focus:()=>{var r;(r=(o.value.enableExternalInput?p:v).value)==null||r.focus()}}),()=>P("input",{ref:o.value.enableExternalInput?p:v,class:`${i.value}-input`,autocomplete:"off",disabled:t.disabled,placeholder:C.value,readonly:l.readonly||!o.value.enableExternalInput,size:f.value,value:s.value,onInput:m},null)}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Se={...Re,open:{type:Boolean,default:void 0},control:{type:[String,Number,Object,Array],default:void 0},allowInput:{type:[Boolean,String],default:void 0},autofocus:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},clearIcon:String,clearText:String,disabled:{type:Boolean,default:!1},format:String,overlayClassName:String,overlayContainer:{type:[String,HTMLElement,Function],default:void 0},overlayRender:Function,readonly:{type:Boolean,default:!1},size:String,status:String,suffix:String,"onUpdate:open":[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array]},Qe={...Se,value:[String,Date,Number],defaultOpenValue:[String,Date,Number],footer:{type:[Boolean,Array,Object],default:!1},placeholder:String,"onUpdate:value":[Function,Array],onChange:[Function,Array],onInput:[Function,Array]},We={...Se,value:Array,defaultOpenValue:Array,footer:{type:[Boolean,Array,Object],default:!0},placeholder:Array,separator:[String,Object],"onUpdate:value":[Function,Array],onChange:[Function,Array],onInput:[Function,Array]},Xe=j({name:"IxTimePicker",inheritAttrs:!1,props:Qe,setup(e,{attrs:n,expose:a,slots:t}){const l=z("common"),{globalHashId:u,hashId:i,registerToken:d}=ie("timePicker");d(ue);const p=k(()=>`${l.prefixCls}-time-picker`),o=z("locale"),s=z("timePicker"),h=re(),v=_(),{elementRef:C,focus:f,blur:m}=de(),b=k(()=>{var D;return(D=e.format)!=null?D:s.format}),{overlayOpened:r,setOverlayOpened:c}=Ce(e,f),y=xe(e,s,h,b),{accessor:V,focused:S,handleFocus:E,handleBlur:B,handleChange:I}=y,A=W(h,b,I,ve(V,"value")),x=Ie(e,s),T=je(r,c),g={props:e,slots:t,dateConfig:h,common:l,locale:o,config:s,mergedPrefixCls:p,formatRef:b,handleKeyDown:T,inputRef:C,inputEnableStatus:x,overlayOpened:r,setOverlayOpened:c,controlContext:A,...y,handleFocus:E,handleBlur:B};me(Z,g);const F=Pe(g);a({focus:f,blur:m}),N(r,D=>{var $;D?setTimeout(()=>{var O;(O=C.value)==null||O.focus()}):(A.init(!0),S.value&&(($=v.value)==null||$.focus()))});const R=()=>P(Je,M({ref:v},n),null),L=()=>P(qe,null,null),G=k(()=>he([`${p.value}-overlay`,u.value,i.value,e.overlayClassName]));return()=>P(pe,M(F.value,{class:`${p.value} ${u.value} ${i.value}`,overlayClassName:G.value},n),{default:R,overlay:L,suffix:t.suffix,clearIcon:t.clearIcon})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ye(e,n,a){const[t,l]=w(q(a.value).map(f=>K(e,f,n.value))),[u,i]=w(!1),d=f=>{l(Ze(e,f,n.value)),i(!0)};N([a,n],([f])=>{d(f)});const p=k(()=>q(t.value)),o=k(()=>p.value[0]),s=k(()=>p.value[1]),h=W(e,n,f=>{d([f,s.value])},o),v=W(e,n,f=>{d([o.value,f])},s);return{buffer:t,bufferUpdated:u,fromControl:h,toControl:v,init:(f=!1)=>{d(a.value),i(!1),h.init(f),v.init(f)}}}function Ze(e,n,a){return q(n).map(t=>K(e,t,a))}const en=j({setup(){const e=J(ee),{props:n,slots:a,dateConfig:t,locale:l,mergedPrefixCls:u,formatRef:i,inputRef:d,inputEnableStatus:p,overlayOpened:o,handleChange:s,handleKeyDown:h,renderSeparator:v,setOverlayOpened:C,rangeControlContext:{buffer:f,fromControl:m,toControl:b}}=e,r=_(),c=()=>{var g;p.value.enableInternalInput&&(d.value=(g=r.value)==null?void 0:g.getInputElement())};X(c),fe(c);const y=ke(e),V=Ve(n,i),{fromActiveValue:S,toActiveValue:E,setFromActiveValue:B,setToActiveValue:I}=Ge(n,t,i,k(()=>[m.panelValue.value,b.panelValue.value])),A=()=>{s(f.value),C(!1)},x=g=>{g.target instanceof HTMLInputElement||g.preventDefault()};function T(g){var ae,te;const{inputValue:F,inputFocused:R,panelValue:L,handleInput:G,handleInputClear:D,handleInputFocus:$,handleInputBlur:O,handlePanelChange:H}=g?m:b,ne=g?0:1,Ae=(te=(ae=n.placeholder)==null?void 0:ae[ne])!=null?te:l.timeRangePicker.placeholder[ne],Q=`${u.value}-board`,Ee={...V.value,activeValue:g?S.value:E.value,visible:o.value,value:L.value,onChange:H,"onUpdate:activeValue":g?B:I};return P("div",{class:Q},[p.value.enableInternalInput&&P(se,M({ref:g?r:void 0,class:`${Q}-input`},y.value,{clearVisible:!!F.value,value:F.value,readonly:n.readonly,focused:R.value,placeholder:Ae,onInput:G,onClear:D,onFocus:$,onBlur:O,onKeydown:h}),a),P(oe,M(Ee,{class:`${Q}-panel`,tabindex:-1}),null)])}return()=>{const g=`${u.value}-overlay`,F={[`${g}-separator`]:!0,[`${g}-separator-line`]:!p.value.enableInternalInput},R=[P("div",{class:`${g}-body`,onMousedown:x},[T(!0),P("div",{class:F},[p.value.enableInternalInput&&v()]),T(!1)]),P(ce,{class:`${g}-footer`,footer:n.footer,okText:l.timeRangePicker.okText,okButton:{size:"xs",mode:"primary"},cancelVisible:!1,ok:A},a)];return n.overlayRender?n.overlayRender(R):P("div",{onMousedown:x},[R])}}}),nn=j({inheritAttrs:!1,setup(e,{expose:n}){const a=J(ee),{accessor:t,props:l,locale:u,mergedPrefixCls:i,inputRef:d,inputEnableStatus:p,renderSeparator:o,rangeControlContext:{fromControl:s,toControl:h}}=a,v=_(),C=k(()=>{var c,y,V,S;return[(y=(c=l.placeholder)==null?void 0:c[0])!=null?y:u.timeRangePicker.placeholder[0],(S=(V=l.placeholder)==null?void 0:V[1])!=null?S:u.timeRangePicker.placeholder[1]]});n({focus:()=>{var c;(c=(p.value.enableExternalInput?d:v).value)==null||c.focus()}});const m=c=>{s.handleInput(c),U(l.onInput,!0,c)},b=c=>{h.handleInput(c),U(l.onInput,!1,c)};function r(c,y){const{inputValue:V}=y?s:h,S=C.value[y?0:1],E=y?m:b;return P("input",{ref:y?p.value.enableExternalInput?d:v:void 0,class:`${c}-input-inner`,autocomplete:"off",disabled:t.disabled,value:V.value,placeholder:S,readonly:l.readonly||!p.value.enableExternalInput,onInput:E},null)}return()=>{const c=i.value;return P("span",{class:`${c}-input`},[r(c,!0),P("span",{class:`${c}-input-separator`},[o()]),r(c,!1)])}}}),an=j({name:"IxTimeRangePicker",inheritAttrs:!1,props:We,setup(e,{attrs:n,expose:a,slots:t}){const l=z("common"),{globalHashId:u,hashId:i,registerToken:d}=ie("timePicker");d(ue);const p=k(()=>`${l.prefixCls}-time-range-picker`),o=z("locale"),s=z("timePicker"),h=re(),v=_(),{elementRef:C,focus:f,blur:m}=de(),b=k(()=>{var $;return($=e.format)!=null?$:s.format}),{overlayOpened:r,setOverlayOpened:c}=Ce(e,f),y=xe(e,s,h,b),{accessor:V,focused:S,handleFocus:E,handleBlur:B,handleChange:I}=y,A=Ye(h,b,ve(V,"value")),x=Ie(e,s),T=_e(A,r,c,I),F={props:e,slots:t,dateConfig:h,common:l,locale:o,config:s,mergedPrefixCls:p,formatRef:b,handleKeyDown:T,inputRef:C,inputEnableStatus:x,overlayOpened:r,setOverlayOpened:c,renderSeparator:()=>{var $,O,H;return(H=(O=($=t.separator)==null?void 0:$.call(t))!=null?O:e.separator)!=null?H:o.timeRangePicker.separator},rangeControlContext:A,...y,handleFocus:E,handleBlur:B},R=Pe(F);me(ee,F),a({focus:f,blur:m}),N(r,$=>{var O;$?setTimeout(()=>{var H;(H=C.value)==null||H.focus()}):(A.init(!0),S.value&&((O=v.value)==null||O.focus()))});const L=()=>P(nn,M({ref:v},n),null),G=()=>P(en,null,null),D=k(()=>he([`${p.value}-overlay`,u.value,i.value,e.overlayClassName]));return()=>P(pe,M(R.value,{class:`${p.value} ${u.value} ${i.value}`,overlayClassName:D.value},n),{default:L,overlay:G,suffix:t.suffix,clearIcon:t.clearIcon})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const un=Xe,rn=an;export{un as I,rn as a};
