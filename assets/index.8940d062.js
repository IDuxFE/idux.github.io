import{aC as qe,ad as ve,aO as Xe,ac as Ve,ag as we,j as M,u as le,v as _,aP as ce,N as q,s as Ye,a3 as ue,ab as oe,o as ee,h as Y,i as me,w as te,C as he,au as Ge,ap as ke,ao as Be,c as be,x as Qe,a4 as Ze,a5 as Je,aa as et,aQ as tt,aw as lt,ar as nt,aD as ot}from"./index.01a21eef.js";import{h as st,l as L,e as m,r as ye,b as O,w as D,a7 as Ke,Q as Ee,k as G,A as Z,x as se,bh as at,P as rt,v as P,z as V,y as b,i as F,ad as ct,a as Q,a1 as J,p as $e,Z as ut,a4 as it}from"./vendor.71a61ad2.js";import{b as Te}from"./GlobalCodeBox.78ca2625.js";import{I as dt}from"./index.cbc39db0.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Oe=Symbol("IxTableColumn"),pe=()=>{};pe.displayName="IxTableColumn";pe[Oe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function We(e,l,t){if(!e||st(e)&&!e.title)return;let o=t;if(L(l))o=l;else{const n=qe(l);n&&L(n.children)&&(o=n.children)}return o}function ft(e){return e.key?e.key:e.dataKey&&e.dataKey?ve(e.dataKey).join("-"):e.type?`__IDUX_table_column_key_${e.type}`:Xe("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function vt(e,l,t,o){const n=m(()=>{var p;const{columns:w}=e;return w&&w.length>0?ie(e.columns,t.columnBase,t.columnExpandable):ie(Pe((p=l.default)==null?void 0:p.call(l)),t.columnBase,t.columnExpandable)}),{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a}=yt(n,o),c=pt(a),i=m(()=>!!e.ellipsis||r.value.some(w=>w.ellipsis)),u=m(()=>r.value.some(w=>w.fixed)),{columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:g}=gt(r,s),{columnOffsets:v,columnOffsetsWithScrollBar:S}=mt(f,h),C=m(()=>bt(n.value,s.value));return{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:g,columnOffsets:v,columnOffsetsWithScrollBar:S,mergedRows:C}}function ie(e,l,t){return e.map(o=>ht(o,l,t))}function Pe(e){const l=[];return Ve(e,{key:Oe}).forEach((t,o)=>{const{props:n,children:r}=t,{key:s=o,editable:a,ellipsis:c,...i}=n||{};i.key=s,i.editable=a||a==="",i.ellipsis=c||c==="";const{default:u,cell:f,title:h,expand:g,icon:v}=r||{};u&&(i.children=Pe(u())),f&&(i.customCell=f),h&&(i.customTitle=h),g&&(i.customExpand=g),v&&(i.customIcon=v),l.push(i)}),l}function ht(e,l,t){var r;const{align:o=l.align}=e,n=ft(e);if("type"in e){const{type:s}=e;if(s==="expandable"){const{icon:a=t.icon}=e;return{...e,key:n,align:o,icon:a}}if(s==="selectable"){const a=(r=e.multiple)!=null?r:!0;return{...e,key:n,align:o,multiple:a}}return{...e,key:n,align:o}}else{const{sortable:s,filterable:a,children:c}=e,i={...e,key:n,align:o};return s&&(i.sortable={...l.sortable,...s}),a&&(i.filterable={...l.filterable,...a}),c!=null&&c.length&&(i.children=ie(c,l,t)),i}}function yt(e,l){const t=m(()=>Re(e.value)),o=m(()=>{const r=l.value;if(r===0)return;const s=t.value,a=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:r}}),n=m(()=>{const r=t.value;if(r.length===0)return r;const s=o.value;return s?[...r,s]:r});return{flattedColumns:t,scrollBarColumn:o,flattedColumnsWithScrollBar:n}}function Re(e){const l=[];return e.forEach(t=>{const{fixed:o,children:n}=t;if(n!=null&&n.length){let r=Re(n);o&&(r=r.map(s=>({fixed:o,...s}))),l.push(...r)}else l.push(t)}),l}function pt(e){return m(()=>{let l,t;return e.value.forEach(o=>{const{fixed:n,key:r}=o;n==="start"?l=r:n==="end"&&(t||(t=r))}),{lastStartKey:l,firstEndKey:t}})}function gt(e,l){const t=ye({}),o=O(),n=O([]);D(o,Ke(a=>{n.value=a?a.split("-").map(Number):[]},16)),Ee(()=>{const a=Object.keys(t),c=e.value;if(a.length!==c.length){o.value=void 0;return}o.value=c.map(i=>t[i.key]).join("-")});const r=m(()=>{const a=n.value;if(a.length===0)return a;const c=l.value;return c?[...a,c.width]:a});return{columnWidths:n,columnWidthsWithScrollBar:r,changeColumnWidth:(a,c)=>{c===!1?delete t[a]:t[a]=c}}}function mt(e,l){const t=m(()=>Se(e.value)),o=m(()=>Se(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:o}}function Se(e){const l=e.length,t=[],o=[];let n=0,r=0;for(let s=0;s<l;s++){t[s]=n,n+=e[s]||0;const a=l-s-1;o[a]=r,r+=e[a]||0}return{starts:t,ends:o}}function bt(e,l){const t=[];function o(s,a,c){var f;(f=t[c])!=null||(t[c]=[]);let i=a;return s.map(h=>{var w;let g=(w=h.titleColSpan)!=null?w:1,v=!1;const S=h.children;if(S!=null&&S.length){v=!0;const p=o(S,i,c+1);G(h.titleColSpan)&&(g=p.reduce((d,y)=>d+y))}const C=i+g-1;return t[c].push({...h,titleColSpan:g,colStart:i,colEnd:C,hasChildren:v}),i+=g,g})}const n=l?[...e,l]:e;o(n,0,0);const r=t.length;return t.forEach((s,a)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-a)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function St(e,l,t,o,n,r,s){const a=m(()=>{const v=l.value,S=t.value;return e.dataSource.map(C=>Fe(C,S,v))}),c=m(()=>{const v=new Map;return de(a.value,v),v}),i=m(()=>Ae(a.value,n.value,r.value)),u=m(()=>Ie(i.value,o.value,r.value)),f=m(()=>{const v=s.value,S=u.value;if(v===null||!v.pageSize)return S;{const{total:C}=v;if(C&&S.length<C)return S;const w=v.pageSize,p=(v.pageIndex-1)*w;return S.slice(p,p+w)}}),h=m(()=>{const v=new Map;return de(f.value,v),v}),g=m(()=>{const v=r.value;return v.length>0?He(f.value,v,0):f.value});return{filteredData:i,flattedData:g,mergedMap:c,paginatedMap:h}}function Fe(e,l,t,o){const n=l(e),r={record:e,rowKey:n,parentKey:o},s=e[t];return s&&(r.children=s.map(a=>Fe(a,l,t,n))),r}function de(e,l){e.forEach(t=>{const{rowKey:o,children:n}=t;l.set(o,t),n&&de(n,l)})}function Ie(e,l,t){const o=l.filter(s=>s.sorter),n=o.length;if(n===0)return e;const r=e.slice();return r.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=Ie(s.children,l,t))}),r.sort((s,a)=>{for(let c=0;c<n;c++){const{orderBy:i,sorter:u}=o[c],f=u(s.record,a.record);if(f!==0)return i==="ascend"?f:-f}return 0})}function Ae(e,l,t){const o=l.filter(n=>n.filter);return o.length===0?e:e.map(n=>{const r=o.every(({filter:u,filterBy:f})=>u(f,n.record)),{rowKey:s,children:a}=n,c=t.includes(s);let i=n;if(c&&a&&a.length){const u=Ae(a,l,t);u.length!==a.length&&(i={...n,children:u})}return r||c&&i.children&&i.children.length?i:null}).filter(n=>n!==null)}function He(e,l,t){return e.reduce((o,n)=>{const{children:r,parentKey:s,record:a,rowKey:c}=n,i=l.includes(c);if(o.push({children:r,parentKey:s,record:a,rowKey:c,level:t,expanded:i}),i&&n.children){const u=He(n.children,l,t+1);o.push(...u)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xt(e,l){const t=m(()=>l.value.find(a=>"type"in a&&a.type==="expandable")),[o,n]=we(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:o,setExpandedRowKeys:n,checkExpandDisabled:a=>{if(!t.value)return!0;const{disabled:c,customExpand:i}=t.value,{record:u}=a;return c!=null&&c(u)?!0:!(i||a.children&&a.children.length>0)},handleExpandChange:(a,c)=>{const{onChange:i,onExpand:u}=t.value||{},f=[...o.value],h=f.indexOf(a),g=h>=0;g?f.splice(h,1):f.push(a),M(u,!g,c),n(f),M(i,f)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e){const l=m(()=>e.value.filter(r=>r.filterable)),t=ye({});D(l,(r,s)=>{r.forEach(a=>{const{key:c,filterable:i}=a,u=i.filterBy;if(u||t[c]===void 0){t[c]=u||[];return}const f=s?s.find(g=>g.key===c):void 0;(f==null?void 0:f.filterable.filterBy)&&(t[c]=[])})},{immediate:!0});const o=m(()=>l.value.map(r=>{const{key:s,filterable:a}=r,{filter:c,filterBy:i=t[s]}=a;return{key:s,filter:c,filterBy:i}}).filter(r=>r.filter&&r.filterBy.length>0));return{activeFilters:o,activeFilterByMap:t,handleFilter:(r,s,a)=>{const{onChange:c}=s;t[r]=a,M(c,a,o.value)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wt(e,l,t){var i,u,f,h,g;const o=le("pagination"),n=m(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),r=O((u=(i=n.value)==null?void 0:i.pageIndex)!=null?u:1),s=O((g=(h=(f=n.value)==null?void 0:f.pageSize)!=null?h:l.pagination.pageSize)!=null?g:o.pageSize),a=(v,S)=>{var C;r.value=v,s.value=S,M((C=n.value)==null?void 0:C.onChange,v,S)};return{mergedPagination:m(()=>{var S,C;const v=n.value;return v===null?null:{...l.pagination,...v,pageIndex:(S=v.pageIndex)!=null?S:r.value,pageSize:(C=v.pageSize)!=null?C:s.value,size:t.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function kt(e,l,{setStickyScrollLeft:t}){const o=O(),n=O(),r=O(),s=O(),a=O();D(o,w=>{w&&(r.value=w.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=Bt(n,r,a,t),f=Kt(e,l,r,s),h=m(()=>{var w;return _((w=e.scroll)==null?void 0:w.width)}),g=m(()=>{var p;let w=_((p=e.scroll)==null?void 0:p.height);return!w&&l.value&&(e.virtual||f.value)&&(w="auto"),w}),v=m(()=>ce(q(r))),S=m(()=>g.value?v.value:0);return{virtualScrollRef:o,scrollHeadRef:n,scrollBodyRef:r,scrollContentRef:s,scrollFootRef:a,handleScroll:c,scrollTo:w=>{var p;e.virtual?(p=o.value)==null||p.scrollTo(w):typeof w=="number"&&Ye({target:q(r),top:w,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:g,scrollBarSize:v,scrollBarSizeOnFixedHolder:S}}function Bt(e,l,t,o){const n=O(!1),r=O(!1);let s;const a=()=>{s&&(clearTimeout(s),s=void 0)};Z(()=>a());const c=O(),i=g=>{c.value=g,a(),s=setTimeout(()=>{c.value=void 0,s=void 0},100)},u=(g,v)=>{!v||v.scrollLeft!==g&&(v.scrollLeft=g)},f=g=>{const v=q(l);if(!v)return;const{clientWidth:S,scrollWidth:C}=v;o(g/C*S||0)};return{handleScroll:(g,v)=>{const S=g==null?void 0:g.currentTarget,C=v!=null?v:S.scrollLeft,w=c.value;if((!w||w===S)&&(i(S),u(C,e.value),u(C,q(l)),u(C,t.value),f(C)),S){const{scrollWidth:p,clientWidth:d}=S;n.value=C>0,r.value=C<p-d}},pingedStart:n,pingedEnd:r}}function Kt(e,l,t,o){const n=O(!0),r=()=>{const c=q(t.value);c?n.value=c.scrollHeight>c.clientHeight:n.value=!1};let s=[];const a=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,i])=>{a(),c&&!i&&(s=[ue(t,r),ue(o,r)])},{immediate:!0})}),Z(()=>a()),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e,l,t,o,n,r){const s=m(()=>{var u;return(u=e.scrollToTopOnChange)!=null?u:l.scrollToTopOnChange});let a=[];const c=()=>{a=[D([()=>{var u;return(u=t.value)==null?void 0:u.pageIndex},()=>{var u;return(u=t.value)==null?void 0:u.pageSize}],()=>r(0)),D([n,o],([u,f],[h,g])=>{(!$t(u,h)||!Tt(f,g))&&r(0)})]},i=()=>{a.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function $t(e,l){return e.length===l.length&&e.every(t=>{const o=l.find(n=>n.key===t.key);return o?t.filter===o.filter&&t.filterBy.length===o.filterBy.length&&t.filterBy.every(n=>o.filterBy.includes(n)):!1})}function Tt(e,l){return e.length===l.length&&e.every(t=>{const o=l.find(n=>n.key===t.key);return o?t.sorter===o.sorter&&t.orderBy===o.orderBy&&t.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ot(e,l,t,{mergedMap:o,paginatedMap:n}){const r=m(()=>t.value.find(p=>"type"in p&&p.type==="selectable")),[s,a]=we(e,"selectedRowKeys",()=>[]),c=m(()=>{const{disabled:p}=r.value||{},d=[],y=[];return n.value.forEach((x,k)=>{p!=null&&p(x.record)?y.push(k):d.push(k)}),{enabledRowKeys:d,disabledRowKeys:y}}),i=m(()=>{const p=new Set,d=s.value,{disabledRowKeys:y}=c.value,x=o.value;return d.forEach(k=>{const{parentKey:T}=x.get(k)||{};if(!G(T)){let B=x.get(T);if(B&&!d.includes(B.rowKey))for(;B&&!G(B==null?void 0:B.rowKey);)y.includes(B.rowKey)||p.add(B.rowKey),B=G(B.parentKey)?void 0:x.get(B.parentKey)}}),[...p]}),u=m(()=>{const p=s.value,{disabledRowKeys:d}=c.value;let y=0;return n.value.forEach((x,k)=>{!d.includes(k)&&p.includes(k)&&y++},0),y}),f=m(()=>{const p=n.value.size,d=c.value.disabledRowKeys.length;return p===0||p===d?!1:p===d+u.value}),h=m(()=>!f.value&&u.value>0),g=p=>{a(p);const d=o.value,{onChange:y}=r.value||{};if(y){const x=[];p.forEach(k=>{const T=d.get(k);T&&x.push(T.record)}),M(y,p,x)}},v=(p,d)=>{const y=o.value,{disabledRowKeys:x}=c.value,{multiple:k,onSelect:T}=r.value||{};let B=[...s.value];const $=B.indexOf(p),I=$>=0;if(k){const A=y.get(p),E=ze(A,x);if(I){B.splice($,1);const z=Wt(y,A,x);B=B.filter(K=>!z.includes(K)&&!E.includes(K))}else B.push(p),B.push(...E);Pt(y,A,B,x)}else B=I?[]:[p];M(T,!I,d),g(B)},S=()=>{const{enabledRowKeys:p}=c.value,d=new Set(s.value);f.value?p.forEach(y=>d.delete(y)):p.forEach(y=>d.add(y)),g([...d])},C=Rt(r,l),w=Ft(r,o,n,s,g);return{selectable:r,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:f,currentPageSomeSelected:h,handleSelectChange:v,handleHeadSelectChange:S,mergedSelectableMenus:C,handleSelectableMenuClick:w}}function ze(e,l){const t=[],{children:o}=e||{};return o&&o.forEach(n=>{const{rowKey:r}=n;l.includes(r)||t.push(n.rowKey),t.push(...ze(n,l))}),t}function Wt(e,l,t){const o=[];for(;l!=null&&l.parentKey;){const{parentKey:n}=l;t.includes(l.parentKey)||o.push(n),l=e.get(n)}return o}function Pt(e,l,t,o){let n=!0;for(;n&&l&&!G(l.parentKey);){const r=e.get(l.parentKey);if(r&&!o.includes(l.parentKey)){n=r.children.every(a=>o.includes(a.rowKey)||t.includes(a.rowKey));const s=t.findIndex(a=>a===l.parentKey);n?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=r}}const Me=Symbol("IDUX_TABLE_KEY_selectable-all"),_e=Symbol("IDUX_TABLE_KEY_selectable-invert"),De=Symbol("IDUX_TABLE_KEY_selectable-none"),Ne=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Rt(e,l){return m(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:o,selectInvert:n,selectNone:r,selectPageInvert:s}=l.table;return t.map(a=>L(a)?a==="all"?{type:"item",key:Me,label:o}:a==="invert"?{type:"item",key:_e,label:n}:a==="none"?{type:"item",key:De,label:r}:a==="pageInvert"?{type:"item",key:Ne,label:s}:{type:"item",key:a,label:a}:a)})}function Ft(e,l,t,o,n){const r=()=>{const{disabled:u,onSelectAll:f}=e.value||{},h=[];l.value.forEach((g,v)=>{u!=null&&u(g.record)||h.push(v)}),M(f,h),n(h)},s=()=>{const{disabled:u,onSelectInvert:f}=e.value||{},h=[...o.value];l.value.forEach((g,v)=>{if(u!=null&&u(g.record))return;const S=h.indexOf(v);S>=0?h.splice(S,1):h.push(v)}),n(h),M(f,h)},a=()=>{const{onSelectNone:u}=e.value||{};M(u),n([])},c=()=>{const{disabled:u,onSelectPageInvert:f}=e.value||{},h=[],g=o.value;t.value.forEach((v,S)=>{(u==null?void 0:u(v.record))||g.includes(S)||h.push(S)}),M(f,h),n(h)},i=new Map([[Me,r],[_e,s],[De,a],[Ne,c]]);return u=>{const f=u.key;if(at(f)&&i.has(f)){i.get(f)();return}const{disabled:h,onMenuClick:g}=e.value||{};if(!g)return;const v=[];t.value.forEach((S,C)=>{h!=null&&h(S.record)||v.push(C)}),M(g,u,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e){const l=m(()=>e.value.filter(s=>s.sortable)),t=ye({}),o=m(()=>l.value.some(s=>s.sortable.multiple!==void 0));D(l,(s,a)=>{s.forEach(c=>{const{key:i,sortable:u}=c,f=u.orderBy;if(f||t[i]===void 0){t[i]=f;return}const h=a?a.find(v=>v.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(t[i]=void 0)})},{immediate:!0});const n=m(()=>l.value.map(s=>{const{key:a,sortable:c}=s,{multiple:i=0,orderBy:u=t[a],sorter:f}=c;return{key:a,multiple:i,orderBy:u,sorter:f}}).filter(s=>s.orderBy).sort((s,a)=>a.multiple-s.multiple));return{activeSorters:n,activeOrderByMap:t,handleSort:(s,a)=>{const{orders:c,onChange:i}=a,u=t[s],f=u?xe(c,u):xe(c);o.value?t[s]=f:Object.keys(t).forEach(h=>{s===h?t[h]=f:t[h]=void 0}),M(i,f,n.value)}}}function xe(e,l){return l?e[e.indexOf(l)+1]:e[0]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function At(e){const l=m(()=>!!e.sticky),t=m(()=>{const{sticky:r}=e,{offsetTop:s=0,offsetBottom:a=0,offsetScroll:c=0,container:i=window}=rt(r)?r:{};return{offsetTop:s,offsetBottom:a,offsetScroll:c,container:i}}),[o,n]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:o,setStickyScrollLeft:n}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:o,scrollHeight:n},r,s){return m(()=>e.tableLayout?e.tableLayout:o.value&&t.value?o.value==="max-content"?"auto":"fixed":n.value||s.value||r.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const H=Symbol("TABLE_TOKEN"),ge=Symbol("tableBodyToken"),ne=P({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:o,mergedSelectableMenus:n,mergedPrefixCls:r}=F(H);return()=>{const{isFixedHolder:s}=e,a=s?t.value:l.value;if(a.every(u=>!u.width&&!u.type))return;const c=r.value,i=a.map((u,f)=>{const{key:h,type:g}=u,v=s?o.value[f]:u.width,S=g?V({[`${c}-col-${g}`]:!0,[`${c}-col-with-dropdown`]:g==="selectable"&&n.value.length>0}):void 0;let C;return s?C=v?`width: ${_(v)}`:void 0:C={width:_(v),minWidth:_(u.minWidth),maxWidth:_(u.maxWidth)},b("col",{key:h,class:S,style:C},null)});return b("colgroup",null,[i])}}}),zt=P({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:o,handleScroll:n,scrollWidth:r,flattedData:s,isSticky:a,columnWidths:c}=F(H);Mt(o,n);const i=m(()=>r.value==="max-content"),u=m(()=>s.value.length>0),f=m(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:a.value}}),h=m(()=>{const v=a.value,{offsetTop:S,offsetBottom:C}=e;return{overflow:"hidden",top:v?_(S):void 0,bottom:v?_(C):void 0}}),g=m(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:f.value,style:h.value,ref:o},[b("table",{style:g.value},[(u.value||!i.value)&&b(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function Mt(e,l){const t=o=>{const n=o.deltaX,r=o.currentTarget;if(n){const s=r.scrollLeft+n;l(o,s),o.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Z(()=>Y(e.value,"wheel",t))}const _t=P({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:o,stickyScrollLeft:n,setStickyScrollLeft:r}=F(H),s=O(!1),a=O(!1),c=O(0),i=O(0),u=O(0),f=m(()=>{const d=i.value,y=u.value;return y&&d*(d/y)});Ee(()=>{const d=q(l);if(!!d&&s.value){const{clientWidth:y,scrollWidth:x,scrollLeft:k}=d;r(k/x*y),i.value=y,u.value=x}});const h=m(()=>({height:ce(),width:i.value,bottom:o.value.offsetScroll})),g=m(()=>{const d=e.value;return{[`${d}-sticky-scrollbar-thumb`]:!0,[`${d}-sticky-scrollbar-thumb-active`]:a.value}}),v=m(()=>({width:`${f.value}px`,transform:`translate3d(${n.value}px, 0, 0)`})),S=()=>a.value=!1,C=d=>{c.value=d.pageX-n.value,a.value=!0,d.preventDefault()},w=d=>{if(!a.value)return;const{buttons:y}=d||window.event;if(y===0){a.value=!1;return}let x=d.pageX-c.value;x<=0&&(x=0);const k=i.value,T=u.value,B=f.value;x+B>=k&&(x=k-B);const $=x/k*(T+2);t(d,$)},p=()=>{const d=q(l),y=me(d).top,x=y+d.offsetHeight,{container:k,offsetScroll:T}=o.value,B=k===window?document.documentElement.scrollTop+window.innerHeight:me(k).top+k.clientHeight;x-ce()<=B||y>=B-T?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",S),ee(document.body,"mousemove",w),ee(window,"resize",p),D(()=>o.value.container,(d,y)=>{Y(y,"scroll",p),ee(d,"scroll",p)},{immediate:!0}),p()}),Z(()=>{Y(document.body,"mouseup",S),Y(document.body,"mousemove",w),Y(window,"resize",p),Y(o.value.container,"scroll",p)}),()=>!l.value||!s.value||u.value<=i.value||!f.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[b("div",{class:g.value,style:v.value,onMousedown:C},null)])}}),fe=P({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:o,hasFixed:n,scrollWidth:r,scrollBarColumn:s}=F(H),{mainTableWidth:a}=F(ge),c=m(()=>o.value.length);return()=>{let i=l.default();if(e.isEmpty?r.value:n.value){const u=s.value;i=b("div",{class:`${t.value}-fixed-row`,style:{width:_(a.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Dt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:void 0},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Nt={columns:{type:Array,required:!0}},Lt={column:{type:Object,required:!0}},jt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Ut={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},qt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Xt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Vt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},Yt=P({props:qt,setup(e){const l=O();return ue(l,o=>{const{offsetWidth:n}=o.target;e.changeColumnWidth(e.cellKey,n)}),Z(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[ct("\xA0")])])}}),Gt=P({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(H),{changeColumnWidth:t}=F(ge);return()=>{const o=l.value.map(n=>{const{key:r}=n;return b(Yt,{key:r,cellKey:r,changeColumnWidth:t},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}}),Qt=P({props:Ut,setup(e){const{props:l,slots:t,mergedPrefixCls:o,mergedEmptyCell:n,activeOrderByMap:r,fixedColumnKeys:s,columnOffsets:a,isSticky:c,expandable:i,selectable:u}=F(H),f=m(()=>r[e.column.key]),h=Zt(e),g=m(()=>s.value.lastStartKey===e.column.key),v=m(()=>s.value.firstEndKey===e.column.key),S=m(()=>{const{type:d,ellipsis:y}=e.column;return d||y!=null?y:l.ellipsis}),C=m(()=>{const{fixed:d,align:y}=e.column,x=o.value;let k={[`${x}-cell`]:!0,[`${x}-cell-sorted`]:!!f.value,[`${x}-cell-align-${y}`]:!!y&&y!="start",[`${x}-cell-ellipsis`]:!!S.value};return d&&(k={...k,[`${x}-fix-start`]:d==="start",[`${x}-fix-start-last`]:g.value,[`${x}-fix-end`]:d==="end",[`${x}-fix-end-first`]:v.value,[`${x}-fix-sticky`]:c.value}),V(k)}),w=m(()=>{const{fixed:d}=e.column;if(!d)return;const{starts:y,ends:x}=a.value,T=_((d==="start"?y:x)[e.colIndex]);return{position:"sticky",left:d==="start"?T:void 0,right:d==="end"?T:void 0}}),p=d=>{d.stopPropagation()};return()=>{var I,A,E;const{column:d}=e,{type:y}=d;let x,k;if(y==="selectable")x=tl(e,t,u,p);else{const z=h.value;if(x=Jt(e,t,z),k=We(S.value,x,z),!y&&(G(x)||x==="")){const K=t.emptyCell||n.value;x=Q(K)?K({column:d,record:e.record,rowIndex:e.rowIndex}):K}}e.column.fixed&&S.value&&(g.value||v.value)&&(x=b("span",{class:`${o.value}-cell-content`},[x]));const T=(I=l.customAdditional)==null?void 0:I.bodyCell,B=T?T({column:d,record:e.record,rowIndex:e.rowIndex}):void 0,$=(E=(A=l.customTag)==null?void 0:A.bodyCell)!=null?E:"td";return b($,J({class:C.value,style:w.value,title:k},B),{default:()=>[y==="expandable"&&el(e,t,i,o.value),x]})}}});function Zt(e){return m(()=>{const{column:l,record:t}=e,o=ve(l.dataKey);if(o.length<=0)return;let n=t;for(let r=0;r<o.length&&n;r++){const s=o[r];n=n[s]}return n})}function Jt(e,l,t){const{record:o,rowIndex:n,column:r}=e,{customCell:s}=r,a=L(s)?l[s]:s;return a?a({value:t,record:o,rowIndex:n}):t}function el(e,l,t,o){const{icon:n,customIcon:r,indent:s}=t.value,{record:a,expanded:c,level:i=0,disabled:u}=e,f={marginLeft:s?_(i*s):void 0};let h;return u?h=null:Q(r)?h=r({expanded:!!c,record:a}):L(r)&&l[r]?h=l[r]({expanded:c,record:a}):h=b(te,{name:n,rotate:c?90:0},null),b("button",{class:`${o}-expandable-trigger`,style:f,type:"button",onClick:e.handleExpend},[h])}function tl(e,l,t,o){const{selected:n,indeterminate:r,disabled:s,handleSelect:a}=e,{multiple:c,customCell:i}=t.value,u=L(i)?l[i]:i;if(c){const f={checked:n,disabled:s,indeterminate:r,onChange:a,onClick:o};return u?u(f):b(he,f,null)}else{const f={checked:n,disabled:s,onChange:a,onClick:o};return u?u(f):b(Te,f,null)}}const ll=P({props:jt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:o,expandable:n,handleExpandChange:r,checkExpandDisabled:s,selectable:a,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:f}=F(H),{expandDisabled:h,handleExpend:g,selectDisabled:v,handleSelect:S,clickEvents:C}=nl(e,n,s,r,a,u,f),w=m(()=>c.value.includes(e.rowKey)),p=m(()=>i.value.includes(e.rowKey)),d=m(()=>{const y=`${t.value}-row`,{level:x,expanded:k}=e;return V({[`${y}`]:!0,[`${y}-level-${x}`]:!!x,[`${y}-selected`]:w.value,[`${y}-expanded`]:k})});return()=>{var T,B,$;const y=(T=l.customAdditional)==null?void 0:T.bodyRow,x=y?y({record:e.record,rowIndex:e.rowIndex}):void 0,k=($=(B=l.customTag)==null?void 0:B.bodyRow)!=null?$:"tr";return b(k,J({class:d.value},C.value,x),{default:()=>[ol(e,o,h.value,g,w,p,v,S)]})}}});function nl(e,l,t,o,n,r,s){const a=m(()=>t(e.rowData)),c=m(()=>{var C;return(C=l.value)==null?void 0:C.trigger}),i=()=>{const{rowKey:C,record:w}=e;o(C,w)},u=m(()=>s.value.disabledRowKeys.includes(e.rowKey)),f=m(()=>{var C;return(C=n.value)==null?void 0:C.trigger}),h=()=>{const{rowKey:C,record:w}=e;r(C,w)},g=()=>{c.value==="click"&&!a.value&&i(),f.value==="click"&&!u.value&&h()},v=()=>{c.value==="dblclick"&&!a.value&&i(),f.value==="dblclick"&&!u.value&&h()},S=m(()=>{const C=c.value==="click"||f.value==="click"?g:void 0,w=c.value==="dblclick"||f.value==="dblclick"?v:void 0;return{onClick:C,onDblclick:w}});return{expandDisabled:a,handleExpend:i,selectDisabled:u,handleSelect:h,clickEvents:S}}function ol(e,l,t,o,n,r,s,a){const c=[],{rowIndex:i,record:u,level:f}=e;return l.value.forEach((h,g)=>{const{type:v,colSpan:S,rowSpan:C,key:w}=h,p=S==null?void 0:S(u,i),d=C==null?void 0:C(u,i);if(p===0||d===0)return;const y={colSpan:p===1?void 0:p,rowSpan:d===1?void 0:d,rowIndex:i,colIndex:g,record:u,column:h,level:f,key:w};v==="expandable"?(y.expanded=e.expanded,y.disabled=t,y.handleExpend=o):v==="selectable"&&(y.selected=n.value,y.indeterminate=r.value,y.disabled=s.value,y.handleSelect=a),c.push(b(Qt,y,null))}),c}function Le(e,l,t,o,n){const{expanded:r,level:s,record:a,rowKey:c}=e,i={key:c,expanded:r,level:s,record:a,rowData:e,rowIndex:l,rowKey:c},u=b(ll,i,null),f=r&&sl(i,t,o,n);return f?[u,f]:u}function sl(e,l,t,o){const{customExpand:n}=t||{},{record:r,rowIndex:s}=e;let a;return Q(n)?a=n({record:r,rowIndex:s}):L(n)&&l[n]&&(a=l[n]({record:r,rowIndex:s})),a&&b(fe,{class:`${o}-expanded-row`},{default:()=>[a]})}const re=P({setup(e,{slots:l}){const{props:t,slots:o,mergedPrefixCls:n,flattedData:r,expandable:s,scrollWidth:a,scrollHeight:c,isSticky:i}=F(H),u=m(()=>a.value||c.value||i.value);return()=>{const f=n.value,h=[];o.alert&&h.push(b(fe,{class:`${f}-alert-row`},{default:()=>[o.alert()]}));const g=r.value;return g.length>0?l.default?h.push(...l.default()):g.forEach((v,S)=>{h.push(...ve(Le(v,S,o,s.value,f)))}):h.push(b(fe,{class:`${f}-empty-row`,isEmpty:!0},{default:()=>[b(Ge,{empty:t.empty},o)]})),b("tbody",{class:`${n.value}-tbody`},[u.value&&b(Gt,null,null),h])}}}),al=P({props:Xt,setup(e){const{slots:l,config:t,locale:o,mergedPrefixCls:n}=F(H),r=m(()=>{var d;return(d=e.filterable.multiple)!=null?d:t.columnBase.filterable.multiple}),s=m(()=>{var d;return(d=e.filterable.footer)!=null?d:t.columnBase.filterable.footer}),a=e.activeFilterBy,[c,i]=oe(()=>a);D(()=>e.activeFilterBy,d=>i(d));const[u,f]=oe(!1),h=d=>{f(d),d||e.onUpdateFilterBy(c.value)},g=()=>{f(!1),e.onUpdateFilterBy(c.value)},v=()=>{i(a)},S=d=>{const y=`${n.value}-filterable-menu-label`,x=r.value?he:Te;return b("span",{class:y},[b(x,{checked:d.selected,disabled:d.disabled},null),b("span",{class:`${y}-content`},[d.label])])},C=()=>{const d=[],{customMenu:y,menus:x}=e.filterable;return Q(y)?d.push(y()):L(y)&&l[y]?d.push(l[y]()):d.push(rl(x,r,c,i,S)),s.value&&d.push(cl(o,n,g,v)),d},w=m(()=>{const d=`${n.value}-filterable-trigger`;return V({[d]:!0,[`${d}-active`]:e.activeFilterBy.length>0})}),p=()=>{const{customTrigger:d}=e.filterable;return Q(d)?d():L(d)&&l[d]?l[d]():b("span",{class:w.value,onClick:y=>y.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const d={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return b(ke,d,{default:p,overlay:C})}}}),rl=(e,l,t,o,n)=>{const r={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":o};return b(Be,r,{itemLabel:n})},cl=(e,l,t,o)=>{const{filterConfirm:n,filterReset:r}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(be,{mode:"primary",size:"xs",onClick:t},{default:()=>[n]}),b(be,{size:"xs",onClick:o},{default:()=>[r]})])},ul=P({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:o,currentPageAllSelected:n,currentPageSomeSelected:r,handleHeadSelectChange:s,mergedSelectableMenus:a,handleSelectableMenuClick:c}=F(H),i=m(()=>{const C=l.value.size;return C===0||C===o.value.disabledRowKeys.length}),[u,f]=oe(!1),h={"onUpdate:visible":f,trigger:"click"},g=()=>b(Be,{dataSource:a.value,onClick:c},null),v=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),S=()=>{if(a.value.length!==0)return b(ke,h,{default:v,overlay:g})};return()=>{const{multiple:C}=t.value;if(!!C)return b("span",{class:`${e.value}-cell-triggers`},[b(he,{checked:n.value,indeterminate:r.value,disabled:i.value,onChange:s},null),S()])}}}),il=P({props:Vt,setup(e){const{locale:l,mergedPrefixCls:t}=F(H);return()=>{const{activeOrderBy:o,sortable:n}=e,{orders:r,nextTooltip:s}=n,a=s&&dl(l.table,r,o),c=fl(t,r,o);return a?b(Qe,{title:a},{default:()=>[c]}):c}}});function dl(e,l,t){const o=t?l[l.indexOf(t)+1]:l[0],{sortCancel:n,sortAsc:r,sortDesc:s}=e;return o?o==="ascend"?r:s:n}function fl(e,l,t){const o=e.value,n=`${o}-sortable-trigger-active`,r=l.includes("ascend")&&b(te,{name:"caret-up-filled",class:t==="ascend"?n:void 0},null),s=l.includes("descend")&&b(te,{name:"caret-down-filled",class:t==="descend"?n:void 0},null);return b("span",{class:`${o}-sortable-trigger`},[r,s])}const vl=P({props:Lt,setup(e){const{props:l,slots:t,mergedPrefixCls:o,fixedColumnKeys:n,columnOffsetsWithScrollBar:r,isSticky:s,handleSort:a,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(H),f=m(()=>{const{type:p,ellipsis:d}=e.column;return p||d!=null?d:l.ellipsis}),h=m(()=>{const{type:p,align:d,fixed:y,hasChildren:x,key:k,sortable:T,filterable:B}=e.column,$=o.value;let I={[`${$}-cell`]:!0,[`${$}-cell-${p}`]:!!p,[`${$}-cell-filterable`]:!!B,[`${$}-cell-sortable`]:!!T,[`${$}-cell-align-center`]:x||d==="center",[`${$}-cell-align-end`]:!x&&d==="end",[`${$}-cell-ellipsis`]:!!f.value};if(y){const{lastStartKey:A,firstEndKey:E}=n.value;I={...I,[`${$}-fix-start`]:y==="start",[`${$}-fix-start-last`]:A===k,[`${$}-fix-end`]:y==="end",[`${$}-fix-end-first`]:E===k,[`${$}-fix-sticky`]:s.value}}return V(I)}),g=m(()=>{const{fixed:p,colStart:d,colEnd:y}=e.column;if(!p)return;const{starts:x,ends:k}=r.value,$=_((p==="start"?x:k)[p==="start"?d:y]);return{position:"sticky",left:p==="start"?$:void 0,right:p==="end"?$:void 0}}),v=m(()=>c[e.column.key]),S=m(()=>i[e.column.key]),C=p=>{const{key:d,filterable:y}=e.column;u(d,y,p)},w=()=>{const{key:p,sortable:d}=e.column;d&&a(p,d)};return()=>{var E,z,K;const{column:p}=e,{type:d,titleColSpan:y,titleRowSpan:x}=p;if(d==="scroll-bar")return b("th",{class:h.value,style:g.value,colspan:y===1?void 0:y,rowspan:x===1?void 0:x,onClick:w},null);const k=o.value;let T,B;if(d==="selectable")B=b(ul,null,null);else{const{title:W,customTitle:R,sortable:N,filterable:X}=p,j=f.value;B=hl(W,R,t),T=We(j,B,W);const U=yl(N,v,X,S,C);U.length>0?B=b("span",{class:`${k}-cell-triggers`},[b("span",{class:`${k}-cell-title`},[B]),U]):j&&(B=b("span",{class:`${k}-cell-title`},[B]))}const $=(E=l.customAdditional)==null?void 0:E.headCell,I=$?$({column:p}):void 0,A=(K=(z=l.customTag)==null?void 0:z.headCell)!=null?K:"th";return b(A,J({class:h.value,style:g.value,colSpan:y===1?void 0:y,rowSpan:x===1?void 0:x,title:T},I,{onClick:w}),{default:()=>[B]})}}});function hl(e,l,t){let o=e;return Q(l)?o=l({title:e}):L(l)&&t[l]&&(o=t[l]({title:e})),o}function yl(e,l,t,o,n){const r=[];return e&&r.push(b(il,{activeOrderBy:l.value,sortable:e},null)),t&&r.push(b(al,{activeFilterBy:o.value,filterable:t,onUpdateFilterBy:n},null)),r}const pl=P({props:Nt,setup(e){const{props:l,mergedPrefixCls:t}=F(H);return()=>{var a,c,i;const{columns:o}=e,n=(a=l.customAdditional)==null?void 0:a.headRow,r=n?n({columns:o}):void 0,s=(i=(c=l.customTag)==null?void 0:c.headRow)!=null?i:"tr";return b(s,J({class:`${t.value}-row`},r),{default:()=>[o.filter(u=>u.titleColSpan!==0).map(u=>b(vl,{key:u.key,column:u},null))]})}}}),Ce=P({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(H);return()=>{var a,c,i;const o=l.value,n=(a=e.customAdditional)==null?void 0:a.head,r=n?n({rows:o}):void 0,s=(i=(c=e.customTag)==null?void 0:c.head)!=null?i:"thead";return b(s,J({class:`${t.value}-thead`},r),{default:()=>[o.map((u,f)=>b(pl,{key:f,columns:u},null))]})}}});P({setup(){return()=>b("tfoot",null,null)}});const gl={sm:32,md:40,lg:56},ml=P({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:o,mergedSize:n,mergedAutoHeight:r,columnWidths:s,changeColumnWidth:a,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:f,scrollBodyRef:h,scrollContentRef:g,handleScroll:v,pingedStart:S,pingedEnd:C,scrollWidth:w,scrollHeight:p,hasFixed:d,tableLayout:y}=F(H),x=O(),k=O(0);$e(ge,{mainTableWidth:k,changeColumnWidth:(K,W)=>{tt(x.value)&&a(K,W)}});const B=()=>{const K=q(h);K&&v({currentTarget:K})},$=K=>{const{offsetWidth:W}=K.target;W!==k.value&&(k.value=W)};se(()=>{B(),D([()=>e.dataSource,w],([,W])=>{W&&B()}),D(s,Ke(()=>{var R;((R=q(h))==null?void 0:R.scrollLeft)===0&&B()},16)),Ze(x.value,$)}),Z(()=>Je(x.value,$));const I=m(()=>{const K=o.value;return V({[`${K}-container`]:!0,[`${K}-ping-start`]:S.value,[`${K}-ping-end`]:C.value,[`${K}-fixed-layout`]:y.value==="fixed",[`${K}-fixed-column`]:d.value,[`${K}-scroll-horizontal`]:w.value,[`${K}-scroll-vertical`]:p.value})}),A=m(()=>{var j;const K=w.value,W=p.value,R=K?"auto":void 0,N=e.virtual?"hidden":W?"scroll":K?"hidden":void 0,X=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:R,overflowY:N,[X?"height":"maxHeight"]:W}}),E=m(()=>({tableLayout:y.value,width:w.value,minWidth:w.value?"100%":void 0})),z=(K,W,R)=>{M(e.onScrolledChange,K,W,R.map(N=>N.record))};return()=>{const K=o.value,W=r.value,R=l.default?l.default():[];if(W||p.value||i.value){const{offsetTop:N}=u.value;if(e.headless||R.push(b(zt,{offsetTop:N},{default:()=>[b(Ce,null,null)]})),e.virtual&&(e.scroll||W)){const X=({item:ae,index:Ue})=>Le(ae,Ue,l,t.value,K),j=ae=>b("table",{ref:g,class:`${K}-table`,style:E.value},[b(ne,null,null),b(re,null,{default:()=>[ae]}),!1]),{scroll:U,onScrolledBottom:je}=e;R.push(b(et,{ref:f,style:A.value,dataSource:c.value,fullHeight:U==null?void 0:U.fullHeight,getKey:"rowKey",height:r.value?"100%":U==null?void 0:U.height,itemHeight:gl[n.value],itemRender:X,contentRender:j,virtual:!0,onScroll:v,onScrolledBottom:je,onScrolledChange:z},null))}else R.push(b("div",{ref:h,class:`${K}-content`,style:A.value,onScroll:v},[b("table",{ref:g,class:`${K}-table`,style:E.value},[b(ne,null,null),b(re,null,null),!1])]));i.value&&R.push(b(_t,null,null))}else R.push(b("div",{ref:h,class:`${K}-content`,style:A.value,onScroll:v},[b("table",{ref:g,class:`${K}-table`,style:E.value},[b(ne,null,null),!e.headless&&b(Ce,null,null),b(re,null,null),!1])]));return b("div",{ref:x,class:I.value},[R])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bl(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function Sl(e,l,t){let o=null,n=null;if(e!==null){const{position:r}=e,[s,a]=ut(r).split("-"),c=`${t}-pagination ${t}-pagination-${a}`,i=b(dt,J({class:c,total:l.length},e),null);o=s==="top"?i:null,n=s==="bottom"?i:null}return[o,n]}const xl=P({name:"IxTable",props:Dt,setup(e,{expose:l,slots:t}){const o=le("common"),n=m(()=>`${o.prefixCls}-table`),r=le("locale"),s=le("table"),a=m(()=>{var E;return(E=e.autoHeight)!=null?E:s.autoHeight}),c=m(()=>{var E;return(E=e.childrenKey)!=null?E:s.childrenKey}),i=lt(e,s),u=m(()=>{var E;return(E=e.emptyCell)!=null?E:s.emptyCell}),f=m(()=>{var E;return(E=e.size)!=null?E:s.size}),{mergedPagination:h}=wt(e,s,f),g=At(e),v=kt(e,a,g),S=vt(e,t,s,v.scrollBarSizeOnFixedHolder),C=It(S.flattedColumns),w=Ct(S.flattedColumns),p=xt(e,S.flattedColumns),d=Ht(e,S,v,g.isSticky,a),{activeSorters:y}=C,{activeFilters:x}=w,k=St(e,c,i,y,x,p.expandedRowKeys,h),T=Ot(e,r,S.flattedColumns,k);Et(e,s,h,y,x,v.scrollTo);const B={props:e,slots:t,config:s,locale:r,mergedPrefixCls:n,mergedEmptyCell:u,mergedSize:f,mergedAutoHeight:a,...S,...v,...C,...w,...g,tableLayout:d,mergedPagination:h,...p,...k,...T};$e(H,B),l({scrollTo:v.scrollTo});const{flattedData:$,filteredData:I}=k,A=m(()=>{const E=n.value,{borderless:z=s.borderless,scroll:K}=e;return V({[E]:!0,[`${E}-auto-height`]:a.value,[`${E}-borderless`]:z,[`${E}-empty`]:$.value.length===0,[`${E}-full-height`]:K==null?void 0:K.fullHeight,[`${E}-${f.value}`]:!0})});return()=>{const E=n.value,z=b(nt,{header:e.header},t),K=bl(t,E),[W,R]=Sl(h.value,I.value,E),N=[z,W,b(ml,null,null),K,R],X=Cl(e.spin),j=X?b(ot,X,{default:()=>[N]}):N;return b("div",{class:A.value},[j])}}});function Cl(e){return it(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const El=xl,$l=pe;export{El as I,$l as a,ft as g};
