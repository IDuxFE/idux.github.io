import{M as Be,N as fe,aN as Qe,am as ke,m as L,L as le,aH as D,aO as ce,o as X,D as ie,a2 as Je,K as oe,a1 as ee,$ as G,a3 as pe,aP as Ze,A as te,j as he,ar as et,X as Ke,W as $e,c as me,aa as tt,ap as lt,E as nt,G as ot,H as st,aQ as at,as as rt,ao as ct,aC as it}from"./index-25c9e6c5.js";import{b as Ee,f as j,N as ut,T as dt,c as x,m as ve,r as P,w as z,a9 as Te,H as Ie,d as Y,Q as J,y as se,bk as ft,S as ht,x as H,l as F,z as V,A as m,ag as vt,i as Q,a4 as Z,q as Pe,$ as yt,an as gt}from"./vendor-9ef21769.js";import{b as Oe}from"./GlobalCodeBox-25180b13.js";import{I as pt}from"./index-8d268409.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const We=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[We]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,l,t){if(!e||Ee(e)&&e.title===!1)return;if(j(l)||ut(l))return l;const n=Be(l).find(o=>o.type===dt);return n?n.children:t}function mt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Qe("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bt(e,l,t,n){const o=x(()=>{var w;const{columns:C}=e;return Fe(C&&C.length>0?C:He((w=l.default)==null?void 0:w.call(l)),t)}),{flattedColumns:a,scrollBarColumn:r,flattedColumnsWithScrollBar:s}=St(o,n),i=Ct(s),u=x(()=>!!e.ellipsis||a.value.some(C=>C.ellipsis)),c=x(()=>a.value.some(C=>C.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y}=wt(a,r),{columnOffsets:v,columnOffsetsWithScrollBar:p}=Bt(d,h),S=x(()=>kt(o.value,r.value));return{flattedColumns:a,scrollBarColumn:r,flattedColumnsWithScrollBar:s,fixedColumnKeys:i,hasEllipsis:u,hasFixed:c,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y,columnOffsets:v,columnOffsetsWithScrollBar:p,mergedRows:S}}function Fe(e,l){return e.map(t=>xt(t,l))}function He(e){const l=[];return Be(e,{key:We}).forEach((t,n)=>{const{props:o,children:a}=t,{key:r=n,editable:s,ellipsis:i,...u}=o||{};u.key=r,u.editable=s||s==="",u.ellipsis=i||i==="";const{default:c,cell:d,title:h,expand:y,icon:v}=a||{};c&&(u.children=He(c())),d&&(u.customCell=d),h&&(u.customTitle=h),y&&(u.customExpand=y),v&&(u.customIcon=v),l.push(u)}),l}function xt(e,l){var i,u;const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:a}=l,{align:r=t.align}=e,s=mt(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{showLine:d=n.showLine,icon:h=n.icon}=e;return{...e,key:s,align:r,icon:h,showLine:d}}if(c==="selectable"){const{multiple:d=!0,showIndex:h=o.showIndex}=e;return{...e,key:s,align:r,multiple:d,showIndex:h}}if(c==="indexable"){const d=(u=(i=e.align)!=null?i:a.align)!=null?u:t.align;return{...a,...e,align:d,key:s}}return{...e,key:s,align:r}}else{const{sortable:c,filterable:d,children:h}=e,y={...e,key:s,align:r};return c&&(y.sortable={...t.sortable,...c}),d&&(y.filterable={...t.filterable,...d}),h!=null&&h.length&&(y.children=Fe(h,l)),y}}function St(e,l){const t=x(()=>Ae(e.value)),n=x(()=>{const a=l.value;if(a===0)return;const r=t.value,s=r[r.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:s&&s.fixed,width:a}}),o=x(()=>{const a=t.value;if(a.length===0)return a;const r=n.value;return r?[...a,r]:a});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let a=Ae(o);n&&(a=a.map(r=>({fixed:n,...r}))),l.push(...a)}else l.push(t)}),l}function Ct(e){return x(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:a}=n;o==="start"?l=a:o==="end"&&(t||(t=a))}),{lastStartKey:l,firstEndKey:t}})}function wt(e,l){const t=ve({}),n=P(),o=P([]);z(n,Te(s=>{o.value=s?s.split("-").map(Number):[]},16)),Ie(()=>{const s=Object.keys(t),i=e.value;if(s.length!==i.length){n.value=void 0;return}n.value=i.map(u=>t[u.key]).join("-")});const a=x(()=>{const s=o.value;if(s.length===0)return s;const i=l.value;return i?[...s,i.width]:s});return{columnWidths:o,columnWidthsWithScrollBar:a,changeColumnWidth:(s,i)=>{i===!1?delete t[s]:t[s]=i}}}function Bt(e,l){const t=x(()=>be(e.value)),n=x(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,a=0;for(let r=0;r<l;r++){t[r]=o,o+=e[r]||0;const s=l-r-1;n[s]=a,a+=e[s]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(r,s,i){var d;(d=t[i])!=null||(t[i]=[]);let u=s;return r.map(h=>{var C;let y=(C=h.titleColSpan)!=null?C:1,v=!1;const p=h.children;if(p!=null&&p.length){v=!0;const w=n(p,u,i+1);Y(h.titleColSpan)&&(y=w.reduce((f,g)=>f+g))}const S=u+y-1;return t[i].push({...h,titleColSpan:y,colStart:u,colEnd:S,hasChildren:v}),u+=y,y})}const o=l?[...e,l]:e;n(o,0,0);const a=t.length;return t.forEach((r,s)=>{r.forEach(i=>{i.hasChildren||(i.titleRowSpan=a-s)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l,t,n,o,a,r){const s=x(()=>{const p=l.value,S=t.value;return e.dataSource.map((C,w)=>Ne(C,S,p,w,e.dataSource.length))}),i=x(()=>{const p=new Map;return ue(s.value,p),p}),u=x(()=>Me(s.value,o.value,a.value)),c=x(()=>Le(u.value,n.value,a.value)),d=x(()=>{const p=r.value,S=c.value;if(p===null||!p.pageSize)return S;{const{total:C}=p;if(C&&S.length<C)return S;const w=p.pageSize,f=(p.pageIndex-1)*w;return S.slice(f,f+w)}}),h=x(()=>{const p=new Map;return ue(d.value,p),p}),y=x(()=>{const p=a.value;return p.length>0?_e(d.value,p,0):d.value});return{isTreeData:x(()=>s.value.some(p=>{var S;return(S=p.children)==null?void 0:S.length})),filteredData:u,flattedData:y,mergedMap:i,paginatedMap:h}}function Ne(e,l,t,n,o,a){var u;const r=l(e),s={record:e,rowKey:r,parentKey:a==null?void 0:a[0].rowKey,showLineIndentIndexList:(u=[...a!=null?a:[]].reverse())==null?void 0:u.reduce((c,d,h)=>(d.hasNextSibling&&c.push(h),c),[]),hasPrevSibling:n>0,hasNextSibling:n<o-1},i=e[t];return i&&(s.children=i.map((c,d)=>Ne(c,l,t,d,i.length,[s,...a!=null?a:[]]))),s}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function Le(e,l,t){const n=l.filter(r=>r.sorter),o=n.length;if(o===0)return e;const a=e.slice();return a.forEach(r=>{t.includes(r.rowKey)&&r.children&&r.children.length>0&&(r.children=Le(r.children,l,t))}),a.sort((r,s)=>{for(let i=0;i<o;i++){const{orderBy:u,sorter:c}=n[i],d=c(r.record,s.record);if(d!==0)return u==="ascend"?d:-d}return 0})}function Me(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const a=n.every(({filter:c,filterBy:d})=>c(d,o.record)),{rowKey:r,children:s}=o,i=t.includes(r);let u=o;if(i&&s&&s.length){const c=Me(s,l,t);c.length!==s.length&&(u={...o,children:c})}return a||i&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function _e(e,l,t){return e.reduce((n,o)=>{const{children:a,parentKey:r,record:s,rowKey:i,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:d}=o,h=l.includes(i);if(n.push({children:a,parentKey:r,record:s,rowKey:i,level:t,expanded:h,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:d}),h&&o.children){const y=_e(o.children,l,t+1);n.push(...y)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l){const t=x(()=>l.value.find(s=>"type"in s&&s.type==="expandable")),[n,o]=ke(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:s=>{if(!t.value)return!0;const{disabled:i,customExpand:u}=t.value,{record:c}=s;return i!=null&&i(c)?!0:!(u||s.children&&s.children.length>0)},handleExpandChange:(s,i)=>{const{onChange:u,onExpand:c}=t.value||{},d=[...n.value],h=d.indexOf(s),y=h>=0;y?d.splice(h,1):d.push(s),L(c,!y,i),o(d),L(u,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=x(()=>e.value.filter(a=>a.filterable)),t=ve({}),n=P([]);return z(l,(a,r)=>{a.forEach(s=>{const{key:i,filterable:u}=s,c=u.filterBy;if(c||t[i]===void 0){t[i]=c||[];return}const d=r?r.find(y=>y.key===i):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[i]=[])}),n.value=xe(a,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(a,r,s)=>{const{onChange:i}=r;t[a]=s,n.value=xe(l.value,t),L(i,s,n.value)}}}function xe(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:a,filterBy:r=l[n]}=o;return{key:n,filter:a,filterBy:r}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t){var u,c,d,h,y;const n=le("pagination"),o=x(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),a=P((c=(u=o.value)==null?void 0:u.pageIndex)!=null?c:1),r=P((y=(h=(d=o.value)==null?void 0:d.pageSize)!=null?h:l.pagination.pageSize)!=null?y:n.pageSize),s=(v,p)=>{var S;a.value=v,r.value=p,L((S=o.value)==null?void 0:S.onChange,v,p)};return{mergedPagination:x(()=>{var p,S;const v=o.value;return v===null?null:{...l.pagination,size:t.value,...v,pageIndex:(p=v.pageIndex)!=null?p:a.value,pageSize:(S=v.pageSize)!=null?S:r.value,onChange:s}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e,l,{setStickyScrollLeft:t}){const n=P(),o=P(),a=P(),r=P(),s=P();z(n,C=>{C&&(a.value=C.holderRef.value)});const{handleScroll:i,pingedStart:u,pingedEnd:c}=Pt(e,o,a,s,t),d=Ot(e,l,a,r),h=x(()=>{var C;return D((C=e.scroll)==null?void 0:C.width)}),y=x(()=>{var w;let C=D((w=e.scroll)==null?void 0:w.height);return!C&&l.value&&(e.virtual||d.value)&&(C="auto"),C}),v=x(()=>ce(X(a))),p=x(()=>y.value?v.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:a,scrollContentRef:r,scrollFootRef:s,handleScroll:i,scrollTo:C=>{var w;e.virtual?(w=n.value)==null||w.scrollTo(C):typeof C=="number"&&Je({target:X(a),top:C,duration:200})},pingedStart:u,pingedEnd:c,scrollWidth:h,scrollHeight:y,scrollBarSize:v,scrollBarSizeOnFixedHolder:p}}function Pt(e,l,t,n,o){const a=P(!1),r=P(!1);let s;const i=()=>{s&&(clearTimeout(s),s=void 0)};J(()=>i());const u=P(),c=v=>{u.value=v,i(),s=setTimeout(()=>{u.value=void 0,s=void 0},100)},d=(v,p)=>{p&&p.scrollLeft!==v&&(p.scrollLeft=v)},h=v=>{const p=X(t);if(!p)return;const{clientWidth:S,scrollWidth:C}=p;o(v/C*S||0)};return{handleScroll:(v,p)=>{const S=v==null?void 0:v.currentTarget,C=p!=null?p:S.scrollLeft,w=u.value;if((!w||w===S)&&(c(S),d(C,l.value),d(C,X(t)),d(C,n.value),h(C)),S){const{scrollWidth:f,clientWidth:g}=S;a.value=C>0,r.value=C<f-g}(v==null?void 0:v.type)==="scroll"&&L(e.onScroll,v)},pingedStart:a,pingedEnd:r}}function Ot(e,l,t,n){const o=P(!0),a=()=>{const i=X(t.value);i?o.value=i.scrollHeight>i.clientHeight:o.value=!1};let r=[];const s=()=>r.forEach(i=>i());return se(()=>{z([l,()=>e.virtual],([i,u])=>{s(),i&&!u&&(r=[ie(t,a),ie(n,a)])},{immediate:!0})}),J(()=>s()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Wt(e,l,t,n,o,a){const r=x(()=>{var c;return(c=e.scrollToTopOnChange)!=null?c:l.scrollToTopOnChange});let s=[];const i=()=>{s=[z([()=>{var c;return(c=t.value)==null?void 0:c.pageIndex},()=>{var c;return(c=t.value)==null?void 0:c.pageSize}],()=>a(0)),z([o,n],([c,d],[h,y])=>{(!Rt(c,h)||!Ft(d,y))&&a(0)})]},u=()=>{s.forEach(c=>c())};z(r,c=>{u(),c&&i()},{immediate:!0})}function Rt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Ft(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e,l,t,{mergedMap:n,paginatedMap:o}){const a=x(()=>t.value.find(f=>"type"in f&&f.type==="selectable")),[r,s]=ke(e,"selectedRowKeys",()=>[]),i=x(()=>{const{disabled:f}=a.value||{},g=[],b=[];return o.value.forEach((B,k)=>{f!=null&&f(B.record)?b.push(k):g.push(k)}),{enabledRowKeys:g,disabledRowKeys:b}}),u=x(()=>{const f=new Set,g=r.value,{disabledRowKeys:b}=i.value,B=n.value;return g.forEach(k=>{const{parentKey:K}=B.get(k)||{};if(!Y(K)){let $=B.get(K);if($&&!g.includes($.rowKey))for(;$&&!Y($==null?void 0:$.rowKey);)b.includes($.rowKey)||f.add($.rowKey),$=Y($.parentKey)?void 0:B.get($.parentKey)}}),[...f]}),c=x(()=>{const f=r.value,{disabledRowKeys:g}=i.value;let b=0;return o.value.forEach((B,k)=>{!g.includes(k)&&f.includes(k)&&b++},0),b}),d=x(()=>{const f=o.value.size,g=i.value.disabledRowKeys.length;return f===0||f===g?!1:f===g+c.value}),h=x(()=>!d.value&&c.value>0),y=new Map,v=f=>{s(f);const g=n.value,{onChange:b}=a.value||{};if(b){const B=[];y.forEach((k,K)=>{f.includes(K)||y.delete(K)}),f.forEach(k=>{let K=g.get(k);K?y.set(k,K):K=y.get(k),K&&B.push(K.record)}),L(b,f,B)}},p=(f,g)=>{const b=n.value,{disabledRowKeys:B}=i.value,{multiple:k,onSelect:K}=a.value||{};let $=[...r.value];const O=$.indexOf(f),W=O>=0;if(k){const A=b.get(f),T=De(A,B);if(W){$.splice(O,1);const E=At(b,A,B);$=$.filter(I=>!E.includes(I)&&!T.includes(I))}else $.push(f),$.push(...T);Nt(b,A,$,B)}else $=W?[]:[f];L(K,!W,g),v($)},S=()=>{const{enabledRowKeys:f}=i.value,g=new Set(r.value);d.value?f.forEach(b=>g.delete(b)):f.forEach(b=>g.add(b)),v([...g])},C=Lt(a,l),w=Mt(a,n,o,r,v);return{selectable:a,selectedRowKeys:r,indeterminateRowKeys:u,currentPageRowKeys:i,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:p,handleHeadSelectChange:S,mergedSelectableMenus:C,handleSelectableMenuClick:w}}function De(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:a}=o;l.includes(a)||t.push(o.rowKey),t.push(...De(o,l))}),t}function At(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function Nt(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const a=e.get(l.parentKey);if(a&&!n.includes(l.parentKey)){o=a.children.every(s=>n.includes(s.rowKey)||t.includes(s.rowKey));const r=t.findIndex(s=>s===l.parentKey);o?r<0&&t.push(l.parentKey):r>-1&&t.splice(r,1)}l=a}}const ze=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Lt(e,l){return x(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:a,selectPageInvert:r}=l.table;return t.map(s=>j(s)?s==="all"?{type:"item",key:ze,label:n}:s==="invert"?{type:"item",key:je,label:o}:s==="none"?{type:"item",key:Ue,label:a}:s==="pageInvert"?{type:"item",key:qe,label:r}:{type:"item",key:s,label:s}:s)})}function Mt(e,l,t,n,o){const a=()=>{const{disabled:c,onSelectAll:d}=e.value||{},h=[];l.value.forEach((y,v)=>{c!=null&&c(y.record)||h.push(v)}),L(d,h),o(h)},r=()=>{const{disabled:c,onSelectInvert:d}=e.value||{},h=[...n.value];l.value.forEach((y,v)=>{if(c!=null&&c(y.record))return;const p=h.indexOf(v);p>=0?h.splice(p,1):h.push(v)}),o(h),L(d,h)},s=()=>{const{onSelectNone:c}=e.value||{};L(c),o([])},i=()=>{const{disabled:c,onSelectPageInvert:d}=e.value||{},h=[],y=n.value;t.value.forEach((v,p)=>{c!=null&&c(v.record)||y.includes(p)||h.push(p)}),L(d,h),o(h)},u=new Map([[ze,a],[je,r],[Ue,s],[qe,i]]);return c=>{const d=c.key;if(ft(d)&&u.has(d)){u.get(d)();return}const{disabled:h,onMenuClick:y}=e.value||{};if(!y)return;const v=[];t.value.forEach((p,S)=>{h!=null&&h(p.record)||v.push(S)}),L(y,c,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function _t(e){const l=x(()=>e.value.filter(r=>r.sortable)),t=x(()=>l.value.some(r=>r.sortable.multiple!==void 0)),n=ve({}),o=P([]);return z(l,(r,s)=>{r.forEach(i=>{const{key:u,sortable:c}=i,d=c.orderBy;if(d||n[u]===void 0){n[u]=d;return}const h=s?s.find(v=>v.key===u):void 0;(h==null?void 0:h.sortable.orderBy)&&(n[u]=void 0)}),o.value=Ce(r,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(r,s)=>{const{orders:i,onChange:u}=s,c=n[r],d=c?Se(i,c):Se(i);t.value?n[r]=d:Object.keys(n).forEach(h=>{r===h?n[h]=d:n[h]=void 0}),o.value=Ce(l.value,n),L(u,d,o.value)}}}function Se(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:a=0,orderBy:r=l[n],sorter:s}=o;return{key:n,multiple:a,orderBy:r,sorter:s}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=x(()=>!!e.sticky),t=x(()=>{const{sticky:a}=e,{offsetTop:r=0,offsetBottom:s=0,offsetScroll:i=0,container:u=window}=ht(a)?a:{};return{offsetTop:r,offsetBottom:s,offsetScroll:i,container:u}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},a,r){return x(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||r.value||a.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const N=Symbol("TABLE_TOKEN"),ge=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:a}=F(N);return()=>{const{isFixedHolder:r}=e,s=r?t.value:l.value;if(s.every(c=>!c.width&&!c.type))return;const i=a.value,u=s.map((c,d)=>{const{key:h,type:y}=c,v=r?n.value[d]:c.width,p=y?V({[`${i}-col-${y}`]:!0,[`${i}-col-with-dropdown`]:y==="selectable"&&o.value.length>0}):void 0;let S;return r?S=v?`width: ${D(v)}`:void 0:S={width:D(v),minWidth:D(c.minWidth),maxWidth:D(c.maxWidth)},m("col",{key:h,class:p,style:S},null)});return m("colgroup",null,[u])}}}),jt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:a,flattedData:r,isSticky:s,columnWidths:i}=F(N);Ut(n,o);const u=x(()=>a.value==="max-content"),c=x(()=>r.value.length>0),d=x(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:s.value}}),h=x(()=>{const v=s.value,{offsetTop:p,offsetBottom:S}=e;return{overflow:"hidden",top:v?D(p):void 0,bottom:v?D(S):void 0}}),y=x(()=>({tableLayout:"fixed",visibility:c.value&&!i.value.length?"hidden":void 0}));return()=>m("div",{class:d.value,style:h.value,ref:n},[m("table",{style:y.value},[(c.value||!u.value)&&m(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function Ut(e,l){const t=n=>{const o=n.deltaX,a=n.currentTarget;if(o){const r=a.scrollLeft+o;l(n,r),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),J(()=>G(e.value,"wheel",t))}const qt=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:a}=F(N),r=P(!1),s=P(!1),i=P(0),u=P(0),c=P(0),d=x(()=>{const f=u.value,g=c.value;return g&&f*(f/g)});Ie(()=>{const f=X(l);if(f&&r.value){const{clientWidth:g,scrollWidth:b,scrollLeft:B}=f;a(B/b*g),u.value=g,c.value=b}});const h=x(()=>({height:ce(),width:u.value,bottom:n.value.offsetScroll})),y=x(()=>{const f=e.value;return{[`${f}-sticky-scrollbar-thumb`]:!0,[`${f}-sticky-scrollbar-thumb-active`]:s.value}}),v=x(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),p=()=>s.value=!1,S=f=>{i.value=f.pageX-o.value,s.value=!0,f.preventDefault()},C=f=>{if(!s.value)return;const{buttons:g}=f||window.event;if(g===0){s.value=!1;return}let b=f.pageX-i.value;b<=0&&(b=0);const B=u.value,k=c.value,K=d.value;b+K>=B&&(b=B-K);const $=b/B*(k+2);t(f,$)},w=()=>{const f=X(l),g=pe(f).top,b=g+f.offsetHeight,{container:B,offsetScroll:k}=n.value,K=B===window?document.documentElement.scrollTop+window.innerHeight:pe(B).top+B.clientHeight;b-ce()<=K||g>=K-k?r.value=!1:r.value=!0};return se(()=>{ee(document.body,"mouseup",p),ee(document.body,"mousemove",C),ee(window,"resize",w),z(()=>n.value.container,(f,g)=>{G(g,"scroll",w),ee(f,"scroll",w)},{immediate:!0}),w()}),J(()=>{G(document.body,"mouseup",p),G(document.body,"mousemove",C),G(window,"resize",w),G(n.value.container,"scroll",w)}),()=>!l.value||!r.value||c.value<=u.value||!d.value?null:m("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[m("div",{class:y.value,style:v.value,onMousedown:S},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:a,scrollBarColumn:r}=F(N),{mainTableWidth:s}=F(ge),i=x(()=>n.value.length);return()=>{let u=l.default();if(e.isEmpty?a.value:o.value){const c=r.value;u=m("div",{class:`${t.value}-fixed-row`,style:{width:D(s.value-(c?c.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return m("tr",null,[m("td",{colSpan:i.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Xt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Vt={columns:{type:Array,required:!0}},Gt={column:{type:Object,required:!0}},Yt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Qt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Zt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},el={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},tl=H({props:Jt,setup(e){const l=P();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),J(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>m("td",{ref:l,style:{padding:0,border:0,height:0}},[m("div",{style:{height:0,overflow:"hidden"}},[vt(" ")])])}}),ll=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(N),{changeColumnWidth:t}=F(ge);return()=>{const n=l.value.map(o=>{const{key:a}=o;return m(tl,{key:a,cellKey:a,changeColumnWidth:t},null)});return m("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),nl=H({props:Qt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:a,activeOrderByMap:r,fixedColumnKeys:s,columnOffsets:i,isSticky:u,isTreeData:c,expandable:d,selectable:h,mergedPagination:y}=F(N),v=x(()=>r[e.column.key]),p=ol(e),S=x(()=>s.value.lastStartKey===e.column.key),C=x(()=>s.value.firstEndKey===e.column.key),w=x(()=>{const{type:b,ellipsis:B}=e.column;return b||B!=null?B:l.ellipsis}),f=x(()=>{const{fixed:b,align:B}=e.column,k=o.value;let K={[`${k}-cell`]:!0,[`${k}-cell-sorted`]:!!v.value,[`${k}-cell-align-${B}`]:!!B&&B!="start",[`${k}-cell-ellipsis`]:!!w.value};return b&&(K={...K,[`${k}-fix-start`]:b==="start",[`${k}-fix-start-last`]:S.value,[`${k}-fix-end`]:b==="end",[`${k}-fix-end-first`]:C.value,[`${k}-fix-sticky`]:u.value}),V(K)}),g=x(()=>{const{fixed:b}=e.column;if(!b)return;const{starts:B,ends:k}=i.value,$=D((b==="start"?B:k)[e.colIndex]);return{position:"sticky",left:b==="start"?$:void 0,right:b==="end"?$:void 0}});return()=>{var T,E,I;const{column:b}=e,{type:B}=b;let k,K;if(B==="selectable")k=rl(e,t,h,n,y);else if(B==="indexable")k=Xe(e,t,b,y);else{const R=p.value;if(k=sl(e,t,R),K=Re(w.value,k,R),!B&&(Y(k)||k==="")){const M=t.emptyCell||a.value;k=Q(M)?M({column:b,record:e.record,rowIndex:e.rowIndex}):M}}e.column.fixed&&w.value&&(S.value||C.value)&&(k=m("span",{class:`${o.value}-cell-content`},[k]));const $=(T=l.customAdditional)==null?void 0:T.bodyCell,O=$?$({column:b,record:e.record,rowIndex:e.rowIndex}):void 0,W=(I=(E=l.customTag)==null?void 0:E.bodyCell)!=null?I:"td",A=B==="expandable"?m("div",{class:`${o.value}-expandable-wrapper`},[al(e,t,d,c,o.value),!Ze(k)&&m("span",{class:`${o.value}-expandable-trigger-gap`},null),k]):k;return m(W,Z({class:f.value,style:g.value,title:K},O),{default:()=>[A]})}}});function ol(e){return x(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let a=0;a<n.length&&o;a++){const r=n[a];o=o[r]}return o})}function sl(e,l,t){const{record:n,rowIndex:o,column:a}=e,{customCell:r}=a,s=j(r)?l[r]:r;return s?s({value:t,record:n,rowIndex:o}):t}function al(e,l,t,n,o){var B;const{icon:a,customIcon:r,indent:s,showLine:i}=t.value,{record:u,expanded:c,level:d=0,hasPrevSibling:h,hasNextSibling:y,showLineIndentIndexList:v}=e,p=d>0,S=n.value&&i&&s;let C;const w=(B=j(r)?l[r]:r)!=null?B:a;Q(w)?C=w({expanded:!!c,record:u}):C=j(w)?m(te,{name:w,rotate:c?90:0},null):w;const f=s?`width: ${D(s)}`:void 0,g={[`${o}-expandable-trigger`]:!0,[`${o}-expandable-trigger-show-line`]:S,[`${o}-expandable-trigger-disabled`]:e.disabled},b=[];if(s)for(let k=0;k<d;k++)b.push(m("div",{class:{[`${o}-expandable-indent`]:!0,[`${o}-expandable-indent-show-line`]:S&&v.includes(k)},style:f},null));return[...b,m("span",{class:g,style:f},[m("button",{class:`${o}-expandable-trigger-button`,type:"button",onClick:e.disabled?void 0:e.handleExpend},[C]),S&&[m("span",{class:`${o}-expandable-trigger-line-right`},null),(h||p)&&m("span",{class:`${o}-expandable-trigger-line-top`},null),y&&m("span",{class:`${o}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function rl(e,l,t,n,o){const{record:a,rowIndex:r,selected:s,indeterminate:i,disabled:u,isHover:c,handleSelect:d}=e,{showIndex:h,multiple:y,customCell:v}=t.value,p=C=>{C.stopPropagation(),!y&&s&&!u&&d&&d()};if(!s&&!c&&h)return Xe(e,l,n.columnIndexable,o);const S=j(v)?l[v]:v;if(y){const C={checked:s,disabled:u,indeterminate:i,onChange:d,onClick:p};return S?S({...C,record:a,rowIndex:r}):m(he,C,null)}else{const C={checked:s,disabled:u,onChange:d,onClick:p};return S?S({...C,record:a,rowIndex:r}):m(Oe,C,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:a,disabled:r}=e,{customCell:s}=t,{pageIndex:i=1,pageSize:u=0}=n.value||{},c=j(s)?l[s]:s;return c?m("span",{style:r?"cursor: not-allowed":"cursor: pointer"},[c({record:o,rowIndex:a,pageIndex:i,pageSize:u})]):void 0}const cl=H({props:Yt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:a,checkExpandDisabled:r,selectable:s,selectedRowKeys:i,indeterminateRowKeys:u,handleSelectChange:c,currentPageRowKeys:d}=F(N),{expandDisabled:h,handleExpend:y,selectDisabled:v,handleSelect:p,isHover:S,attrs:C}=il(e,o,r,a,s,c,d),w=x(()=>i.value.includes(e.rowKey)),f=x(()=>u.value.includes(e.rowKey)),g=x(()=>{const b=`${t.value}-row`,{level:B,expanded:k}=e;return V({[`${b}`]:!0,[`${b}-level-${B}`]:!!B,[`${b}-selected`]:w.value,[`${b}-expanded`]:k})});return()=>{var K,$,O;const b=(K=l.customAdditional)==null?void 0:K.bodyRow,B=b?b({record:e.record,rowIndex:e.rowIndex}):void 0,k=(O=($=l.customTag)==null?void 0:$.bodyRow)!=null?O:"tr";return m(k,Z({class:g.value},C.value,B),{default:()=>[ul(e,n,h,y,w,f,v,p,S)]})}}});function il(e,l,t,n,o,a,r){const s=x(()=>t(e.rowData)),i=x(()=>{var g;return(g=l.value)==null?void 0:g.trigger}),u=()=>{const{rowKey:g,record:b}=e;n(g,b)},c=x(()=>r.value.disabledRowKeys.includes(e.rowKey)),d=x(()=>{var g;return(g=o.value)==null?void 0:g.trigger}),h=x(()=>{var g;return(g=o.value)==null?void 0:g.showIndex}),y=P(!1),v=()=>{const{rowKey:g,record:b}=e;a(g,b)},p=()=>{i.value==="click"&&u(),d.value==="click"&&v()},S=()=>{i.value==="dblclick"&&u(),d.value==="dblclick"&&v()},C=()=>y.value=!0,w=()=>y.value=!1,f=x(()=>{const g=s.value,b=i.value,B=c.value,k=d.value,K=!g&&b==="click"||!B&&k==="click",$=!g&&b==="dblclick"||!B&&k==="dblclick",O=!B&&h.value;let W="";return K||$?W="pointer":(g&&b||B&&k)&&(W="not-allowed"),{style:W?`cursor: ${W}`:void 0,onClick:K?p:void 0,onDblclick:$?S:void 0,onMouseenter:O?C:void 0,onMouseleave:O?w:void 0}});return{expandDisabled:s,handleExpend:u,selectDisabled:c,handleSelect:v,isHover:y,attrs:f}}function ul(e,l,t,n,o,a,r,s,i){const u=[],{rowIndex:c,record:d,level:h,hasNextSibling:y,hasPrevSibling:v,showLineIndentIndexList:p}=e;return l.value.forEach((S,C)=>{const{type:w,colSpan:f,rowSpan:g,key:b}=S,B=f==null?void 0:f(d,c),k=g==null?void 0:g(d,c);if(B===0||k===0)return;const K={colSpan:B===1?void 0:B,rowSpan:k===1?void 0:k,rowIndex:c,colIndex:C,record:d,column:S,level:h,hasNextSibling:y,hasPrevSibling:v,showLineIndentIndexList:p,key:b};w==="expandable"?(K.expanded=e.expanded,K.disabled=t.value,K.handleExpend=n):w==="selectable"&&(K.selected=o.value,K.indeterminate=a.value,K.disabled=r.value,K.handleSelect=s,K.isHover=i.value),u.push(m(nl,K,null))}),u}function Ve(e,l,t,n,o){const{children:a,expanded:r,level:s,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,record:d,rowKey:h}=e,y={key:h,expanded:r,level:s,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,hasChildren:!!(a!=null&&a.length),record:d,rowData:e,rowIndex:l,rowKey:h},v=m(cl,y,null),p=r&&dl(y,t,n,o);return p?[v,p]:v}function dl(e,l,t,n){const{customExpand:o}=t||{},{record:a,rowIndex:r}=e;let s;return Q(o)?s=o({record:a,rowIndex:r}):j(o)&&l[o]&&(s=l[o]({record:a,rowIndex:r})),s&&m(de,{class:`${n}-expanded-row`},{default:()=>[s]})}const re=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:a,flattedData:r,expandable:s,scrollWidth:i,scrollHeight:u,isSticky:c}=F(N),d=x(()=>a.value||i.value||u.value||c.value);return()=>{const h=o.value,y=[];n.alert&&y.push(m(de,{class:`${h}-alert-row`},{default:()=>[n.alert()]}));const v=r.value;return v.length>0?l.default?y.push(...l.default()):v.forEach((p,S)=>{y.push(...fe(Ve(p,S,n,s.value,h)))}):y.push(m(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[m(et,{empty:t.empty},n)]})),m("tbody",{class:`${o.value}-tbody`},[d.value&&m(ll,null,null),y])}}}),fl=H({props:Zt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(N),a=x(()=>{var f;return(f=e.filterable.multiple)!=null?f:t.columnBase.filterable.multiple}),r=x(()=>{var f;return(f=e.filterable.footer)!=null?f:t.columnBase.filterable.footer}),s=e.activeFilterBy,[i,u]=oe(()=>s);z(()=>e.activeFilterBy,f=>u(f));const[c,d]=oe(!1),h=f=>{d(f),f||e.onUpdateFilterBy(i.value)},y=()=>{d(!1),e.onUpdateFilterBy(i.value)},v=()=>{u(s)},p=f=>{const g=`${o.value}-filterable-menu-label`,b=a.value?he:Oe;return m("span",{class:g},[m(b,{checked:f.selected,disabled:f.disabled},null),m("span",{class:`${g}-content`},[f.label])])},S=()=>{const f=[],{customMenu:g,menus:b}=e.filterable;return Q(g)?f.push(g({selectedKeys:i.value,setSelectedKeys:u})):j(g)&&l[g]?f.push(l[g]({selectedKeys:i.value,setSelectedKeys:u})):f.push(hl(b,a,i,u,p)),r.value&&f.push(vl(n,o,y,v)),f},C=x(()=>{const f=`${o.value}-filterable-trigger`;return V({[f]:!0,[`${f}-active`]:e.activeFilterBy.length>0})}),w=()=>{const{customTrigger:f}=e.filterable;return Q(f)?f():j(f)&&l[f]?l[f]():m("span",{class:C.value,onClick:g=>g.stopPropagation()},[m(te,{name:"filter-filled"},null)])};return()=>{const f={visible:c.value,hideOnClick:!r.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return m(Ke,f,{default:w,overlay:S})}}}),hl=(e,l,t,n,o)=>{const a={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return m($e,a,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:a}=e.table;return m("div",{class:`${l.value}-filterable-trigger-footer`},[m(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),m(me,{size:"xs",onClick:n},{default:()=>[a]})])},yl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:a,handleHeadSelectChange:r,mergedSelectableMenus:s,handleSelectableMenuClick:i}=F(N),u=x(()=>{const S=l.value.size;return S===0||S===n.value.disabledRowKeys.length}),[c,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},y=()=>m($e,{dataSource:s.value,onClick:i},null),v=()=>m(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:c.value?180:0},null),p=()=>{if(s.value.length!==0)return m(Ke,h,{default:v,overlay:y})};return()=>{const{multiple:S}=t.value;if(S)return m("span",{class:`${e.value}-cell-triggers`},[m(he,{checked:o.value,indeterminate:a.value,disabled:u.value,onChange:r},null),p()])}}}),gl=H({props:el,setup(e){const{locale:l,mergedPrefixCls:t}=F(N);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:a,nextTooltip:r}=o,s=r&&pl(l.table,a,n),i=ml(t,a,n);return s?m(tt,{title:s},{default:()=>[i]}):i}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:a,sortDesc:r}=e;return n?n==="ascend"?a:r:o}function ml(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,a=l.includes("ascend")&&m(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),r=l.includes("descend")&&m(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return m("span",{class:`${n}-sortable-trigger`},[a,r])}const bl=H({props:Gt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:a,isSticky:r,handleSort:s,activeOrderByMap:i,activeFilterByMap:u,handleFilter:c}=F(N),d=x(()=>{const{type:w,ellipsis:f}=e.column,g=w||f!=null?f:l.ellipsis;return Ee(g)&&g.head===!1?void 0:g}),h=x(()=>{const{type:w,align:f,fixed:g,hasChildren:b,key:B,sortable:k,filterable:K}=e.column,$=n.value;let O={[`${$}-cell`]:!0,[`${$}-cell-${w}`]:!!w,[`${$}-cell-filterable`]:!!K,[`${$}-cell-sortable`]:!!k,[`${$}-cell-align-center`]:b||f==="center",[`${$}-cell-align-end`]:!b&&f==="end",[`${$}-cell-ellipsis`]:!!d.value};if(g){const{lastStartKey:W,firstEndKey:A}=o.value;O={...O,[`${$}-fix-start`]:g==="start",[`${$}-fix-start-last`]:W===B,[`${$}-fix-end`]:g==="end",[`${$}-fix-end-first`]:A===B,[`${$}-fix-sticky`]:r.value}}return V(O)}),y=x(()=>{const{fixed:w,colStart:f,colEnd:g}=e.column;if(!w)return;const{starts:b,ends:B}=a.value,$=D((w==="start"?b:B)[w==="start"?f:g]);return{position:"sticky",left:w==="start"?$:void 0,right:w==="end"?$:void 0}}),v=x(()=>i[e.column.key]),p=x(()=>u[e.column.key]||lt),S=w=>{const{key:f,filterable:g}=e.column;c(f,g,w)},C=()=>{const{key:w,sortable:f}=e.column;f&&s(w,f)};return()=>{var A,T,E;const{column:w}=e,{type:f,titleColSpan:g,titleRowSpan:b}=w;if(f==="scroll-bar")return m("th",{class:h.value,style:y.value,colspan:g===1?void 0:g,rowspan:b===1?void 0:b,onClick:C},null);const B=n.value;let k,K;if(f==="selectable")K=m(yl,null,null);else{const{title:I,customTitle:R,sortable:M,filterable:q}=w,U=d.value;K=xl(I,R,t),k=Re(U,K,I);const _=Sl(M,v,q,p,S);_.length>0?K=m("span",{class:`${B}-cell-triggers`},[m("span",{class:`${B}-cell-title`},[K]),_]):U&&(K=m("span",{class:`${B}-cell-title`},[K]))}const $=(A=l.customAdditional)==null?void 0:A.headCell,O=$?$({column:w}):void 0,W=(E=(T=l.customTag)==null?void 0:T.headCell)!=null?E:"th";return m(W,Z({class:h.value,style:y.value,colSpan:g===1?void 0:g,rowSpan:b===1?void 0:b,title:k},O,{onClick:C}),{default:()=>[K]})}}});function xl(e,l,t){let n=e;return Q(l)?n=l({title:e}):j(l)&&t[l]&&(n=t[l]({title:e})),n}function Sl(e,l,t,n,o){const a=[];return e&&a.push(m(gl,{activeOrderBy:l.value,sortable:e},null)),t&&a.push(m(fl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),a}const Cl=H({props:Vt,setup(e){const{props:l,mergedPrefixCls:t}=F(N);return()=>{var s,i,u;const{columns:n}=e,o=(s=l.customAdditional)==null?void 0:s.headRow,a=o?o({columns:n}):void 0,r=(u=(i=l.customTag)==null?void 0:i.headRow)!=null?u:"tr";return m(r,Z({class:`${t.value}-row`},a),{default:()=>[n.filter(c=>c.titleColSpan!==0).map(c=>m(bl,{key:c.key,column:c},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(N);return()=>{var s,i,u;const n=l.value,o=(s=e.customAdditional)==null?void 0:s.head,a=o?o({rows:n}):void 0,r=(u=(i=e.customTag)==null?void 0:i.head)!=null?u:"thead";return m(r,Z({class:`${t.value}-thead`},a),{default:()=>[n.map((c,d)=>m(Cl,{key:d,columns:c},null))]})}}}),wl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:a,columnWidths:r,changeColumnWidth:s,flattedData:i,isSticky:u,mergedSticky:c,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:y,handleScroll:v,pingedStart:p,pingedEnd:S,scrollWidth:C,scrollHeight:w,hasFixed:f,tableLayout:g}=F(N),b=P(),B=P(0);Pe(ge,{mainTableWidth:B,changeColumnWidth:(E,I)=>{at(b.value)&&s(E,I)}});const K=()=>{const E=X(h);E&&v({currentTarget:E})},$=E=>{const{offsetWidth:I}=E.target;I!==B.value&&(B.value=I)};se(()=>{K(),z([()=>e.dataSource,C],([,I])=>{I&&K()}),z(r,Te(()=>{var R;((R=X(h))==null?void 0:R.scrollLeft)===0&&K()},16)),nt(b.value,$)}),J(()=>ot(b.value,$));const O=x(()=>{const E=n.value;return V({[`${E}-container`]:!0,[`${E}-ping-start`]:p.value,[`${E}-ping-end`]:S.value,[`${E}-fixed-layout`]:g.value==="fixed",[`${E}-fixed-column`]:f.value,[`${E}-scroll-horizontal`]:C.value,[`${E}-scroll-vertical`]:w.value})}),W=x(()=>{var U;const E=C.value,I=w.value,R=E?"auto":void 0,M=e.virtual?"hidden":I?"scroll":E?"hidden":void 0,q=(U=e.scroll)==null?void 0:U.fullHeight;return{overflowX:R,overflowY:M,[q?"height":"maxHeight"]:I}}),A=x(()=>({tableLayout:g.value,width:C.value,minWidth:C.value?"100%":void 0})),T=(E,I,R)=>{L(e.onScrolledChange,E,I,R.map(M=>M.record))};return()=>{const E=n.value,I=a.value,R=l.default?l.default():[];if(I||w.value||u.value){const{offsetTop:M}=c.value;if(e.headless||R.push(m(jt,{offsetTop:M},{default:()=>[m(we,null,null)]})),e.virtual&&(e.scroll||I)){const q=({item:ae,index:Ye})=>Ve(ae,Ye,l,t.value,E),U=ae=>m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),m(re,null,{default:()=>[ae]}),!1]),{scroll:_,onScrolledBottom:Ge}=e;R.push(m(st,{ref:d,style:W.value,dataSource:i.value,fullHeight:_==null?void 0:_.fullHeight,getKey:"rowKey",height:a.value?"100%":_==null?void 0:_.height,itemHeight:o.value,itemRender:q,contentRender:U,virtual:!0,onScroll:v,onScrolledBottom:Ge,onScrolledChange:T},null))}else R.push(m("div",{ref:h,class:`${E}-content`,style:W.value,onScroll:v},[m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),m(re,null,null),!1])]));u.value&&R.push(m(qt,null,null))}else R.push(m("div",{ref:h,class:`${E}-content`,style:W.value,onScroll:v},[m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),!e.headless&&m(we,null,null),m(re,null,null),!1])]));return m("div",{ref:b,class:O.value},[R])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bl(e,l){return e.footer?m("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t,n){var r,s;let o=null,a=null;if(l!==null){const{position:i}=l,[u,c]=yt(i).split("-"),d=`${n}-pagination ${n}-pagination-${c}`,h=(s=(r=e.pagination)==null?void 0:r.call(e,{total:t.length,...l}))!=null?s:m(pt,Z({class:d,total:t.length},l),null);o=u==="top"?h:null,a=u==="bottom"?h:null}return[o,a]}const Kl={sm:32,md:40,lg:56},$l={sm:40,md:48,lg:56},El=H({name:"IxTable",props:Xt,setup(e,{expose:l,slots:t}){const n=le("common"),o=x(()=>`${n.prefixCls}-table`),a=le("locale"),r=le("table"),s=x(()=>{var T;return(T=e.autoHeight)!=null?T:r.autoHeight}),i=x(()=>{var T;return(T=e.childrenKey)!=null?T:r.childrenKey}),u=rt(e,r),c=x(()=>{var T;return(T=e.emptyCell)!=null?T:r.emptyCell}),d=x(()=>{var T;return(T=e.size)!=null?T:r.size}),h=x(()=>{var T;return(T=e.virtualItemHeight)!=null?T:n.theme==="seer"?Kl[d.value]:$l[d.value]}),{mergedPagination:y}=Tt(e,r,d),v=Dt(e),p=It(e,s,v),S=bt(e,t,r,p.scrollBarSizeOnFixedHolder),C=_t(S.flattedColumns),w=Et(S.flattedColumns),f=$t(e,S.flattedColumns),g=zt(e,S,p,v.isSticky,s),{activeSorters:b}=C,{activeFilters:B}=w,k=Kt(e,i,u,b,B,f.expandedRowKeys,y),K=Ht(e,a,S.flattedColumns,k);Wt(e,r,y,b,B,p.scrollTo);const $={props:e,slots:t,config:r,locale:a,mergedPrefixCls:o,mergedEmptyCell:c,mergedVirtualItemHeight:h,mergedAutoHeight:s,...S,...p,...C,...w,...v,tableLayout:g,mergedPagination:y,...f,...k,...K};Pe(N,$),l({scrollTo:p.scrollTo});const{flattedData:O,filteredData:W}=k,A=x(()=>{const T=o.value,{borderless:E=r.borderless,scroll:I}=e;return V({[T]:!0,[`${T}-auto-height`]:s.value,[`${T}-borderless`]:E,[`${T}-empty`]:O.value.length===0,[`${T}-full-height`]:I==null?void 0:I.fullHeight,[`${T}-${d.value}`]:!0})});return()=>{const T=o.value,E=m(ct,{header:e.header},t),I=Bl(t,T),[R,M]=kl(t,y.value,W.value,T),q=[E],U=[R,m(wl,null,null),I,M].filter(Boolean),_=Tl(e.spin);return _?q.push(m(it,_,{default:()=>[U]})):q.push(...U),m("div",{class:A.value},[q])}}});function Tl(e){return gt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=El,Fl=ye;export{Rl as I,Fl as a,mt as g,Xt as t};
