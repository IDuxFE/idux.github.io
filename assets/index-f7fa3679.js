import{a9 as Ce,aa as fe,aI as Ye,ac as we,i as M,u as le,aJ as z,aK as ce,N as X,s as Ge,a2 as ie,a8 as oe,h as ee,o as Y,j as ge,v as te,C as ve,aq as Je,al as ke,ak as Be,c as me,w as Qe,a3 as Ze,a4 as et,a7 as tt,aL as lt,ar as nt,an as ot,ay as st}from"./index-cbb19196.js";import{j as Ke,l as N,L as at,T as rt,e as b,r as he,b as I,w as D,a7 as Ee,Q as $e,k as G,N as Q,x as se,bi as ct,P as it,v as H,z as V,y as x,i as F,ad as ut,a as J,a2 as Z,p as Te,Z as dt,au as ft}from"./vendor-5869a5c0.js";import{b as Ie}from"./GlobalCodeBox-33630eea.js";import{I as vt}from"./index-729b4614.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Oe=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Oe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,l,t){if(!e||Ke(e)&&e.title===!1)return;if(N(l)||at(l))return l;const o=Ce(l).find(n=>n.type===rt);return o?o.children:t}function ht(e){return e.key?e.key:e.dataKey?fe(e.dataKey).join("-"):e.type?`__IDUX_table_column_key_${e.type}`:Ye("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function yt(e,l,t,o){const n=b(()=>{var m;const{columns:k}=e;return Pe(k&&k.length>0?k:We((m=l.default)==null?void 0:m.call(l)),t)}),{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a}=gt(n,o),c=mt(a),i=b(()=>!!e.ellipsis||r.value.some(k=>k.ellipsis)),u=b(()=>r.value.some(k=>k.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y}=bt(r,s),{columnOffsets:f,columnOffsetsWithScrollBar:S}=xt(d,h),C=b(()=>St(n.value,s.value));return{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y,columnOffsets:f,columnOffsetsWithScrollBar:S,mergedRows:C}}function Pe(e,l){return e.map(t=>pt(t,l))}function We(e){const l=[];return Ce(e,{key:Oe}).forEach((t,o)=>{const{props:n,children:r}=t,{key:s=o,editable:a,ellipsis:c,...i}=n||{};i.key=s,i.editable=a||a==="",i.ellipsis=c||c==="";const{default:u,cell:d,title:h,expand:y,icon:f}=r||{};u&&(i.children=We(u())),d&&(i.customCell=d),h&&(i.customTitle=h),y&&(i.customExpand=y),f&&(i.customIcon=f),l.push(i)}),l}function pt(e,l){const{columnBase:t,columnExpandable:o,columnSelectable:n,columnIndexable:r}=l,{align:s=t.align}=e,a=ht(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{icon:i=o.icon}=e;return{...e,key:a,align:s,icon:i}}if(c==="selectable"){const{multiple:i=!0,showIndex:u=n.showIndex}=e;return{...e,key:a,align:s,multiple:i,showIndex:u}}if(c==="indexable"){const i=e.align??r.align??t.align;return{...r,...e,align:i,key:a}}return{...e,key:a,align:s}}else{const{sortable:c,filterable:i,children:u}=e,d={...e,key:a,align:s};return c&&(d.sortable={...t.sortable,...c}),i&&(d.filterable={...t.filterable,...i}),u!=null&&u.length&&(d.children=Pe(u,l)),d}}function gt(e,l){const t=b(()=>Fe(e.value)),o=b(()=>{const r=l.value;if(r===0)return;const s=t.value,a=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:r}}),n=b(()=>{const r=t.value;if(r.length===0)return r;const s=o.value;return s?[...r,s]:r});return{flattedColumns:t,scrollBarColumn:o,flattedColumnsWithScrollBar:n}}function Fe(e){const l=[];return e.forEach(t=>{const{fixed:o,children:n}=t;if(n!=null&&n.length){let r=Fe(n);o&&(r=r.map(s=>({fixed:o,...s}))),l.push(...r)}else l.push(t)}),l}function mt(e){return b(()=>{let l,t;return e.value.forEach(o=>{const{fixed:n,key:r}=o;n==="start"?l=r:n==="end"&&(t||(t=r))}),{lastStartKey:l,firstEndKey:t}})}function bt(e,l){const t=he({}),o=I(),n=I([]);D(o,Ee(a=>{n.value=a?a.split("-").map(Number):[]},16)),$e(()=>{const a=Object.keys(t),c=e.value;if(a.length!==c.length){o.value=void 0;return}o.value=c.map(i=>t[i.key]).join("-")});const r=b(()=>{const a=n.value;if(a.length===0)return a;const c=l.value;return c?[...a,c.width]:a});return{columnWidths:n,columnWidthsWithScrollBar:r,changeColumnWidth:(a,c)=>{c===!1?delete t[a]:t[a]=c}}}function xt(e,l){const t=b(()=>be(e.value)),o=b(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:o}}function be(e){const l=e.length,t=[],o=[];let n=0,r=0;for(let s=0;s<l;s++){t[s]=n,n+=e[s]||0;const a=l-s-1;o[a]=r,r+=e[a]||0}return{starts:t,ends:o}}function St(e,l){const t=[];function o(s,a,c){t[c]??(t[c]=[]);let i=a;return s.map(d=>{let h=d.titleColSpan??1,y=!1;const f=d.children;if(f!=null&&f.length){y=!0;const C=o(f,i,c+1);G(d.titleColSpan)&&(h=C.reduce((k,m)=>k+m))}const S=i+h-1;return t[c].push({...d,titleColSpan:h,colStart:i,colEnd:S,hasChildren:y}),i+=h,h})}const n=l?[...e,l]:e;o(n,0,0);const r=t.length;return t.forEach((s,a)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-a)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e,l,t,o,n,r,s){const a=b(()=>{const f=l.value,S=t.value;return e.dataSource.map(C=>He(C,S,f))}),c=b(()=>{const f=new Map;return ue(a.value,f),f}),i=b(()=>_e(a.value,n.value,r.value)),u=b(()=>Ae(i.value,o.value,r.value)),d=b(()=>{const f=s.value,S=u.value;if(f===null||!f.pageSize)return S;{const{total:C}=f;if(C&&S.length<C)return S;const k=f.pageSize,m=(f.pageIndex-1)*k;return S.slice(m,m+k)}}),h=b(()=>{const f=new Map;return ue(d.value,f),f}),y=b(()=>{const f=r.value;return f.length>0?Me(d.value,f,0):d.value});return{filteredData:i,flattedData:y,mergedMap:c,paginatedMap:h}}function He(e,l,t,o){const n=l(e),r={record:e,rowKey:n,parentKey:o},s=e[t];return s&&(r.children=s.map(a=>He(a,l,t,n))),r}function ue(e,l){e.forEach(t=>{const{rowKey:o,children:n}=t;l.set(o,t),n&&ue(n,l)})}function Ae(e,l,t){const o=l.filter(s=>s.sorter),n=o.length;if(n===0)return e;const r=e.slice();return r.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=Ae(s.children,l,t))}),r.sort((s,a)=>{for(let c=0;c<n;c++){const{orderBy:i,sorter:u}=o[c],d=u(s.record,a.record);if(d!==0)return i==="ascend"?d:-d}return 0})}function _e(e,l,t){const o=l.filter(n=>n.filter);return o.length===0?e:e.map(n=>{const r=o.every(({filter:u,filterBy:d})=>u(d,n.record)),{rowKey:s,children:a}=n,c=t.includes(s);let i=n;if(c&&a&&a.length){const u=_e(a,l,t);u.length!==a.length&&(i={...n,children:u})}return r||c&&i.children&&i.children.length?i:null}).filter(n=>n!==null)}function Me(e,l,t){return e.reduce((o,n)=>{const{children:r,parentKey:s,record:a,rowKey:c}=n,i=l.includes(c);if(o.push({children:r,parentKey:s,record:a,rowKey:c,level:t,expanded:i}),i&&n.children){const u=Me(n.children,l,t+1);o.push(...u)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wt(e,l){const t=b(()=>l.value.find(a=>"type"in a&&a.type==="expandable")),[o,n]=we(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:o,setExpandedRowKeys:n,checkExpandDisabled:a=>{if(!t.value)return!0;const{disabled:c,customExpand:i}=t.value,{record:u}=a;return c!=null&&c(u)?!0:!(i||a.children&&a.children.length>0)},handleExpandChange:(a,c)=>{const{onChange:i,onExpand:u}=t.value||{},d=[...o.value],h=d.indexOf(a),y=h>=0;y?d.splice(h,1):d.push(a),M(u,!y,c),n(d),M(i,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function kt(e){const l=b(()=>e.value.filter(r=>r.filterable)),t=he({});D(l,(r,s)=>{r.forEach(a=>{const{key:c,filterable:i}=a,u=i.filterBy;if(u||t[c]===void 0){t[c]=u||[];return}const d=s?s.find(y=>y.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])})},{immediate:!0});const o=b(()=>l.value.map(r=>{const{key:s,filterable:a}=r,{filter:c,filterBy:i=t[s]}=a;return{key:s,filter:c,filterBy:i}}).filter(r=>r.filter&&r.filterBy.length>0));return{activeFilters:o,activeFilterByMap:t,handleFilter:(r,s,a)=>{const{onChange:c}=s;t[r]=a,M(c,a,o.value)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,l,t){var i,u;const o=le("pagination"),n=b(()=>{const{pagination:d}=e;return d===!1?null:d===!0?{}:d}),r=I(((i=n.value)==null?void 0:i.pageIndex)??1),s=I(((u=n.value)==null?void 0:u.pageSize)??l.pagination.pageSize??o.pageSize),a=(d,h)=>{var y;r.value=d,s.value=h,M((y=n.value)==null?void 0:y.onChange,d,h)};return{mergedPagination:b(()=>{const d=n.value;return d===null?null:{...l.pagination,...d,pageIndex:d.pageIndex??r.value,pageSize:d.pageSize??s.value,size:t.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l,{setStickyScrollLeft:t}){const o=I(),n=I(),r=I(),s=I(),a=I();D(o,k=>{k&&(r.value=k.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=Et(n,r,a,t),d=$t(e,l,r,s),h=b(()=>{var k;return z((k=e.scroll)==null?void 0:k.width)}),y=b(()=>{var m;let k=z((m=e.scroll)==null?void 0:m.height);return!k&&l.value&&(e.virtual||d.value)&&(k="auto"),k}),f=b(()=>ce(X(r))),S=b(()=>y.value?f.value:0);return{virtualScrollRef:o,scrollHeadRef:n,scrollBodyRef:r,scrollContentRef:s,scrollFootRef:a,handleScroll:c,scrollTo:k=>{var m;e.virtual?(m=o.value)==null||m.scrollTo(k):typeof k=="number"&&Ge({target:X(r),top:k,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:y,scrollBarSize:f,scrollBarSizeOnFixedHolder:S}}function Et(e,l,t,o){const n=I(!1),r=I(!1);let s;const a=()=>{s&&(clearTimeout(s),s=void 0)};Q(()=>a());const c=I(),i=y=>{c.value=y,a(),s=setTimeout(()=>{c.value=void 0,s=void 0},100)},u=(y,f)=>{f&&f.scrollLeft!==y&&(f.scrollLeft=y)},d=y=>{const f=X(l);if(!f)return;const{clientWidth:S,scrollWidth:C}=f;o(y/C*S||0)};return{handleScroll:(y,f)=>{const S=y==null?void 0:y.currentTarget,C=f??S.scrollLeft,k=c.value;if((!k||k===S)&&(i(S),u(C,e.value),u(C,X(l)),u(C,t.value),d(C)),S){const{scrollWidth:m,clientWidth:v}=S;n.value=C>0,r.value=C<m-v}},pingedStart:n,pingedEnd:r}}function $t(e,l,t,o){const n=I(!0),r=()=>{const c=X(t.value);c?n.value=c.scrollHeight>c.clientHeight:n.value=!1};let s=[];const a=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,i])=>{a(),c&&!i&&(s=[ie(t,r),ie(o,r)])},{immediate:!0})}),Q(()=>a()),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t,o,n,r){const s=b(()=>e.scrollToTopOnChange??l.scrollToTopOnChange);let a=[];const c=()=>{a=[D([()=>{var u;return(u=t.value)==null?void 0:u.pageIndex},()=>{var u;return(u=t.value)==null?void 0:u.pageSize}],()=>r(0)),D([n,o],([u,d],[h,y])=>{(!It(u,h)||!Ot(d,y))&&r(0)})]},i=()=>{a.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function It(e,l){return e.length===l.length&&e.every(t=>{const o=l.find(n=>n.key===t.key);return o?t.filter===o.filter&&t.filterBy.length===o.filterBy.length&&t.filterBy.every(n=>o.filterBy.includes(n)):!1})}function Ot(e,l){return e.length===l.length&&e.every(t=>{const o=l.find(n=>n.key===t.key);return o?t.sorter===o.sorter&&t.orderBy===o.orderBy&&t.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Rt(e,l,t,{mergedMap:o,paginatedMap:n}){const r=b(()=>t.value.find(m=>"type"in m&&m.type==="selectable")),[s,a]=we(e,"selectedRowKeys",()=>[]),c=b(()=>{const{disabled:m}=r.value||{},v=[],g=[];return n.value.forEach((p,w)=>{m!=null&&m(p.record)?g.push(w):v.push(w)}),{enabledRowKeys:v,disabledRowKeys:g}}),i=b(()=>{const m=new Set,v=s.value,{disabledRowKeys:g}=c.value,p=o.value;return v.forEach(w=>{const{parentKey:K}=p.get(w)||{};if(!G(K)){let B=p.get(K);if(B&&!v.includes(B.rowKey))for(;B&&!G(B==null?void 0:B.rowKey);)g.includes(B.rowKey)||m.add(B.rowKey),B=G(B.parentKey)?void 0:p.get(B.parentKey)}}),[...m]}),u=b(()=>{const m=s.value,{disabledRowKeys:v}=c.value;let g=0;return n.value.forEach((p,w)=>{!v.includes(w)&&m.includes(w)&&g++},0),g}),d=b(()=>{const m=n.value.size,v=c.value.disabledRowKeys.length;return m===0||m===v?!1:m===v+u.value}),h=b(()=>!d.value&&u.value>0),y=m=>{a(m);const v=o.value,{onChange:g}=r.value||{};if(g){const p=[];m.forEach(w=>{const K=v.get(w);K&&p.push(K.record)}),M(g,m,p)}},f=(m,v)=>{const g=o.value,{disabledRowKeys:p}=c.value,{multiple:w,onSelect:K}=r.value||{};let B=[...s.value];const E=B.indexOf(m),P=E>=0;if(w){const O=g.get(m),A=ze(O,p);if(P){B.splice(E,1);const R=Pt(g,O,p);B=B.filter($=>!R.includes($)&&!A.includes($))}else B.push(m),B.push(...A);Wt(g,O,B,p)}else B=P?[]:[m];M(K,!P,v),y(B)},S=()=>{const{enabledRowKeys:m}=c.value,v=new Set(s.value);d.value?m.forEach(g=>v.delete(g)):m.forEach(g=>v.add(g)),y([...v])},C=Ft(r,l),k=Ht(r,o,n,s,y);return{selectable:r,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:f,handleHeadSelectChange:S,mergedSelectableMenus:C,handleSelectableMenuClick:k}}function ze(e,l){const t=[],{children:o}=e||{};return o&&o.forEach(n=>{const{rowKey:r}=n;l.includes(r)||t.push(n.rowKey),t.push(...ze(n,l))}),t}function Pt(e,l,t){const o=[];for(;l!=null&&l.parentKey;){const{parentKey:n}=l;t.includes(l.parentKey)||o.push(n),l=e.get(n)}return o}function Wt(e,l,t,o){let n=!0;for(;n&&l&&!G(l.parentKey);){const r=e.get(l.parentKey);if(r&&!o.includes(l.parentKey)){n=r.children.every(a=>o.includes(a.rowKey)||t.includes(a.rowKey));const s=t.findIndex(a=>a===l.parentKey);n?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=r}}const De=Symbol("IDUX_TABLE_KEY_selectable-all"),Ne=Symbol("IDUX_TABLE_KEY_selectable-invert"),Le=Symbol("IDUX_TABLE_KEY_selectable-none"),je=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Ft(e,l){return b(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:o,selectInvert:n,selectNone:r,selectPageInvert:s}=l.table;return t.map(a=>N(a)?a==="all"?{type:"item",key:De,label:o}:a==="invert"?{type:"item",key:Ne,label:n}:a==="none"?{type:"item",key:Le,label:r}:a==="pageInvert"?{type:"item",key:je,label:s}:{type:"item",key:a,label:a}:a)})}function Ht(e,l,t,o,n){const r=()=>{const{disabled:u,onSelectAll:d}=e.value||{},h=[];l.value.forEach((y,f)=>{u!=null&&u(y.record)||h.push(f)}),M(d,h),n(h)},s=()=>{const{disabled:u,onSelectInvert:d}=e.value||{},h=[...o.value];l.value.forEach((y,f)=>{if(u!=null&&u(y.record))return;const S=h.indexOf(f);S>=0?h.splice(S,1):h.push(f)}),n(h),M(d,h)},a=()=>{const{onSelectNone:u}=e.value||{};M(u),n([])},c=()=>{const{disabled:u,onSelectPageInvert:d}=e.value||{},h=[],y=o.value;t.value.forEach((f,S)=>{u!=null&&u(f.record)||y.includes(S)||h.push(S)}),M(d,h),n(h)},i=new Map([[De,r],[Ne,s],[Le,a],[je,c]]);return u=>{const d=u.key;if(ct(d)&&i.has(d)){i.get(d)();return}const{disabled:h,onMenuClick:y}=e.value||{};if(!y)return;const f=[];t.value.forEach((S,C)=>{h!=null&&h(S.record)||f.push(C)}),M(y,u,f)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function At(e){const l=b(()=>e.value.filter(s=>s.sortable)),t=he({}),o=b(()=>l.value.some(s=>s.sortable.multiple!==void 0));D(l,(s,a)=>{s.forEach(c=>{const{key:i,sortable:u}=c,d=u.orderBy;if(d||t[i]===void 0){t[i]=d;return}const h=a?a.find(f=>f.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(t[i]=void 0)})},{immediate:!0});const n=b(()=>l.value.map(s=>{const{key:a,sortable:c}=s,{multiple:i=0,orderBy:u=t[a],sorter:d}=c;return{key:a,multiple:i,orderBy:u,sorter:d}}).filter(s=>s.orderBy).sort((s,a)=>a.multiple-s.multiple));return{activeSorters:n,activeOrderByMap:t,handleSort:(s,a)=>{const{orders:c,onChange:i}=a,u=t[s],d=u?xe(c,u):xe(c);o.value?t[s]=d:Object.keys(t).forEach(h=>{s===h?t[h]=d:t[h]=void 0}),M(i,d,n.value)}}}function xe(e,l){return l?e[e.indexOf(l)+1]:e[0]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function _t(e){const l=b(()=>!!e.sticky),t=b(()=>{const{sticky:r}=e,{offsetTop:s=0,offsetBottom:a=0,offsetScroll:c=0,container:i=window}=it(r)?r:{};return{offsetTop:s,offsetBottom:a,offsetScroll:c,container:i}}),[o,n]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:o,setStickyScrollLeft:n}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Mt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:o,scrollHeight:n},r,s){return b(()=>e.tableLayout?e.tableLayout:o.value&&t.value?o.value==="max-content"?"auto":"fixed":n.value||s.value||r.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const _=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:o,mergedSelectableMenus:n,mergedPrefixCls:r}=F(_);return()=>{const{isFixedHolder:s}=e,a=s?t.value:l.value;if(a.every(u=>!u.width&&!u.type))return;const c=r.value,i=a.map((u,d)=>{const{key:h,type:y}=u,f=s?o.value[d]:u.width,S=y?V({[`${c}-col-${y}`]:!0,[`${c}-col-with-dropdown`]:y==="selectable"&&n.value.length>0}):void 0;let C;return s?C=f?`width: ${z(f)}`:void 0:C={width:z(f),minWidth:z(u.minWidth),maxWidth:z(u.maxWidth)},x("col",{key:h,class:S,style:C},null)});return x("colgroup",null,[i])}}}),zt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:o,handleScroll:n,scrollWidth:r,flattedData:s,isSticky:a,columnWidths:c}=F(_);Dt(o,n);const i=b(()=>r.value==="max-content"),u=b(()=>s.value.length>0),d=b(()=>{const f=t.value;return{[`${f}-fixed-holder`]:!0,[`${f}-sticky-holder`]:a.value}}),h=b(()=>{const f=a.value,{offsetTop:S,offsetBottom:C}=e;return{overflow:"hidden",top:f?z(S):void 0,bottom:f?z(C):void 0}}),y=b(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>x("div",{class:d.value,style:h.value,ref:o},[x("table",{style:y.value},[(u.value||!i.value)&&x(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function Dt(e,l){const t=o=>{const n=o.deltaX,r=o.currentTarget;if(n){const s=r.scrollLeft+n;l(o,s),o.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Q(()=>Y(e.value,"wheel",t))}const Nt=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:o,stickyScrollLeft:n,setStickyScrollLeft:r}=F(_),s=I(!1),a=I(!1),c=I(0),i=I(0),u=I(0),d=b(()=>{const v=i.value,g=u.value;return g&&v*(v/g)});$e(()=>{const v=X(l);if(v&&s.value){const{clientWidth:g,scrollWidth:p,scrollLeft:w}=v;r(w/p*g),i.value=g,u.value=p}});const h=b(()=>({height:ce(),width:i.value,bottom:o.value.offsetScroll})),y=b(()=>{const v=e.value;return{[`${v}-sticky-scrollbar-thumb`]:!0,[`${v}-sticky-scrollbar-thumb-active`]:a.value}}),f=b(()=>({width:`${d.value}px`,transform:`translate3d(${n.value}px, 0, 0)`})),S=()=>a.value=!1,C=v=>{c.value=v.pageX-n.value,a.value=!0,v.preventDefault()},k=v=>{if(!a.value)return;const{buttons:g}=v||window.event;if(g===0){a.value=!1;return}let p=v.pageX-c.value;p<=0&&(p=0);const w=i.value,K=u.value,B=d.value;p+B>=w&&(p=w-B);const E=p/w*(K+2);t(v,E)},m=()=>{const v=X(l),g=ge(v).top,p=g+v.offsetHeight,{container:w,offsetScroll:K}=o.value,B=w===window?document.documentElement.scrollTop+window.innerHeight:ge(w).top+w.clientHeight;p-ce()<=B||g>=B-K?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",S),ee(document.body,"mousemove",k),ee(window,"resize",m),D(()=>o.value.container,(v,g)=>{Y(g,"scroll",m),ee(v,"scroll",m)},{immediate:!0}),m()}),Q(()=>{Y(document.body,"mouseup",S),Y(document.body,"mousemove",k),Y(window,"resize",m),Y(o.value.container,"scroll",m)}),()=>!l.value||!s.value||u.value<=i.value||!d.value?null:x("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[x("div",{class:y.value,style:f.value,onMousedown:C},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:o,hasFixed:n,scrollWidth:r,scrollBarColumn:s}=F(_),{mainTableWidth:a}=F(pe),c=b(()=>o.value.length);return()=>{let i=l.default();if(e.isEmpty?r.value:n.value){const u=s.value;i=x("div",{class:`${t.value}-fixed-row`,style:{width:z(a.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return x("tr",null,[x("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Lt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},jt={columns:{type:Array,required:!0}},Ut={column:{type:Object,required:!0}},qt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Xt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Vt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Yt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Gt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},Jt=H({props:Vt,setup(e){const l=I();return ie(l,o=>{const{offsetWidth:n}=o.target;e.changeColumnWidth(e.cellKey,n)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>x("td",{ref:l,style:{padding:0,border:0,height:0}},[x("div",{style:{height:0,overflow:"hidden"}},[ut(" ")])])}}),Qt=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(_),{changeColumnWidth:t}=F(pe);return()=>{const o=l.value.map(n=>{const{key:r}=n;return x(Jt,{key:r,cellKey:r,changeColumnWidth:t},null)});return x("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}}),Zt=H({props:Xt,setup(e){const{props:l,slots:t,config:o,mergedPrefixCls:n,mergedEmptyCell:r,activeOrderByMap:s,fixedColumnKeys:a,columnOffsets:c,isSticky:i,expandable:u,selectable:d,mergedPagination:h}=F(_),y=b(()=>s[e.column.key]),f=el(e),S=b(()=>a.value.lastStartKey===e.column.key),C=b(()=>a.value.firstEndKey===e.column.key),k=b(()=>{const{type:p,ellipsis:w}=e.column;return p?w:w??l.ellipsis}),m=b(()=>{const{fixed:p,align:w}=e.column,K=n.value;let B={[`${K}-cell`]:!0,[`${K}-cell-sorted`]:!!y.value,[`${K}-cell-align-${w}`]:!!w&&w!="start",[`${K}-cell-ellipsis`]:!!k.value};return p&&(B={...B,[`${K}-fix-start`]:p==="start",[`${K}-fix-start-last`]:S.value,[`${K}-fix-end`]:p==="end",[`${K}-fix-end-first`]:C.value,[`${K}-fix-sticky`]:i.value}),V(B)}),v=b(()=>{const{fixed:p}=e.column;if(!p)return;const{starts:w,ends:K}=c.value,E=z((p==="start"?w:K)[e.colIndex]);return{position:"sticky",left:p==="start"?E:void 0,right:p==="end"?E:void 0}}),g=p=>{p.stopPropagation()};return()=>{var A,R;const{column:p}=e,{type:w}=p;let K,B;if(w==="selectable")K=nl(e,t,d,g,o,h);else if(w==="indexable")K=Ue(e,t,p,h);else{const $=f.value;if(K=tl(e,t,$),B=Re(k.value,K,$),!w&&(G(K)||K==="")){const T=t.emptyCell||r.value;K=J(T)?T({column:p,record:e.record,rowIndex:e.rowIndex}):T}}e.column.fixed&&k.value&&(S.value||C.value)&&(K=x("span",{class:`${n.value}-cell-content`},[K]));const E=(A=l.customAdditional)==null?void 0:A.bodyCell,P=E?E({column:p,record:e.record,rowIndex:e.rowIndex}):void 0,O=((R=l.customTag)==null?void 0:R.bodyCell)??"td";return x(O,Z({class:m.value,style:v.value,title:B},P),{default:()=>[w==="expandable"&&ll(e,t,u,n.value),K]})}}});function el(e){return b(()=>{const{column:l,record:t}=e,o=fe(l.dataKey);if(o.length<=0)return;let n=t;for(let r=0;r<o.length&&n;r++){const s=o[r];n=n[s]}return n})}function tl(e,l,t){const{record:o,rowIndex:n,column:r}=e,{customCell:s}=r,a=N(s)?l[s]:s;return a?a({value:t,record:o,rowIndex:n}):t}function ll(e,l,t,o){if(e.disabled)return;const{icon:n,customIcon:r,indent:s}=t.value,{record:a,expanded:c,level:i=0}=e,u=s?`margin-left: ${z(i*s)}`:void 0;let d;const h=(N(r)?l[r]:r)??n;return J(h)?d=h({expanded:!!c,record:a}):d=N(h)?x(te,{name:h,rotate:c?90:0},null):h,x("button",{class:`${o}-expandable-trigger`,style:u,type:"button",onClick:e.handleExpend},[d])}function nl(e,l,t,o,n,r){const{selected:s,indeterminate:a,disabled:c,isHover:i,handleSelect:u}=e,{showIndex:d,multiple:h,customCell:y}=t.value;if(!s&&!i&&d)return Ue(e,l,n.columnIndexable,r);const f=N(y)?l[y]:y;if(h){const S={checked:s,disabled:c,indeterminate:a,onChange:u,onClick:o};return f?f(S):x(ve,S,null)}else{const S={checked:s,disabled:c,onChange:u,onClick:o};return f?f(S):x(Ie,S,null)}}function Ue(e,l,t,o){const{record:n,rowIndex:r,disabled:s}=e,{customCell:a}=t,{pageIndex:c=1,pageSize:i=0}=o.value||{},u=N(a)?l[a]:a;return u?x("span",{style:s?"cursor: not-allowed":"cursor: pointer"},[u({record:n,rowIndex:r,pageIndex:c,pageSize:i})]):void 0}const ol=H({props:qt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:o,expandable:n,handleExpandChange:r,checkExpandDisabled:s,selectable:a,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:d}=F(_),{expandDisabled:h,handleExpend:y,selectDisabled:f,handleSelect:S,isHover:C,attrs:k}=sl(e,n,s,r,a,u,d),m=b(()=>c.value.includes(e.rowKey)),v=b(()=>i.value.includes(e.rowKey)),g=b(()=>{const p=`${t.value}-row`,{level:w,expanded:K}=e;return V({[`${p}`]:!0,[`${p}-level-${w}`]:!!w,[`${p}-selected`]:m.value,[`${p}-expanded`]:K})});return()=>{var B,E;const p=(B=l.customAdditional)==null?void 0:B.bodyRow,w=p?p({record:e.record,rowIndex:e.rowIndex}):void 0,K=((E=l.customTag)==null?void 0:E.bodyRow)??"tr";return x(K,Z({class:g.value},k.value,w),{default:()=>[al(e,o,h,y,m,v,f,S,C)]})}}});function sl(e,l,t,o,n,r,s){const a=b(()=>t(e.rowData)),c=b(()=>{var g;return(g=l.value)==null?void 0:g.trigger}),i=()=>{const{rowKey:g,record:p}=e;o(g,p)},u=b(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=b(()=>{var g;return(g=n.value)==null?void 0:g.trigger}),h=b(()=>{var g;return(g=n.value)==null?void 0:g.showIndex}),y=I(!1),f=()=>{const{rowKey:g,record:p}=e;r(g,p)},S=()=>{c.value==="click"&&i(),d.value==="click"&&f()},C=()=>{c.value==="dblclick"&&i(),d.value==="dblclick"&&f()},k=()=>y.value=!0,m=()=>y.value=!1,v=b(()=>{const g=a.value,p=c.value,w=u.value,K=d.value,B=!g&&p==="click"||!w&&K==="click",E=!g&&p==="dblclick"||!w&&K==="dblclick",P=!w&&h.value;let O="";return B||E?O="pointer":(g&&p||w&&K)&&(O="not-allowed"),{style:O?`cursor: ${O}`:void 0,onClick:B?S:void 0,onDblclick:E?C:void 0,onMouseenter:P?k:void 0,onMouseleave:P?m:void 0}});return{expandDisabled:a,handleExpend:i,selectDisabled:u,handleSelect:f,isHover:y,attrs:v}}function al(e,l,t,o,n,r,s,a,c){const i=[],{rowIndex:u,record:d,level:h}=e;return l.value.forEach((y,f)=>{const{type:S,colSpan:C,rowSpan:k,key:m}=y,v=C==null?void 0:C(d,u),g=k==null?void 0:k(d,u);if(v===0||g===0)return;const p={colSpan:v===1?void 0:v,rowSpan:g===1?void 0:g,rowIndex:u,colIndex:f,record:d,column:y,level:h,key:m};S==="expandable"?(p.expanded=e.expanded,p.disabled=t.value,p.handleExpend=o):S==="selectable"&&(p.selected=n.value,p.indeterminate=r.value,p.disabled=s.value,p.handleSelect=a,p.isHover=c.value),i.push(x(Zt,p,null))}),i}function qe(e,l,t,o,n){const{expanded:r,level:s,record:a,rowKey:c}=e,i={key:c,expanded:r,level:s,record:a,rowData:e,rowIndex:l,rowKey:c},u=x(ol,i,null),d=r&&rl(i,t,o,n);return d?[u,d]:u}function rl(e,l,t,o){const{customExpand:n}=t||{},{record:r,rowIndex:s}=e;let a;return J(n)?a=n({record:r,rowIndex:s}):N(n)&&l[n]&&(a=l[n]({record:r,rowIndex:s})),a&&x(de,{class:`${o}-expanded-row`},{default:()=>[a]})}const re=H({setup(e,{slots:l}){const{props:t,slots:o,mergedPrefixCls:n,mergedAutoHeight:r,flattedData:s,expandable:a,scrollWidth:c,scrollHeight:i,isSticky:u}=F(_),d=b(()=>r.value||c.value||i.value||u.value);return()=>{const h=n.value,y=[];o.alert&&y.push(x(de,{class:`${h}-alert-row`},{default:()=>[o.alert()]}));const f=s.value;return f.length>0?l.default?y.push(...l.default()):f.forEach((S,C)=>{y.push(...fe(qe(S,C,o,a.value,h)))}):y.push(x(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[x(Je,{empty:t.empty},o)]})),x("tbody",{class:`${n.value}-tbody`},[d.value&&x(Qt,null,null),y])}}}),cl=H({props:Yt,setup(e){const{slots:l,config:t,locale:o,mergedPrefixCls:n}=F(_),r=b(()=>e.filterable.multiple??t.columnBase.filterable.multiple),s=b(()=>e.filterable.footer??t.columnBase.filterable.footer),a=e.activeFilterBy,[c,i]=oe(()=>a);D(()=>e.activeFilterBy,v=>i(v));const[u,d]=oe(!1),h=v=>{d(v),v||e.onUpdateFilterBy(c.value)},y=()=>{d(!1),e.onUpdateFilterBy(c.value)},f=()=>{i(a)},S=v=>{const g=`${n.value}-filterable-menu-label`,p=r.value?ve:Ie;return x("span",{class:g},[x(p,{checked:v.selected,disabled:v.disabled},null),x("span",{class:`${g}-content`},[v.label])])},C=()=>{const v=[],{customMenu:g,menus:p}=e.filterable;return J(g)?v.push(g()):N(g)&&l[g]?v.push(l[g]()):v.push(il(p,r,c,i,S)),s.value&&v.push(ul(o,n,y,f)),v},k=b(()=>{const v=`${n.value}-filterable-trigger`;return V({[v]:!0,[`${v}-active`]:e.activeFilterBy.length>0})}),m=()=>{const{customTrigger:v}=e.filterable;return J(v)?v():N(v)&&l[v]?l[v]():x("span",{class:k.value,onClick:g=>g.stopPropagation()},[x(te,{name:"filter-filled"},null)])};return()=>{const v={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return x(ke,v,{default:m,overlay:C})}}}),il=(e,l,t,o,n)=>{const r={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":o};return x(Be,r,{itemLabel:n})},ul=(e,l,t,o)=>{const{filterConfirm:n,filterReset:r}=e.table;return x("div",{class:`${l.value}-filterable-trigger-footer`},[x(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[n]}),x(me,{size:"xs",onClick:o},{default:()=>[r]})])},dl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:o,currentPageAllSelected:n,currentPageSomeSelected:r,handleHeadSelectChange:s,mergedSelectableMenus:a,handleSelectableMenuClick:c}=F(_),i=b(()=>{const C=l.value.size;return C===0||C===o.value.disabledRowKeys.length}),[u,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},y=()=>x(Be,{dataSource:a.value,onClick:c},null),f=()=>x(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),S=()=>{if(a.value.length!==0)return x(ke,h,{default:f,overlay:y})};return()=>{const{multiple:C}=t.value;if(C)return x("span",{class:`${e.value}-cell-triggers`},[x(ve,{checked:n.value,indeterminate:r.value,disabled:i.value,onChange:s},null),S()])}}}),fl=H({props:Gt,setup(e){const{locale:l,mergedPrefixCls:t}=F(_);return()=>{const{activeOrderBy:o,sortable:n}=e,{orders:r,nextTooltip:s}=n,a=s&&vl(l.table,r,o),c=hl(t,r,o);return a?x(Qe,{title:a},{default:()=>[c]}):c}}});function vl(e,l,t){const o=t?l[l.indexOf(t)+1]:l[0],{sortCancel:n,sortAsc:r,sortDesc:s}=e;return o?o==="ascend"?r:s:n}function hl(e,l,t){const o=e.value,n=`${o}-sortable-trigger-active`,r=l.includes("ascend")&&x(te,{name:"caret-up-filled",class:t==="ascend"?n:void 0},null),s=l.includes("descend")&&x(te,{name:"caret-down-filled",class:t==="descend"?n:void 0},null);return x("span",{class:`${o}-sortable-trigger`},[r,s])}const yl=H({props:Ut,setup(e){const{props:l,slots:t,mergedPrefixCls:o,fixedColumnKeys:n,columnOffsetsWithScrollBar:r,isSticky:s,handleSort:a,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(_),d=b(()=>{const{type:m,ellipsis:v}=e.column,g=m?v:v??l.ellipsis;return Ke(g)&&g.head===!1?void 0:g}),h=b(()=>{const{type:m,align:v,fixed:g,hasChildren:p,key:w,sortable:K,filterable:B}=e.column,E=o.value;let P={[`${E}-cell`]:!0,[`${E}-cell-${m}`]:!!m,[`${E}-cell-filterable`]:!!B,[`${E}-cell-sortable`]:!!K,[`${E}-cell-align-center`]:p||v==="center",[`${E}-cell-align-end`]:!p&&v==="end",[`${E}-cell-ellipsis`]:!!d.value};if(g){const{lastStartKey:O,firstEndKey:A}=n.value;P={...P,[`${E}-fix-start`]:g==="start",[`${E}-fix-start-last`]:O===w,[`${E}-fix-end`]:g==="end",[`${E}-fix-end-first`]:A===w,[`${E}-fix-sticky`]:s.value}}return V(P)}),y=b(()=>{const{fixed:m,colStart:v,colEnd:g}=e.column;if(!m)return;const{starts:p,ends:w}=r.value,E=z((m==="start"?p:w)[m==="start"?v:g]);return{position:"sticky",left:m==="start"?E:void 0,right:m==="end"?E:void 0}}),f=b(()=>c[e.column.key]),S=b(()=>i[e.column.key]),C=m=>{const{key:v,filterable:g}=e.column;u(v,g,m)},k=()=>{const{key:m,sortable:v}=e.column;v&&a(m,v)};return()=>{var A,R;const{column:m}=e,{type:v,titleColSpan:g,titleRowSpan:p}=m;if(v==="scroll-bar")return x("th",{class:h.value,style:y.value,colspan:g===1?void 0:g,rowspan:p===1?void 0:p,onClick:k},null);const w=o.value;let K,B;if(v==="selectable")B=x(dl,null,null);else{const{title:$,customTitle:T,sortable:W,filterable:U}=m,L=d.value;B=pl($,T,t),K=Re(L,B,$);const j=gl(W,f,U,S,C);j.length>0?B=x("span",{class:`${w}-cell-triggers`},[x("span",{class:`${w}-cell-title`},[B]),j]):L&&(B=x("span",{class:`${w}-cell-title`},[B]))}const E=(A=l.customAdditional)==null?void 0:A.headCell,P=E?E({column:m}):void 0,O=((R=l.customTag)==null?void 0:R.headCell)??"th";return x(O,Z({class:h.value,style:y.value,colSpan:g===1?void 0:g,rowSpan:p===1?void 0:p,title:K},P,{onClick:k}),{default:()=>[B]})}}});function pl(e,l,t){let o=e;return J(l)?o=l({title:e}):N(l)&&t[l]&&(o=t[l]({title:e})),o}function gl(e,l,t,o,n){const r=[];return e&&r.push(x(fl,{activeOrderBy:l.value,sortable:e},null)),t&&r.push(x(cl,{activeFilterBy:o.value,filterable:t,onUpdateFilterBy:n},null)),r}const ml=H({props:jt,setup(e){const{props:l,mergedPrefixCls:t}=F(_);return()=>{var a,c;const{columns:o}=e,n=(a=l.customAdditional)==null?void 0:a.headRow,r=n?n({columns:o}):void 0,s=((c=l.customTag)==null?void 0:c.headRow)??"tr";return x(s,Z({class:`${t.value}-row`},r),{default:()=>[o.filter(i=>i.titleColSpan!==0).map(i=>x(yl,{key:i.key,column:i},null))]})}}}),Se=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(_);return()=>{var a,c;const o=l.value,n=(a=e.customAdditional)==null?void 0:a.head,r=n?n({rows:o}):void 0,s=((c=e.customTag)==null?void 0:c.head)??"thead";return x(s,Z({class:`${t.value}-thead`},r),{default:()=>[o.map((i,u)=>x(ml,{key:u,columns:i},null))]})}}}),bl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:o,mergedVirtualItemHeight:n,mergedAutoHeight:r,columnWidths:s,changeColumnWidth:a,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:y,handleScroll:f,pingedStart:S,pingedEnd:C,scrollWidth:k,scrollHeight:m,hasFixed:v,tableLayout:g}=F(_),p=I(),w=I(0);Te(pe,{mainTableWidth:w,changeColumnWidth:($,T)=>{lt(p.value)&&a($,T)}});const B=()=>{const $=X(h);$&&f({currentTarget:$})},E=$=>{const{offsetWidth:T}=$.target;T!==w.value&&(w.value=T)};se(()=>{B(),D([()=>e.dataSource,k],([,T])=>{T&&B()}),D(s,Ee(()=>{var W;((W=X(h))==null?void 0:W.scrollLeft)===0&&B()},16)),Ze(p.value,E)}),Q(()=>et(p.value,E));const P=b(()=>{const $=o.value;return V({[`${$}-container`]:!0,[`${$}-ping-start`]:S.value,[`${$}-ping-end`]:C.value,[`${$}-fixed-layout`]:g.value==="fixed",[`${$}-fixed-column`]:v.value,[`${$}-scroll-horizontal`]:k.value,[`${$}-scroll-vertical`]:m.value})}),O=b(()=>{var j;const $=k.value,T=m.value,W=$?"auto":void 0,U=e.virtual?"hidden":T?"scroll":$?"hidden":void 0,L=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:W,overflowY:U,[L?"height":"maxHeight"]:T}}),A=b(()=>({tableLayout:g.value,width:k.value,minWidth:k.value?"100%":void 0})),R=($,T,W)=>{M(e.onScrolledChange,$,T,W.map(U=>U.record))};return()=>{const $=o.value,T=r.value,W=l.default?l.default():[];if(T||m.value||i.value){const{offsetTop:U}=u.value;if(e.headless||W.push(x(zt,{offsetTop:U},{default:()=>[x(Se,null,null)]})),e.virtual&&(e.scroll||T)){const L=({item:ae,index:Ve})=>qe(ae,Ve,l,t.value,$),j=ae=>x("table",{ref:y,class:`${$}-table`,style:A.value},[x(ne,null,null),x(re,null,{default:()=>[ae]}),!1]),{scroll:q,onScrolledBottom:Xe}=e;W.push(x(tt,{ref:d,style:O.value,dataSource:c.value,fullHeight:q==null?void 0:q.fullHeight,getKey:"rowKey",height:r.value?"100%":q==null?void 0:q.height,itemHeight:n.value,itemRender:L,contentRender:j,virtual:!0,onScroll:f,onScrolledBottom:Xe,onScrolledChange:R},null))}else W.push(x("div",{ref:h,class:`${$}-content`,style:O.value,onScroll:f},[x("table",{ref:y,class:`${$}-table`,style:A.value},[x(ne,null,null),x(re,null,null),!1])]));i.value&&W.push(x(Nt,null,null))}else W.push(x("div",{ref:h,class:`${$}-content`,style:O.value,onScroll:f},[x("table",{ref:y,class:`${$}-table`,style:A.value},[x(ne,null,null),!e.headless&&x(Se,null,null),x(re,null,null),!1])]));return x("div",{ref:p,class:P.value},[W])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xl(e,l){return e.footer?x("div",{class:`${l}-footer`},[e.footer()]):null}function Sl(e,l,t){let o=null,n=null;if(e!==null){const{position:r}=e,[s,a]=dt(r).split("-"),c=`${t}-pagination ${t}-pagination-${a}`,i=x(vt,Z({class:c,total:l.length},e),null);o=s==="top"?i:null,n=s==="bottom"?i:null}return[o,n]}const Cl={sm:32,md:40,lg:56},wl={sm:40,md:48,lg:56},kl=H({name:"IxTable",props:Lt,setup(e,{expose:l,slots:t}){const o=le("common"),n=b(()=>`${o.prefixCls}-table`),r=le("locale"),s=le("table"),a=b(()=>e.autoHeight??s.autoHeight),c=b(()=>e.childrenKey??s.childrenKey),i=nt(e,s),u=b(()=>e.emptyCell??s.emptyCell),d=b(()=>e.size??s.size),h=b(()=>o.theme==="seer"?Cl[d.value]:wl[d.value]),{mergedPagination:y}=Bt(e,s,d),f=_t(e),S=Kt(e,a,f),C=yt(e,t,s,S.scrollBarSizeOnFixedHolder),k=At(C.flattedColumns),m=kt(C.flattedColumns),v=wt(e,C.flattedColumns),g=Mt(e,C,S,f.isSticky,a),{activeSorters:p}=k,{activeFilters:w}=m,K=Ct(e,c,i,p,w,v.expandedRowKeys,y),B=Rt(e,r,C.flattedColumns,K);Tt(e,s,y,p,w,S.scrollTo);const E={props:e,slots:t,config:s,locale:r,mergedPrefixCls:n,mergedEmptyCell:u,mergedVirtualItemHeight:h,mergedAutoHeight:a,...C,...S,...k,...m,...f,tableLayout:g,mergedPagination:y,...v,...K,...B};Te(_,E),l({scrollTo:S.scrollTo});const{flattedData:P,filteredData:O}=K,A=b(()=>{const R=n.value,{borderless:$=s.borderless,scroll:T}=e;return V({[R]:!0,[`${R}-auto-height`]:a.value,[`${R}-borderless`]:$,[`${R}-empty`]:P.value.length===0,[`${R}-full-height`]:T==null?void 0:T.fullHeight,[`${R}-${d.value}`]:!0})});return()=>{const R=n.value,$=x(ot,{header:e.header},t),T=xl(t,R),[W,U]=Sl(y.value,O.value,R),L=[$],j=[W,x(bl,null,null),T,U].filter(Boolean),q=Bl(e.spin);return q?L.push(x(st,q,{default:()=>[j]})):L.push(...j),x("div",{class:A.value},[L])}}});function Bl(e){return ft(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Il=kl,Ol=ye;export{Il as I,Ol as a,ht as g};
