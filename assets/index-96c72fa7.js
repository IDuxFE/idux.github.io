import{c as p,q as z,x as U,b8 as Xe,bk as G,b9 as kt,bd as Ge,c4 as Bt,be as Oe,bz as $t,aN as $e,c5 as Fe,bg as Ye,R as q,ao as Ze,as as Be,Z as Q,c6 as Ie,aj as ae,y as he,v as Te,ah as Re,aE as Tt,c7 as Kt,c8 as Et,bb as xe,d as L,i as N,an as ie,f as b,aA as Je,br as ve,$ as Ce,az as Qe,k as Ae,N as ze,aR as It,bo as Rt,af as ye,al as et,aD as be,aB as fe,H as Pt,aF as _e,h as Mt,c9 as tt,a5 as He,ai as Ot,ak as zt,ca as Ht,bq as Wt,aV as Dt,C as Ft,D as At,bc as Ne,at as _t,bs as Nt,bj as Lt,bT as Vt,b7 as jt}from"./index-da4385ef.js";import{u as Ut}from"./useTreeCheckState-b3c55523.js";import{b as lt}from"./GlobalCodeBox-0f73b872.js";import{I as qt}from"./index-9a41038b.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Xt(e,t,l){const o=p(()=>{const{fixedStartColumns:n,fixedEndColumns:s,fixedColumnIndexMap:r}=e.value;return Le(n,s.filter(c=>c.type!=="scroll-bar"),r,t.value,l.value-1)}),a=p(()=>{const{fixedStartColumns:n,fixedEndColumns:s,fixedColumnIndexMap:r}=e.value;return Le(n,s,r,t.value,l.value)});return{columnOffsets:o,columnOffsetsWithScrollBar:a}}function Le(e,t,l,o,a){var i,d,h,y,m,S;const n={},s={};let r=0,c=0;for(let C=0;C<e.length;C++){const x=e[C],k=(d=(i=o[x.key])!=null?i:x.width)!=null?d:0;n[x.key]={index:(h=l[x.key])!=null?h:C,offset:r},r+=k}for(let C=0;C<t.length;C++){const x=t[t.length-C-1],k=(m=(y=o[x.key])!=null?y:x.width)!=null?m:0;s[x.key]={index:(S=l[x.key])!=null?S:a-C-1,offset:c},c+=k}return{starts:n,ends:s}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Gt(e){const t=z({}),l=(o,a)=>{a===!1?delete t.value[o]:t.value[o]=a};return U(e,o=>{const a=new Set(o.map(n=>n.key));Object.keys(t).forEach(n=>{a.has(n)||delete t.value[n]})}),{measuredColumnWidthMap:t,changeColumnWidth:l}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const nt=Symbol("IxTableColumn"),We=()=>{};We.displayName="IxTableColumn";We[nt]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ot(e,t,l){if(!e||Xe(e)&&e.title===!1)return;if(G(t)||kt(t))return t;const o=Ge(t).find(a=>a.type===Bt);return o?o.children:l}function Yt(e){return"key"in e?e.key:"dataKey"in e?Oe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:$t("__IDUX_table_column_key_")}function at(e,t,l,o,a,n,s=!1){const r=y=>y.filter(m=>m.type!=="scroll-bar"),c=s?a:r(a),i=s?n:r(n);if(!c.length&&!i.length)return;const d=o.findIndex(y=>y.rowKey===e.rowKey),h=y=>{if(t.findIndex(C=>C.key===y.key)>-1)return;const m=l.findIndex(C=>C.key===y.key);let S;return G(y.key)?S=`fix-${d}-${y.key}`:S=`fix-${d}-${m}`,{data:y,index:m,poolKey:S}};return{start:c.map(h).filter(Boolean),end:i.map(h).filter(Boolean)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Zt(e,t,l,o){const a=p(()=>{var S;const{columns:m}=e;return rt(m&&m.length>0?m:st((S=t.default)==null?void 0:S.call(t)),l)}),{flattedColumns:n,scrollBarColumn:s,flattedColumnsWithScrollBar:r}=Qt(a,o),{fixedColumns:c,fixedColumnKeys:i}=el(r),d=p(()=>!!e.ellipsis||n.value.some(m=>m.ellipsis)),h=p(()=>n.value.some(m=>m.fixed)),y=p(()=>tl(a.value,s.value));return{flattedColumns:n,scrollBarColumn:s,flattedColumnsWithScrollBar:r,fixedColumns:c,fixedColumnKeys:i,hasEllipsis:d,hasFixed:h,mergedRows:y}}function rt(e,t){return e.map(l=>Jt(l,t))}function st(e){const t=[];return Ge(e,{key:nt}).forEach((l,o)=>{const{props:a,children:n}=l,{key:s=o,editable:r,ellipsis:c,...i}=a||{};i.key=s,i.editable=r||r==="",i.ellipsis=c||c==="";const{default:d,cell:h,title:y,expand:m,icon:S}=n||{};d&&(i.children=st(d())),h&&(i.customCell=h),y&&(i.customTitle=y),m&&(i.customExpand=m),S&&(i.customIcon=S),t.push(i)}),t}function me(e){return G(e)?{title:e,cell:e}:e}function Jt(e,t){var c,i;const{columnBase:l,columnExpandable:o,columnSelectable:a,columnIndexable:n}=t,{align:s=l.align}=e,r=Yt(e);if("type"in e){const{type:d}=e;if(d==="expandable"){const{showLine:h=o.showLine,icon:y=o.icon}=e;return{...e,key:r,align:me(s),icon:y,showLine:h}}if(d==="selectable"){const{multiple:h=!0,showIndex:y=a.showIndex}=e;return{...e,key:r,align:me(s),multiple:h,showIndex:y}}if(d==="indexable"){const h=(i=(c=e.align)!=null?c:n.align)!=null?i:l.align;return{...n,...e,align:me(h),key:r}}return{...e,key:r,align:me(s)}}else{const{sortable:d,filterable:h,children:y}=e,m={...e,key:r,align:me(s)};return d&&(m.sortable={...l.sortable,...d}),h&&(m.filterable={...l.filterable,...h}),y!=null&&y.length&&(m.children=rt(y,t)),m}}function Qt(e,t){const l=p(()=>De(e.value)),o=p(()=>{const n=t.value,s=l.value;if(n===0||s.length===0)return;const r=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:r&&r.fixed,width:n}}),a=p(()=>{const n=l.value,s=o.value;return s?[...n,s]:n});return{flattedColumns:l,scrollBarColumn:o,flattedColumnsWithScrollBar:a}}function De(e){const t=[];return e.forEach(l=>{const{fixed:o,children:a}=l;if(a!=null&&a.length){let n=De(a);o&&(n=n.map(s=>({fixed:o,...s}))),t.push(...n)}else t.push(l)}),t}function el(e){const t=p(()=>{const o=[],a=[],n={};return e.value.forEach((s,r)=>{const{key:c,fixed:i}=s;i==="start"?(o.push(s),n[c]=r):i==="end"&&(a.push(s),n[c]=r)}),{fixedStartColumns:o,fixedEndColumns:a,fixedColumnIndexMap:n}}),l=p(()=>{var n,s;const{fixedStartColumns:o,fixedEndColumns:a}=t.value;return{lastStartKey:(n=o[o.length-1])==null?void 0:n.key,firstEndKey:(s=a[0])==null?void 0:s.key}});return{fixedColumns:t,fixedColumnKeys:l}}function tl(e,t){const l=[],o={};function a(r,c,i){var y;(y=l[i])!=null||(l[i]=[]);let d=c;return r.map(m=>{var g;let S=(g=m.titleColSpan)!=null?g:1,C=!1;const x=m.children;if(x!=null&&x.length){C=!0;const u=a(x,d,i+1);$e(m.titleColSpan)&&(S=u.reduce((f,v)=>f+v))}const k=d+S-1;return l[i].push({...m,titleColSpan:S,colStart:d,colEnd:k,hasChildren:C}),o[m.key]={colStart:d,colEnd:k},d+=S,S})}const n=t?[...e,t]:e;a(n,0,0);const s=l.length;return l.forEach((r,c)=>{r.forEach(i=>{i.hasChildren||(i.titleRowSpan=s-c)})}),{rows:l,offsetIndexMap:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ll(e,t,l,o,a,n,s){const r=p(()=>{const g=t.value,u=l.value;return e.dataSource.map((f,v)=>ct(f,u,g,v,e.dataSource.length))}),c=p(()=>{const g=new Map,u=new Map,f=new Map;return Fe(r.value,"children",(v,B)=>{var T;g.set(v.rowKey,v),u.set(v.rowKey,(T=B[0])==null?void 0:T.rowKey),f.set(v.rowKey,B.length)}),{dataKeyMap:g,parentKeyMap:u,depthMap:f}}),i=p(()=>c.value.dataKeyMap),d=p(()=>c.value.parentKeyMap),h=p(()=>c.value.depthMap),y=p(()=>ut(r.value,a.value,n.value)),m=p(()=>it(y.value,o.value,n.value)),S=p(()=>{const g=s.value,u=m.value;if(g===null||!g.pageSize)return u;{const{total:f}=g;if(f&&u.length<f)return u;const v=g.pageSize,B=(g.pageIndex-1)*v;return u.slice(B,B+v)}}),C=p(()=>{const g=new Map;return Fe(S.value,"children",u=>{g.set(u.rowKey,u)}),g}),x=p(()=>{const g=n.value;return g.length>0?dt(S.value,g,0):S.value});return{isTreeData:p(()=>r.value.some(g=>{var u;return(u=g.children)==null?void 0:u.length})),filteredData:y,flattedData:x,mergedData:r,mergedMap:i,paginatedData:S,paginatedMap:C,parentKeyMap:d,depthMap:h}}function ct(e,t,l,o,a,n){var i;const s=t(e),r={record:e,rowKey:s,parentKey:n==null?void 0:n[0].rowKey,showLineIndentIndexList:(i=[...n!=null?n:[]].reverse())==null?void 0:i.reduce((d,h,y)=>(h.hasNextSibling&&d.push(y),d),[]),hasPrevSibling:o>0,hasNextSibling:o<a-1},c=e[l];return c&&(r.children=c.map((d,h)=>ct(d,t,l,h,c.length,[r,...n!=null?n:[]]))),r}function it(e,t,l){const o=t.filter(s=>s.sorter),a=o.length;if(a===0)return e;const n=e.slice();return n.forEach(s=>{l.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=it(s.children,t,l))}),n.sort((s,r)=>{for(let c=0;c<a;c++){const{orderBy:i,sorter:d}=o[c],h=d(s.record,r.record);if(h!==0)return i==="ascend"?h:-h}return 0})}function ut(e,t,l){const o=t.filter(a=>a.filter);return o.length===0?e:e.map(a=>{const n=o.every(({filter:d,filterBy:h})=>d(h,a.record)),{rowKey:s,children:r}=a,c=l.includes(s);let i=a;if(c&&r&&r.length){const d=ut(r,t,l);d.length!==r.length&&(i={...a,children:d})}return n||c&&i.children&&i.children.length?i:null}).filter(a=>a!==null)}function dt(e,t,l){return e.reduce((o,a)=>{const{children:n,parentKey:s,record:r,rowKey:c,hasPrevSibling:i,hasNextSibling:d,showLineIndentIndexList:h}=a,y=t.includes(c);if(o.push({children:n,parentKey:s,record:r,rowKey:c,level:l,expanded:y,hasPrevSibling:i,hasNextSibling:d,showLineIndentIndexList:h}),y&&a.children){const m=dt(a.children,t,l+1);o.push(...m)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function nl(e,t){const l=p(()=>t.value.find(r=>"type"in r&&r.type==="expandable")),[o,a]=Ye(e,"expandedRowKeys",()=>[]);return{expandable:l,expandedRowKeys:o,setExpandedRowKeys:a,checkExpandDisabled:r=>{if(!l.value)return!0;const{disabled:c,customExpand:i}=l.value,{record:d}=r;return c!=null&&c(d)?!0:!(i||r.children&&r.children.length>0)},handleExpandChange:(r,c)=>{const{onChange:i,onExpand:d}=l.value||{},h=[...o.value],y=h.indexOf(r),m=y>=0;m?h.splice(y,1):h.push(r),q(d,!m,c),a(h),q(i,h)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ol(e){const t=p(()=>e.value.filter(n=>n.filterable)),l=Ze({}),o=z([]);return U(t,(n,s)=>{n.forEach(r=>{const{key:c,filterable:i}=r,d=i.filterBy;if(d||l[c]===void 0){l[c]=d||[];return}const h=s?s.find(m=>m.key===c):void 0;(h==null?void 0:h.filterable.filterBy)&&(l[c]=[])}),o.value=Ve(n,l)},{immediate:!0}),{activeFilters:o,activeFilterByMap:l,handleFilter:(n,s,r)=>{const{onChange:c}=s;l[n]=r,o.value=Ve(t.value,l),q(c,r,o.value)}}}function Ve(e,t){return e.map(l=>{const{key:o,filterable:a}=l,{filter:n,filterBy:s=t[o]}=a;return{key:o,filter:n,filterBy:s}}).filter(l=>l.filter&&l.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function al(e,t,l){var i,d,h,y,m;const o=Be("pagination"),a=p(()=>{const{pagination:S}=e;return S===!1?null:S===!0?{}:S}),n=z((d=(i=a.value)==null?void 0:i.pageIndex)!=null?d:1),s=z((m=(y=(h=a.value)==null?void 0:h.pageSize)!=null?y:t.pagination.pageSize)!=null?m:o.pageSize),r=(S,C)=>{var x;n.value=S,s.value=C,q((x=a.value)==null?void 0:x.onChange,S,C)};return{mergedPagination:p(()=>{var C,x;const S=a.value;return S===null?null:{...t.pagination,size:l.value,...S,pageIndex:(C=S.pageIndex)!=null?C:n.value,pageSize:(x=S.pageSize)!=null?x:s.value,onChange:r}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function rl(e,{setStickyScrollLeft:t}){const l=z(),o=z(),a=z(),n=z(),s=z(),r=z();U(l,v=>{v&&(n.value=v.getHolderElement())},{immediate:!0}),U(o,v=>{v&&(a.value=v.getHolderElement(),a.value.style.overflow="hidden")},{immediate:!0});const c=il(n,s),{handleScroll:i,pingedStart:d,pingedEnd:h}=sl(e,l,o,a,n,r,c,t),{scrollHorizontalOverflowed:y,scrollVerticalOverflowed:m}=cl(n,c),S=p(()=>{var v;return Q((v=e.scroll)==null?void 0:v.width)}),C=p(()=>{var v;return Q((v=e.scroll)==null?void 0:v.height)}),x=p(()=>Ie(ae(n))),k=p(()=>m.value?x.value:0),g=p(()=>d.value&&y.value),u=p(()=>h.value&&y.value);return{virtualScrollRef:l,headerVirtualScrollRef:o,scrollHeadRef:a,scrollBodyRef:n,scrollContentRef:s,scrollFootRef:r,handleScroll:i,scrollTo:v=>{var B;e.virtual?(B=l.value)==null||B.scrollTo(v):typeof v=="number"&&Tt({target:ae(n),top:v,duration:200})},pingedStart:g,pingedEnd:u,scrollWidth:S,scrollHeight:C,scrollBarSize:x,scrollBarSizeOnFixedHolder:k,scrollHorizontalOverflowed:y,scrollVerticalOverflowed:m}}function sl(e,t,l,o,a,n,s,r){const c=z(!1),i=z(!1);let d;const h=()=>{d&&(clearTimeout(d),d=void 0)};he(()=>h());const y=z(),m=g=>{y.value=g,h(),d=setTimeout(()=>{y.value=void 0,d=void 0},100)},S=(g,u)=>{u&&u.scrollLeft!==g&&(u.scrollLeft=g)},C=(g,u)=>{u&&u.scrollTo({left:g})},x=g=>{const u=ae(a);if(!u)return;const{clientWidth:f,scrollWidth:v}=u;r(g/v*f||0)},k=(g,u)=>{const f=g==null?void 0:g.currentTarget,v=u!=null?u:f.scrollLeft,B=y.value;if((!B||B===f)&&(m(f),l.value?C(v,l.value):S(v,o.value),t.value?C(v,t.value):S(v,ae(a)),S(v,n.value),x(v)),f){const{scrollWidth:T,clientWidth:$}=f;c.value=v>1,i.value=T-$-v>1}(g==null?void 0:g.type)==="scroll"&&q(e.onScroll,g)};return U(s,()=>{const g=ae(a);g&&k({currentTarget:g})}),{handleScroll:k,pingedStart:c,pingedEnd:i}}function cl(e,t){const l=z(!1),o=z(!1);return U(t,()=>{const n=ae(e.value);n?(l.value=n.scrollWidth>n.clientWidth,o.value=n.scrollHeight>n.clientHeight):(l.value=!1,o.value=!1)}),{scrollHorizontalOverflowed:l,scrollVerticalOverflowed:o}}function il(e,t){const l=z(!1),o=()=>{l.value=!l.value};let a=[];const n=()=>a.forEach(s=>s());return Te(()=>{a=[Re(e,o),Re(t,o)]}),he(()=>n()),l}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ul(e,t,l,o,a,n){const s=p(()=>{var d;return(d=e.scrollToTopOnChange)!=null?d:t.scrollToTopOnChange});let r=[];const c=()=>{r=[U([()=>{var d;return(d=l.value)==null?void 0:d.pageIndex},()=>{var d;return(d=l.value)==null?void 0:d.pageSize}],()=>n(0)),U([a,o],([d,h],[y,m])=>{(!dl(d,y)||!fl(h,m))&&n(0)})]},i=()=>{r.forEach(d=>d())};U(s,d=>{i(),d&&c()},{immediate:!0})}function dl(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(a=>a.key===l.key);return o?l.filter===o.filter&&l.filterBy.length===o.filterBy.length&&l.filterBy.every(a=>o.filterBy.includes(a)):!1})}function fl(e,t){return e.length===t.length&&e.every(l=>{const o=t.find(a=>a.key===l.key);return o?l.sorter===o.sorter&&l.orderBy===o.orderBy&&l.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function vl(e,t,l,{mergedData:o,mergedMap:a,paginatedMap:n,parentKeyMap:s,depthMap:r}){const c=p(()=>l.value.find(P=>"type"in P&&P.type==="selectable")),[i,d]=Ye(e,"selectedRowKeys",()=>[]),h=p(()=>({data:o.value,dataMap:a.value,parentKeyMap:s.value,depthMap:r.value})),y=z("children"),m=z(P=>P.rowKey),S=p(()=>{var P;return(P=c.value)!=null&&P.multiple?e.cascaderStrategy:"off"}),C=p(()=>{var M;const P=(M=c.value)==null?void 0:M.disabled;return A=>!!(P!=null&&P(A.record))}),x=Ut(i,h,y,m,S,C),{checkStateResolver:k,isCheckDisabled:g,isChecked:u,isIndeterminate:f,toggle:v,getDataByKeys:B}=x,T=p(()=>{const P=[],M=[];return n.value.forEach((A,O)=>{g(O)?M.push(O):P.push(O)}),{enabledRowKeys:P,disabledRowKeys:M}}),$=p(()=>{let P=!!n.value.size,M=!!n.value.size,A=!1;for(const O of n.value.keys())u(O)||f(O)?A=!0:(M=!1,g(O)||(P=!1));return!M&&!A&&(P=!1),{checked:P,allSelected:M,someSelected:A}}),I=p(()=>$.value.checked),w=p(()=>!$.value.allSelected&&$.value.someSelected),R=P=>{d(P);const{onChange:M}=c.value||{};if(M){const A=B(P).map(O=>O.record);q(M,P,A)}},H=(P,M)=>{const O=a.value.get(P);if(!O)return;const{multiple:X,onSelect:J}=c.value||{};let re=[...i.value],ee;if(X){const{checked:ge,checkedKeys:ce}=v(O);ee=ge,re=ce}else ee=!u(P),re=ee?[P]:[];q(J,ee,M),R(re)},W=()=>{let P;if(I.value){const M=[];n.value.forEach((A,O)=>{g(O)||u(O)&&M.push(O)}),P=k.removeKeys(i.value,M)}else{const M=[];n.value.forEach((A,O)=>{g(O)||u(O)||M.push(O)}),P=k.appendKeys(i.value,M)}R(P)},_=hl(c,t),Y=yl(c,x,a,n,i,R);return{selectable:c,selectedRowKeys:i,isChecked:u,isIndeterminate:f,isCheckDisabled:g,currentPageRowKeys:T,currentPageAllSelected:I,currentPageSomeSelected:w,handleSelectChange:H,handleHeadSelectChange:W,mergedSelectableMenus:_,handleSelectableMenuClick:Y}}const ft=Symbol("IDUX_TABLE_KEY_selectable-all"),vt=Symbol("IDUX_TABLE_KEY_selectable-invert"),ht=Symbol("IDUX_TABLE_KEY_selectable-none"),yt=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function hl(e,t){return p(()=>{const{menus:l}=e.value||{};if(!l||l.length===0)return[];const{selectAll:o,selectInvert:a,selectNone:n,selectPageInvert:s}=t.table;return l.map(r=>G(r)?r==="all"?{type:"item",key:ft,label:o}:r==="invert"?{type:"item",key:vt,label:a}:r==="none"?{type:"item",key:ht,label:n}:r==="pageInvert"?{type:"item",key:yt,label:s}:{type:"item",key:r,label:r}:r)})}function yl(e,t,l,o,a,n){const{checkDisabledKeySet:s,checkStateResolver:r,getAllCheckedKeys:c,isChecked:i,isCheckDisabled:d}=t,h=()=>{const{onSelectAll:x}=e.value||{},k=c([...s.value].filter(g=>!i(g)));q(x,k),n(k)},y=()=>{const{onSelectInvert:x}=e.value||{},k=[],g=[];l.value.forEach((f,v)=>{d(v)||(i(v)?g.push(v):k.push(v))});const u=r.removeKeys(r.appendKeys(a.value,k),g);n(u),q(x,u)},m=()=>{const{onSelectNone:x}=e.value||{};q(x),n([])},S=()=>{const{onSelectPageInvert:x}=e.value||{},k=[],g=[];o.value.forEach((f,v)=>{d(v)||(i(v)?g.push(v):k.push(v))});const u=r.removeKeys(r.appendKeys(a.value,k),g);n(u),q(x,u)},C=new Map([[ft,h],[vt,y],[ht,m],[yt,S]]);return x=>{const k=x.key;if(Kt(k)&&C.has(k)){C.get(k)();return}const{onMenuClick:g}=e.value||{};if(!g)return;const u=[];o.value.forEach((f,v)=>{d(v)||u.push(v)}),q(g,x,u)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function gl(e){const t=p(()=>e.value.filter(s=>s.sortable)),l=p(()=>t.value.some(s=>s.sortable.multiple!==void 0)),o=Ze({}),a=z([]);return U(t,(s,r)=>{s.forEach(c=>{const{key:i,sortable:d}=c,h=d.orderBy;if(h||o[i]===void 0){o[i]=h;return}const y=r?r.find(S=>S.key===i):void 0;(y==null?void 0:y.sortable.orderBy)&&(o[i]=void 0)}),a.value=Ue(s,o)},{immediate:!0}),{activeSorters:a,activeOrderByMap:o,handleSort:(s,r)=>{const{orders:c,onChange:i}=r,d=o[s],h=d?je(c,d):je(c);l.value?o[s]=h:Object.keys(o).forEach(y=>{s===y?o[y]=h:o[y]=void 0}),a.value=Ue(t.value,o),q(i,h,a.value)}}}function je(e,t){return t?e[e.indexOf(t)+1]:e[0]}function Ue(e,t){return e.map(l=>{const{key:o,sortable:a}=l,{multiple:n=0,orderBy:s=t[o],sorter:r}=a;return{key:o,multiple:n,orderBy:s,sorter:r}}).filter(l=>l.orderBy).sort((l,o)=>o.multiple-l.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function pl(e){const t=p(()=>!!e.sticky),l=p(()=>{const{sticky:n}=e,{offsetTop:s=0,offsetBottom:r=0,offsetScroll:c=0,container:i=window}=Et(n)?n:{};return{offsetTop:s,offsetBottom:r,offsetScroll:c,container:i}}),[o,a]=xe(0);return{isSticky:t,mergedSticky:l,stickyScrollLeft:o,setStickyScrollLeft:a}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ml(e,{hasEllipsis:t,hasFixed:l},{scrollWidth:o,scrollHeight:a},n,s,r){return p(()=>e.tableLayout?e.tableLayout:o.value&&l.value?o.value==="max-content"?"auto":"fixed":a.value||r.value||n.value||t.value||s.value.horizontal||s.value.vertical?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const j=Symbol("TABLE_TOKEN"),gt=Symbol("tableBodyToken"),pt=Symbol("tableBodyRowToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Se=L({props:{isFixedHolder:Boolean,columns:Array},setup(e){const{flattedColumns:t,flattedColumnsWithScrollBar:l,measuredColumnWidthMap:o,mergedSelectableMenus:a,mergedPrefixCls:n}=N(j),s=p(()=>{const{isFixedHolder:r,columns:c}=e;return c||(r?l.value:t.value)});return()=>{if(s.value.every(i=>!i.width&&!i.type))return;const r=n.value,c=s.value.map(i=>{var C;const{key:d,type:h}=i,y=e.isFixedHolder&&(C=o.value[d])!=null?C:i.width,m=h?ie({[`${r}-col-${h}`]:!0,[`${r}-col-with-dropdown`]:h==="selectable"&&a.value.length>0}):void 0,S={width:Q(y),minWidth:Q(i.minWidth),maxWidth:Q(i.maxWidth)};return b("col",{key:d,class:m,style:S},null)});return b("colgroup",null,[c])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const bl={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},cascaderStrategy:{type:String,default:"all"},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},insetShadow:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},spinHeader:{type:Boolean,default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualScrollMode:{type:String,default:void 0},virtualHorizontal:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},virtualColWidth:{type:Number,default:void 0},virtualBufferSize:{type:Number,default:void 0},virtualBufferOffset:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Sl={columns:{type:Array,required:!0}},xl={column:{type:Object,required:!0}},Cl={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},wl={column:{type:Object,required:!0},isLast:{type:Boolean,required:!0},colSpan:Number,rowSpan:Number},kl={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Bl={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},$l={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}};/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Tl=L({props:Bl,setup(e){const{slots:t,config:l,locale:o,mergedPrefixCls:a}=N(j),n=p(()=>{var u;return(u=e.filterable.multiple)!=null?u:l.columnBase.filterable.multiple}),s=p(()=>{var u;return(u=e.filterable.footer)!=null?u:l.columnBase.filterable.footer}),r=e.activeFilterBy,[c,i]=xe(()=>r);U(()=>e.activeFilterBy,u=>i(u));const[d,h]=xe(!1),y=u=>{h(u),u||e.onUpdateFilterBy(c.value)},m=()=>{h(!1),e.onUpdateFilterBy(c.value)},S=()=>{i(r)},C=u=>{const f=`${a.value}-filterable-menu-label`,v=n.value?ze:lt;return b("span",{class:f},[b(v,{checked:u.selected,disabled:u.disabled},null),b("span",{class:`${f}-content`},[u.label])])},x=()=>{const u=[],{customMenu:f,menus:v}=e.filterable;return ve(f)?u.push(f({selectedKeys:c.value,setSelectedKeys:i})):G(f)&&t[f]?u.push(t[f]({selectedKeys:c.value,setSelectedKeys:i})):u.push(Kl(v,n,c,i,C)),s.value&&u.push(El(o,a,m,S)),u},k=p(()=>{const u=`${a.value}-filterable-trigger`;return ie({[u]:!0,[`${u}-active`]:e.activeFilterBy.length>0})}),g=()=>{const{customTrigger:u}=e.filterable;return ve(u)?u():G(u)&&t[u]?t[u]():b("span",{class:k.value,onClick:f=>f.stopPropagation()},[b(Ce,{name:"filter-filled"},null)])};return()=>{const u={visible:d.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":y};return b(Je,u,{default:g,overlay:x})}}}),Kl=(e,t,l,o,a)=>{const n={dataSource:e,multiple:t.value,selectable:!0,selectedKeys:l.value,"onUpdate:selectedKeys":o};return b(Qe,n,{itemLabel:a})},El=(e,t,l,o)=>{const{filterConfirm:a,filterReset:n}=e.table;return b("div",{class:`${t.value}-filterable-trigger-footer`},[b(Ae,{mode:"primary",size:"xs",onClick:l},{default:()=>[a]}),b(Ae,{size:"xs",onClick:o},{default:()=>[n]})])};/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Il=L({setup(){const{mergedPrefixCls:e,paginatedMap:t,selectable:l,currentPageRowKeys:o,currentPageAllSelected:a,currentPageSomeSelected:n,handleHeadSelectChange:s,mergedSelectableMenus:r,handleSelectableMenuClick:c}=N(j),i=p(()=>{const x=t.value.size;return x===0||x===o.value.disabledRowKeys.length}),[d,h]=xe(!1),y={"onUpdate:visible":h,trigger:"click"},m=()=>b(Qe,{dataSource:r.value,onClick:c},null),S=()=>b(Ce,{class:`${e.value}-selectable-trigger`,name:"down",rotate:d.value?180:0},null),C=()=>{if(r.value.length!==0)return b(Je,y,{default:S,overlay:m})};return()=>{const{multiple:x}=l.value;if(x)return b("span",{class:`${e.value}-cell-triggers`},[b(ze,{checked:a.value,indeterminate:n.value,disabled:i.value,onChange:s},null),C()])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=L({props:$l,setup(e){const{locale:t,mergedPrefixCls:l}=N(j);return()=>{const{activeOrderBy:o,sortable:a}=e,{orders:n,nextTooltip:s}=a,r=s&&Pl(t.table,n,o),c=Ml(l,n,o);return r?b(It,{title:r},{default:()=>[c]}):c}}});function Pl(e,t,l){const o=l?t[t.indexOf(l)+1]:t[0],{sortCancel:a,sortAsc:n,sortDesc:s}=e;return o?o==="ascend"?n:s:a}function Ml(e,t,l){const o=e.value,a=`${o}-sortable-trigger-active`,n=t.includes("ascend")&&b(Ce,{name:"caret-up-filled",class:l==="ascend"?a:void 0,role:"button",ariaPressed:String(l==="ascend")},null),s=t.includes("descend")&&b(Ce,{name:"caret-down-filled",class:l==="descend"?a:void 0,role:"button",ariaPressed:String(l==="descend")},null);return b("span",{class:`${o}-sortable-trigger`},[n,s])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ol=L({props:xl,setup(e){const{props:t,slots:l,mergedPrefixCls:o,fixedColumnKeys:a,columnOffsetsWithScrollBar:n,isSticky:s,handleSort:r,activeOrderByMap:c,activeFilterByMap:i,mergedRows:d,handleFilter:h}=N(j),y=p(()=>{const{type:u,ellipsis:f}=e.column,v=u||f!=null?f:t.ellipsis;return Xe(v)&&v.head===!1?void 0:v}),m=p(()=>{const{type:u,align:f,fixed:v,hasChildren:B,key:T,sortable:$,filterable:I}=e.column,w=o.value;let R={[`${w}-cell`]:!0,[`${w}-cell-${u}`]:!!u,[`${w}-cell-filterable`]:!!I,[`${w}-cell-sortable`]:!!$,[`${w}-cell-align-center`]:B||(f==null?void 0:f.title)==="center",[`${w}-cell-align-end`]:!B&&(f==null?void 0:f.title)==="end",[`${w}-cell-ellipsis`]:!!y.value};if(v){const{lastStartKey:H,firstEndKey:W}=a.value;R={...R,[`${w}-fix-start`]:v==="start",[`${w}-fix-start-last`]:H===T,[`${w}-fix-end`]:v==="end",[`${w}-fix-end-first`]:W===T,[`${w}-fix-sticky`]:s.value}}return ie(R)}),S=p(()=>{var R,H;const{key:u,fixed:f}=e.column,{offsetIndexMap:v}=d.value;if(!f)return;const{starts:B,ends:T}=n.value,$=Object.values(f==="start"?B:T),I=(R=v[u])==null?void 0:R[f==="start"?"colStart":"colEnd"];if($e(I))return{};const w=Q((H=$.find(W=>W.index===I))==null?void 0:H.offset);return{position:"sticky",left:f==="start"?w:void 0,right:f==="end"?w:void 0}}),C=p(()=>c[e.column.key]),x=p(()=>i[e.column.key]||Rt),k=u=>{const{key:f,filterable:v}=e.column;h(f,v,u)},g=()=>{const{key:u,sortable:f}=e.column;f&&r(u,f)};return()=>{var W,_,Y;const{column:u}=e,{type:f,titleColSpan:v,titleRowSpan:B}=u;if(f==="scroll-bar")return b("th",{class:m.value,style:S.value,colspan:v===1?void 0:v,rowspan:B===1?void 0:B,onClick:g},null);const T=o.value;let $,I;if(f==="selectable")I=b(Il,null,null);else{const{title:P,customTitle:M,sortable:A,filterable:O}=u,X=y.value;I=zl(P,M,l),$=ot(X,I,P);const J=Hl(A,C,O,x,k);J.length>0?I=b("span",{class:`${T}-cell-triggers`},[b("span",{class:`${T}-cell-title`},[I]),J]):X&&(I=b("span",{class:`${T}-cell-title`},[I]))}const w=(W=t.customAdditional)==null?void 0:W.headCell,R=w?w({column:u}):void 0,H=(Y=(_=t.customTag)==null?void 0:_.headCell)!=null?Y:"th";return b(H,ye({class:m.value,style:S.value,colSpan:v===1?void 0:v,rowSpan:B===1?void 0:B,title:$},R,{onClick:g}),{default:()=>[I]})}}});function zl(e,t,l){let o=e;return ve(t)?o=t({title:e}):G(t)&&l[t]&&(o=l[t]({title:e})),o}function Hl(e,t,l,o,a){const n=[];return e&&n.push(b(Rl,{activeOrderBy:t.value,sortable:e},null)),l&&n.push(b(Tl,{activeFilterBy:o.value,filterable:l,onUpdateFilterBy:a},null)),n}function Wl(e){return e.map(t=>mt(t)).filter(Boolean)}function mt(e){if(e.titleColSpan!==0)return b(Ol,{key:e.key,column:e},null)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Dl=L({props:Sl,setup(e,{slots:t}){const{props:l,mergedPrefixCls:o}=N(j);return()=>{var c,i,d;const{columns:a}=e,n=(c=l.customAdditional)==null?void 0:c.headRow,s=n?n({columns:a}):void 0,r=(d=(i=l.customTag)==null?void 0:i.headRow)!=null?d:"tr";return b(r,ye({class:`${o.value}-row`},s),{default:()=>{var h;return[(h=t.default)==null?void 0:h.call(t)]}})}}});function bt(e,t,l){return b(Dl,{columns:e,key:t},{default:()=>[l]})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pe=L({setup(e,{slots:t}){const{props:l,mergedRows:o,mergedPrefixCls:a}=N(j);return()=>{var d,h,y;let n;const{rows:s}=o.value,r=(d=l.customAdditional)==null?void 0:d.head,c=r?r({rows:s}):void 0,i=(y=(h=l.customTag)==null?void 0:h.head)!=null?y:"thead";return t.default?n=t.default():n=s.map((m,S)=>{const C=Wl(m);return bt(m,S,C)}),b(i,ye({class:`${a.value}-thead`},c),{default:()=>[n]})}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Fl=L({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e){const{props:t,mergedPrefixCls:l,mergedVirtual:o,mergedVirtualColWidth:a,getVirtualColWidth:n,headerVirtualScrollRef:s,handleScroll:r,scrollHeadRef:c,scrollWidth:i,flattedData:d,flattedColumns:h,fixedColumns:y,mergedRows:m,isSticky:S}=N(j);Al(c,r);const C=p(()=>i.value==="max-content"),x=p(()=>d.value.length>0),k=p(()=>{const f=l.value;return{[`${f}-fixed-holder`]:!0,[`${f}-sticky-holder`]:S.value}}),g=p(()=>{const f=S.value,{offsetTop:v,offsetBottom:B}=e;return{overflow:"hidden",top:f?Q(v):void 0,bottom:f?Q(B):void 0}}),u=p(()=>o.value.horizontal?m.value.rows.map((f,v)=>({key:v,data:f})):[]);return()=>{const f=x.value||!C.value;if(o.value.horizontal){const v=(R,{renderedData:H})=>{let W=[];if(f){const _=[];H.forEach(Y=>{_.push(...Y.data)}),W=De(_)}return b("table",{style:{tableLayout:"fixed"}},[f&&b(Se,{columns:W,isFixedHolder:!0},null),b(Pe,null,{default:()=>[R]})])},B=({item:R,index:H,children:W})=>bt(R.data,H,W),T=({item:R})=>mt(R),$=(R,H)=>{const{fixedStartColumns:W,fixedEndColumns:_}=y.value;return at(R,H,h.value,d.value,W,_,!0)},{virtualBufferSize:I,virtualBufferOffset:w}=t;return b("div",{class:k.value,style:g.value},[b(et,{ref:s,dataSource:u.value,colModifier:$,getKey:"key",height:0,width:"100%",colWidth:a.value,getColWidth:n,rowRender:B,colRender:T,contentRender:v,virtual:{horizontal:!0,vertical:!1},bufferSize:I,bufferOffset:w},null)])}return b("div",{class:k.value,style:g.value,ref:c},[b("table",{style:{tableLayout:"fixed"}},[f&&b(Se,{isFixedHolder:!0},null),b(Pe,null,null)])])}}});function Al(e,t){const l=n=>{if(!n.shiftKey)return;const s=n.deltaY,r=n.currentTarget;if(s){const c=r.scrollLeft+s;t(n,c)}},o=n=>{be(n,"wheel",l,{passive:!0})},a=n=>{fe(n,"wheel",l)};Te(()=>{U(e,(n,s)=>{a(s),o(n)},{immediate:!0})}),he(()=>a(e.value))}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const _l=L({setup(){const{mergedPrefixCls:e,scrollBodyRef:t,handleScroll:l,mergedSticky:o,stickyScrollLeft:a,setStickyScrollLeft:n}=N(j),s=z(!1),r=z(!1),c=z(0),i=z(0),d=z(0),h=p(()=>{const u=i.value,f=d.value;return f&&u*(u/f)});Pt(()=>{const u=ae(t);if(u&&s.value){const{clientWidth:f,scrollWidth:v,scrollLeft:B}=u;n(B/v*f),i.value=f,d.value=v}});const y=p(()=>({height:Ie(),width:i.value,bottom:o.value.offsetScroll})),m=p(()=>{const u=e.value;return{[`${u}-sticky-scrollbar-thumb`]:!0,[`${u}-sticky-scrollbar-thumb-active`]:r.value}}),S=p(()=>({width:`${h.value}px`,transform:`translate3d(${a.value}px, 0, 0)`})),C=()=>r.value=!1,x=u=>{c.value=u.pageX-a.value,r.value=!0,u.preventDefault()},k=u=>{if(!r.value)return;const{buttons:f}=u||window.event;if(f===0){r.value=!1;return}let v=u.pageX-c.value;v<=0&&(v=0);const B=i.value,T=d.value,$=h.value;v+$>=B&&(v=B-$);const I=v/B*(T+2);l(u,I)},g=()=>{const u=ae(t),f=_e(u).top,v=f+u.offsetHeight,{container:B,offsetScroll:T}=o.value,$=B===window?document.documentElement.scrollTop+window.innerHeight:_e(B).top+B.clientHeight;v-Ie()<=$||f>=$-T?s.value=!1:s.value=!0};return Te(()=>{be(document.body,"mouseup",C),be(document.body,"mousemove",k),be(window,"resize",g),U(()=>o.value.container,(u,f)=>{fe(f,"scroll",g),be(u,"scroll",g)},{immediate:!0}),g()}),he(()=>{fe(document.body,"mouseup",C),fe(document.body,"mousemove",k),fe(window,"resize",g),fe(o.value.container,"scroll",g)}),()=>!t.value||!s.value||d.value<=i.value||!h.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:y.value},[b("div",{class:m.value,style:S.value,onMousedown:x},null)])}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Nl=L({setup(e,{slots:t}){const{props:l,mergedPrefixCls:o}=N(j);return()=>{var n,s;const a=(s=(n=l.customTag)==null?void 0:n.body)!=null?s:"tbody";return b(a,{class:`${o.value}-tbody`},{default:()=>{var r;return[(r=t.default)==null?void 0:r.call(t)]}})}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Me=L({props:{columns:Array,isEmpty:Boolean},setup(e,{slots:t}){const{clientWidth:l,mergedPrefixCls:o,hasFixed:a,scrollHorizontalOverflowed:n,scrollBarColumn:s}=N(j),r=p(()=>{var c,i;return(i=(c=e.columns)==null?void 0:c.length)!=null?i:1});return()=>{let c=t.default();if(e.isEmpty?n.value:a.value){const i=s.value;c=b("div",{class:`${o.value}-fixed-row`,style:{width:Q(l.value-(i?i.width:0)),position:"sticky",left:0,overflow:"hidden"}},[c])}return b("tr",null,[b("td",{colspan:r.value},[c])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ll=L({props:kl,setup(e){const t=z();return Re(t,o=>{const{contentRect:{width:a}}=o;e.changeColumnWidth(e.cellKey,a)}),he(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:t,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[Mt("Â ")])])}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Vl=L({props:{columns:Array},setup(e){const{mergedPrefixCls:t}=N(j),{changeColumnWidth:l}=N(gt);return()=>{var a;const o=(a=e.columns)==null?void 0:a.map(n=>{const{key:s}=n;return b(Ll,{key:s,cellKey:s,changeColumnWidth:l},null)});return b("tr",{class:`${t.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const jl=L({props:wl,setup(e){const{props:t,slots:l,config:o,mergedPrefixCls:a,mergedEmptyCell:n,activeOrderByMap:s,fixedColumnKeys:r,columnOffsets:c,isSticky:i,isTreeData:d,expandable:h,selectable:y,mergedPagination:m}=N(j),S=N(pt),C=S.props,x=p(()=>s[e.column.key]),k=Ul(S,e),g=p(()=>r.value.lastStartKey===e.column.key),u=p(()=>r.value.firstEndKey===e.column.key),f=p(()=>{const{type:T,ellipsis:$}=e.column;return T||$!=null?$:t.ellipsis}),v=p(()=>{const{fixed:T,align:$,type:I}=e.column,w=a.value;let R={[`${w}-cell`]:!0,[`${w}-cell-sorted`]:!!x.value,[`${w}-cell-align-${$.cell}`]:!!$&&$.cell!="start",[`${w}-cell-ellipsis`]:!!f.value,[`${w}-cell-${I}`]:!!I,[`${w}-cell-last`]:!!e.isLast};return T&&(R={...R,[`${w}-fix-start`]:T==="start",[`${w}-fix-start-last`]:g.value,[`${w}-fix-end`]:T==="end",[`${w}-fix-end-first`]:u.value,[`${w}-fix-sticky`]:i.value}),ie(R)}),B=p(()=>{var H;const{fixed:T}=e.column;if(!T)return;const{starts:$,ends:I}=c.value,R=Q((H=(T==="start"?$:I)[e.column.key])==null?void 0:H.offset);return $e(R)?{}:{position:"sticky",left:T==="start"?R:void 0,right:T==="end"?R:void 0}});return()=>{var P,M,A;const{column:T}=e,$=a.value,{type:I}=T;let w,R;if(I==="selectable")w=Gl(S,l,y,o,m,$);else if(I==="indexable")w=St(S,l,T,m,$);else{const O=k.value;if(w=ql(S,e,l,O),R=ot(f.value,w,O),!I&&($e(w)||w==="")){const X=l.emptyCell||n.value;w=ve(X)?X({column:T,record:C.record,rowIndex:C.rowIndex}):X}}e.column.fixed&&f.value&&(g.value||u.value)&&(w=b("span",{class:`${$}-cell-content`},[w]));const H=(P=t.customAdditional)==null?void 0:P.bodyCell,W=H?H({column:T,record:C.record,rowIndex:C.rowIndex}):void 0,_=(A=(M=t.customTag)==null?void 0:M.bodyCell)!=null?A:"td",Y=I==="expandable"?b("div",{class:`${$}-expandable-wrapper`},[Xl(S,l,h,d,$),!tt(w)&&b("span",{class:`${$}-expandable-trigger-gap`},null),w]):w;return b(_,ye({class:v.value,style:B.value,title:R,colSpan:e.colSpan,rowSpan:e.rowSpan},W),{default:()=>[Y]})}}});function Ul(e,t){return p(()=>{const{props:{record:l}}=e,{column:o}=t,a=Oe(o.dataKey);if(a.length<=0)return;let n=l;for(let s=0;s<a.length&&n;s++){const r=a[s];n=n[r]}return n})}function ql(e,t,l,o){const{props:{record:a,rowIndex:n}}=e,{column:s}=t,{customCell:r}=s,c=G(r)?l[r]:r;return c?c({value:o,record:a,rowIndex:n}):o}function Xl(e,t,l,o,a){var I;const{icon:n,customIcon:s,indent:r,showLine:c}=l.value,{props:{record:i,expanded:d,level:h=0,hasPrevSibling:y,hasNextSibling:m,showLineIndentIndexList:S},expandDisabled:C,handleExpend:x}=e,k=h>0,g=o.value&&c&&r;let u;const f=(I=G(s)?t[s]:s)!=null?I:n;ve(f)?u=f({expanded:!!d,record:i}):u=G(f)?b(Ce,{name:f,rotate:d?90:0},null):f;const v=r?`width: ${Q(r)}`:void 0,B={[`${a}-expandable-trigger`]:!0,[`${a}-expandable-trigger-show-line`]:g,[`${a}-expandable-trigger-disabled`]:C.value},T=[];if(r)for(let w=0;w<h;w++)T.push(b("div",{class:{[`${a}-expandable-indent`]:!0,[`${a}-expandable-indent-show-line`]:g&&S.includes(w)},style:v},null));const $=w=>{w.preventDefault(),w.stopImmediatePropagation(),C.value||x()};return[...T,b("span",{class:B,style:v},[b("button",{class:`${a}-expandable-trigger-button`,type:"button",onClick:$},[u]),g&&[b("span",{class:`${a}-expandable-trigger-line-right`},null),(y||k)&&b("span",{class:`${a}-expandable-trigger-line-top`},null),m&&b("span",{class:`${a}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function Gl(e,t,l,o,a,n){const{props:{record:s,rowIndex:r},isSelected:c,isIndeterminate:i,selectDisabled:d,isHover:h,handleSelect:y}=e,{showIndex:m,multiple:S,customCell:C}=l.value,x=g=>{g.stopPropagation(),!S&&c.value&&!d.value&&y&&y()};if(!c.value&&!h.value&&m)return St(e,t,o.columnIndexable,a,n);const k=G(C)?t[C]:C;if(S){const g={checked:c.value,disabled:d.value,indeterminate:i.value,onChange:y,onClick:x};return k?k({...g,record:s,rowIndex:r}):b(ze,g,null)}else{const g={checked:c.value,disabled:d.value,onChange:y,onClick:x};return k?k({...g,record:s,rowIndex:r}):b(lt,g,null)}}function St(e,t,l,o,a){const{props:{record:n,rowIndex:s},selectDisabled:r}=e,{customCell:c}=l,{pageIndex:i=1,pageSize:d=0}=o.value||{},h=G(c)?t[c]:c;if(!h)return;const y=[`${a}-indexable-label`,r.value&&`${a}-indexable-label-disabled`];return b("span",{class:y},[h({record:n,rowIndex:s,pageIndex:i,pageSize:d})])}function Yl(e,t,l){const o=[];return e.forEach((a,n)=>{const s=xt(a,t,l,n===e.length-1);s&&o.push(s)}),o}function xt(e,t,l,o){const{colSpan:a,rowSpan:n}=e,s=a==null?void 0:a(t,l),r=n==null?void 0:n(t,l);if(s===0||r===0)return;const c={key:e.key,colSpan:s===1?void 0:s,rowSpan:r===1?void 0:r,isLast:o,column:e};return b(jl,c,null)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Zl=L({props:Cl,setup(e,{slots:t}){const{props:l,mergedPrefixCls:o,expandable:a,isChecked:n,isIndeterminate:s,isCheckDisabled:r,handleExpandChange:c,checkExpandDisabled:i,selectable:d,handleSelectChange:h}=N(j),{expandDisabled:y,handleExpend:m,selectDisabled:S,handleSelect:C,isHover:x,attrs:k}=Jl(e,a,i,c,d,h,r),g=p(()=>n(e.rowKey)),u=p(()=>s(e.rowKey)),f=p(()=>{const v=`${o.value}-row`,{level:B,expanded:T}=e;return ie({[`${v}`]:!0,[`${v}-level-${B}`]:!!B,[`${v}-selected`]:g.value,[`${v}-expanded`]:T})});return He(pt,{props:e,expandDisabled:y,handleExpend:m,isSelected:g,isIndeterminate:u,selectDisabled:S,handleSelect:C,isHover:x}),()=>{var $,I,w;const v=($=l.customAdditional)==null?void 0:$.bodyRow,B=v?v({record:e.record,rowIndex:e.rowIndex}):void 0,T=(w=(I=l.customTag)==null?void 0:I.bodyRow)!=null?w:"tr";return b(T,ye({class:f.value},k.value,B),{default:()=>{var R;return[(R=t.default)==null?void 0:R.call(t)]}})}}});function Jl(e,t,l,o,a,n,s){const r=p(()=>l(e.rowData)),c=p(()=>{var f;return(f=t.value)==null?void 0:f.trigger}),i=()=>{const{rowKey:f,record:v}=e;o(f,v)},d=p(()=>s(e.rowKey)),h=p(()=>{var f;return(f=a.value)==null?void 0:f.trigger}),y=p(()=>{var f;return(f=a.value)==null?void 0:f.showIndex}),m=z(!1),S=()=>{const{rowKey:f,record:v}=e;n(f,v)},C=()=>{c.value==="click"&&i(),h.value==="click"&&S()},x=()=>{c.value==="dblclick"&&i(),h.value==="dblclick"&&S()},k=()=>m.value=!0,g=()=>m.value=!1,u=p(()=>{const f=r.value,v=c.value,B=d.value,T=h.value,$=!f&&v==="click"||!B&&T==="click",I=!f&&v==="dblclick"||!B&&T==="dblclick",w=!B&&y.value;let R="";return $||I?R="pointer":(f&&v||B&&T)&&(R="not-allowed"),{style:R?`cursor: ${R}`:void 0,onClick:$?C:void 0,onDblclick:I?x:void 0,onMouseenter:w?k:void 0,onMouseleave:w?g:void 0}});return{expandDisabled:r,handleExpend:i,selectDisabled:d,handleSelect:S,isHover:m,attrs:u}}function qe(e,t,l,o,a,n,s){const{children:r,expanded:c,level:i,hasPrevSibling:d,hasNextSibling:h,showLineIndentIndexList:y,record:m,rowKey:S}=e,C={key:S,expanded:c,level:i,hasPrevSibling:d,hasNextSibling:h,showLineIndentIndexList:y,hasChildren:!!(r!=null&&r.length),record:m,rowData:e,rowIndex:l,rowKey:S},x=b(Zl,C,{default:()=>[s]}),k=c&&Ql(C,o,t,a,n);return k?[x,k]:x}function Ql(e,t,l,o,a){const{customExpand:n}=o||{},{record:s,rowIndex:r}=e;let c;return ve(n)?c=n({record:s,rowIndex:r}):G(n)&&t[n]&&(c=t[n]({record:s,rowIndex:r})),c&&b(Me,{class:`${a}-expanded-row`,columns:l},{default:()=>[c]})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const en=L({setup(){const{props:e,slots:t,clientWidth:l,setClientWidth:o,expandable:a,mergedPrefixCls:n,mergedInsetShadow:s,mergedVirtual:r,mergedVirtualItemHeight:c,mergedVirtualColWidth:i,mergedAutoHeight:d,changeColumnWidth:h,flattedData:y,flattedColumns:m,fixedColumns:S,getVirtualColWidth:C,isSticky:x,mergedSticky:k,virtualScrollRef:g,scrollBodyRef:u,scrollContentRef:f,handleScroll:v,pingedStart:B,pingedEnd:T,scrollWidth:$,scrollHeight:I,scrollHorizontalOverflowed:w,scrollVerticalOverflowed:R,hasFixed:H,tableLayout:W}=N(j),_=z(),Y=p(()=>d.value||!!$.value||x.value||r.value.horizontal);He(gt,{changeColumnWidth:(E,D)=>{Ht(_.value)&&h(E,D)}});const M=()=>{const E=ae(u);E&&v({currentTarget:E})},A=E=>{const{offsetWidth:D}=E.target;D!==l.value&&o(D)};Te(()=>{M(),U([()=>e.dataSource,$],([,E])=>{E&&M()}),Ot(_.value,A)}),he(()=>zt(_.value,A));const O=p(()=>{const E=n.value;return ie({[`${E}-container`]:!0,[`${E}-ping-start`]:B.value,[`${E}-ping-end`]:T.value,[`${E}-fixed-layout`]:W.value==="fixed",[`${E}-fixed-column`]:H.value,[`${E}-inset-shadow`]:s.value,[`${E}-scroll-horizontal`]:w.value,[`${E}-scroll-vertical`]:R.value})}),X=p(()=>{var V;const E=I.value,D=r.value.horizontal?"hidden":"auto",K=r.value.vertical?"hidden":"auto",F=(V=e.scroll)==null?void 0:V.fullHeight;return{overflowX:D,overflowY:K,[F?"height":"maxHeight"]:E}}),J=p(()=>({tableLayout:W.value,width:$.value,minWidth:$.value?"100%":void 0})),re=(E,D,K)=>{q(e.onScrolledChange,E,D,K.map(F=>F.record))},ee=p(()=>!r.value.vertical&&!r.value.horizontal?[]:y.value.map(E=>({...E,data:m.value}))),ge=E=>{if(!(!Y.value||!E))return b(Vl,{columns:E},null)},ce=E=>{var K;const D=(K=t.alert)==null?void 0:K.call(t);if(!tt(D))return b(Me,{class:`${n.value}-alert-row`,columns:E},{default:()=>[D]})},Ke=E=>{if(!(y.value.length>0))return b(Me,{class:`${n.value}-empty-row`,columns:E,isEmpty:!0},{default:()=>[b(Wt,{empty:e.empty},t)]})},Ee=(E,D,K)=>{let F;if(K)F=K;else if(D!=null&&D.length){const V=[];D.forEach((le,ue)=>{const se=Yl(E!=null?E:[],le.record,ue);V.push(...Oe(qe(le,E,ue,t,a.value,n.value,se)))}),F=V}return b(Nl,null,{default:()=>[ce(E),ge(E),Ke(E),F]})},we=()=>Ee(m.value,y.value),ke=(E,D)=>Ee(E,void 0,D);return()=>{const E=n.value,D=d.value,K=r.value,F=t.default?t.default():[];if(D||I.value||x.value||K.horizontal){const{offsetTop:V}=k.value;if(e.headless||F.push(b(Fl,{offsetTop:V},null)),K.vertical&&(e.scroll||D)||!K.vertical&&K.horizontal){const le=({item:Z,index:te,children:oe})=>qe(Z,Z.data,te,t,a.value,E,oe),ue=({row:Z,item:te,index:oe,rowIndex:de})=>xt(te,Z.record,de,oe===Z.data.length-1),se=(Z,{renderedData:te})=>{var de;const oe=y.value.length?(de=te[0])==null?void 0:de.data:m.value;return b("table",{ref:f,class:`${E}-table`,style:J.value},[oe?b(Se,{columns:oe},null):void 0,ke(oe,Z),!1])},pe=(Z,te)=>{const{fixedStartColumns:oe,fixedEndColumns:de}=S.value;return at(Z,te,m.value,y.value,oe,de,!1)},{scroll:ne,onScrolledBottom:wt}=e;F.push(b(et,{ref:g,class:`${E}-body-virtual-scroll`,dataSource:ee.value,colModifier:pe,fullHeight:ne==null?void 0:ne.fullHeight,getKey:Z=>{var te;return(te=Z.rowKey)!=null?te:Z.key},height:d.value?"100%":ne==null?void 0:ne.height,width:"100%",rowHeight:c.value,colWidth:i.value,getColWidth:C,rowRender:le,colRender:ue,contentRender:se,virtual:r.value,scrollMode:e.virtualScrollMode,bufferSize:e.virtualBufferSize,bufferOffset:e.virtualBufferOffset,onScroll:v,onScrolledBottom:wt,onScrolledChange:re},null))}else F.push(b("div",{ref:u,class:`${E}-content`,style:X.value,onScroll:v},[b("table",{ref:f,class:`${E}-table`,style:J.value},[b(Se,null,null),we(),!1])]));x.value&&F.push(b(_l,null,null))}else F.push(b("div",{ref:u,class:`${E}-content`,style:X.value,onScroll:v},[b("table",{ref:f,class:`${E}-table`,style:J.value},[b(Se,null,null),!e.headless&&b(Pe,null,null),we(),!1])]));return b("div",{ref:_,class:O.value},[F])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function tn(e,t){return e.footer?b("div",{class:`${t}-footer`},[e.footer()]):null}function ln(e,t,l,o,a){var r,c;let n=null,s=null;if(t!==null){const{position:i}=t,[d,h]=Dt(i).split("-"),y=`${a}-pagination ${a}-pagination-${h}`,m=(c=(r=e.pagination)==null?void 0:r.call(e,{total:l.length,...t}))!=null?c:Ft(b(qt,ye({class:y,total:l.length},t),null),[[At,o]]);n=d==="top"?m:null,s=d==="bottom"?m:null}return[n,s]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e,t){const{getGreyColors:l}=t,o=l(),{fontSizeSm:a,heightMd:n,paddingSizeSm:s,paddingSizeMd:r,paddingSizeLg:c,colorTextTitleSecondary:i,colorEmphasizedContainerBg:d,colorBorder:h,colorIconInfo:y,colorPrimary:m,colorContainerBg:S,colorContainerBgHover:C,colorInfoContainerBg:x}=e;return{fontSizeSm:a,fontSizeMd:a,fontSizeLg:a,headRowHeightSm:n,headRowHeightMd:n,headRowHeightLg:n,cellPaddingHorizontalSm:s,cellPaddingHorizontalMd:r,cellPaddingHorizontalLg:c,cellPaddingVerticalSm:6,cellPaddingVerticalMd:10,cellPaddingVerticalLg:18,headColor:i,headBgColor:d,headSeparatorColor:h,headIconColor:y,headIconColorActive:m,headIconBgColorHover:l().l30,insetShadowStart:`inset 10px 0 8px -8px ${Ne(o.d50,.12)}`,insetShadowEnd:`inset -10px 0 8px -8px ${Ne(o.d50,.12)}`,bodyRowBgColorHover:C,bodyRowBgColorSelected:S,bodyRowBgColorExpanded:x,bodyRowBgColorTreeExpanded:x,bodyCellVerticalAlign:"middle",expandableIconColor:y}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function nn(e,t){const{getGreyColors:l}=t,o=l();return{...Ct(e,t),insetShadowStart:`inset 10px 0 8px -8px ${o.l50}`,insetShadowEnd:`inset -10px 0 8px -8px ${o.l50}`}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const on=(e,t,l)=>t==="default"?Ct(e,l):nn(e,l);/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const an={sm:32,md:40,lg:56},rn=150,sn=L({name:"IxTable",props:bl,setup(e,{expose:t,slots:l}){const o=Be("common"),{globalHashId:a,hashId:n,registerToken:s}=_t("table");s(on);const r=p(()=>`${o.prefixCls}-table`),c=Be("locale"),i=Be("table"),[d,h]=xe(0),y=p(()=>{var K;return(K=e.autoHeight)!=null?K:i.autoHeight}),m=p(()=>{var K;return(K=e.childrenKey)!=null?K:i.childrenKey}),S=Nt(e,i),C=p(()=>{var K;return(K=e.emptyCell)!=null?K:i.emptyCell}),x=p(()=>{var K;return(K=e.spinHeader)!=null?K:i.spinHeader}),k=p(()=>{var K;return(K=e.insetShadow)!=null?K:i.insetShadow}),g=p(()=>{var K;return(K=e.size)!=null?K:i.size}),u=p(()=>({horizontal:e.virtualHorizontal,vertical:e.virtual})),f=p(()=>{var K;return(K=e.virtualItemHeight)!=null?K:an[g.value]}),v=p(()=>{var K;return(K=e.virtualColWidth)!=null?K:rn}),{mergedPagination:B}=al(e,i,g),T=pl(e),$=rl(e,T),I=Zt(e,l,i,$.scrollBarSizeOnFixedHolder),{flattedColumns:w,flattedColumnsWithScrollBar:R,fixedColumns:H}=I,W=Gt(w),{measuredColumnWidthMap:_}=W,Y=p(()=>R.value.length),P=Xt(H,_,Y),M=gl(w),A=ol(w),O=nl(e,w),X=ml(e,I,$,T.isSticky,u,y),{activeSorters:J}=M,{activeFilters:re}=A,ee=new Map,ge=()=>{ee.clear(),w.value.forEach(K=>{ee.set(K.key,K)})};U(w,()=>{ge()},{immediate:!0});const ce=ll(e,m,S,J,re,O.expandedRowKeys,B),Ke=vl(e,c,I.flattedColumns,ce);ul(e,i,B,J,re,$.scrollTo);const we={props:e,slots:l,config:i,locale:c,clientWidth:d,setClientWidth:h,mergedPrefixCls:r,mergedEmptyCell:C,mergedInsetShadow:k,mergedVirtual:u,mergedVirtualItemHeight:f,mergedVirtualColWidth:v,mergedAutoHeight:y,getVirtualColWidth:(K,F)=>{var V,le;return(le=_.value[F])!=null?le:(V=ee.get(F))==null?void 0:V.width},...I,...W,...P,...$,...M,...A,...T,tableLayout:X,mergedPagination:B,...O,...ce,...Ke};He(j,we),t({scrollTo:$.scrollTo});const{flattedData:ke,filteredData:E}=ce,D=p(()=>{const K=r.value,{borderless:F=i.borderless,scroll:V}=e;return ie({[a.value]:!!a.value,[n.value]:!!n.value,[K]:!0,[`${K}-auto-height`]:y.value,[`${K}-borderless`]:F,[`${K}-empty`]:ke.value.length===0,[`${K}-full-height`]:V==null?void 0:V.fullHeight,[`${K}-${g.value}`]:!0})});return()=>{const K=r.value,F=b(Lt,{header:e.header},l),V=tn(l,K),[le,ue]=ln(l,B.value,E.value,ke.value.length>0,K),se=[],pe=[le,b(en,null,null),V,ue].filter(Boolean),ne=cn(e.spin);return ne?(x.value?pe.unshift(F):se.push(F),se.push(b(Vt,ne,{default:()=>[pe]}))):se.push(F,...pe),b("div",{class:D.value},[se])}}});function cn(e){return jt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const hn=sn,yn=We;export{hn as I,j as T,yn as a,Yt as g,bl as t};
