import{c as p,q as z,x as U,b8 as Xe,bk as G,b9 as kt,bd as Ge,c6 as Bt,be as Oe,bz as $t,aN as $e,c7 as Fe,bg as Ye,R as q,ao as Ze,as as Be,Z as Q,c8 as Ie,aj as ae,y as he,v as Te,ah as Re,aE as Tt,c9 as Kt,ca as Et,bb as xe,d as L,i as N,an as ie,f as b,aA as Je,br as ve,$ as Ce,az as Qe,k as Ae,N as ze,aR as It,bo as Rt,af as ye,al as et,aD as be,aB as fe,H as Pt,aF as _e,h as Mt,cb as tt,a5 as He,ai as Ot,ak as zt,cc as Ht,bq as Wt,aV as Dt,C as Ft,D as At,bc as Ne,at as _t,bs as Nt,bj as Lt,bU as Vt,b7 as jt}from"./index-200961bb.js";import{u as Ut}from"./useTreeCheckState-e0527647.js";import{b as lt}from"./GlobalCodeBox-3bc0753c.js";import{I as qt}from"./index-2caaf0c6.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Xt(e,l,n){const o=p(()=>{const{fixedStartColumns:t,fixedEndColumns:r,fixedColumnIndexMap:s}=e.value;return Le(t,r.filter(i=>i.type!=="scroll-bar"),s,l.value,n.value-1)}),a=p(()=>{const{fixedStartColumns:t,fixedEndColumns:r,fixedColumnIndexMap:s}=e.value;return Le(t,r,s,l.value,n.value)});return{columnOffsets:o,columnOffsetsWithScrollBar:a}}function Le(e,l,n,o,a){var c,u,v,y,m,S;const t={},r={};let s=0,i=0;for(let C=0;C<e.length;C++){const x=e[C],k=(u=(c=o[x.key])!=null?c:x.width)!=null?u:0;t[x.key]={index:(v=n[x.key])!=null?v:C,offset:s},s+=k}for(let C=0;C<l.length;C++){const x=l[l.length-C-1],k=(m=(y=o[x.key])!=null?y:x.width)!=null?m:0;r[x.key]={index:(S=n[x.key])!=null?S:a-C-1,offset:i},i+=k}return{starts:t,ends:r}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Gt(e){const l=z({}),n=(o,a)=>{a===!1?delete l.value[o]:l.value[o]=a};return U(e,o=>{const a=new Set(o.map(t=>t.key));Object.keys(l).forEach(t=>{a.has(t)||delete l.value[t]})}),{measuredColumnWidthMap:l,changeColumnWidth:n}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const nt=Symbol("IxTableColumn"),We=()=>{};We.displayName="IxTableColumn";We[nt]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ot(e,l,n){if(!e||Xe(e)&&e.title===!1)return;if(G(l)||kt(l))return l;const o=Ge(l).find(a=>a.type===Bt);return o?o.children:n}function Yt(e){return"key"in e?e.key:"dataKey"in e?Oe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:$t("__IDUX_table_column_key_")}function at(e,l,n,o,a,t,r=!1){const s=y=>y.filter(m=>m.type!=="scroll-bar"),i=r?a:s(a),c=r?t:s(t);if(!i.length&&!c.length)return;const u=o.findIndex(y=>y.rowKey===e.rowKey),v=y=>{if(l.findIndex(C=>C.key===y.key)>-1)return;const m=n.findIndex(C=>C.key===y.key);let S;return G(y.key)?S=`fix-${u}-${y.key}`:S=`fix-${u}-${m}`,{data:y,index:m,poolKey:S}};return{start:i.map(v).filter(Boolean),end:c.map(v).filter(Boolean)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Zt(e,l,n,o){const a=p(()=>{var S;const{columns:m}=e;return rt(m&&m.length>0?m:st((S=l.default)==null?void 0:S.call(l)),n)}),{flattedColumns:t,scrollBarColumn:r,flattedColumnsWithScrollBar:s}=Qt(a,o),{fixedColumns:i,fixedColumnKeys:c}=el(s),u=p(()=>!!e.ellipsis||t.value.some(m=>m.ellipsis)),v=p(()=>t.value.some(m=>m.fixed)),y=p(()=>tl(a.value,r.value));return{flattedColumns:t,scrollBarColumn:r,flattedColumnsWithScrollBar:s,fixedColumns:i,fixedColumnKeys:c,hasEllipsis:u,hasFixed:v,mergedRows:y}}function rt(e,l){return e.map(n=>Jt(n,l))}function st(e){const l=[];return Ge(e,{key:nt}).forEach((n,o)=>{const{props:a,children:t}=n,{key:r=o,editable:s,ellipsis:i,...c}=a||{};c.key=r,c.editable=s||s==="",c.ellipsis=i||i==="";const{default:u,cell:v,title:y,expand:m,icon:S}=t||{};u&&(c.children=st(u())),v&&(c.customCell=v),y&&(c.customTitle=y),m&&(c.customExpand=m),S&&(c.customIcon=S),l.push(c)}),l}function me(e){return G(e)?{title:e,cell:e}:e}function Jt(e,l){var i,c;const{columnBase:n,columnExpandable:o,columnSelectable:a,columnIndexable:t}=l,{align:r=n.align}=e,s=Yt(e);if("type"in e){const{type:u}=e;if(u==="expandable"){const{showLine:v=o.showLine,icon:y=o.icon}=e;return{...e,key:s,align:me(r),icon:y,showLine:v}}if(u==="selectable"){const{multiple:v=!0,showIndex:y=a.showIndex}=e;return{...e,key:s,align:me(r),multiple:v,showIndex:y}}if(u==="indexable"){const v=(c=(i=e.align)!=null?i:t.align)!=null?c:n.align;return{...t,...e,align:me(v),key:s}}return{...e,key:s,align:me(r)}}else{const{sortable:u,filterable:v,children:y}=e,m={...e,key:s,align:me(r)};return u&&(m.sortable={...n.sortable,...u}),v&&(m.filterable={...n.filterable,...v}),y!=null&&y.length&&(m.children=rt(y,l)),m}}function Qt(e,l){const n=p(()=>De(e.value)),o=p(()=>{const t=l.value,r=n.value;if(t===0||r.length===0)return;const s=r[r.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:s&&s.fixed,width:t}}),a=p(()=>{const t=n.value,r=o.value;return r?[...t,r]:t});return{flattedColumns:n,scrollBarColumn:o,flattedColumnsWithScrollBar:a}}function De(e){const l=[];return e.forEach(n=>{const{fixed:o,children:a}=n;if(a!=null&&a.length){let t=De(a);o&&(t=t.map(r=>({fixed:o,...r}))),l.push(...t)}else l.push(n)}),l}function el(e){const l=p(()=>{const o=[],a=[],t={};return e.value.forEach((r,s)=>{const{key:i,fixed:c}=r;c==="start"?(o.push(r),t[i]=s):c==="end"&&(a.push(r),t[i]=s)}),{fixedStartColumns:o,fixedEndColumns:a,fixedColumnIndexMap:t}}),n=p(()=>{var t,r;const{fixedStartColumns:o,fixedEndColumns:a}=l.value;return{lastStartKey:(t=o[o.length-1])==null?void 0:t.key,firstEndKey:(r=a[0])==null?void 0:r.key}});return{fixedColumns:l,fixedColumnKeys:n}}function tl(e,l){const n=[],o={};function a(s,i,c){var y;(y=n[c])!=null||(n[c]=[]);let u=i;return s.map(m=>{var g;let S=(g=m.titleColSpan)!=null?g:1,C=!1;const x=m.children;if(x!=null&&x.length){C=!0;const d=a(x,u,c+1);$e(m.titleColSpan)&&(S=d.reduce((f,h)=>f+h))}const k=u+S-1;return n[c].push({...m,titleColSpan:S,colStart:u,colEnd:k,hasChildren:C}),o[m.key]={colStart:u,colEnd:k},u+=S,S})}const t=l?[...e,l]:e;a(t,0,0);const r=n.length;return n.forEach((s,i)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-i)})}),{rows:n,offsetIndexMap:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ll(e,l,n,o,a,t,r){const s=p(()=>{const g=l.value,d=n.value;return e.dataSource.map((f,h)=>ct(f,d,g,h,e.dataSource.length))}),i=p(()=>{const g=new Map,d=new Map,f=new Map;return Fe(s.value,"children",(h,B)=>{var T;g.set(h.rowKey,h),d.set(h.rowKey,(T=B[0])==null?void 0:T.rowKey),f.set(h.rowKey,B.length)}),{dataKeyMap:g,parentKeyMap:d,depthMap:f}}),c=p(()=>i.value.dataKeyMap),u=p(()=>i.value.parentKeyMap),v=p(()=>i.value.depthMap),y=p(()=>ut(s.value,a.value,t.value)),m=p(()=>it(y.value,o.value,t.value)),S=p(()=>{const g=r.value,d=m.value;if(g===null||!g.pageSize)return d;{const{total:f}=g;if(f&&d.length<f)return d;const h=g.pageSize,B=(g.pageIndex-1)*h;return d.slice(B,B+h)}}),C=p(()=>{const g=new Map;return Fe(S.value,"children",d=>{g.set(d.rowKey,d)}),g}),x=p(()=>{const g=t.value;return g.length>0?dt(S.value,g,0):S.value});return{isTreeData:p(()=>s.value.some(g=>{var d;return(d=g.children)==null?void 0:d.length})),filteredData:y,flattedData:x,mergedData:s,mergedMap:c,paginatedData:S,paginatedMap:C,parentKeyMap:u,depthMap:v}}function ct(e,l,n,o,a,t){var c;const r=l(e),s={record:e,rowKey:r,parentKey:t==null?void 0:t[0].rowKey,showLineIndentIndexList:(c=[...t!=null?t:[]].reverse())==null?void 0:c.reduce((u,v,y)=>(v.hasNextSibling&&u.push(y),u),[]),hasPrevSibling:o>0,hasNextSibling:o<a-1},i=e[n];return i&&(s.children=i.map((u,v)=>ct(u,l,n,v,i.length,[s,...t!=null?t:[]]))),s}function it(e,l,n){const o=l.filter(r=>r.sorter),a=o.length;if(a===0)return e;const t=e.slice();return t.forEach(r=>{n.includes(r.rowKey)&&r.children&&r.children.length>0&&(r.children=it(r.children,l,n))}),t.sort((r,s)=>{for(let i=0;i<a;i++){const{orderBy:c,sorter:u}=o[i],v=u(r.record,s.record);if(v!==0)return c==="ascend"?v:-v}return 0})}function ut(e,l,n){const o=l.filter(a=>a.filter);return o.length===0?e:e.map(a=>{const t=o.every(({filter:u,filterBy:v})=>u(v,a.record)),{rowKey:r,children:s}=a,i=n.includes(r);let c=a;if(i&&s&&s.length){const u=ut(s,l,n);u.length!==s.length&&(c={...a,children:u})}return t||i&&c.children&&c.children.length?c:null}).filter(a=>a!==null)}function dt(e,l,n){return e.reduce((o,a)=>{const{children:t,parentKey:r,record:s,rowKey:i,hasPrevSibling:c,hasNextSibling:u,showLineIndentIndexList:v}=a,y=l.includes(i);if(o.push({children:t,parentKey:r,record:s,rowKey:i,level:n,expanded:y,hasPrevSibling:c,hasNextSibling:u,showLineIndentIndexList:v}),y&&a.children){const m=dt(a.children,l,n+1);o.push(...m)}return o},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function nl(e,l,n){const o=p(()=>l.value.find(c=>"type"in c&&c.type==="expandable")),[a,t]=Ye(e,"expandedRowKeys",()=>[]),r=c=>{s(c,!(a.value.indexOf(c)>=0))},s=(c,u)=>{const v=[...a.value];if(v.includes(c)===u)return;const m=v.indexOf(c);u?v.push(c):v.splice(m,1);const S=n(c),{onChange:C,onExpand:x}=o.value||{};q(x,u,S),t(v),q(C,v)};return{expandable:o,expandedRowKeys:a,setExpandedRowKeys:t,checkExpandDisabled:c=>{if(!o.value)return!0;const{disabled:u,customExpand:v}=o.value,{record:y}=c;return u!=null&&u(y)?!0:!(v||c.children&&c.children.length>0)},setRowExpanded:s,handleExpandChange:r}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ol(e){const l=p(()=>e.value.filter(t=>t.filterable)),n=Ze({}),o=z([]);return U(l,(t,r)=>{t.forEach(s=>{const{key:i,filterable:c}=s,u=c.filterBy;if(u||n[i]===void 0){n[i]=u||[];return}const v=r?r.find(m=>m.key===i):void 0;(v==null?void 0:v.filterable.filterBy)&&(n[i]=[])}),o.value=Ve(t,n)},{immediate:!0}),{activeFilters:o,activeFilterByMap:n,handleFilter:(t,r,s)=>{const{onChange:i}=r;n[t]=s,o.value=Ve(l.value,n),q(i,s,o.value)}}}function Ve(e,l){return e.map(n=>{const{key:o,filterable:a}=n,{filter:t,filterBy:r=l[o]}=a;return{key:o,filter:t,filterBy:r}}).filter(n=>n.filter&&n.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function al(e,l,n){var c,u,v,y,m;const o=Be("pagination"),a=p(()=>{const{pagination:S}=e;return S===!1?null:S===!0?{}:S}),t=z((u=(c=a.value)==null?void 0:c.pageIndex)!=null?u:1),r=z((m=(y=(v=a.value)==null?void 0:v.pageSize)!=null?y:l.pagination.pageSize)!=null?m:o.pageSize),s=(S,C)=>{var x;t.value=S,r.value=C,q((x=a.value)==null?void 0:x.onChange,S,C)};return{mergedPagination:p(()=>{var C,x;const S=a.value;return S===null?null:{...l.pagination,size:n.value,...S,pageIndex:(C=S.pageIndex)!=null?C:t.value,pageSize:(x=S.pageSize)!=null?x:r.value,onChange:s}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function rl(e,{setStickyScrollLeft:l}){const n=z(),o=z(),a=z(),t=z(),r=z(),s=z();U(n,h=>{h&&(t.value=h.getHolderElement())},{immediate:!0}),U(o,h=>{h&&(a.value=h.getHolderElement(),a.value.style.overflow="hidden")},{immediate:!0});const i=il(t,r),{handleScroll:c,pingedStart:u,pingedEnd:v}=sl(e,n,o,a,t,s,i,l),{scrollHorizontalOverflowed:y,scrollVerticalOverflowed:m}=cl(t,i),S=p(()=>{var h;return Q((h=e.scroll)==null?void 0:h.width)}),C=p(()=>{var h;return Q((h=e.scroll)==null?void 0:h.height)}),x=p(()=>Ie(ae(t))),k=p(()=>m.value?x.value:0),g=p(()=>u.value&&y.value),d=p(()=>v.value&&y.value);return{virtualScrollRef:n,headerVirtualScrollRef:o,scrollHeadRef:a,scrollBodyRef:t,scrollContentRef:r,scrollFootRef:s,handleScroll:c,scrollTo:h=>{var B;e.virtual?(B=n.value)==null||B.scrollTo(h):typeof h=="number"&&Tt({target:ae(t),top:h,duration:200})},pingedStart:g,pingedEnd:d,scrollWidth:S,scrollHeight:C,scrollBarSize:x,scrollBarSizeOnFixedHolder:k,scrollHorizontalOverflowed:y,scrollVerticalOverflowed:m}}function sl(e,l,n,o,a,t,r,s){const i=z(!1),c=z(!1);let u;const v=()=>{u&&(clearTimeout(u),u=void 0)};he(()=>v());const y=z(),m=g=>{y.value=g,v(),u=setTimeout(()=>{y.value=void 0,u=void 0},100)},S=(g,d)=>{d&&d.scrollLeft!==g&&(d.scrollLeft=g)},C=(g,d)=>{d&&d.scrollTo({left:g})},x=g=>{const d=ae(a);if(!d)return;const{clientWidth:f,scrollWidth:h}=d;s(g/h*f||0)},k=(g,d)=>{const f=g==null?void 0:g.currentTarget,h=d!=null?d:f.scrollLeft,B=y.value;if((!B||B===f)&&(m(f),n.value?C(h,n.value):S(h,o.value),l.value?C(h,l.value):S(h,ae(a)),S(h,t.value),x(h)),f){const{scrollWidth:T,clientWidth:$}=f;i.value=h>1,c.value=T-$-h>1}(g==null?void 0:g.type)==="scroll"&&q(e.onScroll,g)};return U(r,()=>{const g=ae(a);g&&k({currentTarget:g})}),{handleScroll:k,pingedStart:i,pingedEnd:c}}function cl(e,l){const n=z(!1),o=z(!1);return U(l,()=>{const t=ae(e.value);t?(n.value=t.scrollWidth>t.clientWidth,o.value=t.scrollHeight>t.clientHeight):(n.value=!1,o.value=!1)}),{scrollHorizontalOverflowed:n,scrollVerticalOverflowed:o}}function il(e,l){const n=z(!1),o=()=>{n.value=!n.value};let a=[];const t=()=>a.forEach(r=>r());return Te(()=>{a=[Re(e,o),Re(l,o)]}),he(()=>t()),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ul(e,l,n,o,a,t){const r=p(()=>{var u;return(u=e.scrollToTopOnChange)!=null?u:l.scrollToTopOnChange});let s=[];const i=()=>{s=[U([()=>{var u;return(u=n.value)==null?void 0:u.pageIndex},()=>{var u;return(u=n.value)==null?void 0:u.pageSize}],()=>t(0)),U([a,o],([u,v],[y,m])=>{(!dl(u,y)||!fl(v,m))&&t(0)})]},c=()=>{s.forEach(u=>u())};U(r,u=>{c(),u&&i()},{immediate:!0})}function dl(e,l){return e.length===l.length&&e.every(n=>{const o=l.find(a=>a.key===n.key);return o?n.filter===o.filter&&n.filterBy.length===o.filterBy.length&&n.filterBy.every(a=>o.filterBy.includes(a)):!1})}function fl(e,l){return e.length===l.length&&e.every(n=>{const o=l.find(a=>a.key===n.key);return o?n.sorter===o.sorter&&n.orderBy===o.orderBy&&n.multiple===o.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function vl(e,l,n,{mergedData:o,mergedMap:a,paginatedMap:t,parentKeyMap:r,depthMap:s}){const i=p(()=>n.value.find(P=>"type"in P&&P.type==="selectable")),[c,u]=Ye(e,"selectedRowKeys",()=>[]),v=p(()=>({data:o.value,dataMap:a.value,parentKeyMap:r.value,depthMap:s.value})),y=z("children"),m=z(P=>P.rowKey),S=p(()=>{var P;return(P=i.value)!=null&&P.multiple?e.cascaderStrategy:"off"}),C=p(()=>{var M;const P=(M=i.value)==null?void 0:M.disabled;return A=>!!(P!=null&&P(A.record))}),x=Ut(c,v,y,m,S,C),{checkStateResolver:k,isCheckDisabled:g,isChecked:d,isIndeterminate:f,toggle:h,getDataByKeys:B}=x,T=p(()=>{const P=[],M=[];return t.value.forEach((A,O)=>{g(O)?M.push(O):P.push(O)}),{enabledRowKeys:P,disabledRowKeys:M}}),$=p(()=>{let P=!!t.value.size,M=!!t.value.size,A=!1;for(const O of t.value.keys())d(O)||f(O)?A=!0:(M=!1,g(O)||(P=!1));return!M&&!A&&(P=!1),{checked:P,allSelected:M,someSelected:A}}),I=p(()=>$.value.checked),w=p(()=>!$.value.allSelected&&$.value.someSelected),R=P=>{u(P);const{onChange:M}=i.value||{};if(M){const A=B(P).map(O=>O.record);q(M,P,A)}},W=(P,M)=>{const O=a.value.get(P);if(!O)return;const{multiple:X,onSelect:J}=i.value||{};let re=[...c.value],ee;if(X){const{checked:ge,checkedKeys:se}=h(O);ee=ge,re=se}else ee=!d(P),re=ee?[P]:[];q(J,ee,M),R(re)},D=()=>{let P;if(I.value){const M=[];t.value.forEach((A,O)=>{g(O)||d(O)&&M.push(O)}),P=k.removeKeys(c.value,M)}else{const M=[];t.value.forEach((A,O)=>{g(O)||d(O)||M.push(O)}),P=k.appendKeys(c.value,M)}R(P)},_=hl(i,l),Y=yl(i,x,a,t,c,R);return{selectable:i,selectedRowKeys:c,isChecked:d,isIndeterminate:f,isCheckDisabled:g,currentPageRowKeys:T,currentPageAllSelected:I,currentPageSomeSelected:w,handleSelectChange:W,handleHeadSelectChange:D,mergedSelectableMenus:_,handleSelectableMenuClick:Y}}const ft=Symbol("IDUX_TABLE_KEY_selectable-all"),vt=Symbol("IDUX_TABLE_KEY_selectable-invert"),ht=Symbol("IDUX_TABLE_KEY_selectable-none"),yt=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function hl(e,l){return p(()=>{const{menus:n}=e.value||{};if(!n||n.length===0)return[];const{selectAll:o,selectInvert:a,selectNone:t,selectPageInvert:r}=l.table;return n.map(s=>G(s)?s==="all"?{type:"item",key:ft,label:o}:s==="invert"?{type:"item",key:vt,label:a}:s==="none"?{type:"item",key:ht,label:t}:s==="pageInvert"?{type:"item",key:yt,label:r}:{type:"item",key:s,label:s}:s)})}function yl(e,l,n,o,a,t){const{checkDisabledKeySet:r,checkStateResolver:s,getAllCheckedKeys:i,isChecked:c,isCheckDisabled:u}=l,v=()=>{const{onSelectAll:x}=e.value||{},k=i([...r.value].filter(g=>!c(g)));q(x,k),t(k)},y=()=>{const{onSelectInvert:x}=e.value||{},k=[],g=[];n.value.forEach((f,h)=>{u(h)||(c(h)?g.push(h):k.push(h))});const d=s.removeKeys(s.appendKeys(a.value,k),g);t(d),q(x,d)},m=()=>{const{onSelectNone:x}=e.value||{};q(x),t([])},S=()=>{const{onSelectPageInvert:x}=e.value||{},k=[],g=[];o.value.forEach((f,h)=>{u(h)||(c(h)?g.push(h):k.push(h))});const d=s.removeKeys(s.appendKeys(a.value,k),g);t(d),q(x,d)},C=new Map([[ft,v],[vt,y],[ht,m],[yt,S]]);return x=>{const k=x.key;if(Kt(k)&&C.has(k)){C.get(k)();return}const{onMenuClick:g}=e.value||{};if(!g)return;const d=[];o.value.forEach((f,h)=>{u(h)||d.push(h)}),q(g,x,d)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function gl(e){const l=p(()=>e.value.filter(r=>r.sortable)),n=p(()=>l.value.some(r=>r.sortable.multiple!==void 0)),o=Ze({}),a=z([]);return U(l,(r,s)=>{r.forEach(i=>{const{key:c,sortable:u}=i,v=u.orderBy;if(v||o[c]===void 0){o[c]=v;return}const y=s?s.find(S=>S.key===c):void 0;(y==null?void 0:y.sortable.orderBy)&&(o[c]=void 0)}),a.value=Ue(r,o)},{immediate:!0}),{activeSorters:a,activeOrderByMap:o,handleSort:(r,s)=>{const{orders:i,onChange:c}=s,u=o[r],v=u?je(i,u):je(i);n.value?o[r]=v:Object.keys(o).forEach(y=>{r===y?o[y]=v:o[y]=void 0}),a.value=Ue(l.value,o),q(c,v,a.value)}}}function je(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ue(e,l){return e.map(n=>{const{key:o,sortable:a}=n,{multiple:t=0,orderBy:r=l[o],sorter:s}=a;return{key:o,multiple:t,orderBy:r,sorter:s}}).filter(n=>n.orderBy).sort((n,o)=>o.multiple-n.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function pl(e){const l=p(()=>!!e.sticky),n=p(()=>{const{sticky:t}=e,{offsetTop:r=0,offsetBottom:s=0,offsetScroll:i=0,container:c=window}=Et(t)?t:{};return{offsetTop:r,offsetBottom:s,offsetScroll:i,container:c}}),[o,a]=xe(0);return{isSticky:l,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:a}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ml(e,{hasEllipsis:l,hasFixed:n},{scrollWidth:o,scrollHeight:a},t,r,s){return p(()=>e.tableLayout?e.tableLayout:o.value&&n.value?o.value==="max-content"?"auto":"fixed":a.value||s.value||t.value||l.value||r.value.horizontal||r.value.vertical?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const j=Symbol("TABLE_TOKEN"),gt=Symbol("tableBodyToken"),pt=Symbol("tableBodyRowToken");/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Se=L({props:{isFixedHolder:Boolean,columns:Array},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:n,measuredColumnWidthMap:o,mergedSelectableMenus:a,mergedPrefixCls:t}=N(j),r=p(()=>{const{isFixedHolder:s,columns:i}=e;return i||(s?n.value:l.value)});return()=>{if(r.value.every(c=>!c.width&&!c.type))return;const s=t.value,i=r.value.map(c=>{var C;const{key:u,type:v}=c,y=e.isFixedHolder&&(C=o.value[u])!=null?C:c.width,m=v?ie({[`${s}-col-${v}`]:!0,[`${s}-col-with-dropdown`]:v==="selectable"&&a.value.length>0}):void 0,S={width:Q(y),minWidth:Q(c.minWidth),maxWidth:Q(c.maxWidth)};return b("col",{key:u,class:m,style:S},null)});return b("colgroup",null,[i])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const bl={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},cascaderStrategy:{type:String,default:"all"},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},insetShadow:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},spinHeader:{type:Boolean,default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualScrollMode:{type:String,default:void 0},virtualHorizontal:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},virtualColWidth:{type:Number,default:void 0},virtualBufferSize:{type:Number,default:void 0},virtualBufferOffset:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Sl={columns:{type:Array,required:!0}},xl={column:{type:Object,required:!0}},Cl={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},wl={column:{type:Object,required:!0},isLast:{type:Boolean,required:!0},colSpan:Number,rowSpan:Number},kl={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Bl={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},$l={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}};/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Tl=L({props:Bl,setup(e){const{slots:l,config:n,locale:o,mergedPrefixCls:a}=N(j),t=p(()=>{var d;return(d=e.filterable.multiple)!=null?d:n.columnBase.filterable.multiple}),r=p(()=>{var d;return(d=e.filterable.footer)!=null?d:n.columnBase.filterable.footer}),s=e.activeFilterBy,[i,c]=xe(()=>s);U(()=>e.activeFilterBy,d=>c(d));const[u,v]=xe(!1),y=d=>{v(d),d||e.onUpdateFilterBy(i.value)},m=()=>{v(!1),e.onUpdateFilterBy(i.value)},S=()=>{c(s)},C=d=>{const f=`${a.value}-filterable-menu-label`,h=t.value?ze:lt;return b("span",{class:f},[b(h,{checked:d.selected,disabled:d.disabled},null),b("span",{class:`${f}-content`},[d.label])])},x=()=>{const d=[],{customMenu:f,menus:h}=e.filterable;return ve(f)?d.push(f({selectedKeys:i.value,setSelectedKeys:c})):G(f)&&l[f]?d.push(l[f]({selectedKeys:i.value,setSelectedKeys:c})):d.push(Kl(h,t,i,c,C)),r.value&&d.push(El(o,a,m,S)),d},k=p(()=>{const d=`${a.value}-filterable-trigger`;return ie({[d]:!0,[`${d}-active`]:e.activeFilterBy.length>0})}),g=()=>{const{customTrigger:d}=e.filterable;return ve(d)?d():G(d)&&l[d]?l[d]():b("span",{class:k.value,onClick:f=>f.stopPropagation()},[b(Ce,{name:"filter-filled"},null)])};return()=>{const d={visible:u.value,hideOnClick:!r.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":y};return b(Je,d,{default:g,overlay:x})}}}),Kl=(e,l,n,o,a)=>{const t={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:n.value,"onUpdate:selectedKeys":o};return b(Qe,t,{itemLabel:a})},El=(e,l,n,o)=>{const{filterConfirm:a,filterReset:t}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(Ae,{mode:"primary",size:"xs",onClick:n},{default:()=>[a]}),b(Ae,{size:"xs",onClick:o},{default:()=>[t]})])};/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Il=L({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:n,currentPageRowKeys:o,currentPageAllSelected:a,currentPageSomeSelected:t,handleHeadSelectChange:r,mergedSelectableMenus:s,handleSelectableMenuClick:i}=N(j),c=p(()=>{const x=l.value.size;return x===0||x===o.value.disabledRowKeys.length}),[u,v]=xe(!1),y={"onUpdate:visible":v,trigger:"click"},m=()=>b(Qe,{dataSource:s.value,onClick:i},null),S=()=>b(Ce,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),C=()=>{if(s.value.length!==0)return b(Je,y,{default:S,overlay:m})};return()=>{const{multiple:x}=n.value;if(x)return b("span",{class:`${e.value}-cell-triggers`},[b(ze,{checked:a.value,indeterminate:t.value,disabled:c.value,onChange:r},null),C()])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=L({props:$l,setup(e){const{locale:l,mergedPrefixCls:n}=N(j);return()=>{const{activeOrderBy:o,sortable:a}=e,{orders:t,nextTooltip:r}=a,s=r&&Pl(l.table,t,o),i=Ml(n,t,o);return s?b(It,{title:s},{default:()=>[i]}):i}}});function Pl(e,l,n){const o=n?l[l.indexOf(n)+1]:l[0],{sortCancel:a,sortAsc:t,sortDesc:r}=e;return o?o==="ascend"?t:r:a}function Ml(e,l,n){const o=e.value,a=`${o}-sortable-trigger-active`,t=l.includes("ascend")&&b(Ce,{name:"caret-up-filled",class:n==="ascend"?a:void 0,role:"button",ariaPressed:String(n==="ascend")},null),r=l.includes("descend")&&b(Ce,{name:"caret-down-filled",class:n==="descend"?a:void 0,role:"button",ariaPressed:String(n==="descend")},null);return b("span",{class:`${o}-sortable-trigger`},[t,r])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ol=L({props:xl,setup(e){const{props:l,slots:n,mergedPrefixCls:o,fixedColumnKeys:a,columnOffsetsWithScrollBar:t,isSticky:r,handleSort:s,activeOrderByMap:i,activeFilterByMap:c,mergedRows:u,handleFilter:v}=N(j),y=p(()=>{const{type:d,ellipsis:f}=e.column,h=d||f!=null?f:l.ellipsis;return Xe(h)&&h.head===!1?void 0:h}),m=p(()=>{const{type:d,align:f,fixed:h,hasChildren:B,key:T,sortable:$,filterable:I}=e.column,w=o.value;let R={[`${w}-cell`]:!0,[`${w}-cell-${d}`]:!!d,[`${w}-cell-filterable`]:!!I,[`${w}-cell-sortable`]:!!$,[`${w}-cell-align-center`]:B||(f==null?void 0:f.title)==="center",[`${w}-cell-align-end`]:!B&&(f==null?void 0:f.title)==="end",[`${w}-cell-ellipsis`]:!!y.value};if(h){const{lastStartKey:W,firstEndKey:D}=a.value;R={...R,[`${w}-fix-start`]:h==="start",[`${w}-fix-start-last`]:W===T,[`${w}-fix-end`]:h==="end",[`${w}-fix-end-first`]:D===T,[`${w}-fix-sticky`]:r.value}}return ie(R)}),S=p(()=>{var R,W;const{key:d,fixed:f}=e.column,{offsetIndexMap:h}=u.value;if(!f)return;const{starts:B,ends:T}=t.value,$=Object.values(f==="start"?B:T),I=(R=h[d])==null?void 0:R[f==="start"?"colStart":"colEnd"];if($e(I))return{};const w=Q((W=$.find(D=>D.index===I))==null?void 0:W.offset);return{position:"sticky",left:f==="start"?w:void 0,right:f==="end"?w:void 0}}),C=p(()=>i[e.column.key]),x=p(()=>c[e.column.key]||Rt),k=d=>{const{key:f,filterable:h}=e.column;v(f,h,d)},g=()=>{const{key:d,sortable:f}=e.column;f&&s(d,f)};return()=>{var D,_,Y;const{column:d}=e,{type:f,titleColSpan:h,titleRowSpan:B}=d;if(f==="scroll-bar")return b("th",{class:m.value,style:S.value,colspan:h===1?void 0:h,rowspan:B===1?void 0:B,onClick:g},null);const T=o.value;let $,I;if(f==="selectable")I=b(Il,null,null);else{const{title:P,customTitle:M,sortable:A,filterable:O}=d,X=y.value;I=zl(P,M,n),$=ot(X,I,P);const J=Hl(A,C,O,x,k);J.length>0?I=b("span",{class:`${T}-cell-triggers`},[b("span",{class:`${T}-cell-title`},[I]),J]):X&&(I=b("span",{class:`${T}-cell-title`},[I]))}const w=(D=l.customAdditional)==null?void 0:D.headCell,R=w?w({column:d}):void 0,W=(Y=(_=l.customTag)==null?void 0:_.headCell)!=null?Y:"th";return b(W,ye({class:m.value,style:S.value,colSpan:h===1?void 0:h,rowSpan:B===1?void 0:B,title:$},R,{onClick:g}),{default:()=>[I]})}}});function zl(e,l,n){let o=e;return ve(l)?o=l({title:e}):G(l)&&n[l]&&(o=n[l]({title:e})),o}function Hl(e,l,n,o,a){const t=[];return e&&t.push(b(Rl,{activeOrderBy:l.value,sortable:e},null)),n&&t.push(b(Tl,{activeFilterBy:o.value,filterable:n,onUpdateFilterBy:a},null)),t}function Wl(e){return e.map(l=>mt(l)).filter(Boolean)}function mt(e){if(e.titleColSpan!==0)return b(Ol,{key:e.key,column:e},null)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Dl=L({props:Sl,setup(e,{slots:l}){const{props:n,mergedPrefixCls:o}=N(j);return()=>{var i,c,u;const{columns:a}=e,t=(i=n.customAdditional)==null?void 0:i.headRow,r=t?t({columns:a}):void 0,s=(u=(c=n.customTag)==null?void 0:c.headRow)!=null?u:"tr";return b(s,ye({class:`${o.value}-row`},r),{default:()=>{var v;return[(v=l.default)==null?void 0:v.call(l)]}})}}});function bt(e,l,n){return b(Dl,{columns:e,key:l},{default:()=>[n]})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pe=L({setup(e,{slots:l}){const{props:n,mergedRows:o,mergedPrefixCls:a}=N(j);return()=>{var u,v,y;let t;const{rows:r}=o.value,s=(u=n.customAdditional)==null?void 0:u.head,i=s?s({rows:r}):void 0,c=(y=(v=n.customTag)==null?void 0:v.head)!=null?y:"thead";return l.default?t=l.default():t=r.map((m,S)=>{const C=Wl(m);return bt(m,S,C)}),b(c,ye({class:`${a.value}-thead`},i),{default:()=>[t]})}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Fl=L({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e){const{props:l,mergedPrefixCls:n,mergedVirtual:o,mergedVirtualColWidth:a,getVirtualColWidth:t,headerVirtualScrollRef:r,handleScroll:s,scrollHeadRef:i,scrollWidth:c,flattedData:u,flattedColumns:v,fixedColumns:y,mergedRows:m,isSticky:S}=N(j);Al(i,s);const C=p(()=>c.value==="max-content"),x=p(()=>u.value.length>0),k=p(()=>{const f=n.value;return{[`${f}-fixed-holder`]:!0,[`${f}-sticky-holder`]:S.value}}),g=p(()=>{const f=S.value,{offsetTop:h,offsetBottom:B}=e;return{overflow:"hidden",top:f?Q(h):void 0,bottom:f?Q(B):void 0}}),d=p(()=>o.value.horizontal?m.value.rows.map((f,h)=>({key:h,data:f})):[]);return()=>{const f=x.value||!C.value;if(o.value.horizontal){const h=(R,{renderedData:W})=>{let D=[];if(f){const _=[];W.forEach(Y=>{_.push(...Y.data)}),D=De(_)}return b("table",{style:{tableLayout:"fixed"}},[f&&b(Se,{columns:D,isFixedHolder:!0},null),b(Pe,null,{default:()=>[R]})])},B=({item:R,index:W,children:D})=>bt(R.data,W,D),T=({item:R})=>mt(R),$=(R,W)=>{const{fixedStartColumns:D,fixedEndColumns:_}=y.value;return at(R,W,v.value,u.value,D,_,!0)},{virtualBufferSize:I,virtualBufferOffset:w}=l;return b("div",{class:k.value,style:g.value},[b(et,{ref:r,dataSource:d.value,colModifier:$,getKey:"key",height:0,width:"100%",colWidth:a.value,getColWidth:t,rowRender:B,colRender:T,contentRender:h,virtual:{horizontal:!0,vertical:!1},bufferSize:I,bufferOffset:w},null)])}return b("div",{class:k.value,style:g.value,ref:i},[b("table",{style:{tableLayout:"fixed"}},[f&&b(Se,{isFixedHolder:!0},null),b(Pe,null,null)])])}}});function Al(e,l){const n=t=>{if(!t.shiftKey)return;const r=t.deltaY,s=t.currentTarget;if(r){const i=s.scrollLeft+r;l(t,i)}},o=t=>{be(t,"wheel",n,{passive:!0})},a=t=>{fe(t,"wheel",n)};Te(()=>{U(e,(t,r)=>{a(r),o(t)},{immediate:!0})}),he(()=>a(e.value))}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const _l=L({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:n,mergedSticky:o,stickyScrollLeft:a,setStickyScrollLeft:t}=N(j),r=z(!1),s=z(!1),i=z(0),c=z(0),u=z(0),v=p(()=>{const d=c.value,f=u.value;return f&&d*(d/f)});Pt(()=>{const d=ae(l);if(d&&r.value){const{clientWidth:f,scrollWidth:h,scrollLeft:B}=d;t(B/h*f),c.value=f,u.value=h}});const y=p(()=>({height:Ie(),width:c.value,bottom:o.value.offsetScroll})),m=p(()=>{const d=e.value;return{[`${d}-sticky-scrollbar-thumb`]:!0,[`${d}-sticky-scrollbar-thumb-active`]:s.value}}),S=p(()=>({width:`${v.value}px`,transform:`translate3d(${a.value}px, 0, 0)`})),C=()=>s.value=!1,x=d=>{i.value=d.pageX-a.value,s.value=!0,d.preventDefault()},k=d=>{if(!s.value)return;const{buttons:f}=d||window.event;if(f===0){s.value=!1;return}let h=d.pageX-i.value;h<=0&&(h=0);const B=c.value,T=u.value,$=v.value;h+$>=B&&(h=B-$);const I=h/B*(T+2);n(d,I)},g=()=>{const d=ae(l),f=_e(d).top,h=f+d.offsetHeight,{container:B,offsetScroll:T}=o.value,$=B===window?document.documentElement.scrollTop+window.innerHeight:_e(B).top+B.clientHeight;h-Ie()<=$||f>=$-T?r.value=!1:r.value=!0};return Te(()=>{be(document.body,"mouseup",C),be(document.body,"mousemove",k),be(window,"resize",g),U(()=>o.value.container,(d,f)=>{fe(f,"scroll",g),be(d,"scroll",g)},{immediate:!0}),g()}),he(()=>{fe(document.body,"mouseup",C),fe(document.body,"mousemove",k),fe(window,"resize",g),fe(o.value.container,"scroll",g)}),()=>!l.value||!r.value||u.value<=c.value||!v.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:y.value},[b("div",{class:m.value,style:S.value,onMousedown:x},null)])}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Nl=L({setup(e,{slots:l}){const{props:n,mergedPrefixCls:o}=N(j);return()=>{var t,r;const a=(r=(t=n.customTag)==null?void 0:t.body)!=null?r:"tbody";return b(a,{class:`${o.value}-tbody`},{default:()=>{var s;return[(s=l.default)==null?void 0:s.call(l)]}})}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Me=L({props:{columns:Array,isEmpty:Boolean},setup(e,{slots:l}){const{clientWidth:n,mergedPrefixCls:o,hasFixed:a,scrollHorizontalOverflowed:t,scrollBarColumn:r}=N(j),s=p(()=>{var i,c;return(c=(i=e.columns)==null?void 0:i.length)!=null?c:1});return()=>{let i=l.default();if(e.isEmpty?t.value:a.value){const c=r.value;i=b("div",{class:`${o.value}-fixed-row`,style:{width:Q(n.value-(c?c.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colspan:s.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Ll=L({props:kl,setup(e){const l=z();return Re(l,o=>{const{contentRect:{width:a}}=o;e.changeColumnWidth(e.cellKey,a)}),he(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[Mt("Â ")])])}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Vl=L({props:{columns:Array},setup(e){const{mergedPrefixCls:l}=N(j),{changeColumnWidth:n}=N(gt);return()=>{var a;const o=(a=e.columns)==null?void 0:a.map(t=>{const{key:r}=t;return b(Ll,{key:r,cellKey:r,changeColumnWidth:n},null)});return b("tr",{class:`${l.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[o])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const jl=L({props:wl,setup(e){const{props:l,slots:n,config:o,mergedPrefixCls:a,mergedEmptyCell:t,activeOrderByMap:r,fixedColumnKeys:s,columnOffsets:i,isSticky:c,isTreeData:u,expandable:v,selectable:y,mergedPagination:m}=N(j),S=N(pt),C=S.props,x=p(()=>r[e.column.key]),k=Ul(S,e),g=p(()=>s.value.lastStartKey===e.column.key),d=p(()=>s.value.firstEndKey===e.column.key),f=p(()=>{const{type:T,ellipsis:$}=e.column;return T||$!=null?$:l.ellipsis}),h=p(()=>{const{fixed:T,align:$,type:I}=e.column,w=a.value;let R={[`${w}-cell`]:!0,[`${w}-cell-sorted`]:!!x.value,[`${w}-cell-align-${$.cell}`]:!!$&&$.cell!="start",[`${w}-cell-ellipsis`]:!!f.value,[`${w}-cell-${I}`]:!!I,[`${w}-cell-last`]:!!e.isLast};return T&&(R={...R,[`${w}-fix-start`]:T==="start",[`${w}-fix-start-last`]:g.value,[`${w}-fix-end`]:T==="end",[`${w}-fix-end-first`]:d.value,[`${w}-fix-sticky`]:c.value}),ie(R)}),B=p(()=>{var W;const{fixed:T}=e.column;if(!T)return;const{starts:$,ends:I}=i.value,R=Q((W=(T==="start"?$:I)[e.column.key])==null?void 0:W.offset);return $e(R)?{}:{position:"sticky",left:T==="start"?R:void 0,right:T==="end"?R:void 0}});return()=>{var P,M,A;const{column:T}=e,$=a.value,{type:I}=T;let w,R;if(I==="selectable")w=Gl(S,n,y,o,m,$);else if(I==="indexable")w=St(S,n,T,m,$);else{const O=k.value;if(w=ql(S,e,n,O),R=ot(f.value,w,O),!I&&($e(w)||w==="")){const X=n.emptyCell||t.value;w=ve(X)?X({column:T,record:C.record,rowIndex:C.rowIndex}):X}}e.column.fixed&&f.value&&(g.value||d.value)&&(w=b("span",{class:`${$}-cell-content`},[w]));const W=(P=l.customAdditional)==null?void 0:P.bodyCell,D=W?W({column:T,record:C.record,rowIndex:C.rowIndex}):void 0,_=(A=(M=l.customTag)==null?void 0:M.bodyCell)!=null?A:"td",Y=I==="expandable"?b("div",{class:`${$}-expandable-wrapper`},[Xl(S,n,v,u,$),!tt(w)&&b("span",{class:`${$}-expandable-trigger-gap`},null),w]):w;return b(_,ye({class:h.value,style:B.value,title:R,colSpan:e.colSpan,rowSpan:e.rowSpan},D),{default:()=>[Y]})}}});function Ul(e,l){return p(()=>{const{props:{record:n}}=e,{column:o}=l,a=Oe(o.dataKey);if(a.length<=0)return;let t=n;for(let r=0;r<a.length&&t;r++){const s=a[r];t=t[s]}return t})}function ql(e,l,n,o){const{props:{record:a,rowIndex:t}}=e,{column:r}=l,{customCell:s}=r,i=G(s)?n[s]:s;return i?i({value:o,record:a,rowIndex:t}):o}function Xl(e,l,n,o,a){var I;const{icon:t,customIcon:r,indent:s,showLine:i}=n.value,{props:{record:c,expanded:u,level:v=0,hasPrevSibling:y,hasNextSibling:m,showLineIndentIndexList:S},expandDisabled:C,handleExpend:x}=e,k=v>0,g=o.value&&i&&s;let d;const f=(I=G(r)?l[r]:r)!=null?I:t;ve(f)?d=f({expanded:!!u,record:c}):d=G(f)?b(Ce,{name:f,rotate:u?90:0},null):f;const h=s?`width: ${Q(s)}`:void 0,B={[`${a}-expandable-trigger`]:!0,[`${a}-expandable-trigger-show-line`]:g,[`${a}-expandable-trigger-disabled`]:C.value},T=[];if(s)for(let w=0;w<v;w++)T.push(b("div",{class:{[`${a}-expandable-indent`]:!0,[`${a}-expandable-indent-show-line`]:g&&S.includes(w)},style:h},null));const $=w=>{w.preventDefault(),w.stopImmediatePropagation(),C.value||x()};return[...T,b("span",{class:B,style:h},[b("button",{class:`${a}-expandable-trigger-button`,type:"button",onClick:$},[d]),g&&[b("span",{class:`${a}-expandable-trigger-line-right`},null),(y||k)&&b("span",{class:`${a}-expandable-trigger-line-top`},null),m&&b("span",{class:`${a}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function Gl(e,l,n,o,a,t){const{props:{record:r,rowIndex:s},isSelected:i,isIndeterminate:c,selectDisabled:u,isHover:v,handleSelect:y}=e,{showIndex:m,multiple:S,customCell:C}=n.value,x=g=>{g.stopPropagation(),!S&&i.value&&!u.value&&y&&y()};if(!i.value&&!v.value&&m)return St(e,l,o.columnIndexable,a,t);const k=G(C)?l[C]:C;if(S){const g={checked:i.value,disabled:u.value,indeterminate:c.value,onChange:y,onClick:x};return k?k({...g,record:r,rowIndex:s}):b(ze,g,null)}else{const g={checked:i.value,disabled:u.value,onChange:y,onClick:x};return k?k({...g,record:r,rowIndex:s}):b(lt,g,null)}}function St(e,l,n,o,a){const{props:{record:t,rowIndex:r},selectDisabled:s}=e,{customCell:i}=n,{pageIndex:c=1,pageSize:u=0}=o.value||{},v=G(i)?l[i]:i;if(!v)return;const y=[`${a}-indexable-label`,s.value&&`${a}-indexable-label-disabled`];return b("span",{class:y},[v({record:t,rowIndex:r,pageIndex:c,pageSize:u})])}function Yl(e,l,n){const o=[];return e.forEach((a,t)=>{const r=xt(a,l,n,t===e.length-1);r&&o.push(r)}),o}function xt(e,l,n,o){const{colSpan:a,rowSpan:t}=e,r=a==null?void 0:a(l,n),s=t==null?void 0:t(l,n);if(r===0||s===0)return;const i={key:e.key,colSpan:r===1?void 0:r,rowSpan:s===1?void 0:s,isLast:o,column:e};return b(jl,i,null)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Zl=L({props:Cl,setup(e,{slots:l}){const{props:n,mergedPrefixCls:o,expandable:a,isChecked:t,isIndeterminate:r,isCheckDisabled:s,handleExpandChange:i,checkExpandDisabled:c,selectable:u,handleSelectChange:v}=N(j),{expandDisabled:y,handleExpend:m,selectDisabled:S,handleSelect:C,isHover:x,attrs:k}=Jl(e,a,c,i,u,v,s),g=p(()=>t(e.rowKey)),d=p(()=>r(e.rowKey)),f=p(()=>{const h=`${o.value}-row`,{level:B,expanded:T}=e;return ie({[`${h}`]:!0,[`${h}-level-${B}`]:!!B,[`${h}-selected`]:g.value,[`${h}-expanded`]:T})});return He(pt,{props:e,expandDisabled:y,handleExpend:m,isSelected:g,isIndeterminate:d,selectDisabled:S,handleSelect:C,isHover:x}),()=>{var $,I,w;const h=($=n.customAdditional)==null?void 0:$.bodyRow,B=h?h({record:e.record,rowIndex:e.rowIndex}):void 0,T=(w=(I=n.customTag)==null?void 0:I.bodyRow)!=null?w:"tr";return b(T,ye({class:f.value},k.value,B),{default:()=>{var R;return[(R=l.default)==null?void 0:R.call(l)]}})}}});function Jl(e,l,n,o,a,t,r){const s=p(()=>n(e.rowData)),i=p(()=>{var f;return(f=l.value)==null?void 0:f.trigger}),c=()=>{const{rowKey:f}=e;o(f)},u=p(()=>r(e.rowKey)),v=p(()=>{var f;return(f=a.value)==null?void 0:f.trigger}),y=p(()=>{var f;return(f=a.value)==null?void 0:f.showIndex}),m=z(!1),S=()=>{const{rowKey:f,record:h}=e;t(f,h)},C=()=>{i.value==="click"&&c(),v.value==="click"&&S()},x=()=>{i.value==="dblclick"&&c(),v.value==="dblclick"&&S()},k=()=>m.value=!0,g=()=>m.value=!1,d=p(()=>{const f=s.value,h=i.value,B=u.value,T=v.value,$=!f&&h==="click"||!B&&T==="click",I=!f&&h==="dblclick"||!B&&T==="dblclick",w=!B&&y.value;let R="";return $||I?R="pointer":(f&&h||B&&T)&&(R="not-allowed"),{style:R?`cursor: ${R}`:void 0,onClick:$?C:void 0,onDblclick:I?x:void 0,onMouseenter:w?k:void 0,onMouseleave:w?g:void 0}});return{expandDisabled:s,handleExpend:c,selectDisabled:u,handleSelect:S,isHover:m,attrs:d}}function qe(e,l,n,o,a,t,r){const{children:s,expanded:i,level:c,hasPrevSibling:u,hasNextSibling:v,showLineIndentIndexList:y,record:m,rowKey:S}=e,C={key:S,expanded:i,level:c,hasPrevSibling:u,hasNextSibling:v,showLineIndentIndexList:y,hasChildren:!!(s!=null&&s.length),record:m,rowData:e,rowIndex:n,rowKey:S},x=b(Zl,C,{default:()=>[r]}),k=i&&Ql(C,o,l,a,t);return k?[x,k]:x}function Ql(e,l,n,o,a){const{customExpand:t}=o||{},{record:r,rowIndex:s}=e;let i;return ve(t)?i=t({record:r,rowIndex:s}):G(t)&&l[t]&&(i=l[t]({record:r,rowIndex:s})),i&&b(Me,{class:`${a}-expanded-row`,columns:n},{default:()=>[i]})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const en=L({setup(){const{props:e,slots:l,clientWidth:n,setClientWidth:o,expandable:a,mergedPrefixCls:t,mergedInsetShadow:r,mergedVirtual:s,mergedVirtualItemHeight:i,mergedVirtualColWidth:c,mergedAutoHeight:u,changeColumnWidth:v,flattedData:y,flattedColumns:m,fixedColumns:S,getVirtualColWidth:C,isSticky:x,mergedSticky:k,virtualScrollRef:g,scrollBodyRef:d,scrollContentRef:f,handleScroll:h,pingedStart:B,pingedEnd:T,scrollWidth:$,scrollHeight:I,scrollHorizontalOverflowed:w,scrollVerticalOverflowed:R,hasFixed:W,tableLayout:D}=N(j),_=z(),Y=p(()=>u.value||!!$.value||x.value||s.value.horizontal);He(gt,{changeColumnWidth:(E,F)=>{Ht(_.value)&&v(E,F)}});const M=()=>{const E=ae(d);E&&h({currentTarget:E})},A=E=>{const{offsetWidth:F}=E.target;F!==n.value&&o(F)};Te(()=>{M(),U([()=>e.dataSource,$],([,E])=>{E&&M()}),Ot(_.value,A)}),he(()=>zt(_.value,A));const O=p(()=>{const E=t.value;return ie({[`${E}-container`]:!0,[`${E}-ping-start`]:B.value,[`${E}-ping-end`]:T.value,[`${E}-fixed-layout`]:D.value==="fixed",[`${E}-fixed-column`]:W.value,[`${E}-inset-shadow`]:r.value,[`${E}-scroll-horizontal`]:w.value,[`${E}-scroll-vertical`]:R.value})}),X=p(()=>{var V;const E=I.value,F=s.value.horizontal?"hidden":"auto",K=s.value.vertical?"hidden":"auto",H=(V=e.scroll)==null?void 0:V.fullHeight;return{overflowX:F,overflowY:K,[H?"height":"maxHeight"]:E}}),J=p(()=>({tableLayout:D.value,width:$.value,minWidth:$.value?"100%":void 0})),re=(E,F,K)=>{q(e.onScrolledChange,E,F,K.map(H=>H.record))},ee=p(()=>!s.value.vertical&&!s.value.horizontal?[]:y.value.map(E=>({...E,data:m.value}))),ge=E=>{if(!(!Y.value||!E))return b(Vl,{columns:E},null)},se=E=>{var K;const F=(K=l.alert)==null?void 0:K.call(l);if(!tt(F))return b(Me,{class:`${t.value}-alert-row`,columns:E},{default:()=>[F]})},Ke=E=>{if(!(y.value.length>0))return b(Me,{class:`${t.value}-empty-row`,columns:E,isEmpty:!0},{default:()=>[b(Wt,{empty:e.empty},l)]})},Ee=(E,F,K)=>{let H;if(K)H=K;else if(F!=null&&F.length){const V=[];F.forEach((le,ue)=>{const ce=Yl(E!=null?E:[],le.record,ue);V.push(...Oe(qe(le,E,ue,l,a.value,t.value,ce)))}),H=V}return b(Nl,null,{default:()=>[se(E),ge(E),Ke(E),H]})},we=()=>Ee(m.value,y.value),ke=(E,F)=>Ee(E,void 0,F);return()=>{const E=t.value,F=u.value,K=s.value,H=l.default?l.default():[];if(F||I.value||x.value||K.horizontal){const{offsetTop:V}=k.value;if(e.headless||H.push(b(Fl,{offsetTop:V},null)),K.vertical&&(e.scroll||F)||!K.vertical&&K.horizontal){const le=({item:Z,index:te,children:oe})=>qe(Z,Z.data,te,l,a.value,E,oe),ue=({row:Z,item:te,index:oe,rowIndex:de})=>xt(te,Z.record,de,oe===Z.data.length-1),ce=(Z,{renderedData:te})=>{var de;const oe=y.value.length?(de=te[0])==null?void 0:de.data:m.value;return b("table",{ref:f,class:`${E}-table`,style:J.value},[oe?b(Se,{columns:oe},null):void 0,ke(oe,Z),!1])},pe=(Z,te)=>{const{fixedStartColumns:oe,fixedEndColumns:de}=S.value;return at(Z,te,m.value,y.value,oe,de,!1)},{scroll:ne,onScrolledBottom:wt}=e;H.push(b(et,{ref:g,class:`${E}-body-virtual-scroll`,dataSource:ee.value,colModifier:pe,fullHeight:ne==null?void 0:ne.fullHeight,getKey:Z=>{var te;return(te=Z.rowKey)!=null?te:Z.key},height:u.value?"100%":ne==null?void 0:ne.height,width:"100%",rowHeight:i.value,colWidth:c.value,getColWidth:C,rowRender:le,colRender:ue,contentRender:ce,virtual:s.value,scrollMode:e.virtualScrollMode,bufferSize:e.virtualBufferSize,bufferOffset:e.virtualBufferOffset,onScroll:h,onScrolledBottom:wt,onScrolledChange:re},null))}else H.push(b("div",{ref:d,class:`${E}-content`,style:X.value,onScroll:h},[b("table",{ref:f,class:`${E}-table`,style:J.value},[b(Se,null,null),we(),!1])]));x.value&&H.push(b(_l,null,null))}else H.push(b("div",{ref:d,class:`${E}-content`,style:X.value,onScroll:h},[b("table",{ref:f,class:`${E}-table`,style:J.value},[b(Se,null,null),!e.headless&&b(Pe,null,null),we(),!1])]));return b("div",{ref:_,class:O.value},[H])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function tn(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function ln(e,l,n,o,a){var s,i;let t=null,r=null;if(l!==null){const{position:c}=l,[u,v]=Dt(c).split("-"),y=`${a}-pagination ${a}-pagination-${v}`,m=(i=(s=e.pagination)==null?void 0:s.call(e,{total:n.length,...l}))!=null?i:Ft(b(qt,ye({class:y,total:n.length},l),null),[[At,o]]);t=u==="top"?m:null,r=u==="bottom"?m:null}return[t,r]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ct(e,l){const{getGreyColors:n}=l,o=n(),{fontSizeSm:a,heightMd:t,paddingSizeSm:r,paddingSizeMd:s,paddingSizeLg:i,colorTextTitleSecondary:c,colorEmphasizedContainerBg:u,colorBorder:v,colorIconInfo:y,colorPrimary:m,colorContainerBg:S,colorContainerBgHover:C,colorInfoContainerBg:x}=e;return{fontSizeSm:a,fontSizeMd:a,fontSizeLg:a,headRowHeightSm:t,headRowHeightMd:t,headRowHeightLg:t,cellPaddingHorizontalSm:r,cellPaddingHorizontalMd:s,cellPaddingHorizontalLg:i,cellPaddingVerticalSm:6,cellPaddingVerticalMd:10,cellPaddingVerticalLg:18,headColor:c,headBgColor:u,headSeparatorColor:v,headIconColor:y,headIconColorActive:m,headIconBgColorHover:n().l30,insetShadowStart:`inset 10px 0 8px -8px ${Ne(o.d50,.12)}`,insetShadowEnd:`inset -10px 0 8px -8px ${Ne(o.d50,.12)}`,bodyRowBgColorHover:C,bodyRowBgColorSelected:S,bodyRowBgColorExpanded:x,bodyRowBgColorTreeExpanded:x,bodyCellVerticalAlign:"middle",expandableIconColor:y}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function nn(e,l){const{getGreyColors:n}=l,o=n();return{...Ct(e,l),insetShadowStart:`inset 10px 0 8px -8px ${o.l50}`,insetShadowEnd:`inset -10px 0 8px -8px ${o.l50}`}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const on=(e,l,n)=>l==="default"?Ct(e,n):nn(e,n);/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const an={sm:32,md:40,lg:56},rn=150,sn=L({name:"IxTable",props:bl,setup(e,{expose:l,slots:n}){const o=Be("common"),{globalHashId:a,hashId:t,registerToken:r}=_t("table");r(on);const s=p(()=>`${o.prefixCls}-table`),i=Be("locale"),c=Be("table"),[u,v]=xe(0),y=p(()=>{var K;return(K=e.autoHeight)!=null?K:c.autoHeight}),m=p(()=>{var K;return(K=e.childrenKey)!=null?K:c.childrenKey}),S=Nt(e,c),C=p(()=>{var K;return(K=e.emptyCell)!=null?K:c.emptyCell}),x=p(()=>{var K;return(K=e.spinHeader)!=null?K:c.spinHeader}),k=p(()=>{var K;return(K=e.insetShadow)!=null?K:c.insetShadow}),g=p(()=>{var K;return(K=e.size)!=null?K:c.size}),d=p(()=>({horizontal:e.virtualHorizontal,vertical:e.virtual})),f=p(()=>{var K;return(K=e.virtualItemHeight)!=null?K:an[g.value]}),h=p(()=>{var K;return(K=e.virtualColWidth)!=null?K:rn}),{mergedPagination:B}=al(e,c,g),T=pl(e),$=rl(e,T),I=Zt(e,n,c,$.scrollBarSizeOnFixedHolder),{flattedColumns:w,flattedColumnsWithScrollBar:R,fixedColumns:W}=I,D=Gt(w),{measuredColumnWidthMap:_}=D,Y=p(()=>R.value.length),P=Xt(W,_,Y),M=gl(w),A=ol(w),O=nl(e,w,K=>{var H;return(H=se.mergedMap.value.get(K))==null?void 0:H.record}),X=ml(e,I,$,T.isSticky,d,y),{activeSorters:J}=M,{activeFilters:re}=A,ee=new Map,ge=()=>{ee.clear(),w.value.forEach(K=>{ee.set(K.key,K)})};U(w,()=>{ge()},{immediate:!0});const se=ll(e,m,S,J,re,O.expandedRowKeys,B),Ke=vl(e,i,I.flattedColumns,se);ul(e,c,B,J,re,$.scrollTo);const we={props:e,slots:n,config:c,locale:i,clientWidth:u,setClientWidth:v,mergedChildrenKey:m,mergedPrefixCls:s,mergedEmptyCell:C,mergedInsetShadow:k,mergedVirtual:d,mergedVirtualItemHeight:f,mergedVirtualColWidth:h,mergedAutoHeight:y,getVirtualColWidth:(K,H)=>{var V,le;return(le=_.value[H])!=null?le:(V=ee.get(H))==null?void 0:V.width},...I,...D,...P,...$,...M,...A,...T,tableLayout:X,mergedPagination:B,...O,...se,...Ke};He(j,we),l({scrollTo:$.scrollTo});const{flattedData:ke,filteredData:E}=se,F=p(()=>{const K=s.value,{borderless:H=c.borderless,scroll:V}=e;return ie({[a.value]:!!a.value,[t.value]:!!t.value,[K]:!0,[`${K}-auto-height`]:y.value,[`${K}-borderless`]:H,[`${K}-empty`]:ke.value.length===0,[`${K}-full-height`]:V==null?void 0:V.fullHeight,[`${K}-${g.value}`]:!0})});return()=>{const K=s.value,H=b(Lt,{header:e.header},n),V=tn(n,K),[le,ue]=ln(n,B.value,E.value,ke.value.length>0,K),ce=[],pe=[le,b(en,null,null),V,ue].filter(Boolean),ne=cn(e.spin);return ne?(x.value?pe.unshift(H):ce.push(H),ce.push(b(Vt,ne,{default:()=>[pe]}))):ce.push(H,...pe),b("div",{class:F.value},[ce])}}});function cn(e){return jt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const hn=sn,yn=We;export{hn as I,j as T,yn as a,Yt as g,bl as t};
