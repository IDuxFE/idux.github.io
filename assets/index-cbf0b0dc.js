import{K as M,ao as Be,r as $e,aa as Re,ae as we,af as De,m as U,P as X,ad as se,aH as ce,N as Z,M as N,a8 as ie,ay as de,az as pe}from"./index-ebff8fb2.js";import{c as Me,a as He,n as ze,f as Ue,Éµ as fe,b as ve,h as Ke,g as me,u as he}from"./index-0dac8dd7.js";import{c as x,f as Ne,w as j,m as Y,a0 as ne,t as _e,l as L,y as ee,r as H,$ as ge,q as k,ad as w,ac as be,D as ye,p as Ie}from"./vendor-7de7c0f1.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function _(e,n,a){if(n)return e.convert(n,a)}function je(e){return e.sort((n,a)=>n?a?n.valueOf()-a.valueOf():0:1)}function Ce(e){return/[hH]/.test(e)}function Pe(e){return/m/.test(e)}function ke(e){return/s/.test(e)}function te(e){return/[aA]/.test(e)}function Le(e){return/A/.test(e)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function ae(e,n,a,t){const[u,c]=M(void 0),[i,s]=M(!1),[p,o]=M(void 0),{parse:d,format:m}=e,f=x(()=>Me(e,t.value,n.value)),C=x(()=>Ne(t.value)?t.value:f.value?m(f.value,n.value):""),r=x(()=>({hourEnabled:Ce(n.value)||te(n.value),minuteEnabled:Pe(n.value),secondEnabled:ke(n.value)}));function v(l=!1){(l||!u.value||d(u.value,n.value).valueOf()!==d(C.value,n.value).valueOf())&&c(C.value),o(f.value)}j([t,n],()=>v(),{immediate:!0});function h(l){if(!l||!f.value)return l;const{hourEnabled:g,minuteEnabled:y,secondEnabled:T}=r.value,b=["year","month","date",!g&&"hour",!y&&"minute",!T&&"second","millisecond"].filter(Boolean);return He(e,f.value,l,b)}function P(l,g,y){return l?e.parse(l,g,y):void 0}function V(l){return!l||e.isValid(l)}function S(l){const g=l.target.value;c(g);const y=P(g,n.value,f.value);V(y)&&a(u.value?h(y):void 0)}function A(){c("")}function E(){s(!0)}function O(){s(!1)}function I(l){a(l)}return{inputValue:u,panelValue:p,inputFocused:i,setInputValue:c,setPanelValue:o,init:v,handleInput:S,handleInputClear:A,handleInputFocus:E,handleInputBlur:O,handlePanelChange:I}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xe(e,n){return x(()=>{var t;const a=(t=e.allowInput)!=null?t:n.allowInput;return{enableExternalInput:a===!0,enableInternalInput:a==="overlay"}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function qe(e,n){return a=>{if(a.code==="Escape"){n(!1);return}if(!e.value&&!["Backspace","Tab"].includes(a.code)){a.preventDefault(),n(!0);return}a.code==="Enter"&&n(!1)}}function Ge(e,n,a,t){const{bufferUpdated:u,buffer:c}=e;return i=>{if(i.code==="Escape"){a(!1);return}if(!n.value&&!["Backspace","Tab"].includes(i.code)){i.preventDefault(),a(!0);return}switch(i.code){case"Enter":u.value&&t(c.value),a(!1);break}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Je=[0,4];function Ve(e){const{props:n,common:a,config:t,accessor:u,mergedPrefixCls:c,overlayOpened:i,setOverlayOpened:s}=e;return x(()=>{var p;return{clickOutside:!1,container:(p=n.overlayContainer)!=null?p:t.overlayContainer,containerFallback:`.${c.value}-overlay-container`,disabled:u.disabled||n.readonly,offset:Je,placement:"bottomStart",transitionName:`${a.prefixCls}-slide-auto`,trigger:"manual",visible:i.value,"onUpdate:visible":s}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Se(e,n){const[a,t]=Be(e,"open",!1);return Y(()=>{e.autofocus&&n()}),{overlayOpened:a,setOverlayOpened:t}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ae(e,n,a,t,u){const{accessor:c,control:i}=$e();Re(i);const s=we(e,n),p=De(e,i),o=r=>{const{get:v}=a,h=te(t.value);return X(r).some(P=>{const V=v(P,"hour"),S=ze(V,h),A=Ue(V,!!h),E=v(P,"minute"),O=v(P,"second");return e.disabledHours(S).includes(A)||e.disabledMinutes(A,S).includes(E)||e.disabledSeconds(A,E,S).includes(O)})};function d(r){const v=ne(r)?je(r):r;if(o(v))return;let h=_e(c.value);h=ne(h)?h.map(P=>_(a,P,t.value)):_(a,h,t.value),c.setValue(v),U(e.onChange,v,h)}function m(r){d(void 0),U(e.onClear,r)}function f(r){U(e.onFocus,r)}function C(r){c.markAsBlurred(),u(!1),U(e.onBlur,r)}return{accessor:c,mergedSize:s,mergedStatus:p,handleChange:d,handleClear:m,handleFocus:f,handleBlur:C}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ee(e){return x(()=>{var u,c;const{props:n,config:a,accessor:t}=e;return{borderless:!1,clearable:(u=n.clearable)!=null?u:a.clearable,clearIcon:(c=n.clearIcon)!=null?c:a.clearIcon,disabled:t.disabled,size:"sm"}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Qe(e,n,a,t){const u=x(()=>_(n,e.defaultOpenValue,a.value)),[c,i]=M(()=>{var s;return(s=t.value)!=null?s:u.value});return j(t,s=>{i(s!=null?s:u.value)}),{activeValue:c,setActiveValue:i}}function We(e,n,a,t){const u=x(()=>X(e.defaultOpenValue).map(o=>_(n,o,a.value))),[c,i]=M(()=>{var o,d;return(d=(o=t.value)==null?void 0:o[0])!=null?d:u.value[0]}),[s,p]=M(()=>{var o,d;return(d=(o=t.value)==null?void 0:o[1])!=null?d:u.value[1]});return j(t,o=>{var d,m;i((d=o==null?void 0:o[0])!=null?d:u.value[0]),p((m=o==null?void 0:o[1])!=null?m:u.value[1])}),{fromActiveValue:c,toActiveValue:s,setFromActiveValue:i,setToActiveValue:p}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Te(e,n){return x(()=>{const{disabledHours:a,disabledMinutes:t,disabledSeconds:u,hideDisabledOptions:c,hourStep:i,minuteStep:s,secondStep:p}=e,o=n.value;return{disabledHours:a,disabledMinutes:t,disabledSeconds:u,hideDisabledOptions:c,hourStep:i,minuteStep:s,secondStep:p,hourEnabled:Ce(o),minuteEnabled:Pe(o),secondEnabled:ke(o),use12Hours:te(o),amPmCapital:Le(o)}})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const le=Symbol("timePickerContext"),oe=Symbol("timeRangePickerContext"),Xe=L({setup(){const e=ee(le),{slots:n,props:a,locale:t,formatRef:u,dateConfig:c,inputRef:i,inputEnableStatus:s,mergedPrefixCls:p,overlayOpened:o,handleClear:d,handleKeyDown:m,controlContext:{inputValue:f,panelValue:C,inputFocused:r,handleInput:v,handleInputFocus:h,handleInputBlur:P,handlePanelChange:V}}=e,S=H(),A=()=>{var y;s.value.enableInternalInput&&(i.value=(y=S.value)==null?void 0:y.getInputElement())};Y(A),ge(A);const E=Ee(e),O=Te(a,u),{activeValue:I,setActiveValue:l}=Qe(a,c,u,C),g=y=>{y.target instanceof HTMLInputElement||y.preventDefault()};return()=>{var R;const y=`${p.value}-overlay`,T=`${p.value}-board`,b={...O.value,activeValue:I.value,visible:o.value,value:C.value,onChange:V,"onUpdate:activeValue":l},$=[k("div",{class:`${y}-body ${T}`,tabindex:-1,onMousedown:g},[s.value.enableInternalInput&&k(se,w({ref:S,class:`${T}-input`},E.value,{clearVisible:!!f.value,value:f.value,readonly:a.readonly,focused:r.value,placeholder:(R=a.placeholder)!=null?R:t.timePicker.placeholder,onInput:v,onClear:d,onFocus:h,onBlur:P,onKeydown:m}),n),k(fe,w(b,{class:`${T}-panel`,tabindex:-1}),null)]),k(ce,{class:`${y}-footer`,footer:a.footer},n)];return a.overlayRender?a.overlayRender($):k("div",{onMousedown:g},[$])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Oe(e){const{props:n,config:a,accessor:t,mergedSize:u,mergedStatus:c,focused:i,handleBlur:s,handleFocus:p,handleClear:o,handleKeyDown:d,overlayOpened:m,setOverlayOpened:f}=e,C=()=>{t.disabled||f(!m.value)};return x(()=>{var r,v,h;return{borderless:n.borderless,clearable:!n.readonly&&!t.disabled&&((r=n.clearable)!=null?r:a.clearable)&&(ne(t.value)?!!t.value.length:!!t.value),clearIcon:(v=n.clearIcon)!=null?v:a.clearIcon,disabled:t.disabled,focused:i.value,readonly:n.readonly,size:u.value,status:c.value,suffix:(h=n.suffix)!=null?h:a.suffix,onClick:C,onClear:o,onFocus:p,onBlur:s,onKeyDown:d}})}const Ye=L({inheritAttrs:!1,setup(e,{expose:n,attrs:a}){const{globalHashId:t,hashId:u}=Z("timePicker"),c=ee(le),{accessor:i,props:s,slots:p,locale:o,mergedPrefixCls:d,formatRef:m,inputRef:f,inputEnableStatus:C,controlContext:{inputValue:r,handleInput:v}}=c,h=H(),P=x(()=>{var I;return(I=s.placeholder)!=null?I:o.timePicker.placeholder}),V=x(()=>Math.max(10,m.value.length)+2),S=I=>{v(I),U(s.onInput,I)};n({focus:()=>{var I;(I=(C.value.enableExternalInput?f:h).value)==null||I.focus()}});const E=Oe(c),O=I=>k("input",{ref:C.value.enableExternalInput?f:h,class:`${I}-input`,autocomplete:"off",disabled:i.disabled,placeholder:P.value,readonly:s.readonly||!C.value.enableExternalInput,size:V.value,value:r.value,onInput:S},null);return()=>{const I=d.value,l={default:()=>O(I),suffix:p.suffix,clearIcon:p.clearIcon};return k(ve,w({className:`${I} ${t.value} ${u.value}`},E.value,a),l)}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Fe={...Ke,open:{type:Boolean,default:void 0},control:{type:[String,Number,Object,Array],default:void 0},allowInput:{type:[Boolean,String],default:void 0},autofocus:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},clearable:{type:Boolean,default:void 0},clearIcon:String,clearText:String,disabled:{type:Boolean,default:!1},format:String,overlayClassName:String,overlayContainer:{type:[String,HTMLElement,Function],default:void 0},overlayRender:Function,readonly:{type:Boolean,default:!1},size:String,status:String,suffix:String,"onUpdate:open":[Function,Array],onClear:[Function,Array],onFocus:[Function,Array],onBlur:[Function,Array]},Ze={...Fe,value:[String,Date,Number],defaultOpenValue:[String,Date,Number],footer:{type:[Boolean,Array,Object],default:!1},placeholder:String,"onUpdate:value":[Function,Array],onChange:[Function,Array],onInput:[Function,Array]},en={...Fe,value:Array,defaultOpenValue:Array,footer:{type:[Boolean,Array,Object],default:!0},placeholder:Array,separator:[String,Object],"onUpdate:value":[Function,Array],onChange:[Function,Array],onInput:[Function,Array]},nn=L({name:"IxTimePicker",inheritAttrs:!1,props:Ze,setup(e,{attrs:n,expose:a,slots:t}){const u=N("common"),{globalHashId:c,hashId:i,registerToken:s}=Z("timePicker");s(me);const p=x(()=>`${u.prefixCls}-time-picker`),o=N("locale"),d=N("timePicker"),m=he(),f=H(),C=H(),{elementRef:r,focus:v,blur:h}=ie(),P=x(()=>{var D;return(D=e.format)!=null?D:d.format}),{overlayOpened:V,setOverlayOpened:S}=Se(e,v),A=Ae(e,d,m,P,S),{accessor:E,handleFocus:O,handleBlur:I,handleChange:l}=A,g=ae(m,P,l,be(E,"value")),y=xe(e,d),T=qe(V,S),{focused:b,handleFocus:$,handleBlur:R,bindOverlayMonitor:q}=de(O,I);Y(()=>{q(f,V)});const G={props:e,slots:t,dateConfig:m,common:u,locale:o,config:d,mergedPrefixCls:p,formatRef:P,focused:b,handleKeyDown:T,inputRef:r,inputEnableStatus:y,overlayOpened:V,setOverlayOpened:S,controlContext:g,...A,handleFocus:$,handleBlur:R};ye(le,G),a({focus:v,blur:h}),j(V,D=>{var F;D?setTimeout(()=>{var B;(B=r.value)==null||B.focus()}):(g.init(!0),b.value&&((F=C.value)==null||F.focus()))});const K=()=>k(Ye,w({ref:C},n),null),J=()=>k(Xe,null,null),Q=Ve(G),W=x(()=>Ie([`${p.value}-overlay`,c.value,i.value,e.overlayClassName]));return()=>k(pe,w({ref:f},Q.value,{class:W.value,triggerId:n.id}),{default:K,content:J})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function an(e,n,a){const[t,u]=M(X(a.value).map(r=>_(e,r,n.value))),[c,i]=M(!1),s=r=>{u(tn(e,r,n.value)),i(!0)};j([a,n],([r])=>{s(r)});const p=x(()=>X(t.value)),o=x(()=>p.value[0]),d=x(()=>p.value[1]),m=ae(e,n,r=>{s([r,d.value])},o),f=ae(e,n,r=>{s([o.value,r])},d);return{buffer:t,bufferUpdated:c,fromControl:m,toControl:f,init:(r=!1)=>{s(a.value),i(!1),m.init(r),f.init(r)}}}function tn(e,n,a){return X(n).map(t=>_(e,t,a))}const ln=L({setup(){const e=ee(oe),{props:n,slots:a,dateConfig:t,locale:u,mergedPrefixCls:c,formatRef:i,inputRef:s,inputEnableStatus:p,overlayOpened:o,handleChange:d,handleKeyDown:m,renderSeparator:f,setOverlayOpened:C,rangeControlContext:{buffer:r,fromControl:v,toControl:h}}=e,P=H(),V=()=>{var b;p.value.enableInternalInput&&(s.value=(b=P.value)==null?void 0:b.getInputElement())};Y(V),ge(V);const S=Ee(e),A=Te(n,i),{fromActiveValue:E,toActiveValue:O,setFromActiveValue:I,setToActiveValue:l}=We(n,t,i,x(()=>[v.panelValue.value,h.panelValue.value])),g=()=>{d(r.value),C(!1)},y=b=>{b.target instanceof HTMLInputElement||b.preventDefault()};function T(b){var re,ue;const{inputValue:$,inputFocused:R,panelValue:q,handleInput:G,handleInputClear:K,handleInputFocus:J,handleInputBlur:Q,handlePanelChange:W}=b?v:h,D=b?0:1,F=(ue=(re=n.placeholder)==null?void 0:re[D])!=null?ue:u.timeRangePicker.placeholder[D],B=`${c.value}-board`,z={...A.value,activeValue:b?E.value:O.value,visible:o.value,value:q.value,onChange:W,"onUpdate:activeValue":b?I:l};return k("div",{class:B},[p.value.enableInternalInput&&k(se,w({ref:b?P:void 0,class:`${B}-input`},S.value,{clearVisible:!!$.value,value:$.value,readonly:n.readonly,focused:R.value,placeholder:F,onInput:G,onClear:K,onFocus:J,onBlur:Q,onKeydown:m}),a),k(fe,w(z,{class:`${B}-panel`,tabindex:-1}),null)])}return()=>{const b=`${c.value}-overlay`,$={[`${b}-separator`]:!0,[`${b}-separator-line`]:!p.value.enableInternalInput},R=[k("div",{class:`${b}-body`,onMousedown:y},[T(!0),k("div",{class:$},[p.value.enableInternalInput&&f()]),T(!1)]),k(ce,{class:`${b}-footer`,footer:n.footer,okText:u.timeRangePicker.okText,okButton:{size:"xs",mode:"primary"},cancelVisible:!1,ok:g},a)];return n.overlayRender?n.overlayRender(R):k("div",{onMousedown:y},[R])}}}),on=L({inheritAttrs:!1,setup(e,{attrs:n,expose:a}){const{globalHashId:t,hashId:u}=Z("timePicker"),c=ee(oe),{accessor:i,props:s,slots:p,locale:o,mergedPrefixCls:d,inputRef:m,inputEnableStatus:f,renderSeparator:C,rangeControlContext:{fromControl:r,toControl:v}}=c,h=H(),P=x(()=>{var l,g,y,T;return[(g=(l=s.placeholder)==null?void 0:l[0])!=null?g:o.timeRangePicker.placeholder[0],(T=(y=s.placeholder)==null?void 0:y[1])!=null?T:o.timeRangePicker.placeholder[1]]});a({focus:()=>{var l;(l=(f.value.enableExternalInput?m:h).value)==null||l.focus()}});const S=l=>{r.handleInput(l),U(s.onInput,!0,l)},A=l=>{v.handleInput(l),U(s.onInput,!1,l)};function E(l,g){const{inputValue:y}=g?r:v,T=P.value[g?0:1],b=g?S:A;return k("input",{ref:g?f.value.enableExternalInput?m:h:void 0,class:`${l}-input-inner`,autocomplete:"off",disabled:i.disabled,value:y.value,placeholder:T,readonly:s.readonly||!f.value.enableExternalInput,onInput:b},null)}const O=Oe(c),I=l=>k("span",{class:`${l}-input`},[E(l,!0),k("span",{class:`${l}-input-separator`},[C()]),E(l,!1)]);return()=>{const l=d.value,g={default:()=>I(l),suffix:p.suffix,clearIcon:p.clearIcon};return k(ve,w({className:`${l} ${t.value} ${u.value}`},O.value,n),g)}}}),rn=L({name:"IxTimeRangePicker",inheritAttrs:!1,props:en,setup(e,{attrs:n,expose:a,slots:t}){const u=N("common"),{globalHashId:c,hashId:i,registerToken:s}=Z("timePicker");s(me);const p=x(()=>`${u.prefixCls}-time-range-picker`),o=N("locale"),d=N("timePicker"),m=he(),f=H(),C=H(),{elementRef:r,focus:v,blur:h}=ie(),P=x(()=>{var F;return(F=e.format)!=null?F:d.format}),{overlayOpened:V,setOverlayOpened:S}=Se(e,v),A=Ae(e,d,m,P,S),{accessor:E,handleFocus:O,handleBlur:I,handleChange:l}=A,g=an(m,P,be(E,"value")),y=xe(e,d),T=Ge(g,V,S,l),{focused:b,handleFocus:$,handleBlur:R,bindOverlayMonitor:q}=de(O,I);Y(()=>{q(f,V)});const K={props:e,slots:t,dateConfig:m,common:u,locale:o,config:d,focused:b,mergedPrefixCls:p,formatRef:P,handleKeyDown:T,inputRef:r,inputEnableStatus:y,overlayOpened:V,setOverlayOpened:S,renderSeparator:()=>{var F,B,z;return(z=(B=(F=t.separator)==null?void 0:F.call(t))!=null?B:e.separator)!=null?z:o.timeRangePicker.separator},rangeControlContext:g,...A,handleFocus:$,handleBlur:R};ye(oe,K),a({focus:v,blur:h}),j(V,F=>{var B;F?setTimeout(()=>{var z;(z=r.value)==null||z.focus()}):(g.init(!0),b.value&&((B=C.value)==null||B.focus()))});const J=()=>k(on,w({ref:C},n),null),Q=()=>k(ln,null,null),W=Ve(K),D=x(()=>Ie([`${p.value}-overlay`,c.value,i.value,e.overlayClassName]));return()=>k(pe,w({ref:f},W.value,{class:D.value,triggerId:n.id}),{default:J,content:Q})}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const dn=nn,pn=rn;export{dn as I,pn as a};
