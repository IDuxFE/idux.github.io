import{M as Be,N as fe,aN as Qe,am as ke,m as M,L as le,aH as z,aO as ce,o as X,D as ie,a2 as Je,K as oe,a1 as ee,$ as G,a3 as pe,aP as Ze,A as te,j as ve,ar as et,X as Ke,W as $e,c as me,aa as tt,ap as lt,E as nt,G as ot,H as st,aQ as at,as as rt,ao as ct,aC as it}from"./index-a3491652.js";import{b as Ee,f as j,N as ut,T as dt,c as S,m as he,r as P,w as L,a9 as Te,H as Ie,d as Y,Q as J,y as se,bk as ft,S as vt,x as H,l as F,z as V,A as m,ag as ht,i as Q,a4 as Z,q as Pe,$ as yt,an as gt}from"./vendor-63a43443.js";import{b as Oe}from"./GlobalCodeBox-28b3345e.js";import{I as pt}from"./index-bf7a6a37.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const We=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[We]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,l,t){if(!e||Ee(e)&&e.title===!1)return;if(j(l)||ut(l))return l;const n=Be(l).find(o=>o.type===dt);return n?n.children:t}function mt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Qe("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bt(e,l,t,n){const o=S(()=>{var k;const{columns:x}=e;return Fe(x&&x.length>0?x:He((k=l.default)==null?void 0:k.call(l)),t)}),{flattedColumns:r,scrollBarColumn:a,flattedColumnsWithScrollBar:s}=xt(o,n),c=Ct(s),u=S(()=>!!e.ellipsis||r.value.some(x=>x.ellipsis)),i=S(()=>r.value.some(x=>x.fixed)),{columnWidths:d,columnWidthsWithScrollBar:v,changeColumnWidth:y}=wt(r,a),{columnOffsets:h,columnOffsetsWithScrollBar:g}=Bt(d,v),C=S(()=>kt(o.value,a.value));return{flattedColumns:r,scrollBarColumn:a,flattedColumnsWithScrollBar:s,fixedColumnKeys:c,hasEllipsis:u,hasFixed:i,columnWidths:d,columnWidthsWithScrollBar:v,changeColumnWidth:y,columnOffsets:h,columnOffsetsWithScrollBar:g,mergedRows:C}}function Fe(e,l){return e.map(t=>St(t,l))}function He(e){const l=[];return Be(e,{key:We}).forEach((t,n)=>{const{props:o,children:r}=t,{key:a=n,editable:s,ellipsis:c,...u}=o||{};u.key=a,u.editable=s||s==="",u.ellipsis=c||c==="";const{default:i,cell:d,title:v,expand:y,icon:h}=r||{};i&&(u.children=He(i())),d&&(u.customCell=d),v&&(u.customTitle=v),y&&(u.customExpand=y),h&&(u.customIcon=h),l.push(u)}),l}function St(e,l){var c,u;const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:r}=l,{align:a=t.align}=e,s=mt(e);if("type"in e){const{type:i}=e;if(i==="expandable"){const{showLine:d=n.showLine,icon:v=n.icon}=e;return{...e,key:s,align:a,icon:v,showLine:d}}if(i==="selectable"){const{multiple:d=!0,showIndex:v=o.showIndex}=e;return{...e,key:s,align:a,multiple:d,showIndex:v}}if(i==="indexable"){const d=(u=(c=e.align)!=null?c:r.align)!=null?u:t.align;return{...r,...e,align:d,key:s}}return{...e,key:s,align:a}}else{const{sortable:i,filterable:d,children:v}=e,y={...e,key:s,align:a};return i&&(y.sortable={...t.sortable,...i}),d&&(y.filterable={...t.filterable,...d}),v!=null&&v.length&&(y.children=Fe(v,l)),y}}function xt(e,l){const t=S(()=>Ae(e.value)),n=S(()=>{const r=l.value;if(r===0)return;const a=t.value,s=a[a.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:s&&s.fixed,width:r}}),o=S(()=>{const r=t.value;if(r.length===0)return r;const a=n.value;return a?[...r,a]:r});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let r=Ae(o);n&&(r=r.map(a=>({fixed:n,...a}))),l.push(...r)}else l.push(t)}),l}function Ct(e){return S(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:r}=n;o==="start"?l=r:o==="end"&&(t||(t=r))}),{lastStartKey:l,firstEndKey:t}})}function wt(e,l){const t=he({}),n=P(),o=P([]);L(n,Te(s=>{o.value=s?s.split("-").map(Number):[]},16)),Ie(()=>{const s=Object.keys(t),c=e.value;if(s.length!==c.length){n.value=void 0;return}n.value=c.map(u=>t[u.key]).join("-")});const r=S(()=>{const s=o.value;if(s.length===0)return s;const c=l.value;return c?[...s,c.width]:s});return{columnWidths:o,columnWidthsWithScrollBar:r,changeColumnWidth:(s,c)=>{c===!1?delete t[s]:t[s]=c}}}function Bt(e,l){const t=S(()=>be(e.value)),n=S(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,r=0;for(let a=0;a<l;a++){t[a]=o,o+=e[a]||0;const s=l-a-1;n[s]=r,r+=e[s]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(a,s,c){var d;(d=t[c])!=null||(t[c]=[]);let u=s;return a.map(v=>{var x;let y=(x=v.titleColSpan)!=null?x:1,h=!1;const g=v.children;if(g!=null&&g.length){h=!0;const k=n(g,u,c+1);Y(v.titleColSpan)&&(y=k.reduce((f,p)=>f+p))}const C=u+y-1;return t[c].push({...v,titleColSpan:y,colStart:u,colEnd:C,hasChildren:h}),u+=y,y})}const o=l?[...e,l]:e;n(o,0,0);const r=t.length;return t.forEach((a,s)=>{a.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-s)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l,t,n,o,r,a){const s=S(()=>{const g=l.value,C=t.value;return e.dataSource.map((x,k)=>Ne(x,C,g,k,e.dataSource.length))}),c=S(()=>{const g=new Map;return ue(s.value,g),g}),u=S(()=>_e(s.value,o.value,r.value)),i=S(()=>Me(u.value,n.value,r.value)),d=S(()=>{const g=a.value,C=i.value;if(g===null||!g.pageSize)return C;{const{total:x}=g;if(x&&C.length<x)return C;const k=g.pageSize,f=(g.pageIndex-1)*k;return C.slice(f,f+k)}}),v=S(()=>{const g=new Map;return ue(d.value,g),g}),y=S(()=>{const g=r.value;return g.length>0?De(d.value,g,0):d.value});return{isTreeData:S(()=>s.value.some(g=>{var C;return(C=g.children)==null?void 0:C.length})),filteredData:u,flattedData:y,mergedMap:c,paginatedMap:v}}function Ne(e,l,t,n,o,r){const a=l(e),s={record:e,rowKey:a,parentKey:r,hasPrevSibling:n>0,hasNextSibling:n<o-1},c=e[t];return c&&(s.children=c.map((u,i)=>Ne(u,l,t,i,c.length,a))),s}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function Me(e,l,t){const n=l.filter(a=>a.sorter),o=n.length;if(o===0)return e;const r=e.slice();return r.forEach(a=>{t.includes(a.rowKey)&&a.children&&a.children.length>0&&(a.children=Me(a.children,l,t))}),r.sort((a,s)=>{for(let c=0;c<o;c++){const{orderBy:u,sorter:i}=n[c],d=i(a.record,s.record);if(d!==0)return u==="ascend"?d:-d}return 0})}function _e(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const r=n.every(({filter:i,filterBy:d})=>i(d,o.record)),{rowKey:a,children:s}=o,c=t.includes(a);let u=o;if(c&&s&&s.length){const i=_e(s,l,t);i.length!==s.length&&(u={...o,children:i})}return r||c&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:r,parentKey:a,record:s,rowKey:c,hasPrevSibling:u,hasNextSibling:i}=o,d=l.includes(c);if(n.push({children:r,parentKey:a,record:s,rowKey:c,level:t,expanded:d,hasPrevSibling:u,hasNextSibling:i}),d&&o.children){const v=De(o.children,l,t+1);n.push(...v)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l){const t=S(()=>l.value.find(s=>"type"in s&&s.type==="expandable")),[n,o]=ke(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:s=>{if(!t.value)return!0;const{disabled:c,customExpand:u}=t.value,{record:i}=s;return c!=null&&c(i)?!0:!(u||s.children&&s.children.length>0)},handleExpandChange:(s,c)=>{const{onChange:u,onExpand:i}=t.value||{},d=[...n.value],v=d.indexOf(s),y=v>=0;y?d.splice(v,1):d.push(s),M(i,!y,c),o(d),M(u,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=S(()=>e.value.filter(r=>r.filterable)),t=he({}),n=P([]);return L(l,(r,a)=>{r.forEach(s=>{const{key:c,filterable:u}=s,i=u.filterBy;if(i||t[c]===void 0){t[c]=i||[];return}const d=a?a.find(y=>y.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=Se(r,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(r,a,s)=>{const{onChange:c}=a;t[r]=s,n.value=Se(l.value,t),M(c,s,n.value)}}}function Se(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:r,filterBy:a=l[n]}=o;return{key:n,filter:r,filterBy:a}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t){var u,i,d,v,y;const n=le("pagination"),o=S(()=>{const{pagination:h}=e;return h===!1?null:h===!0?{}:h}),r=P((i=(u=o.value)==null?void 0:u.pageIndex)!=null?i:1),a=P((y=(v=(d=o.value)==null?void 0:d.pageSize)!=null?v:l.pagination.pageSize)!=null?y:n.pageSize),s=(h,g)=>{var C;r.value=h,a.value=g,M((C=o.value)==null?void 0:C.onChange,h,g)};return{mergedPagination:S(()=>{var g,C;const h=o.value;return h===null?null:{...l.pagination,size:t.value,...h,pageIndex:(g=h.pageIndex)!=null?g:r.value,pageSize:(C=h.pageSize)!=null?C:a.value,onChange:s}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e,l,{setStickyScrollLeft:t}){const n=P(),o=P(),r=P(),a=P(),s=P();L(n,x=>{x&&(r.value=x.holderRef.value)});const{handleScroll:c,pingedStart:u,pingedEnd:i}=Pt(e,o,r,s,t),d=Ot(e,l,r,a),v=S(()=>{var x;return z((x=e.scroll)==null?void 0:x.width)}),y=S(()=>{var k;let x=z((k=e.scroll)==null?void 0:k.height);return!x&&l.value&&(e.virtual||d.value)&&(x="auto"),x}),h=S(()=>ce(X(r))),g=S(()=>y.value?h.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:r,scrollContentRef:a,scrollFootRef:s,handleScroll:c,scrollTo:x=>{var k;e.virtual?(k=n.value)==null||k.scrollTo(x):typeof x=="number"&&Je({target:X(r),top:x,duration:200})},pingedStart:u,pingedEnd:i,scrollWidth:v,scrollHeight:y,scrollBarSize:h,scrollBarSizeOnFixedHolder:g}}function Pt(e,l,t,n,o){const r=P(!1),a=P(!1);let s;const c=()=>{s&&(clearTimeout(s),s=void 0)};J(()=>c());const u=P(),i=h=>{u.value=h,c(),s=setTimeout(()=>{u.value=void 0,s=void 0},100)},d=(h,g)=>{g&&g.scrollLeft!==h&&(g.scrollLeft=h)},v=h=>{const g=X(t);if(!g)return;const{clientWidth:C,scrollWidth:x}=g;o(h/x*C||0)};return{handleScroll:(h,g)=>{const C=h==null?void 0:h.currentTarget,x=g!=null?g:C.scrollLeft,k=u.value;if((!k||k===C)&&(i(C),d(x,l.value),d(x,X(t)),d(x,n.value),v(x)),C){const{scrollWidth:f,clientWidth:p}=C;r.value=x>0,a.value=x<f-p}(h==null?void 0:h.type)==="scroll"&&M(e.onScroll,h)},pingedStart:r,pingedEnd:a}}function Ot(e,l,t,n){const o=P(!0),r=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let a=[];const s=()=>a.forEach(c=>c());return se(()=>{L([l,()=>e.virtual],([c,u])=>{s(),c&&!u&&(a=[ie(t,r),ie(n,r)])},{immediate:!0})}),J(()=>s()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Wt(e,l,t,n,o,r){const a=S(()=>{var i;return(i=e.scrollToTopOnChange)!=null?i:l.scrollToTopOnChange});let s=[];const c=()=>{s=[L([()=>{var i;return(i=t.value)==null?void 0:i.pageIndex},()=>{var i;return(i=t.value)==null?void 0:i.pageSize}],()=>r(0)),L([o,n],([i,d],[v,y])=>{(!Rt(i,v)||!Ft(d,y))&&r(0)})]},u=()=>{s.forEach(i=>i())};L(a,i=>{u(),i&&c()},{immediate:!0})}function Rt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Ft(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e,l,t,{mergedMap:n,paginatedMap:o}){const r=S(()=>t.value.find(f=>"type"in f&&f.type==="selectable")),[a,s]=ke(e,"selectedRowKeys",()=>[]),c=S(()=>{const{disabled:f}=r.value||{},p=[],b=[];return o.value.forEach((w,B)=>{f!=null&&f(w.record)?b.push(B):p.push(B)}),{enabledRowKeys:p,disabledRowKeys:b}}),u=S(()=>{const f=new Set,p=a.value,{disabledRowKeys:b}=c.value,w=n.value;return p.forEach(B=>{const{parentKey:$}=w.get(B)||{};if(!Y($)){let K=w.get($);if(K&&!p.includes(K.rowKey))for(;K&&!Y(K==null?void 0:K.rowKey);)b.includes(K.rowKey)||f.add(K.rowKey),K=Y(K.parentKey)?void 0:w.get(K.parentKey)}}),[...f]}),i=S(()=>{const f=a.value,{disabledRowKeys:p}=c.value;let b=0;return o.value.forEach((w,B)=>{!p.includes(B)&&f.includes(B)&&b++},0),b}),d=S(()=>{const f=o.value.size,p=c.value.disabledRowKeys.length;return f===0||f===p?!1:f===p+i.value}),v=S(()=>!d.value&&i.value>0),y=new Map,h=f=>{s(f);const p=n.value,{onChange:b}=r.value||{};if(b){const w=[];y.forEach((B,$)=>{f.includes($)||y.delete($)}),f.forEach(B=>{let $=p.get(B);$?y.set(B,$):$=y.get(B),$&&w.push($.record)}),M(b,f,w)}},g=(f,p)=>{const b=n.value,{disabledRowKeys:w}=c.value,{multiple:B,onSelect:$}=r.value||{};let K=[...a.value];const O=K.indexOf(f),W=O>=0;if(B){const A=b.get(f),T=ze(A,w);if(W){K.splice(O,1);const E=At(b,A,w);K=K.filter(I=>!E.includes(I)&&!T.includes(I))}else K.push(f),K.push(...T);Nt(b,A,K,w)}else K=W?[]:[f];M($,!W,p),h(K)},C=()=>{const{enabledRowKeys:f}=c.value,p=new Set(a.value);d.value?f.forEach(b=>p.delete(b)):f.forEach(b=>p.add(b)),h([...p])},x=Mt(r,l),k=_t(r,n,o,a,h);return{selectable:r,selectedRowKeys:a,indeterminateRowKeys:u,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:v,handleSelectChange:g,handleHeadSelectChange:C,mergedSelectableMenus:x,handleSelectableMenuClick:k}}function ze(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:r}=o;l.includes(r)||t.push(o.rowKey),t.push(...ze(o,l))}),t}function At(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function Nt(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const r=e.get(l.parentKey);if(r&&!n.includes(l.parentKey)){o=r.children.every(s=>n.includes(s.rowKey)||t.includes(s.rowKey));const a=t.findIndex(s=>s===l.parentKey);o?a<0&&t.push(l.parentKey):a>-1&&t.splice(a,1)}l=r}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Mt(e,l){return S(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:r,selectPageInvert:a}=l.table;return t.map(s=>j(s)?s==="all"?{type:"item",key:Le,label:n}:s==="invert"?{type:"item",key:je,label:o}:s==="none"?{type:"item",key:Ue,label:r}:s==="pageInvert"?{type:"item",key:qe,label:a}:{type:"item",key:s,label:s}:s)})}function _t(e,l,t,n,o){const r=()=>{const{disabled:i,onSelectAll:d}=e.value||{},v=[];l.value.forEach((y,h)=>{i!=null&&i(y.record)||v.push(h)}),M(d,v),o(v)},a=()=>{const{disabled:i,onSelectInvert:d}=e.value||{},v=[...n.value];l.value.forEach((y,h)=>{if(i!=null&&i(y.record))return;const g=v.indexOf(h);g>=0?v.splice(g,1):v.push(h)}),o(v),M(d,v)},s=()=>{const{onSelectNone:i}=e.value||{};M(i),o([])},c=()=>{const{disabled:i,onSelectPageInvert:d}=e.value||{},v=[],y=n.value;t.value.forEach((h,g)=>{i!=null&&i(h.record)||y.includes(g)||v.push(g)}),M(d,v),o(v)},u=new Map([[Le,r],[je,a],[Ue,s],[qe,c]]);return i=>{const d=i.key;if(ft(d)&&u.has(d)){u.get(d)();return}const{disabled:v,onMenuClick:y}=e.value||{};if(!y)return;const h=[];t.value.forEach((g,C)=>{v!=null&&v(g.record)||h.push(C)}),M(y,i,h)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=S(()=>e.value.filter(a=>a.sortable)),t=S(()=>l.value.some(a=>a.sortable.multiple!==void 0)),n=he({}),o=P([]);return L(l,(a,s)=>{a.forEach(c=>{const{key:u,sortable:i}=c,d=i.orderBy;if(d||n[u]===void 0){n[u]=d;return}const v=s?s.find(h=>h.key===u):void 0;(v==null?void 0:v.sortable.orderBy)&&(n[u]=void 0)}),o.value=Ce(a,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(a,s)=>{const{orders:c,onChange:u}=s,i=n[a],d=i?xe(c,i):xe(c);t.value?n[a]=d:Object.keys(n).forEach(v=>{a===v?n[v]=d:n[v]=void 0}),o.value=Ce(l.value,n),M(u,d,o.value)}}}function xe(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:r=0,orderBy:a=l[n],sorter:s}=o;return{key:n,multiple:r,orderBy:a,sorter:s}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=S(()=>!!e.sticky),t=S(()=>{const{sticky:r}=e,{offsetTop:a=0,offsetBottom:s=0,offsetScroll:c=0,container:u=window}=vt(r)?r:{};return{offsetTop:a,offsetBottom:s,offsetScroll:c,container:u}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Lt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},r,a){return S(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||a.value||r.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const N=Symbol("TABLE_TOKEN"),ge=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:r}=F(N);return()=>{const{isFixedHolder:a}=e,s=a?t.value:l.value;if(s.every(i=>!i.width&&!i.type))return;const c=r.value,u=s.map((i,d)=>{const{key:v,type:y}=i,h=a?n.value[d]:i.width,g=y?V({[`${c}-col-${y}`]:!0,[`${c}-col-with-dropdown`]:y==="selectable"&&o.value.length>0}):void 0;let C;return a?C=h?`width: ${z(h)}`:void 0:C={width:z(h),minWidth:z(i.minWidth),maxWidth:z(i.maxWidth)},m("col",{key:v,class:g,style:C},null)});return m("colgroup",null,[u])}}}),jt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:r,flattedData:a,isSticky:s,columnWidths:c}=F(N);Ut(n,o);const u=S(()=>r.value==="max-content"),i=S(()=>a.value.length>0),d=S(()=>{const h=t.value;return{[`${h}-fixed-holder`]:!0,[`${h}-sticky-holder`]:s.value}}),v=S(()=>{const h=s.value,{offsetTop:g,offsetBottom:C}=e;return{overflow:"hidden",top:h?z(g):void 0,bottom:h?z(C):void 0}}),y=S(()=>({tableLayout:"fixed",visibility:i.value&&!c.value.length?"hidden":void 0}));return()=>m("div",{class:d.value,style:v.value,ref:n},[m("table",{style:y.value},[(i.value||!u.value)&&m(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function Ut(e,l){const t=n=>{const o=n.deltaX,r=n.currentTarget;if(o){const a=r.scrollLeft+o;l(n,a),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),J(()=>G(e.value,"wheel",t))}const qt=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:r}=F(N),a=P(!1),s=P(!1),c=P(0),u=P(0),i=P(0),d=S(()=>{const f=u.value,p=i.value;return p&&f*(f/p)});Ie(()=>{const f=X(l);if(f&&a.value){const{clientWidth:p,scrollWidth:b,scrollLeft:w}=f;r(w/b*p),u.value=p,i.value=b}});const v=S(()=>({height:ce(),width:u.value,bottom:n.value.offsetScroll})),y=S(()=>{const f=e.value;return{[`${f}-sticky-scrollbar-thumb`]:!0,[`${f}-sticky-scrollbar-thumb-active`]:s.value}}),h=S(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),g=()=>s.value=!1,C=f=>{c.value=f.pageX-o.value,s.value=!0,f.preventDefault()},x=f=>{if(!s.value)return;const{buttons:p}=f||window.event;if(p===0){s.value=!1;return}let b=f.pageX-c.value;b<=0&&(b=0);const w=u.value,B=i.value,$=d.value;b+$>=w&&(b=w-$);const K=b/w*(B+2);t(f,K)},k=()=>{const f=X(l),p=pe(f).top,b=p+f.offsetHeight,{container:w,offsetScroll:B}=n.value,$=w===window?document.documentElement.scrollTop+window.innerHeight:pe(w).top+w.clientHeight;b-ce()<=$||p>=$-B?a.value=!1:a.value=!0};return se(()=>{ee(document.body,"mouseup",g),ee(document.body,"mousemove",x),ee(window,"resize",k),L(()=>n.value.container,(f,p)=>{G(p,"scroll",k),ee(f,"scroll",k)},{immediate:!0}),k()}),J(()=>{G(document.body,"mouseup",g),G(document.body,"mousemove",x),G(window,"resize",k),G(n.value.container,"scroll",k)}),()=>!l.value||!a.value||i.value<=u.value||!d.value?null:m("div",{class:`${e.value}-sticky-scrollbar`,style:v.value},[m("div",{class:y.value,style:h.value,onMousedown:C},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:r,scrollBarColumn:a}=F(N),{mainTableWidth:s}=F(ge),c=S(()=>n.value.length);return()=>{let u=l.default();if(e.isEmpty?r.value:o.value){const i=a.value;u=m("div",{class:`${t.value}-fixed-row`,style:{width:z(s.value-(i?i.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return m("tr",null,[m("td",{colSpan:c.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Xt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Vt={columns:{type:Array,required:!0}},Gt={column:{type:Object,required:!0}},Yt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Qt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Zt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},el={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},tl=H({props:Jt,setup(e){const l=P();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),J(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>m("td",{ref:l,style:{padding:0,border:0,height:0}},[m("div",{style:{height:0,overflow:"hidden"}},[ht(" ")])])}}),ll=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(N),{changeColumnWidth:t}=F(ge);return()=>{const n=l.value.map(o=>{const{key:r}=o;return m(tl,{key:r,cellKey:r,changeColumnWidth:t},null)});return m("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),nl=H({props:Qt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:r,activeOrderByMap:a,fixedColumnKeys:s,columnOffsets:c,isSticky:u,isTreeData:i,expandable:d,selectable:v,mergedPagination:y}=F(N),h=S(()=>a[e.column.key]),g=ol(e),C=S(()=>s.value.lastStartKey===e.column.key),x=S(()=>s.value.firstEndKey===e.column.key),k=S(()=>{const{type:b,ellipsis:w}=e.column;return b||w!=null?w:l.ellipsis}),f=S(()=>{const{fixed:b,align:w}=e.column,B=o.value;let $={[`${B}-cell`]:!0,[`${B}-cell-sorted`]:!!h.value,[`${B}-cell-align-${w}`]:!!w&&w!="start",[`${B}-cell-ellipsis`]:!!k.value};return b&&($={...$,[`${B}-fix-start`]:b==="start",[`${B}-fix-start-last`]:C.value,[`${B}-fix-end`]:b==="end",[`${B}-fix-end-first`]:x.value,[`${B}-fix-sticky`]:u.value}),V($)}),p=S(()=>{const{fixed:b}=e.column;if(!b)return;const{starts:w,ends:B}=c.value,K=z((b==="start"?w:B)[e.colIndex]);return{position:"sticky",left:b==="start"?K:void 0,right:b==="end"?K:void 0}});return()=>{var T,E,I;const{column:b}=e,{type:w}=b;let B,$;if(w==="selectable")B=rl(e,t,v,n,y);else if(w==="indexable")B=Xe(e,t,b,y);else{const R=g.value;if(B=sl(e,t,R),$=Re(k.value,B,R),!w&&(Y(B)||B==="")){const _=t.emptyCell||r.value;B=Q(_)?_({column:b,record:e.record,rowIndex:e.rowIndex}):_}}e.column.fixed&&k.value&&(C.value||x.value)&&(B=m("span",{class:`${o.value}-cell-content`},[B]));const K=(T=l.customAdditional)==null?void 0:T.bodyCell,O=K?K({column:b,record:e.record,rowIndex:e.rowIndex}):void 0,W=(I=(E=l.customTag)==null?void 0:E.bodyCell)!=null?I:"td",A=w==="expandable"?m("div",{class:`${o.value}-expandable-wrapper`},[al(e,t,d,i,o.value),!Ze(B)&&m("span",{class:`${o.value}-expandable-trigger-gap`},null),B]):B;return m(W,Z({class:f.value,style:p.value,title:$},O),{default:()=>[A]})}}});function ol(e){return S(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let r=0;r<n.length&&o;r++){const a=n[r];o=o[a]}return o})}function sl(e,l,t){const{record:n,rowIndex:o,column:r}=e,{customCell:a}=r,s=j(a)?l[a]:a;return s?s({value:t,record:n,rowIndex:o}):t}function al(e,l,t,n,o){var b;const{icon:r,customIcon:a,indent:s,showLine:c}=t.value,{record:u,expanded:i,level:d=0,hasPrevSibling:v,hasNextSibling:y}=e,h=d>0,g=n.value&&c&&s;let C;const x=(b=j(a)?l[a]:a)!=null?b:r;Q(x)?C=x({expanded:!!i,record:u}):C=j(x)?m(te,{name:x,rotate:i?90:0},null):x;const k=s?`width: ${z(s)}`:void 0,f={[`${o}-expandable-trigger`]:!0,[`${o}-expandable-trigger-show-line`]:g,[`${o}-expandable-trigger-disabled`]:e.disabled},p=[];if(g)for(let w=0;w<d;w++)p.push(m("div",{class:`${o}-expandable-indent`,style:k},null));return[...p,m("span",{class:f,style:k},[m("button",{class:`${o}-expandable-trigger-button`,type:"button",onClick:e.disabled?void 0:e.handleExpend},[C]),g&&[m("span",{class:`${o}-expandable-trigger-line-right`},null),(v||h)&&m("span",{class:`${o}-expandable-trigger-line-top`},null),y&&m("span",{class:`${o}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function rl(e,l,t,n,o){const{record:r,rowIndex:a,selected:s,indeterminate:c,disabled:u,isHover:i,handleSelect:d}=e,{showIndex:v,multiple:y,customCell:h}=t.value,g=x=>{x.stopPropagation(),!y&&s&&!u&&d&&d()};if(!s&&!i&&v)return Xe(e,l,n.columnIndexable,o);const C=j(h)?l[h]:h;if(y){const x={checked:s,disabled:u,indeterminate:c,onChange:d,onClick:g};return C?C({...x,record:r,rowIndex:a}):m(ve,x,null)}else{const x={checked:s,disabled:u,onChange:d,onClick:g};return C?C({...x,record:r,rowIndex:a}):m(Oe,x,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:r,disabled:a}=e,{customCell:s}=t,{pageIndex:c=1,pageSize:u=0}=n.value||{},i=j(s)?l[s]:s;return i?m("span",{style:a?"cursor: not-allowed":"cursor: pointer"},[i({record:o,rowIndex:r,pageIndex:c,pageSize:u})]):void 0}const cl=H({props:Yt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:r,checkExpandDisabled:a,selectable:s,selectedRowKeys:c,indeterminateRowKeys:u,handleSelectChange:i,currentPageRowKeys:d}=F(N),{expandDisabled:v,handleExpend:y,selectDisabled:h,handleSelect:g,isHover:C,attrs:x}=il(e,o,a,r,s,i,d),k=S(()=>c.value.includes(e.rowKey)),f=S(()=>u.value.includes(e.rowKey)),p=S(()=>{const b=`${t.value}-row`,{level:w,expanded:B}=e;return V({[`${b}`]:!0,[`${b}-level-${w}`]:!!w,[`${b}-selected`]:k.value,[`${b}-expanded`]:B})});return()=>{var $,K,O;const b=($=l.customAdditional)==null?void 0:$.bodyRow,w=b?b({record:e.record,rowIndex:e.rowIndex}):void 0,B=(O=(K=l.customTag)==null?void 0:K.bodyRow)!=null?O:"tr";return m(B,Z({class:p.value},x.value,w),{default:()=>[ul(e,n,v,y,k,f,h,g,C)]})}}});function il(e,l,t,n,o,r,a){const s=S(()=>t(e.rowData)),c=S(()=>{var p;return(p=l.value)==null?void 0:p.trigger}),u=()=>{const{rowKey:p,record:b}=e;n(p,b)},i=S(()=>a.value.disabledRowKeys.includes(e.rowKey)),d=S(()=>{var p;return(p=o.value)==null?void 0:p.trigger}),v=S(()=>{var p;return(p=o.value)==null?void 0:p.showIndex}),y=P(!1),h=()=>{const{rowKey:p,record:b}=e;r(p,b)},g=()=>{c.value==="click"&&u(),d.value==="click"&&h()},C=()=>{c.value==="dblclick"&&u(),d.value==="dblclick"&&h()},x=()=>y.value=!0,k=()=>y.value=!1,f=S(()=>{const p=s.value,b=c.value,w=i.value,B=d.value,$=!p&&b==="click"||!w&&B==="click",K=!p&&b==="dblclick"||!w&&B==="dblclick",O=!w&&v.value;let W="";return $||K?W="pointer":(p&&b||w&&B)&&(W="not-allowed"),{style:W?`cursor: ${W}`:void 0,onClick:$?g:void 0,onDblclick:K?C:void 0,onMouseenter:O?x:void 0,onMouseleave:O?k:void 0}});return{expandDisabled:s,handleExpend:u,selectDisabled:i,handleSelect:h,isHover:y,attrs:f}}function ul(e,l,t,n,o,r,a,s,c){const u=[],{rowIndex:i,record:d,level:v,hasNextSibling:y,hasPrevSibling:h}=e;return l.value.forEach((g,C)=>{const{type:x,colSpan:k,rowSpan:f,key:p}=g,b=k==null?void 0:k(d,i),w=f==null?void 0:f(d,i);if(b===0||w===0)return;const B={colSpan:b===1?void 0:b,rowSpan:w===1?void 0:w,rowIndex:i,colIndex:C,record:d,column:g,level:v,hasNextSibling:y,hasPrevSibling:h,key:p};x==="expandable"?(B.expanded=e.expanded,B.disabled=t.value,B.handleExpend=n):x==="selectable"&&(B.selected=o.value,B.indeterminate=r.value,B.disabled=a.value,B.handleSelect=s,B.isHover=c.value),u.push(m(nl,B,null))}),u}function Ve(e,l,t,n,o){const{children:r,expanded:a,level:s,hasPrevSibling:c,hasNextSibling:u,record:i,rowKey:d}=e,v={key:d,expanded:a,level:s,hasPrevSibling:c,hasNextSibling:u,hasChildren:!!(r!=null&&r.length),record:i,rowData:e,rowIndex:l,rowKey:d},y=m(cl,v,null),h=a&&dl(v,t,n,o);return h?[y,h]:y}function dl(e,l,t,n){const{customExpand:o}=t||{},{record:r,rowIndex:a}=e;let s;return Q(o)?s=o({record:r,rowIndex:a}):j(o)&&l[o]&&(s=l[o]({record:r,rowIndex:a})),s&&m(de,{class:`${n}-expanded-row`},{default:()=>[s]})}const re=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:r,flattedData:a,expandable:s,scrollWidth:c,scrollHeight:u,isSticky:i}=F(N),d=S(()=>r.value||c.value||u.value||i.value);return()=>{const v=o.value,y=[];n.alert&&y.push(m(de,{class:`${v}-alert-row`},{default:()=>[n.alert()]}));const h=a.value;return h.length>0?l.default?y.push(...l.default()):h.forEach((g,C)=>{y.push(...fe(Ve(g,C,n,s.value,v)))}):y.push(m(de,{class:`${v}-empty-row`,isEmpty:!0},{default:()=>[m(et,{empty:t.empty},n)]})),m("tbody",{class:`${o.value}-tbody`},[d.value&&m(ll,null,null),y])}}}),fl=H({props:Zt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(N),r=S(()=>{var f;return(f=e.filterable.multiple)!=null?f:t.columnBase.filterable.multiple}),a=S(()=>{var f;return(f=e.filterable.footer)!=null?f:t.columnBase.filterable.footer}),s=e.activeFilterBy,[c,u]=oe(()=>s);L(()=>e.activeFilterBy,f=>u(f));const[i,d]=oe(!1),v=f=>{d(f),f||e.onUpdateFilterBy(c.value)},y=()=>{d(!1),e.onUpdateFilterBy(c.value)},h=()=>{u(s)},g=f=>{const p=`${o.value}-filterable-menu-label`,b=r.value?ve:Oe;return m("span",{class:p},[m(b,{checked:f.selected,disabled:f.disabled},null),m("span",{class:`${p}-content`},[f.label])])},C=()=>{const f=[],{customMenu:p,menus:b}=e.filterable;return Q(p)?f.push(p({selectedKeys:c.value,setSelectedKeys:u})):j(p)&&l[p]?f.push(l[p]({selectedKeys:c.value,setSelectedKeys:u})):f.push(vl(b,r,c,u,g)),a.value&&f.push(hl(n,o,y,h)),f},x=S(()=>{const f=`${o.value}-filterable-trigger`;return V({[f]:!0,[`${f}-active`]:e.activeFilterBy.length>0})}),k=()=>{const{customTrigger:f}=e.filterable;return Q(f)?f():j(f)&&l[f]?l[f]():m("span",{class:x.value,onClick:p=>p.stopPropagation()},[m(te,{name:"filter-filled"},null)])};return()=>{const f={visible:i.value,hideOnClick:!a.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":v};return m(Ke,f,{default:k,overlay:C})}}}),vl=(e,l,t,n,o)=>{const r={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return m($e,r,{itemLabel:o})},hl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:r}=e.table;return m("div",{class:`${l.value}-filterable-trigger-footer`},[m(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),m(me,{size:"xs",onClick:n},{default:()=>[r]})])},yl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:r,handleHeadSelectChange:a,mergedSelectableMenus:s,handleSelectableMenuClick:c}=F(N),u=S(()=>{const C=l.value.size;return C===0||C===n.value.disabledRowKeys.length}),[i,d]=oe(!1),v={"onUpdate:visible":d,trigger:"click"},y=()=>m($e,{dataSource:s.value,onClick:c},null),h=()=>m(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:i.value?180:0},null),g=()=>{if(s.value.length!==0)return m(Ke,v,{default:h,overlay:y})};return()=>{const{multiple:C}=t.value;if(C)return m("span",{class:`${e.value}-cell-triggers`},[m(ve,{checked:o.value,indeterminate:r.value,disabled:u.value,onChange:a},null),g()])}}}),gl=H({props:el,setup(e){const{locale:l,mergedPrefixCls:t}=F(N);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:r,nextTooltip:a}=o,s=a&&pl(l.table,r,n),c=ml(t,r,n);return s?m(tt,{title:s},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:r,sortDesc:a}=e;return n?n==="ascend"?r:a:o}function ml(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,r=l.includes("ascend")&&m(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),a=l.includes("descend")&&m(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return m("span",{class:`${n}-sortable-trigger`},[r,a])}const bl=H({props:Gt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:r,isSticky:a,handleSort:s,activeOrderByMap:c,activeFilterByMap:u,handleFilter:i}=F(N),d=S(()=>{const{type:k,ellipsis:f}=e.column,p=k||f!=null?f:l.ellipsis;return Ee(p)&&p.head===!1?void 0:p}),v=S(()=>{const{type:k,align:f,fixed:p,hasChildren:b,key:w,sortable:B,filterable:$}=e.column,K=n.value;let O={[`${K}-cell`]:!0,[`${K}-cell-${k}`]:!!k,[`${K}-cell-filterable`]:!!$,[`${K}-cell-sortable`]:!!B,[`${K}-cell-align-center`]:b||f==="center",[`${K}-cell-align-end`]:!b&&f==="end",[`${K}-cell-ellipsis`]:!!d.value};if(p){const{lastStartKey:W,firstEndKey:A}=o.value;O={...O,[`${K}-fix-start`]:p==="start",[`${K}-fix-start-last`]:W===w,[`${K}-fix-end`]:p==="end",[`${K}-fix-end-first`]:A===w,[`${K}-fix-sticky`]:a.value}}return V(O)}),y=S(()=>{const{fixed:k,colStart:f,colEnd:p}=e.column;if(!k)return;const{starts:b,ends:w}=r.value,K=z((k==="start"?b:w)[k==="start"?f:p]);return{position:"sticky",left:k==="start"?K:void 0,right:k==="end"?K:void 0}}),h=S(()=>c[e.column.key]),g=S(()=>u[e.column.key]||lt),C=k=>{const{key:f,filterable:p}=e.column;i(f,p,k)},x=()=>{const{key:k,sortable:f}=e.column;f&&s(k,f)};return()=>{var A,T,E;const{column:k}=e,{type:f,titleColSpan:p,titleRowSpan:b}=k;if(f==="scroll-bar")return m("th",{class:v.value,style:y.value,colspan:p===1?void 0:p,rowspan:b===1?void 0:b,onClick:x},null);const w=n.value;let B,$;if(f==="selectable")$=m(yl,null,null);else{const{title:I,customTitle:R,sortable:_,filterable:q}=k,U=d.value;$=Sl(I,R,t),B=Re(U,$,I);const D=xl(_,h,q,g,C);D.length>0?$=m("span",{class:`${w}-cell-triggers`},[m("span",{class:`${w}-cell-title`},[$]),D]):U&&($=m("span",{class:`${w}-cell-title`},[$]))}const K=(A=l.customAdditional)==null?void 0:A.headCell,O=K?K({column:k}):void 0,W=(E=(T=l.customTag)==null?void 0:T.headCell)!=null?E:"th";return m(W,Z({class:v.value,style:y.value,colSpan:p===1?void 0:p,rowSpan:b===1?void 0:b,title:B},O,{onClick:x}),{default:()=>[$]})}}});function Sl(e,l,t){let n=e;return Q(l)?n=l({title:e}):j(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const r=[];return e&&r.push(m(gl,{activeOrderBy:l.value,sortable:e},null)),t&&r.push(m(fl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),r}const Cl=H({props:Vt,setup(e){const{props:l,mergedPrefixCls:t}=F(N);return()=>{var s,c,u;const{columns:n}=e,o=(s=l.customAdditional)==null?void 0:s.headRow,r=o?o({columns:n}):void 0,a=(u=(c=l.customTag)==null?void 0:c.headRow)!=null?u:"tr";return m(a,Z({class:`${t.value}-row`},r),{default:()=>[n.filter(i=>i.titleColSpan!==0).map(i=>m(bl,{key:i.key,column:i},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(N);return()=>{var s,c,u;const n=l.value,o=(s=e.customAdditional)==null?void 0:s.head,r=o?o({rows:n}):void 0,a=(u=(c=e.customTag)==null?void 0:c.head)!=null?u:"thead";return m(a,Z({class:`${t.value}-thead`},r),{default:()=>[n.map((i,d)=>m(Cl,{key:d,columns:i},null))]})}}}),wl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:r,columnWidths:a,changeColumnWidth:s,flattedData:c,isSticky:u,mergedSticky:i,virtualScrollRef:d,scrollBodyRef:v,scrollContentRef:y,handleScroll:h,pingedStart:g,pingedEnd:C,scrollWidth:x,scrollHeight:k,hasFixed:f,tableLayout:p}=F(N),b=P(),w=P(0);Pe(ge,{mainTableWidth:w,changeColumnWidth:(E,I)=>{at(b.value)&&s(E,I)}});const $=()=>{const E=X(v);E&&h({currentTarget:E})},K=E=>{const{offsetWidth:I}=E.target;I!==w.value&&(w.value=I)};se(()=>{$(),L([()=>e.dataSource,x],([,I])=>{I&&$()}),L(a,Te(()=>{var R;((R=X(v))==null?void 0:R.scrollLeft)===0&&$()},16)),nt(b.value,K)}),J(()=>ot(b.value,K));const O=S(()=>{const E=n.value;return V({[`${E}-container`]:!0,[`${E}-ping-start`]:g.value,[`${E}-ping-end`]:C.value,[`${E}-fixed-layout`]:p.value==="fixed",[`${E}-fixed-column`]:f.value,[`${E}-scroll-horizontal`]:x.value,[`${E}-scroll-vertical`]:k.value})}),W=S(()=>{var U;const E=x.value,I=k.value,R=E?"auto":void 0,_=e.virtual?"hidden":I?"scroll":E?"hidden":void 0,q=(U=e.scroll)==null?void 0:U.fullHeight;return{overflowX:R,overflowY:_,[q?"height":"maxHeight"]:I}}),A=S(()=>({tableLayout:p.value,width:x.value,minWidth:x.value?"100%":void 0})),T=(E,I,R)=>{M(e.onScrolledChange,E,I,R.map(_=>_.record))};return()=>{const E=n.value,I=r.value,R=l.default?l.default():[];if(I||k.value||u.value){const{offsetTop:_}=i.value;if(e.headless||R.push(m(jt,{offsetTop:_},{default:()=>[m(we,null,null)]})),e.virtual&&(e.scroll||I)){const q=({item:ae,index:Ye})=>Ve(ae,Ye,l,t.value,E),U=ae=>m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),m(re,null,{default:()=>[ae]}),!1]),{scroll:D,onScrolledBottom:Ge}=e;R.push(m(st,{ref:d,style:W.value,dataSource:c.value,fullHeight:D==null?void 0:D.fullHeight,getKey:"rowKey",height:r.value?"100%":D==null?void 0:D.height,itemHeight:o.value,itemRender:q,contentRender:U,virtual:!0,onScroll:h,onScrolledBottom:Ge,onScrolledChange:T},null))}else R.push(m("div",{ref:v,class:`${E}-content`,style:W.value,onScroll:h},[m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),m(re,null,null),!1])]));u.value&&R.push(m(qt,null,null))}else R.push(m("div",{ref:v,class:`${E}-content`,style:W.value,onScroll:h},[m("table",{ref:y,class:`${E}-table`,style:A.value},[m(ne,null,null),!e.headless&&m(we,null,null),m(re,null,null),!1])]));return m("div",{ref:b,class:O.value},[R])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bl(e,l){return e.footer?m("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t,n){var a,s;let o=null,r=null;if(l!==null){const{position:c}=l,[u,i]=yt(c).split("-"),d=`${n}-pagination ${n}-pagination-${i}`,v=(s=(a=e.pagination)==null?void 0:a.call(e,{total:t.length,...l}))!=null?s:m(pt,Z({class:d,total:t.length},l),null);o=u==="top"?v:null,r=u==="bottom"?v:null}return[o,r]}const Kl={sm:32,md:40,lg:56},$l={sm:40,md:48,lg:56},El=H({name:"IxTable",props:Xt,setup(e,{expose:l,slots:t}){const n=le("common"),o=S(()=>`${n.prefixCls}-table`),r=le("locale"),a=le("table"),s=S(()=>{var T;return(T=e.autoHeight)!=null?T:a.autoHeight}),c=S(()=>{var T;return(T=e.childrenKey)!=null?T:a.childrenKey}),u=rt(e,a),i=S(()=>{var T;return(T=e.emptyCell)!=null?T:a.emptyCell}),d=S(()=>{var T;return(T=e.size)!=null?T:a.size}),v=S(()=>{var T;return(T=e.virtualItemHeight)!=null?T:n.theme==="seer"?Kl[d.value]:$l[d.value]}),{mergedPagination:y}=Tt(e,a,d),h=zt(e),g=It(e,s,h),C=bt(e,t,a,g.scrollBarSizeOnFixedHolder),x=Dt(C.flattedColumns),k=Et(C.flattedColumns),f=$t(e,C.flattedColumns),p=Lt(e,C,g,h.isSticky,s),{activeSorters:b}=x,{activeFilters:w}=k,B=Kt(e,c,u,b,w,f.expandedRowKeys,y),$=Ht(e,r,C.flattedColumns,B);Wt(e,a,y,b,w,g.scrollTo);const K={props:e,slots:t,config:a,locale:r,mergedPrefixCls:o,mergedEmptyCell:i,mergedVirtualItemHeight:v,mergedAutoHeight:s,...C,...g,...x,...k,...h,tableLayout:p,mergedPagination:y,...f,...B,...$};Pe(N,K),l({scrollTo:g.scrollTo});const{flattedData:O,filteredData:W}=B,A=S(()=>{const T=o.value,{borderless:E=a.borderless,scroll:I}=e;return V({[T]:!0,[`${T}-auto-height`]:s.value,[`${T}-borderless`]:E,[`${T}-empty`]:O.value.length===0,[`${T}-full-height`]:I==null?void 0:I.fullHeight,[`${T}-${d.value}`]:!0})});return()=>{const T=o.value,E=m(ct,{header:e.header},t),I=Bl(t,T),[R,_]=kl(t,y.value,W.value,T),q=[E],U=[R,m(wl,null,null),I,_].filter(Boolean),D=Tl(e.spin);return D?q.push(m(it,D,{default:()=>[U]})):q.push(...U),m("div",{class:A.value},[q])}}});function Tl(e){return gt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=El,Fl=ye;export{Rl as I,Fl as a,mt as g,Xt as t};
