import{M as ke,N as fe,aI as Je,al as Be,m as _,L as le,aJ as z,aK as ce,o as X,D as ie,U as Qe,K as oe,R as ee,S as G,a3 as ge,A as te,k as ve,aq as Ze,a0 as Ke,$ as Ee,c as me,aa as et,ao as tt,E as lt,G as nt,H as ot,aL as st,ar as rt,an as at,ay as ct}from"./index-d79199e1.js";import{j as $e,l as N,L as it,T as ut,f as m,r as he,b as I,w as D,a7 as Te,P as Ie,k as Y,N as Q,x as se,bi as dt,Q as ft,v as H,z as V,y as b,i as F,ad as vt,a as J,a2 as Z,p as Re,Z as ht,av as yt}from"./vendor-50817465.js";import{b as Oe}from"./GlobalCodeBox-b1a70fd7.js";import{I as pt}from"./index-8f1315b4.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pe=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Pe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function We(e,l,t){if(!e||$e(e)&&e.title===!1)return;if(N(l)||it(l))return l;const n=ke(l).find(o=>o.type===ut);return n?n.children:t}function gt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Je("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function mt(e,l,t,n){const o=m(()=>{var g;const{columns:S}=e;return Fe(S&&S.length>0?S:He((g=l.default)==null?void 0:g.call(l)),t)}),{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r}=xt(o,n),c=St(r),i=m(()=>!!e.ellipsis||a.value.some(S=>S.ellipsis)),u=m(()=>a.value.some(S=>S.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:x}=Ct(a,s),{columnOffsets:f,columnOffsetsWithScrollBar:C}=wt(d,h),w=m(()=>kt(o.value,s.value));return{flattedColumns:a,scrollBarColumn:s,flattedColumnsWithScrollBar:r,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:x,columnOffsets:f,columnOffsetsWithScrollBar:C,mergedRows:w}}function Fe(e,l){return e.map(t=>bt(t,l))}function He(e){const l=[];return ke(e,{key:Pe}).forEach((t,n)=>{const{props:o,children:a}=t,{key:s=n,editable:r,ellipsis:c,...i}=o||{};i.key=s,i.editable=r||r==="",i.ellipsis=c||c==="";const{default:u,cell:d,title:h,expand:x,icon:f}=a||{};u&&(i.children=He(u())),d&&(i.customCell=d),h&&(i.customTitle=h),x&&(i.customExpand=x),f&&(i.customIcon=f),l.push(i)}),l}function bt(e,l){const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:a}=l,{align:s=t.align}=e,r=gt(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{icon:i=n.icon}=e;return{...e,key:r,align:s,icon:i}}if(c==="selectable"){const{multiple:i=!0,showIndex:u=o.showIndex}=e;return{...e,key:r,align:s,multiple:i,showIndex:u}}if(c==="indexable"){const i=e.align??a.align??t.align;return{...a,...e,align:i,key:r}}return{...e,key:r,align:s}}else{const{sortable:c,filterable:i,children:u}=e,d={...e,key:r,align:s};return c&&(d.sortable={...t.sortable,...c}),i&&(d.filterable={...t.filterable,...i}),u!=null&&u.length&&(d.children=Fe(u,l)),d}}function xt(e,l){const t=m(()=>Ae(e.value)),n=m(()=>{const a=l.value;if(a===0)return;const s=t.value,r=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:r&&r.fixed,width:a}}),o=m(()=>{const a=t.value;if(a.length===0)return a;const s=n.value;return s?[...a,s]:a});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let a=Ae(o);n&&(a=a.map(s=>({fixed:n,...s}))),l.push(...a)}else l.push(t)}),l}function St(e){return m(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:a}=n;o==="start"?l=a:o==="end"&&(t||(t=a))}),{lastStartKey:l,firstEndKey:t}})}function Ct(e,l){const t=he({}),n=I(),o=I([]);D(n,Te(r=>{o.value=r?r.split("-").map(Number):[]},16)),Ie(()=>{const r=Object.keys(t),c=e.value;if(r.length!==c.length){n.value=void 0;return}n.value=c.map(i=>t[i.key]).join("-")});const a=m(()=>{const r=o.value;if(r.length===0)return r;const c=l.value;return c?[...r,c.width]:r});return{columnWidths:o,columnWidthsWithScrollBar:a,changeColumnWidth:(r,c)=>{c===!1?delete t[r]:t[r]=c}}}function wt(e,l){const t=m(()=>be(e.value)),n=m(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,a=0;for(let s=0;s<l;s++){t[s]=o,o+=e[s]||0;const r=l-s-1;n[r]=a,a+=e[r]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(s,r,c){t[c]??(t[c]=[]);let i=r;return s.map(d=>{let h=d.titleColSpan??1,x=!1;const f=d.children;if(f!=null&&f.length){x=!0;const w=n(f,i,c+1);Y(d.titleColSpan)&&(h=w.reduce((S,g)=>S+g))}const C=i+h-1;return t[c].push({...d,titleColSpan:h,colStart:i,colEnd:C,hasChildren:x}),i+=h,h})}const o=l?[...e,l]:e;n(o,0,0);const a=t.length;return t.forEach((s,r)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=a-r)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,l,t,n,o,a,s){const r=m(()=>{const f=l.value,C=t.value;return e.dataSource.map(w=>Me(w,C,f))}),c=m(()=>{const f=new Map;return ue(r.value,f),f}),i=m(()=>ze(r.value,o.value,a.value)),u=m(()=>_e(i.value,n.value,a.value)),d=m(()=>{const f=s.value,C=u.value;if(f===null||!f.pageSize)return C;{const{total:w}=f;if(w&&C.length<w)return C;const S=f.pageSize,g=(f.pageIndex-1)*S;return C.slice(g,g+S)}}),h=m(()=>{const f=new Map;return ue(d.value,f),f}),x=m(()=>{const f=a.value;return f.length>0?De(d.value,f,0):d.value});return{filteredData:i,flattedData:x,mergedMap:c,paginatedMap:h}}function Me(e,l,t,n){const o=l(e),a={record:e,rowKey:o,parentKey:n},s=e[t];return s&&(a.children=s.map(r=>Me(r,l,t,o))),a}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function _e(e,l,t){const n=l.filter(s=>s.sorter),o=n.length;if(o===0)return e;const a=e.slice();return a.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=_e(s.children,l,t))}),a.sort((s,r)=>{for(let c=0;c<o;c++){const{orderBy:i,sorter:u}=n[c],d=u(s.record,r.record);if(d!==0)return i==="ascend"?d:-d}return 0})}function ze(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const a=n.every(({filter:u,filterBy:d})=>u(d,o.record)),{rowKey:s,children:r}=o,c=t.includes(s);let i=o;if(c&&r&&r.length){const u=ze(r,l,t);u.length!==r.length&&(i={...o,children:u})}return a||c&&i.children&&i.children.length?i:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:a,parentKey:s,record:r,rowKey:c}=o,i=l.includes(c);if(n.push({children:a,parentKey:s,record:r,rowKey:c,level:t,expanded:i}),i&&o.children){const u=De(o.children,l,t+1);n.push(...u)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l){const t=m(()=>l.value.find(r=>"type"in r&&r.type==="expandable")),[n,o]=Be(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:r=>{if(!t.value)return!0;const{disabled:c,customExpand:i}=t.value,{record:u}=r;return c!=null&&c(u)?!0:!(i||r.children&&r.children.length>0)},handleExpandChange:(r,c)=>{const{onChange:i,onExpand:u}=t.value||{},d=[...n.value],h=d.indexOf(r),x=h>=0;x?d.splice(h,1):d.push(r),_(u,!x,c),o(d),_(i,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=m(()=>e.value.filter(a=>a.filterable)),t=he({}),n=I([]);return D(l,(a,s)=>{a.forEach(r=>{const{key:c,filterable:i}=r,u=i.filterBy;if(u||t[c]===void 0){t[c]=u||[];return}const d=s?s.find(x=>x.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=xe(a,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(a,s,r)=>{const{onChange:c}=s;t[a]=r,n.value=xe(l.value,t),_(c,r,n.value)}}}function xe(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:a,filterBy:s=l[n]}=o;return{key:n,filter:a,filterBy:s}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l,t){var i,u;const n=le("pagination"),o=m(()=>{const{pagination:d}=e;return d===!1?null:d===!0?{}:d}),a=I(((i=o.value)==null?void 0:i.pageIndex)??1),s=I(((u=o.value)==null?void 0:u.pageSize)??l.pagination.pageSize??n.pageSize),r=(d,h)=>{var x;a.value=d,s.value=h,_((x=o.value)==null?void 0:x.onChange,d,h)};return{mergedPagination:m(()=>{const d=o.value;return d===null?null:{...l.pagination,size:t.value,...d,pageIndex:d.pageIndex??a.value,pageSize:d.pageSize??s.value,onChange:r}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,{setStickyScrollLeft:t}){const n=I(),o=I(),a=I(),s=I(),r=I();D(n,S=>{S&&(a.value=S.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=It(e,o,a,r,t),d=Rt(e,l,a,s),h=m(()=>{var S;return z((S=e.scroll)==null?void 0:S.width)}),x=m(()=>{var g;let S=z((g=e.scroll)==null?void 0:g.height);return!S&&l.value&&(e.virtual||d.value)&&(S="auto"),S}),f=m(()=>ce(X(a))),C=m(()=>x.value?f.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:a,scrollContentRef:s,scrollFootRef:r,handleScroll:c,scrollTo:S=>{var g;e.virtual?(g=n.value)==null||g.scrollTo(S):typeof S=="number"&&Qe({target:X(a),top:S,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:x,scrollBarSize:f,scrollBarSizeOnFixedHolder:C}}function It(e,l,t,n,o){const a=I(!1),s=I(!1);let r;const c=()=>{r&&(clearTimeout(r),r=void 0)};Q(()=>c());const i=I(),u=f=>{i.value=f,c(),r=setTimeout(()=>{i.value=void 0,r=void 0},100)},d=(f,C)=>{C&&C.scrollLeft!==f&&(C.scrollLeft=f)},h=f=>{const C=X(t);if(!C)return;const{clientWidth:w,scrollWidth:S}=C;o(f/S*w||0)};return{handleScroll:(f,C)=>{const w=f==null?void 0:f.currentTarget,S=C??w.scrollLeft,g=i.value;if((!g||g===w)&&(u(w),d(S,l.value),d(S,X(t)),d(S,n.value),h(S)),w){const{scrollWidth:v,clientWidth:y}=w;a.value=S>0,s.value=S<v-y}(f==null?void 0:f.type)==="scroll"&&_(e.onScroll,f)},pingedStart:a,pingedEnd:s}}function Rt(e,l,t,n){const o=I(!0),a=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let s=[];const r=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,i])=>{r(),c&&!i&&(s=[ie(t,a),ie(n,a)])},{immediate:!0})}),Q(()=>r()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ot(e,l,t,n,o,a){const s=m(()=>e.scrollToTopOnChange??l.scrollToTopOnChange);let r=[];const c=()=>{r=[D([()=>{var u;return(u=t.value)==null?void 0:u.pageIndex},()=>{var u;return(u=t.value)==null?void 0:u.pageSize}],()=>a(0)),D([o,n],([u,d],[h,x])=>{(!Pt(u,h)||!Wt(d,x))&&a(0)})]},i=()=>{r.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function Pt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Wt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ft(e,l,t,{mergedMap:n,paginatedMap:o}){const a=m(()=>t.value.find(g=>"type"in g&&g.type==="selectable")),[s,r]=Be(e,"selectedRowKeys",()=>[]),c=m(()=>{const{disabled:g}=a.value||{},v=[],y=[];return o.value.forEach((p,k)=>{g!=null&&g(p.record)?y.push(k):v.push(k)}),{enabledRowKeys:v,disabledRowKeys:y}}),i=m(()=>{const g=new Set,v=s.value,{disabledRowKeys:y}=c.value,p=n.value;return v.forEach(k=>{const{parentKey:K}=p.get(k)||{};if(!Y(K)){let B=p.get(K);if(B&&!v.includes(B.rowKey))for(;B&&!Y(B==null?void 0:B.rowKey);)y.includes(B.rowKey)||g.add(B.rowKey),B=Y(B.parentKey)?void 0:p.get(B.parentKey)}}),[...g]}),u=m(()=>{const g=s.value,{disabledRowKeys:v}=c.value;let y=0;return o.value.forEach((p,k)=>{!v.includes(k)&&g.includes(k)&&y++},0),y}),d=m(()=>{const g=o.value.size,v=c.value.disabledRowKeys.length;return g===0||g===v?!1:g===v+u.value}),h=m(()=>!d.value&&u.value>0),x=g=>{r(g);const v=n.value,{onChange:y}=a.value||{};if(y){const p=[];g.forEach(k=>{const K=v.get(k);K&&p.push(K.record)}),_(y,g,p)}},f=(g,v)=>{const y=n.value,{disabledRowKeys:p}=c.value,{multiple:k,onSelect:K}=a.value||{};let B=[...s.value];const E=B.indexOf(g),P=E>=0;if(k){const R=y.get(g),A=Ne(R,p);if(P){B.splice(E,1);const O=Ht(y,R,p);B=B.filter($=>!O.includes($)&&!A.includes($))}else B.push(g),B.push(...A);At(y,R,B,p)}else B=P?[]:[g];_(K,!P,v),x(B)},C=()=>{const{enabledRowKeys:g}=c.value,v=new Set(s.value);d.value?g.forEach(y=>v.delete(y)):g.forEach(y=>v.add(y)),x([...v])},w=Mt(a,l),S=_t(a,n,o,s,x);return{selectable:a,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:f,handleHeadSelectChange:C,mergedSelectableMenus:w,handleSelectableMenuClick:S}}function Ne(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:a}=o;l.includes(a)||t.push(o.rowKey),t.push(...Ne(o,l))}),t}function Ht(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function At(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const a=e.get(l.parentKey);if(a&&!n.includes(l.parentKey)){o=a.children.every(r=>n.includes(r.rowKey)||t.includes(r.rowKey));const s=t.findIndex(r=>r===l.parentKey);o?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=a}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Mt(e,l){return m(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:a,selectPageInvert:s}=l.table;return t.map(r=>N(r)?r==="all"?{type:"item",key:Le,label:n}:r==="invert"?{type:"item",key:je,label:o}:r==="none"?{type:"item",key:Ue,label:a}:r==="pageInvert"?{type:"item",key:qe,label:s}:{type:"item",key:r,label:r}:r)})}function _t(e,l,t,n,o){const a=()=>{const{disabled:u,onSelectAll:d}=e.value||{},h=[];l.value.forEach((x,f)=>{u!=null&&u(x.record)||h.push(f)}),_(d,h),o(h)},s=()=>{const{disabled:u,onSelectInvert:d}=e.value||{},h=[...n.value];l.value.forEach((x,f)=>{if(u!=null&&u(x.record))return;const C=h.indexOf(f);C>=0?h.splice(C,1):h.push(f)}),o(h),_(d,h)},r=()=>{const{onSelectNone:u}=e.value||{};_(u),o([])},c=()=>{const{disabled:u,onSelectPageInvert:d}=e.value||{},h=[],x=n.value;t.value.forEach((f,C)=>{u!=null&&u(f.record)||x.includes(C)||h.push(C)}),_(d,h),o(h)},i=new Map([[Le,a],[je,s],[Ue,r],[qe,c]]);return u=>{const d=u.key;if(dt(d)&&i.has(d)){i.get(d)();return}const{disabled:h,onMenuClick:x}=e.value||{};if(!x)return;const f=[];t.value.forEach((C,w)=>{h!=null&&h(C.record)||f.push(w)}),_(x,u,f)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=m(()=>e.value.filter(s=>s.sortable)),t=m(()=>l.value.some(s=>s.sortable.multiple!==void 0)),n=he({}),o=I([]);return D(l,(s,r)=>{s.forEach(c=>{const{key:i,sortable:u}=c,d=u.orderBy;if(d||n[i]===void 0){n[i]=d;return}const h=r?r.find(f=>f.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(n[i]=void 0)}),o.value=Ce(s,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(s,r)=>{const{orders:c,onChange:i}=r,u=n[s],d=u?Se(c,u):Se(c);t.value?n[s]=d:Object.keys(n).forEach(h=>{s===h?n[h]=d:n[h]=void 0}),o.value=Ce(l.value,n),_(i,d,o.value)}}}function Se(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:a=0,orderBy:s=l[n],sorter:r}=o;return{key:n,multiple:a,orderBy:s,sorter:r}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=m(()=>!!e.sticky),t=m(()=>{const{sticky:a}=e,{offsetTop:s=0,offsetBottom:r=0,offsetScroll:c=0,container:i=window}=ft(a)?a:{};return{offsetTop:s,offsetBottom:r,offsetScroll:c,container:i}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Nt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},a,s){return m(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||s.value||a.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const M=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:a}=F(M);return()=>{const{isFixedHolder:s}=e,r=s?t.value:l.value;if(r.every(u=>!u.width&&!u.type))return;const c=a.value,i=r.map((u,d)=>{const{key:h,type:x}=u,f=s?n.value[d]:u.width,C=x?V({[`${c}-col-${x}`]:!0,[`${c}-col-with-dropdown`]:x==="selectable"&&o.value.length>0}):void 0;let w;return s?w=f?`width: ${z(f)}`:void 0:w={width:z(f),minWidth:z(u.minWidth),maxWidth:z(u.maxWidth)},b("col",{key:h,class:C,style:w},null)});return b("colgroup",null,[i])}}}),Lt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:a,flattedData:s,isSticky:r,columnWidths:c}=F(M);jt(n,o);const i=m(()=>a.value==="max-content"),u=m(()=>s.value.length>0),d=m(()=>{const f=t.value;return{[`${f}-fixed-holder`]:!0,[`${f}-sticky-holder`]:r.value}}),h=m(()=>{const f=r.value,{offsetTop:C,offsetBottom:w}=e;return{overflow:"hidden",top:f?z(C):void 0,bottom:f?z(w):void 0}}),x=m(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:d.value,style:h.value,ref:n},[b("table",{style:x.value},[(u.value||!i.value)&&b(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function jt(e,l){const t=n=>{const o=n.deltaX,a=n.currentTarget;if(o){const s=a.scrollLeft+o;l(n,s),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Q(()=>G(e.value,"wheel",t))}const Ut=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:a}=F(M),s=I(!1),r=I(!1),c=I(0),i=I(0),u=I(0),d=m(()=>{const v=i.value,y=u.value;return y&&v*(v/y)});Ie(()=>{const v=X(l);if(v&&s.value){const{clientWidth:y,scrollWidth:p,scrollLeft:k}=v;a(k/p*y),i.value=y,u.value=p}});const h=m(()=>({height:ce(),width:i.value,bottom:n.value.offsetScroll})),x=m(()=>{const v=e.value;return{[`${v}-sticky-scrollbar-thumb`]:!0,[`${v}-sticky-scrollbar-thumb-active`]:r.value}}),f=m(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),C=()=>r.value=!1,w=v=>{c.value=v.pageX-o.value,r.value=!0,v.preventDefault()},S=v=>{if(!r.value)return;const{buttons:y}=v||window.event;if(y===0){r.value=!1;return}let p=v.pageX-c.value;p<=0&&(p=0);const k=i.value,K=u.value,B=d.value;p+B>=k&&(p=k-B);const E=p/k*(K+2);t(v,E)},g=()=>{const v=X(l),y=ge(v).top,p=y+v.offsetHeight,{container:k,offsetScroll:K}=n.value,B=k===window?document.documentElement.scrollTop+window.innerHeight:ge(k).top+k.clientHeight;p-ce()<=B||y>=B-K?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",C),ee(document.body,"mousemove",S),ee(window,"resize",g),D(()=>n.value.container,(v,y)=>{G(y,"scroll",g),ee(v,"scroll",g)},{immediate:!0}),g()}),Q(()=>{G(document.body,"mouseup",C),G(document.body,"mousemove",S),G(window,"resize",g),G(n.value.container,"scroll",g)}),()=>!l.value||!s.value||u.value<=i.value||!d.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[b("div",{class:x.value,style:f.value,onMousedown:w},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:a,scrollBarColumn:s}=F(M),{mainTableWidth:r}=F(pe),c=m(()=>n.value.length);return()=>{let i=l.default();if(e.isEmpty?a.value:o.value){const u=s.value;i=b("div",{class:`${t.value}-fixed-row`,style:{width:z(r.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const qt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Xt={columns:{type:Array,required:!0}},Vt={column:{type:Object,required:!0}},Gt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Yt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Qt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Zt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},el=H({props:Jt,setup(e){const l=I();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[vt(" ")])])}}),tl=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(M),{changeColumnWidth:t}=F(pe);return()=>{const n=l.value.map(o=>{const{key:a}=o;return b(el,{key:a,cellKey:a,changeColumnWidth:t},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),ll=H({props:Yt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:a,activeOrderByMap:s,fixedColumnKeys:r,columnOffsets:c,isSticky:i,expandable:u,selectable:d,mergedPagination:h}=F(M),x=m(()=>s[e.column.key]),f=nl(e),C=m(()=>r.value.lastStartKey===e.column.key),w=m(()=>r.value.firstEndKey===e.column.key),S=m(()=>{const{type:p,ellipsis:k}=e.column;return p?k:k??l.ellipsis}),g=m(()=>{const{fixed:p,align:k}=e.column,K=o.value;let B={[`${K}-cell`]:!0,[`${K}-cell-sorted`]:!!x.value,[`${K}-cell-align-${k}`]:!!k&&k!="start",[`${K}-cell-ellipsis`]:!!S.value};return p&&(B={...B,[`${K}-fix-start`]:p==="start",[`${K}-fix-start-last`]:C.value,[`${K}-fix-end`]:p==="end",[`${K}-fix-end-first`]:w.value,[`${K}-fix-sticky`]:i.value}),V(B)}),v=m(()=>{const{fixed:p}=e.column;if(!p)return;const{starts:k,ends:K}=c.value,E=z((p==="start"?k:K)[e.colIndex]);return{position:"sticky",left:p==="start"?E:void 0,right:p==="end"?E:void 0}}),y=p=>{p.stopPropagation()};return()=>{var A,O;const{column:p}=e,{type:k}=p;let K,B;if(k==="selectable")K=rl(e,t,d,y,n,h);else if(k==="indexable")K=Xe(e,t,p,h);else{const $=f.value;if(K=ol(e,t,$),B=We(S.value,K,$),!k&&(Y(K)||K==="")){const T=t.emptyCell||a.value;K=J(T)?T({column:p,record:e.record,rowIndex:e.rowIndex}):T}}e.column.fixed&&S.value&&(C.value||w.value)&&(K=b("span",{class:`${o.value}-cell-content`},[K]));const E=(A=l.customAdditional)==null?void 0:A.bodyCell,P=E?E({column:p,record:e.record,rowIndex:e.rowIndex}):void 0,R=((O=l.customTag)==null?void 0:O.bodyCell)??"td";return b(R,Z({class:g.value,style:v.value,title:B},P),{default:()=>[k==="expandable"&&sl(e,t,u,o.value),K]})}}});function nl(e){return m(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let a=0;a<n.length&&o;a++){const s=n[a];o=o[s]}return o})}function ol(e,l,t){const{record:n,rowIndex:o,column:a}=e,{customCell:s}=a,r=N(s)?l[s]:s;return r?r({value:t,record:n,rowIndex:o}):t}function sl(e,l,t,n){if(e.disabled)return;const{icon:o,customIcon:a,indent:s}=t.value,{record:r,expanded:c,level:i=0}=e,u=s?`margin-left: ${z(i*s)}`:void 0;let d;const h=(N(a)?l[a]:a)??o;return J(h)?d=h({expanded:!!c,record:r}):d=N(h)?b(te,{name:h,rotate:c?90:0},null):h,b("button",{class:`${n}-expandable-trigger`,style:u,type:"button",onClick:e.handleExpend},[d])}function rl(e,l,t,n,o,a){const{selected:s,indeterminate:r,disabled:c,isHover:i,handleSelect:u}=e,{showIndex:d,multiple:h,customCell:x,trigger:f}=t.value;if(!s&&!i&&d)return Xe(e,l,o.columnIndexable,a);const C=N(x)?l[x]:x;if(h){const w={checked:s,disabled:c,indeterminate:r},S={...w,onChange:u,onClick:n};return C?C(f?w:S):b(ve,f?w:S,null)}else{const w={checked:s,disabled:c},S={...w,onChange:u,onClick:n};return C?C(S):b(Oe,f?w:S,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:a,disabled:s}=e,{customCell:r}=t,{pageIndex:c=1,pageSize:i=0}=n.value||{},u=N(r)?l[r]:r;return u?b("span",{style:s?"cursor: not-allowed":"cursor: pointer"},[u({record:o,rowIndex:a,pageIndex:c,pageSize:i})]):void 0}const al=H({props:Gt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:a,checkExpandDisabled:s,selectable:r,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:d}=F(M),{expandDisabled:h,handleExpend:x,selectDisabled:f,handleSelect:C,isHover:w,attrs:S}=cl(e,o,s,a,r,u,d),g=m(()=>c.value.includes(e.rowKey)),v=m(()=>i.value.includes(e.rowKey)),y=m(()=>{const p=`${t.value}-row`,{level:k,expanded:K}=e;return V({[`${p}`]:!0,[`${p}-level-${k}`]:!!k,[`${p}-selected`]:g.value,[`${p}-expanded`]:K})});return()=>{var B,E;const p=(B=l.customAdditional)==null?void 0:B.bodyRow,k=p?p({record:e.record,rowIndex:e.rowIndex}):void 0,K=((E=l.customTag)==null?void 0:E.bodyRow)??"tr";return b(K,Z({class:y.value},S.value,k),{default:()=>[il(e,n,h,x,g,v,f,C,w)]})}}});function cl(e,l,t,n,o,a,s){const r=m(()=>t(e.rowData)),c=m(()=>{var y;return(y=l.value)==null?void 0:y.trigger}),i=()=>{const{rowKey:y,record:p}=e;n(y,p)},u=m(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=m(()=>{var y;return(y=o.value)==null?void 0:y.trigger}),h=m(()=>{var y;return(y=o.value)==null?void 0:y.showIndex}),x=I(!1),f=()=>{const{rowKey:y,record:p}=e;a(y,p)},C=()=>{c.value==="click"&&i(),d.value==="click"&&f()},w=()=>{c.value==="dblclick"&&i(),d.value==="dblclick"&&f()},S=()=>x.value=!0,g=()=>x.value=!1,v=m(()=>{const y=r.value,p=c.value,k=u.value,K=d.value,B=!y&&p==="click"||!k&&K==="click",E=!y&&p==="dblclick"||!k&&K==="dblclick",P=!k&&h.value;let R="";return B||E?R="pointer":(y&&p||k&&K)&&(R="not-allowed"),{style:R?`cursor: ${R}`:void 0,onClick:B?C:void 0,onDblclick:E?w:void 0,onMouseenter:P?S:void 0,onMouseleave:P?g:void 0}});return{expandDisabled:r,handleExpend:i,selectDisabled:u,handleSelect:f,isHover:x,attrs:v}}function il(e,l,t,n,o,a,s,r,c){const i=[],{rowIndex:u,record:d,level:h}=e;return l.value.forEach((x,f)=>{const{type:C,colSpan:w,rowSpan:S,key:g}=x,v=w==null?void 0:w(d,u),y=S==null?void 0:S(d,u);if(v===0||y===0)return;const p={colSpan:v===1?void 0:v,rowSpan:y===1?void 0:y,rowIndex:u,colIndex:f,record:d,column:x,level:h,key:g};C==="expandable"?(p.expanded=e.expanded,p.disabled=t.value,p.handleExpend=n):C==="selectable"&&(p.selected=o.value,p.indeterminate=a.value,p.disabled=s.value,p.handleSelect=r,p.isHover=c.value),i.push(b(ll,p,null))}),i}function Ve(e,l,t,n,o){const{expanded:a,level:s,record:r,rowKey:c}=e,i={key:c,expanded:a,level:s,record:r,rowData:e,rowIndex:l,rowKey:c},u=b(al,i,null),d=a&&ul(i,t,n,o);return d?[u,d]:u}function ul(e,l,t,n){const{customExpand:o}=t||{},{record:a,rowIndex:s}=e;let r;return J(o)?r=o({record:a,rowIndex:s}):N(o)&&l[o]&&(r=l[o]({record:a,rowIndex:s})),r&&b(de,{class:`${n}-expanded-row`},{default:()=>[r]})}const ae=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:a,flattedData:s,expandable:r,scrollWidth:c,scrollHeight:i,isSticky:u}=F(M),d=m(()=>a.value||c.value||i.value||u.value);return()=>{const h=o.value,x=[];n.alert&&x.push(b(de,{class:`${h}-alert-row`},{default:()=>[n.alert()]}));const f=s.value;return f.length>0?l.default?x.push(...l.default()):f.forEach((C,w)=>{x.push(...fe(Ve(C,w,n,r.value,h)))}):x.push(b(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[b(Ze,{empty:t.empty},n)]})),b("tbody",{class:`${o.value}-tbody`},[d.value&&b(tl,null,null),x])}}}),dl=H({props:Qt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(M),a=m(()=>e.filterable.multiple??t.columnBase.filterable.multiple),s=m(()=>e.filterable.footer??t.columnBase.filterable.footer),r=e.activeFilterBy,[c,i]=oe(()=>r);D(()=>e.activeFilterBy,v=>i(v));const[u,d]=oe(!1),h=v=>{d(v),v||e.onUpdateFilterBy(c.value)},x=()=>{d(!1),e.onUpdateFilterBy(c.value)},f=()=>{i(r)},C=v=>{const y=`${o.value}-filterable-menu-label`,p=a.value?ve:Oe;return b("span",{class:y},[b(p,{checked:v.selected,disabled:v.disabled},null),b("span",{class:`${y}-content`},[v.label])])},w=()=>{const v=[],{customMenu:y,menus:p}=e.filterable;return J(y)?v.push(y()):N(y)&&l[y]?v.push(l[y]()):v.push(fl(p,a,c,i,C)),s.value&&v.push(vl(n,o,x,f)),v},S=m(()=>{const v=`${o.value}-filterable-trigger`;return V({[v]:!0,[`${v}-active`]:e.activeFilterBy.length>0})}),g=()=>{const{customTrigger:v}=e.filterable;return J(v)?v():N(v)&&l[v]?l[v]():b("span",{class:S.value,onClick:y=>y.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const v={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return b(Ke,v,{default:g,overlay:w})}}}),fl=(e,l,t,n,o)=>{const a={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return b(Ee,a,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:a}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),b(me,{size:"xs",onClick:n},{default:()=>[a]})])},hl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:a,handleHeadSelectChange:s,mergedSelectableMenus:r,handleSelectableMenuClick:c}=F(M),i=m(()=>{const w=l.value.size;return w===0||w===n.value.disabledRowKeys.length}),[u,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},x=()=>b(Ee,{dataSource:r.value,onClick:c},null),f=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),C=()=>{if(r.value.length!==0)return b(Ke,h,{default:f,overlay:x})};return()=>{const{multiple:w}=t.value;if(w)return b("span",{class:`${e.value}-cell-triggers`},[b(ve,{checked:o.value,indeterminate:a.value,disabled:i.value,onChange:s},null),C()])}}}),yl=H({props:Zt,setup(e){const{locale:l,mergedPrefixCls:t}=F(M);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:a,nextTooltip:s}=o,r=s&&pl(l.table,a,n),c=gl(t,a,n);return r?b(et,{title:r},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:a,sortDesc:s}=e;return n?n==="ascend"?a:s:o}function gl(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,a=l.includes("ascend")&&b(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),s=l.includes("descend")&&b(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return b("span",{class:`${n}-sortable-trigger`},[a,s])}const ml=H({props:Vt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:a,isSticky:s,handleSort:r,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(M),d=m(()=>{const{type:g,ellipsis:v}=e.column,y=g?v:v??l.ellipsis;return $e(y)&&y.head===!1?void 0:y}),h=m(()=>{const{type:g,align:v,fixed:y,hasChildren:p,key:k,sortable:K,filterable:B}=e.column,E=n.value;let P={[`${E}-cell`]:!0,[`${E}-cell-${g}`]:!!g,[`${E}-cell-filterable`]:!!B,[`${E}-cell-sortable`]:!!K,[`${E}-cell-align-center`]:p||v==="center",[`${E}-cell-align-end`]:!p&&v==="end",[`${E}-cell-ellipsis`]:!!d.value};if(y){const{lastStartKey:R,firstEndKey:A}=o.value;P={...P,[`${E}-fix-start`]:y==="start",[`${E}-fix-start-last`]:R===k,[`${E}-fix-end`]:y==="end",[`${E}-fix-end-first`]:A===k,[`${E}-fix-sticky`]:s.value}}return V(P)}),x=m(()=>{const{fixed:g,colStart:v,colEnd:y}=e.column;if(!g)return;const{starts:p,ends:k}=a.value,E=z((g==="start"?p:k)[g==="start"?v:y]);return{position:"sticky",left:g==="start"?E:void 0,right:g==="end"?E:void 0}}),f=m(()=>c[e.column.key]),C=m(()=>i[e.column.key]||tt),w=g=>{const{key:v,filterable:y}=e.column;u(v,y,g)},S=()=>{const{key:g,sortable:v}=e.column;v&&r(g,v)};return()=>{var A,O;const{column:g}=e,{type:v,titleColSpan:y,titleRowSpan:p}=g;if(v==="scroll-bar")return b("th",{class:h.value,style:x.value,colspan:y===1?void 0:y,rowspan:p===1?void 0:p,onClick:S},null);const k=n.value;let K,B;if(v==="selectable")B=b(hl,null,null);else{const{title:$,customTitle:T,sortable:W,filterable:U}=g,L=d.value;B=bl($,T,t),K=We(L,B,$);const j=xl(W,f,U,C,w);j.length>0?B=b("span",{class:`${k}-cell-triggers`},[b("span",{class:`${k}-cell-title`},[B]),j]):L&&(B=b("span",{class:`${k}-cell-title`},[B]))}const E=(A=l.customAdditional)==null?void 0:A.headCell,P=E?E({column:g}):void 0,R=((O=l.customTag)==null?void 0:O.headCell)??"th";return b(R,Z({class:h.value,style:x.value,colSpan:y===1?void 0:y,rowSpan:p===1?void 0:p,title:K},P,{onClick:S}),{default:()=>[B]})}}});function bl(e,l,t){let n=e;return J(l)?n=l({title:e}):N(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const a=[];return e&&a.push(b(yl,{activeOrderBy:l.value,sortable:e},null)),t&&a.push(b(dl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),a}const Sl=H({props:Xt,setup(e){const{props:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const{columns:n}=e,o=(r=l.customAdditional)==null?void 0:r.headRow,a=o?o({columns:n}):void 0,s=((c=l.customTag)==null?void 0:c.headRow)??"tr";return b(s,Z({class:`${t.value}-row`},a),{default:()=>[n.filter(i=>i.titleColSpan!==0).map(i=>b(ml,{key:i.key,column:i},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(M);return()=>{var r,c;const n=l.value,o=(r=e.customAdditional)==null?void 0:r.head,a=o?o({rows:n}):void 0,s=((c=e.customTag)==null?void 0:c.head)??"thead";return b(s,Z({class:`${t.value}-thead`},a),{default:()=>[n.map((i,u)=>b(Sl,{key:u,columns:i},null))]})}}}),Cl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:a,columnWidths:s,changeColumnWidth:r,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:x,handleScroll:f,pingedStart:C,pingedEnd:w,scrollWidth:S,scrollHeight:g,hasFixed:v,tableLayout:y}=F(M),p=I(),k=I(0);Re(pe,{mainTableWidth:k,changeColumnWidth:($,T)=>{st(p.value)&&r($,T)}});const B=()=>{const $=X(h);$&&f({currentTarget:$})},E=$=>{const{offsetWidth:T}=$.target;T!==k.value&&(k.value=T)};se(()=>{B(),D([()=>e.dataSource,S],([,T])=>{T&&B()}),D(s,Te(()=>{var W;((W=X(h))==null?void 0:W.scrollLeft)===0&&B()},16)),lt(p.value,E)}),Q(()=>nt(p.value,E));const P=m(()=>{const $=n.value;return V({[`${$}-container`]:!0,[`${$}-ping-start`]:C.value,[`${$}-ping-end`]:w.value,[`${$}-fixed-layout`]:y.value==="fixed",[`${$}-fixed-column`]:v.value,[`${$}-scroll-horizontal`]:S.value,[`${$}-scroll-vertical`]:g.value})}),R=m(()=>{var j;const $=S.value,T=g.value,W=$?"auto":void 0,U=e.virtual?"hidden":T?"scroll":$?"hidden":void 0,L=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:W,overflowY:U,[L?"height":"maxHeight"]:T}}),A=m(()=>({tableLayout:y.value,width:S.value,minWidth:S.value?"100%":void 0})),O=($,T,W)=>{_(e.onScrolledChange,$,T,W.map(U=>U.record))};return()=>{const $=n.value,T=a.value,W=l.default?l.default():[];if(T||g.value||i.value){const{offsetTop:U}=u.value;if(e.headless||W.push(b(Lt,{offsetTop:U},{default:()=>[b(we,null,null)]})),e.virtual&&(e.scroll||T)){const L=({item:re,index:Ye})=>Ve(re,Ye,l,t.value,$),j=re=>b("table",{ref:x,class:`${$}-table`,style:A.value},[b(ne,null,null),b(ae,null,{default:()=>[re]}),!1]),{scroll:q,onScrolledBottom:Ge}=e;W.push(b(ot,{ref:d,style:R.value,dataSource:c.value,fullHeight:q==null?void 0:q.fullHeight,getKey:"rowKey",height:a.value?"100%":q==null?void 0:q.height,itemHeight:o.value,itemRender:L,contentRender:j,virtual:!0,onScroll:f,onScrolledBottom:Ge,onScrolledChange:O},null))}else W.push(b("div",{ref:h,class:`${$}-content`,style:R.value,onScroll:f},[b("table",{ref:x,class:`${$}-table`,style:A.value},[b(ne,null,null),b(ae,null,null),!1])]));i.value&&W.push(b(Ut,null,null))}else W.push(b("div",{ref:h,class:`${$}-content`,style:R.value,onScroll:f},[b("table",{ref:x,class:`${$}-table`,style:A.value},[b(ne,null,null),!e.headless&&b(we,null,null),b(ae,null,null),!1])]));return b("div",{ref:p,class:P.value},[W])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wl(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t){let n=null,o=null;if(e!==null){const{position:a}=e,[s,r]=ht(a).split("-"),c=`${t}-pagination ${t}-pagination-${r}`,i=b(pt,Z({class:c,total:l.length},e),null);n=s==="top"?i:null,o=s==="bottom"?i:null}return[n,o]}const Bl={sm:32,md:40,lg:56},Kl={sm:40,md:48,lg:56},El=H({name:"IxTable",props:qt,setup(e,{expose:l,slots:t}){const n=le("common"),o=m(()=>`${n.prefixCls}-table`),a=le("locale"),s=le("table"),r=m(()=>e.autoHeight??s.autoHeight),c=m(()=>e.childrenKey??s.childrenKey),i=rt(e,s),u=m(()=>e.emptyCell??s.emptyCell),d=m(()=>e.size??s.size),h=m(()=>n.theme==="seer"?Bl[d.value]:Kl[d.value]),{mergedPagination:x}=$t(e,s,d),f=Dt(e),C=Tt(e,r,f),w=mt(e,t,s,C.scrollBarSizeOnFixedHolder),S=zt(w.flattedColumns),g=Et(w.flattedColumns),v=Kt(e,w.flattedColumns),y=Nt(e,w,C,f.isSticky,r),{activeSorters:p}=S,{activeFilters:k}=g,K=Bt(e,c,i,p,k,v.expandedRowKeys,x),B=Ft(e,a,w.flattedColumns,K);Ot(e,s,x,p,k,C.scrollTo);const E={props:e,slots:t,config:s,locale:a,mergedPrefixCls:o,mergedEmptyCell:u,mergedVirtualItemHeight:h,mergedAutoHeight:r,...w,...C,...S,...g,...f,tableLayout:y,mergedPagination:x,...v,...K,...B};Re(M,E),l({scrollTo:C.scrollTo});const{flattedData:P,filteredData:R}=K,A=m(()=>{const O=o.value,{borderless:$=s.borderless,scroll:T}=e;return V({[O]:!0,[`${O}-auto-height`]:r.value,[`${O}-borderless`]:$,[`${O}-empty`]:P.value.length===0,[`${O}-full-height`]:T==null?void 0:T.fullHeight,[`${O}-${d.value}`]:!0})});return()=>{const O=o.value,$=b(at,{header:e.header},t),T=wl(t,O),[W,U]=kl(x.value,R.value,O),L=[$],j=[W,b(Cl,null,null),T,U].filter(Boolean),q=$l(e.spin);return q?L.push(b(ct,q,{default:()=>[j]})):L.push(...j),b("div",{class:A.value},[L])}}});function $l(e){return yt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Pl=El,Wl=ye;export{Pl as I,Wl as a,gt as g,qt as t};
