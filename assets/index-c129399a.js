import{O as Te,P as ve,aS as Je,aq as $e,m as M,M as ae,aM as N,aT as ue,o as V,D as de,a4 as Qe,K as re,a3 as ne,a1 as Y,a5 as be,aU as et,A as le,j as ye,av as tt,Z as Ie,Y as Ee,c as Se,ac as nt,at as lt,E as ot,G as at,H as st,aV as rt,N as ct,aw as it,as as ut,aG as dt}from"./index-a1eb659d.js";import{b as Pe,f as U,W as ft,T as ht,c as S,y as ge,r as P,w as _,af as Re,P as Oe,d as Z,Z as Q,m as ce,bq as vt,$ as yt,l as W,x as H,p as X,n as m,am as gt,i as J,ab as ee,B as He,K as pt,at as mt}from"./vendor-4aa48d2c.js";import{b as We}from"./GlobalCodeBox-9190e325.js";import{I as bt}from"./index-0f116485.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Fe=Symbol("IxTableColumn"),pe=()=>{};pe.displayName="IxTableColumn";pe[Fe]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ae(e,t,n){if(!e||Pe(e)&&e.title===!1)return;if(U(t)||ft(t))return t;const l=Te(t).find(o=>o.type===ht);return l?l.children:n}function St(e){return"key"in e?e.key:"dataKey"in e?ve(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Je("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function xt(e,t,n,l){const o=S(()=>{var w;const{columns:x}=e;return Le(x&&x.length>0?x:Me((w=t.default)==null?void 0:w.call(t)),n)}),{flattedColumns:s,scrollBarColumn:r,flattedColumnsWithScrollBar:a}=wt(o,l),i=Bt(a),u=S(()=>!!e.ellipsis||s.value.some(x=>x.ellipsis)),c=S(()=>s.value.some(x=>x.fixed)),{columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:y}=kt(s,r),{columnOffsets:v,columnOffsetsWithScrollBar:p}=Kt(f,h),C=S(()=>Tt(o.value,r.value));return{flattedColumns:s,scrollBarColumn:r,flattedColumnsWithScrollBar:a,fixedColumnKeys:i,hasEllipsis:u,hasFixed:c,columnWidths:f,columnWidthsWithScrollBar:h,changeColumnWidth:y,columnOffsets:v,columnOffsetsWithScrollBar:p,mergedRows:C}}function Le(e,t){return e.map(n=>Ct(n,t))}function Me(e){const t=[];return Te(e,{key:Fe}).forEach((n,l)=>{const{props:o,children:s}=n,{key:r=l,editable:a,ellipsis:i,...u}=o||{};u.key=r,u.editable=a||a==="",u.ellipsis=i||i==="";const{default:c,cell:f,title:h,expand:y,icon:v}=s||{};c&&(u.children=Me(c())),f&&(u.customCell=f),h&&(u.customTitle=h),y&&(u.customExpand=y),v&&(u.customIcon=v),t.push(u)}),t}function Ct(e,t){var i,u;const{columnBase:n,columnExpandable:l,columnSelectable:o,columnIndexable:s}=t,{align:r=n.align}=e,a=St(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{showLine:f=l.showLine,icon:h=l.icon}=e;return{...e,key:a,align:r,icon:h,showLine:f}}if(c==="selectable"){const{multiple:f=!0,showIndex:h=o.showIndex}=e;return{...e,key:a,align:r,multiple:f,showIndex:h}}if(c==="indexable"){const f=(u=(i=e.align)!=null?i:s.align)!=null?u:n.align;return{...s,...e,align:f,key:a}}return{...e,key:a,align:r}}else{const{sortable:c,filterable:f,children:h}=e,y={...e,key:a,align:r};return c&&(y.sortable={...n.sortable,...c}),f&&(y.filterable={...n.filterable,...f}),h!=null&&h.length&&(y.children=Le(h,t)),y}}function wt(e,t){const n=S(()=>ze(e.value)),l=S(()=>{const s=t.value;if(s===0)return;const r=n.value,a=r[r.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:s}}),o=S(()=>{const s=n.value;if(s.length===0)return s;const r=l.value;return r?[...s,r]:s});return{flattedColumns:n,scrollBarColumn:l,flattedColumnsWithScrollBar:o}}function ze(e){const t=[];return e.forEach(n=>{const{fixed:l,children:o}=n;if(o!=null&&o.length){let s=ze(o);l&&(s=s.map(r=>({fixed:l,...r}))),t.push(...s)}else t.push(n)}),t}function Bt(e){return S(()=>{let t,n;return e.value.forEach(l=>{const{fixed:o,key:s}=l;o==="start"?t=s:o==="end"&&(n||(n=s))}),{lastStartKey:t,firstEndKey:n}})}function kt(e,t){const n=ge({}),l=P(),o=P([]);_(l,Re(a=>{o.value=a?a.split("-").map(Number):[]},16)),Oe(()=>{const a=Object.keys(n),i=e.value;if(a.length!==i.length){l.value=void 0;return}l.value=i.map(u=>n[u.key]).join("-")});const s=S(()=>{const a=o.value;if(a.length===0)return a;const i=t.value;return i?[...a,i.width]:a});return{columnWidths:o,columnWidthsWithScrollBar:s,changeColumnWidth:(a,i)=>{i===!1?delete n[a]:n[a]=i}}}function Kt(e,t){const n=S(()=>xe(e.value)),l=S(()=>xe(t.value));return{columnOffsets:n,columnOffsetsWithScrollBar:l}}function xe(e){const t=e.length,n=[],l=[];let o=0,s=0;for(let r=0;r<t;r++){n[r]=o,o+=e[r]||0;const a=t-r-1;l[a]=s,s+=e[a]||0}return{starts:n,ends:l}}function Tt(e,t){const n=[];function l(r,a,i){var f;(f=n[i])!=null||(n[i]=[]);let u=a;return r.map(h=>{var x;let y=(x=h.titleColSpan)!=null?x:1,v=!1;const p=h.children;if(p!=null&&p.length){v=!0;const w=l(p,u,i+1);Z(h.titleColSpan)&&(y=w.reduce((d,g)=>d+g))}const C=u+y-1;return n[i].push({...h,titleColSpan:y,colStart:u,colEnd:C,hasChildren:v}),u+=y,y})}const o=t?[...e,t]:e;l(o,0,0);const s=n.length;return n.forEach((r,a)=>{r.forEach(i=>{i.hasChildren||(i.titleRowSpan=s-a)})}),n}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,t,n,l,o,s,r){const a=S(()=>{const p=t.value,C=n.value;return e.dataSource.map((x,w)=>Ne(x,C,p,w,e.dataSource.length))}),i=S(()=>{const p=new Map;return fe(a.value,p),p}),u=S(()=>De(a.value,o.value,s.value)),c=S(()=>_e(u.value,l.value,s.value)),f=S(()=>{const p=r.value,C=c.value;if(p===null||!p.pageSize)return C;{const{total:x}=p;if(x&&C.length<x)return C;const w=p.pageSize,d=(p.pageIndex-1)*w;return C.slice(d,d+w)}}),h=S(()=>{const p=new Map;return fe(f.value,p),p}),y=S(()=>{const p=s.value;return p.length>0?je(f.value,p,0):f.value});return{isTreeData:S(()=>a.value.some(p=>{var C;return(C=p.children)==null?void 0:C.length})),filteredData:u,flattedData:y,mergedMap:i,paginatedMap:h}}function Ne(e,t,n,l,o,s){var u;const r=t(e),a={record:e,rowKey:r,parentKey:s==null?void 0:s[0].rowKey,showLineIndentIndexList:(u=[...s!=null?s:[]].reverse())==null?void 0:u.reduce((c,f,h)=>(f.hasNextSibling&&c.push(h),c),[]),hasPrevSibling:l>0,hasNextSibling:l<o-1},i=e[n];return i&&(a.children=i.map((c,f)=>Ne(c,t,n,f,i.length,[a,...s!=null?s:[]]))),a}function fe(e,t){e.forEach(n=>{const{rowKey:l,children:o}=n;t.set(l,n),o&&fe(o,t)})}function _e(e,t,n){const l=t.filter(r=>r.sorter),o=l.length;if(o===0)return e;const s=e.slice();return s.forEach(r=>{n.includes(r.rowKey)&&r.children&&r.children.length>0&&(r.children=_e(r.children,t,n))}),s.sort((r,a)=>{for(let i=0;i<o;i++){const{orderBy:u,sorter:c}=l[i],f=c(r.record,a.record);if(f!==0)return u==="ascend"?f:-f}return 0})}function De(e,t,n){const l=t.filter(o=>o.filter);return l.length===0?e:e.map(o=>{const s=l.every(({filter:c,filterBy:f})=>c(f,o.record)),{rowKey:r,children:a}=o,i=n.includes(r);let u=o;if(i&&a&&a.length){const c=De(a,t,n);c.length!==a.length&&(u={...o,children:c})}return s||i&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function je(e,t,n){return e.reduce((l,o)=>{const{children:s,parentKey:r,record:a,rowKey:i,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:f}=o,h=t.includes(i);if(l.push({children:s,parentKey:r,record:a,rowKey:i,level:n,expanded:h,hasPrevSibling:u,hasNextSibling:c,showLineIndentIndexList:f}),h&&o.children){const y=je(o.children,t,n+1);l.push(...y)}return l},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e,t){const n=S(()=>t.value.find(a=>"type"in a&&a.type==="expandable")),[l,o]=$e(e,"expandedRowKeys",()=>[]);return{expandable:n,expandedRowKeys:l,setExpandedRowKeys:o,checkExpandDisabled:a=>{if(!n.value)return!0;const{disabled:i,customExpand:u}=n.value,{record:c}=a;return i!=null&&i(c)?!0:!(u||a.children&&a.children.length>0)},handleExpandChange:(a,i)=>{const{onChange:u,onExpand:c}=n.value||{},f=[...l.value],h=f.indexOf(a),y=h>=0;y?f.splice(h,1):f.push(a),M(c,!y,i),o(f),M(u,f)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const t=S(()=>e.value.filter(s=>s.filterable)),n=ge({}),l=P([]);return _(t,(s,r)=>{s.forEach(a=>{const{key:i,filterable:u}=a,c=u.filterBy;if(c||n[i]===void 0){n[i]=c||[];return}const f=r?r.find(y=>y.key===i):void 0;(f==null?void 0:f.filterable.filterBy)&&(n[i]=[])}),l.value=Ce(s,n)},{immediate:!0}),{activeFilters:l,activeFilterByMap:n,handleFilter:(s,r,a)=>{const{onChange:i}=r;n[s]=a,l.value=Ce(t.value,n),M(i,a,l.value)}}}function Ce(e,t){return e.map(n=>{const{key:l,filterable:o}=n,{filter:s,filterBy:r=t[l]}=o;return{key:l,filter:s,filterBy:r}}).filter(n=>n.filter&&n.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pt(e,t,n){var u,c,f,h,y;const l=ae("pagination"),o=S(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),s=P((c=(u=o.value)==null?void 0:u.pageIndex)!=null?c:1),r=P((y=(h=(f=o.value)==null?void 0:f.pageSize)!=null?h:t.pagination.pageSize)!=null?y:l.pageSize),a=(v,p)=>{var C;s.value=v,r.value=p,M((C=o.value)==null?void 0:C.onChange,v,p)};return{mergedPagination:S(()=>{var p,C;const v=o.value;return v===null?null:{...t.pagination,size:n.value,...v,pageIndex:(p=v.pageIndex)!=null?p:s.value,pageSize:(C=v.pageSize)!=null?C:r.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Rt(e,t,{setStickyScrollLeft:n}){const l=P(),o=P(),s=P(),r=P(),a=P();_(l,x=>{x&&(s.value=x.holderRef.value)});const{handleScroll:i,pingedStart:u,pingedEnd:c}=Ot(e,o,s,a,n),f=Ht(e,t,s,r),h=S(()=>{var x;return N((x=e.scroll)==null?void 0:x.width)}),y=S(()=>{var w;let x=N((w=e.scroll)==null?void 0:w.height);return!x&&t.value&&(e.virtual||f.value)&&(x="auto"),x}),v=S(()=>ue(V(s))),p=S(()=>y.value?v.value:0);return{virtualScrollRef:l,scrollHeadRef:o,scrollBodyRef:s,scrollContentRef:r,scrollFootRef:a,handleScroll:i,scrollTo:x=>{var w;e.virtual?(w=l.value)==null||w.scrollTo(x):typeof x=="number"&&Qe({target:V(s),top:x,duration:200})},pingedStart:u,pingedEnd:c,scrollWidth:h,scrollHeight:y,scrollBarSize:v,scrollBarSizeOnFixedHolder:p}}function Ot(e,t,n,l,o){const s=P(!1),r=P(!1);let a;const i=()=>{a&&(clearTimeout(a),a=void 0)};Q(()=>i());const u=P(),c=v=>{u.value=v,i(),a=setTimeout(()=>{u.value=void 0,a=void 0},100)},f=(v,p)=>{p&&p.scrollLeft!==v&&(p.scrollLeft=v)},h=v=>{const p=V(n);if(!p)return;const{clientWidth:C,scrollWidth:x}=p;o(v/x*C||0)};return{handleScroll:(v,p)=>{const C=v==null?void 0:v.currentTarget,x=p!=null?p:C.scrollLeft,w=u.value;if((!w||w===C)&&(c(C),f(x,t.value),f(x,V(n)),f(x,l.value),h(x)),C){const{scrollWidth:d,clientWidth:g}=C;s.value=x>0,r.value=x<d-g}(v==null?void 0:v.type)==="scroll"&&M(e.onScroll,v)},pingedStart:s,pingedEnd:r}}function Ht(e,t,n,l){const o=P(!0),s=()=>{const i=V(n.value);i?o.value=i.scrollHeight>i.clientHeight:o.value=!1};let r=[];const a=()=>r.forEach(i=>i());return ce(()=>{_([t,()=>e.virtual],([i,u])=>{a(),i&&!u&&(r=[de(n,s),de(l,s)])},{immediate:!0})}),Q(()=>a()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Wt(e,t,n,l,o,s){const r=S(()=>{var c;return(c=e.scrollToTopOnChange)!=null?c:t.scrollToTopOnChange});let a=[];const i=()=>{a=[_([()=>{var c;return(c=n.value)==null?void 0:c.pageIndex},()=>{var c;return(c=n.value)==null?void 0:c.pageSize}],()=>s(0)),_([o,l],([c,f],[h,y])=>{(!Ft(c,h)||!At(f,y))&&s(0)})]},u=()=>{a.forEach(c=>c())};_(r,c=>{u(),c&&i()},{immediate:!0})}function Ft(e,t){return e.length===t.length&&e.every(n=>{const l=t.find(o=>o.key===n.key);return l?n.filter===l.filter&&n.filterBy.length===l.filterBy.length&&n.filterBy.every(o=>l.filterBy.includes(o)):!1})}function At(e,t){return e.length===t.length&&e.every(n=>{const l=t.find(o=>o.key===n.key);return l?n.sorter===l.sorter&&n.orderBy===l.orderBy&&n.multiple===l.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Lt(e,t,n,{mergedMap:l,paginatedMap:o}){const s=S(()=>n.value.find(d=>"type"in d&&d.type==="selectable")),[r,a]=$e(e,"selectedRowKeys",()=>[]),i=S(()=>{const{disabled:d}=s.value||{},g=[],b=[];return o.value.forEach((B,k)=>{d!=null&&d(B.record)?b.push(k):g.push(k)}),{enabledRowKeys:g,disabledRowKeys:b}}),u=S(()=>{const d=new Set,g=r.value,{disabledRowKeys:b}=i.value,B=l.value;return g.forEach(k=>{const{parentKey:K}=B.get(k)||{};if(!Z(K)){let T=B.get(K);if(T&&!g.includes(T.rowKey))for(;T&&!Z(T==null?void 0:T.rowKey);)b.includes(T.rowKey)||d.add(T.rowKey),T=Z(T.parentKey)?void 0:B.get(T.parentKey)}}),[...d]}),c=S(()=>{const d=r.value,{disabledRowKeys:g}=i.value;let b=0;return o.value.forEach((B,k)=>{!g.includes(k)&&d.includes(k)&&b++},0),b}),f=S(()=>{const d=o.value.size,g=i.value.disabledRowKeys.length;return d===0||d===g?!1:d===g+c.value}),h=S(()=>!f.value&&c.value>0),y=new Map,v=d=>{a(d);const g=l.value,{onChange:b}=s.value||{};if(b){const B=[];y.forEach((k,K)=>{d.includes(K)||y.delete(K)}),d.forEach(k=>{let K=g.get(k);K?y.set(k,K):K=y.get(k),K&&B.push(K.record)}),M(b,d,B)}},p=(d,g)=>{const b=l.value,{disabledRowKeys:B}=i.value,{multiple:k,onSelect:K}=s.value||{};let T=[...r.value];const R=T.indexOf(d),O=R>=0;if(k){const F=b.get(d),z=Ue(F,B);if(O){T.splice(R,1);const I=Mt(b,F,B);T=T.filter(E=>!I.includes(E)&&!z.includes(E))}else T.push(d),T.push(...z);zt(b,F,T,B)}else T=O?[]:[d];M(K,!O,g),v(T)},C=()=>{const{enabledRowKeys:d}=i.value,g=new Set(r.value);f.value?d.forEach(b=>g.delete(b)):d.forEach(b=>g.add(b)),v([...g])},x=Nt(s,t),w=_t(s,l,o,r,v);return{selectable:s,selectedRowKeys:r,indeterminateRowKeys:u,currentPageRowKeys:i,currentPageAllSelected:f,currentPageSomeSelected:h,handleSelectChange:p,handleHeadSelectChange:C,mergedSelectableMenus:x,handleSelectableMenuClick:w}}function Ue(e,t){const n=[],{children:l}=e||{};return l&&l.forEach(o=>{const{rowKey:s}=o;t.includes(s)||n.push(o.rowKey),n.push(...Ue(o,t))}),n}function Mt(e,t,n){const l=[];for(;t!=null&&t.parentKey;){const{parentKey:o}=t;n.includes(t.parentKey)||l.push(o),t=e.get(o)}return l}function zt(e,t,n,l){let o=!0;for(;o&&t&&!Z(t.parentKey);){const s=e.get(t.parentKey);if(s&&!l.includes(t.parentKey)){o=s.children.every(a=>l.includes(a.rowKey)||n.includes(a.rowKey));const r=n.findIndex(a=>a===t.parentKey);o?r<0&&n.push(t.parentKey):r>-1&&n.splice(r,1)}t=s}}const qe=Symbol("IDUX_TABLE_KEY_selectable-all"),Ve=Symbol("IDUX_TABLE_KEY_selectable-invert"),Xe=Symbol("IDUX_TABLE_KEY_selectable-none"),Ge=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Nt(e,t){return S(()=>{const{menus:n}=e.value||{};if(!n||n.length===0)return[];const{selectAll:l,selectInvert:o,selectNone:s,selectPageInvert:r}=t.table;return n.map(a=>U(a)?a==="all"?{type:"item",key:qe,label:l}:a==="invert"?{type:"item",key:Ve,label:o}:a==="none"?{type:"item",key:Xe,label:s}:a==="pageInvert"?{type:"item",key:Ge,label:r}:{type:"item",key:a,label:a}:a)})}function _t(e,t,n,l,o){const s=()=>{const{disabled:c,onSelectAll:f}=e.value||{},h=[];t.value.forEach((y,v)=>{c!=null&&c(y.record)||h.push(v)}),M(f,h),o(h)},r=()=>{const{disabled:c,onSelectInvert:f}=e.value||{},h=[...l.value];t.value.forEach((y,v)=>{if(c!=null&&c(y.record))return;const p=h.indexOf(v);p>=0?h.splice(p,1):h.push(v)}),o(h),M(f,h)},a=()=>{const{onSelectNone:c}=e.value||{};M(c),o([])},i=()=>{const{disabled:c,onSelectPageInvert:f}=e.value||{},h=[],y=l.value;n.value.forEach((v,p)=>{c!=null&&c(v.record)||y.includes(p)||h.push(p)}),M(f,h),o(h)},u=new Map([[qe,s],[Ve,r],[Xe,a],[Ge,i]]);return c=>{const f=c.key;if(vt(f)&&u.has(f)){u.get(f)();return}const{disabled:h,onMenuClick:y}=e.value||{};if(!y)return;const v=[];n.value.forEach((p,C)=>{h!=null&&h(p.record)||v.push(C)}),M(y,c,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const t=S(()=>e.value.filter(r=>r.sortable)),n=S(()=>t.value.some(r=>r.sortable.multiple!==void 0)),l=ge({}),o=P([]);return _(t,(r,a)=>{r.forEach(i=>{const{key:u,sortable:c}=i,f=c.orderBy;if(f||l[u]===void 0){l[u]=f;return}const h=a?a.find(v=>v.key===u):void 0;(h==null?void 0:h.sortable.orderBy)&&(l[u]=void 0)}),o.value=Be(r,l)},{immediate:!0}),{activeSorters:o,activeOrderByMap:l,handleSort:(r,a)=>{const{orders:i,onChange:u}=a,c=l[r],f=c?we(i,c):we(i);n.value?l[r]=f:Object.keys(l).forEach(h=>{r===h?l[h]=f:l[h]=void 0}),o.value=Be(t.value,l),M(u,f,o.value)}}}function we(e,t){return t?e[e.indexOf(t)+1]:e[0]}function Be(e,t){return e.map(n=>{const{key:l,sortable:o}=n,{multiple:s=0,orderBy:r=t[l],sorter:a}=o;return{key:l,multiple:s,orderBy:r,sorter:a}}).filter(n=>n.orderBy).sort((n,l)=>l.multiple-n.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function jt(e){const t=S(()=>!!e.sticky),n=S(()=>{const{sticky:s}=e,{offsetTop:r=0,offsetBottom:a=0,offsetScroll:i=0,container:u=window}=yt(s)?s:{};return{offsetTop:r,offsetBottom:a,offsetScroll:i,container:u}}),[l,o]=re(0);return{isSticky:t,mergedSticky:n,stickyScrollLeft:l,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ut(e,{hasEllipsis:t,hasFixed:n},{scrollWidth:l,scrollHeight:o},s,r){return S(()=>e.tableLayout?e.tableLayout:l.value&&n.value?l.value==="max-content"?"auto":"fixed":o.value||r.value||s.value||t.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const A=Symbol("TABLE_TOKEN"),me=Symbol("tableBodyToken"),se=W({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:t,flattedColumnsWithScrollBar:n,columnWidthsWithScrollBar:l,mergedSelectableMenus:o,mergedPrefixCls:s}=H(A);return()=>{const{isFixedHolder:r}=e,a=r?n.value:t.value;if(a.every(c=>!c.width&&!c.type))return;const i=s.value,u=a.map((c,f)=>{const{key:h,type:y}=c,v=r?l.value[f]:c.width,p=y?X({[`${i}-col-${y}`]:!0,[`${i}-col-with-dropdown`]:y==="selectable"&&o.value.length>0}):void 0;let C;return r?C=v?`width: ${N(v)}`:void 0:C={width:N(v),minWidth:N(c.minWidth),maxWidth:N(c.maxWidth)},m("col",{key:h,class:p,style:C},null)});return m("colgroup",null,[u])}}}),qt=W({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:t}){const{mergedPrefixCls:n,scrollHeadRef:l,handleScroll:o,scrollWidth:s,flattedData:r,isSticky:a,columnWidths:i}=H(A);Vt(l,o);const u=S(()=>s.value==="max-content"),c=S(()=>r.value.length>0),f=S(()=>{const v=n.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:a.value}}),h=S(()=>{const v=a.value,{offsetTop:p,offsetBottom:C}=e;return{overflow:"hidden",top:v?N(p):void 0,bottom:v?N(C):void 0}}),y=S(()=>({tableLayout:"fixed",visibility:c.value&&!i.value.length?"hidden":void 0}));return()=>m("div",{class:f.value,style:h.value,ref:l},[m("table",{style:y.value},[(c.value||!u.value)&&m(se,{isFixedHolder:!0},null),t.default&&t.default()])])}});function Vt(e,t){const n=l=>{const o=l.deltaX,s=l.currentTarget;if(o){const r=s.scrollLeft+o;t(l,r),l.preventDefault()}};ce(()=>ne(e.value,"wheel",n,{passive:!0})),Q(()=>Y(e.value,"wheel",n))}const Xt=W({setup(){const{mergedPrefixCls:e,scrollBodyRef:t,handleScroll:n,mergedSticky:l,stickyScrollLeft:o,setStickyScrollLeft:s}=H(A),r=P(!1),a=P(!1),i=P(0),u=P(0),c=P(0),f=S(()=>{const d=u.value,g=c.value;return g&&d*(d/g)});Oe(()=>{const d=V(t);if(d&&r.value){const{clientWidth:g,scrollWidth:b,scrollLeft:B}=d;s(B/b*g),u.value=g,c.value=b}});const h=S(()=>({height:ue(),width:u.value,bottom:l.value.offsetScroll})),y=S(()=>{const d=e.value;return{[`${d}-sticky-scrollbar-thumb`]:!0,[`${d}-sticky-scrollbar-thumb-active`]:a.value}}),v=S(()=>({width:`${f.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),p=()=>a.value=!1,C=d=>{i.value=d.pageX-o.value,a.value=!0,d.preventDefault()},x=d=>{if(!a.value)return;const{buttons:g}=d||window.event;if(g===0){a.value=!1;return}let b=d.pageX-i.value;b<=0&&(b=0);const B=u.value,k=c.value,K=f.value;b+K>=B&&(b=B-K);const T=b/B*(k+2);n(d,T)},w=()=>{const d=V(t),g=be(d).top,b=g+d.offsetHeight,{container:B,offsetScroll:k}=l.value,K=B===window?document.documentElement.scrollTop+window.innerHeight:be(B).top+B.clientHeight;b-ue()<=K||g>=K-k?r.value=!1:r.value=!0};return ce(()=>{ne(document.body,"mouseup",p),ne(document.body,"mousemove",x),ne(window,"resize",w),_(()=>l.value.container,(d,g)=>{Y(g,"scroll",w),ne(d,"scroll",w)},{immediate:!0}),w()}),Q(()=>{Y(document.body,"mouseup",p),Y(document.body,"mousemove",x),Y(window,"resize",w),Y(l.value.container,"scroll",w)}),()=>!t.value||!r.value||c.value<=u.value||!f.value?null:m("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[m("div",{class:y.value,style:v.value,onMousedown:C},null)])}}),he=W({props:{isEmpty:Boolean},setup(e,{slots:t}){const{mergedPrefixCls:n,flattedColumns:l,hasFixed:o,scrollWidth:s,scrollBarColumn:r}=H(A),{mainTableWidth:a}=H(me),i=S(()=>l.value.length);return()=>{let u=t.default();if(e.isEmpty?s.value:o.value){const c=r.value;u=m("div",{class:`${n.value}-fixed-row`,style:{width:N(a.value-(c?c.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return m("tr",null,[m("td",{colSpan:i.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Gt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Yt={columns:{type:Array,required:!0}},Zt={column:{type:Object,required:!0}},Jt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Qt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},showLineIndentIndexList:{type:Array,default:()=>[]},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},en={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},tn={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},nn={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},ln=W({props:en,setup(e){const t=P();return de(t,l=>{const{offsetWidth:o}=l.target;e.changeColumnWidth(e.cellKey,o)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>m("td",{ref:t,style:{padding:0,border:0,height:0}},[m("div",{style:{height:0,overflow:"hidden"}},[gt(" ")])])}}),on=W({setup(){const{mergedPrefixCls:e,flattedColumns:t}=H(A),{changeColumnWidth:n}=H(me);return()=>{const l=t.value.map(o=>{const{key:s}=o;return m(ln,{key:s,cellKey:s,changeColumnWidth:n},null)});return m("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[l])}}}),an=W({props:Qt,setup(e){const{props:t,slots:n,config:l,mergedPrefixCls:o,mergedEmptyCell:s,activeOrderByMap:r,fixedColumnKeys:a,columnOffsets:i,isSticky:u,isTreeData:c,expandable:f,selectable:h,mergedPagination:y}=H(A),v=S(()=>r[e.column.key]),p=sn(e),C=S(()=>a.value.lastStartKey===e.column.key),x=S(()=>a.value.firstEndKey===e.column.key),w=S(()=>{const{type:b,ellipsis:B}=e.column;return b||B!=null?B:t.ellipsis}),d=S(()=>{const{fixed:b,align:B}=e.column,k=o.value;let K={[`${k}-cell`]:!0,[`${k}-cell-sorted`]:!!v.value,[`${k}-cell-align-${B}`]:!!B&&B!="start",[`${k}-cell-ellipsis`]:!!w.value};return b&&(K={...K,[`${k}-fix-start`]:b==="start",[`${k}-fix-start-last`]:C.value,[`${k}-fix-end`]:b==="end",[`${k}-fix-end-first`]:x.value,[`${k}-fix-sticky`]:u.value}),X(K)}),g=S(()=>{const{fixed:b}=e.column;if(!b)return;const{starts:B,ends:k}=i.value,T=N((b==="start"?B:k)[e.colIndex]);return{position:"sticky",left:b==="start"?T:void 0,right:b==="end"?T:void 0}});return()=>{var z,I,E;const{column:b}=e,{type:B}=b;let k,K;if(B==="selectable")k=un(e,n,h,l,y);else if(B==="indexable")k=Ye(e,n,b,y);else{const $=p.value;if(k=rn(e,n,$),K=Ae(w.value,k,$),!B&&(Z(k)||k==="")){const L=n.emptyCell||s.value;k=J(L)?L({column:b,record:e.record,rowIndex:e.rowIndex}):L}}e.column.fixed&&w.value&&(C.value||x.value)&&(k=m("span",{class:`${o.value}-cell-content`},[k]));const T=(z=t.customAdditional)==null?void 0:z.bodyCell,R=T?T({column:b,record:e.record,rowIndex:e.rowIndex}):void 0,O=(E=(I=t.customTag)==null?void 0:I.bodyCell)!=null?E:"td",F=B==="expandable"?m("div",{class:`${o.value}-expandable-wrapper`},[cn(e,n,f,c,o.value),!et(k)&&m("span",{class:`${o.value}-expandable-trigger-gap`},null),k]):k;return m(O,ee({class:d.value,style:g.value,title:K},R),{default:()=>[F]})}}});function sn(e){return S(()=>{const{column:t,record:n}=e,l=ve(t.dataKey);if(l.length<=0)return;let o=n;for(let s=0;s<l.length&&o;s++){const r=l[s];o=o[r]}return o})}function rn(e,t,n){const{record:l,rowIndex:o,column:s}=e,{customCell:r}=s,a=U(r)?t[r]:r;return a?a({value:n,record:l,rowIndex:o}):n}function cn(e,t,n,l,o){var B;const{icon:s,customIcon:r,indent:a,showLine:i}=n.value,{record:u,expanded:c,level:f=0,hasPrevSibling:h,hasNextSibling:y,showLineIndentIndexList:v}=e,p=f>0,C=l.value&&i&&a;let x;const w=(B=U(r)?t[r]:r)!=null?B:s;J(w)?x=w({expanded:!!c,record:u}):x=U(w)?m(le,{name:w,rotate:c?90:0},null):w;const d=a?`width: ${N(a)}`:void 0,g={[`${o}-expandable-trigger`]:!0,[`${o}-expandable-trigger-show-line`]:C,[`${o}-expandable-trigger-disabled`]:e.disabled},b=[];if(a)for(let k=0;k<f;k++)b.push(m("div",{class:{[`${o}-expandable-indent`]:!0,[`${o}-expandable-indent-show-line`]:C&&v.includes(k)},style:d},null));return[...b,m("span",{class:g,style:d},[m("button",{class:`${o}-expandable-trigger-button`,type:"button",onClick:e.disabled?void 0:e.handleExpend},[x]),C&&[m("span",{class:`${o}-expandable-trigger-line-right`},null),(h||p)&&m("span",{class:`${o}-expandable-trigger-line-top`},null),y&&m("span",{class:`${o}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function un(e,t,n,l,o){const{record:s,rowIndex:r,selected:a,indeterminate:i,disabled:u,isHover:c,handleSelect:f}=e,{showIndex:h,multiple:y,customCell:v}=n.value,p=x=>{x.stopPropagation(),!y&&a&&!u&&f&&f()};if(!a&&!c&&h)return Ye(e,t,l.columnIndexable,o);const C=U(v)?t[v]:v;if(y){const x={checked:a,disabled:u,indeterminate:i,onChange:f,onClick:p};return C?C({...x,record:s,rowIndex:r}):m(ye,x,null)}else{const x={checked:a,disabled:u,onChange:f,onClick:p};return C?C({...x,record:s,rowIndex:r}):m(We,x,null)}}function Ye(e,t,n,l){const{record:o,rowIndex:s,disabled:r}=e,{customCell:a}=n,{pageIndex:i=1,pageSize:u=0}=l.value||{},c=U(a)?t[a]:a;return c?m("span",{style:r?"cursor: not-allowed":"cursor: pointer"},[c({record:o,rowIndex:s,pageIndex:i,pageSize:u})]):void 0}const dn=W({props:Jt,setup(e){const{props:t,mergedPrefixCls:n,flattedColumns:l,expandable:o,handleExpandChange:s,checkExpandDisabled:r,selectable:a,selectedRowKeys:i,indeterminateRowKeys:u,handleSelectChange:c,currentPageRowKeys:f}=H(A),{expandDisabled:h,handleExpend:y,selectDisabled:v,handleSelect:p,isHover:C,attrs:x}=fn(e,o,r,s,a,c,f),w=S(()=>i.value.includes(e.rowKey)),d=S(()=>u.value.includes(e.rowKey)),g=S(()=>{const b=`${n.value}-row`,{level:B,expanded:k}=e;return X({[`${b}`]:!0,[`${b}-level-${B}`]:!!B,[`${b}-selected`]:w.value,[`${b}-expanded`]:k})});return()=>{var K,T,R;const b=(K=t.customAdditional)==null?void 0:K.bodyRow,B=b?b({record:e.record,rowIndex:e.rowIndex}):void 0,k=(R=(T=t.customTag)==null?void 0:T.bodyRow)!=null?R:"tr";return m(k,ee({class:g.value},x.value,B),{default:()=>[hn(e,l,h,y,w,d,v,p,C)]})}}});function fn(e,t,n,l,o,s,r){const a=S(()=>n(e.rowData)),i=S(()=>{var g;return(g=t.value)==null?void 0:g.trigger}),u=()=>{const{rowKey:g,record:b}=e;l(g,b)},c=S(()=>r.value.disabledRowKeys.includes(e.rowKey)),f=S(()=>{var g;return(g=o.value)==null?void 0:g.trigger}),h=S(()=>{var g;return(g=o.value)==null?void 0:g.showIndex}),y=P(!1),v=()=>{const{rowKey:g,record:b}=e;s(g,b)},p=()=>{i.value==="click"&&u(),f.value==="click"&&v()},C=()=>{i.value==="dblclick"&&u(),f.value==="dblclick"&&v()},x=()=>y.value=!0,w=()=>y.value=!1,d=S(()=>{const g=a.value,b=i.value,B=c.value,k=f.value,K=!g&&b==="click"||!B&&k==="click",T=!g&&b==="dblclick"||!B&&k==="dblclick",R=!B&&h.value;let O="";return K||T?O="pointer":(g&&b||B&&k)&&(O="not-allowed"),{style:O?`cursor: ${O}`:void 0,onClick:K?p:void 0,onDblclick:T?C:void 0,onMouseenter:R?x:void 0,onMouseleave:R?w:void 0}});return{expandDisabled:a,handleExpend:u,selectDisabled:c,handleSelect:v,isHover:y,attrs:d}}function hn(e,t,n,l,o,s,r,a,i){const u=[],{rowIndex:c,record:f,level:h,hasNextSibling:y,hasPrevSibling:v,showLineIndentIndexList:p}=e;return t.value.forEach((C,x)=>{const{type:w,colSpan:d,rowSpan:g,key:b}=C,B=d==null?void 0:d(f,c),k=g==null?void 0:g(f,c);if(B===0||k===0)return;const K={colSpan:B===1?void 0:B,rowSpan:k===1?void 0:k,rowIndex:c,colIndex:x,record:f,column:C,level:h,hasNextSibling:y,hasPrevSibling:v,showLineIndentIndexList:p,key:b};w==="expandable"?(K.expanded=e.expanded,K.disabled=n.value,K.handleExpend=l):w==="selectable"&&(K.selected=o.value,K.indeterminate=s.value,K.disabled=r.value,K.handleSelect=a,K.isHover=i.value),u.push(m(an,K,null))}),u}function Ze(e,t,n,l,o){const{children:s,expanded:r,level:a,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,record:f,rowKey:h}=e,y={key:h,expanded:r,level:a,hasPrevSibling:i,hasNextSibling:u,showLineIndentIndexList:c,hasChildren:!!(s!=null&&s.length),record:f,rowData:e,rowIndex:t,rowKey:h},v=m(dn,y,null),p=r&&vn(y,n,l,o);return p?[v,p]:v}function vn(e,t,n,l){const{customExpand:o}=n||{},{record:s,rowIndex:r}=e;let a;return J(o)?a=o({record:s,rowIndex:r}):U(o)&&t[o]&&(a=t[o]({record:s,rowIndex:r})),a&&m(he,{class:`${l}-expanded-row`},{default:()=>[a]})}const ie=W({setup(e,{slots:t}){const{props:n,slots:l,mergedPrefixCls:o,mergedAutoHeight:s,flattedData:r,expandable:a,scrollWidth:i,scrollHeight:u,isSticky:c}=H(A),f=S(()=>s.value||i.value||u.value||c.value);return()=>{const h=o.value,y=[];l.alert&&y.push(m(he,{class:`${h}-alert-row`},{default:()=>[l.alert()]}));const v=r.value;return v.length>0?t.default?y.push(...t.default()):v.forEach((p,C)=>{y.push(...ve(Ze(p,C,l,a.value,h)))}):y.push(m(he,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[m(tt,{empty:n.empty},l)]})),m("tbody",{class:`${o.value}-tbody`},[f.value&&m(on,null,null),y])}}}),yn=W({props:tn,setup(e){const{slots:t,config:n,locale:l,mergedPrefixCls:o}=H(A),s=S(()=>{var d;return(d=e.filterable.multiple)!=null?d:n.columnBase.filterable.multiple}),r=S(()=>{var d;return(d=e.filterable.footer)!=null?d:n.columnBase.filterable.footer}),a=e.activeFilterBy,[i,u]=re(()=>a);_(()=>e.activeFilterBy,d=>u(d));const[c,f]=re(!1),h=d=>{f(d),d||e.onUpdateFilterBy(i.value)},y=()=>{f(!1),e.onUpdateFilterBy(i.value)},v=()=>{u(a)},p=d=>{const g=`${o.value}-filterable-menu-label`,b=s.value?ye:We;return m("span",{class:g},[m(b,{checked:d.selected,disabled:d.disabled},null),m("span",{class:`${g}-content`},[d.label])])},C=()=>{const d=[],{customMenu:g,menus:b}=e.filterable;return J(g)?d.push(g({selectedKeys:i.value,setSelectedKeys:u})):U(g)&&t[g]?d.push(t[g]({selectedKeys:i.value,setSelectedKeys:u})):d.push(gn(b,s,i,u,p)),r.value&&d.push(pn(l,o,y,v)),d},x=S(()=>{const d=`${o.value}-filterable-trigger`;return X({[d]:!0,[`${d}-active`]:e.activeFilterBy.length>0})}),w=()=>{const{customTrigger:d}=e.filterable;return J(d)?d():U(d)&&t[d]?t[d]():m("span",{class:x.value,onClick:g=>g.stopPropagation()},[m(le,{name:"filter-filled"},null)])};return()=>{const d={visible:c.value,hideOnClick:!r.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return m(Ie,d,{default:w,overlay:C})}}}),gn=(e,t,n,l,o)=>{const s={dataSource:e,multiple:t.value,selectable:!0,selectedKeys:n.value,"onUpdate:selectedKeys":l};return m(Ee,s,{itemLabel:o})},pn=(e,t,n,l)=>{const{filterConfirm:o,filterReset:s}=e.table;return m("div",{class:`${t.value}-filterable-trigger-footer`},[m(Se,{mode:"primary",size:"xs",onClick:n},{default:()=>[o]}),m(Se,{size:"xs",onClick:l},{default:()=>[s]})])},mn=W({setup(){const{mergedPrefixCls:e,paginatedMap:t,selectable:n,currentPageRowKeys:l,currentPageAllSelected:o,currentPageSomeSelected:s,handleHeadSelectChange:r,mergedSelectableMenus:a,handleSelectableMenuClick:i}=H(A),u=S(()=>{const C=t.value.size;return C===0||C===l.value.disabledRowKeys.length}),[c,f]=re(!1),h={"onUpdate:visible":f,trigger:"click"},y=()=>m(Ee,{dataSource:a.value,onClick:i},null),v=()=>m(le,{class:`${e.value}-selectable-trigger`,name:"down",rotate:c.value?180:0},null),p=()=>{if(a.value.length!==0)return m(Ie,h,{default:v,overlay:y})};return()=>{const{multiple:C}=n.value;if(C)return m("span",{class:`${e.value}-cell-triggers`},[m(ye,{checked:o.value,indeterminate:s.value,disabled:u.value,onChange:r},null),p()])}}}),bn=W({props:nn,setup(e){const{locale:t,mergedPrefixCls:n}=H(A);return()=>{const{activeOrderBy:l,sortable:o}=e,{orders:s,nextTooltip:r}=o,a=r&&Sn(t.table,s,l),i=xn(n,s,l);return a?m(nt,{title:a},{default:()=>[i]}):i}}});function Sn(e,t,n){const l=n?t[t.indexOf(n)+1]:t[0],{sortCancel:o,sortAsc:s,sortDesc:r}=e;return l?l==="ascend"?s:r:o}function xn(e,t,n){const l=e.value,o=`${l}-sortable-trigger-active`,s=t.includes("ascend")&&m(le,{name:"caret-up-filled",class:n==="ascend"?o:void 0},null),r=t.includes("descend")&&m(le,{name:"caret-down-filled",class:n==="descend"?o:void 0},null);return m("span",{class:`${l}-sortable-trigger`},[s,r])}const Cn=W({props:Zt,setup(e){const{props:t,slots:n,mergedPrefixCls:l,fixedColumnKeys:o,columnOffsetsWithScrollBar:s,isSticky:r,handleSort:a,activeOrderByMap:i,activeFilterByMap:u,handleFilter:c}=H(A),f=S(()=>{const{type:w,ellipsis:d}=e.column,g=w||d!=null?d:t.ellipsis;return Pe(g)&&g.head===!1?void 0:g}),h=S(()=>{const{type:w,align:d,fixed:g,hasChildren:b,key:B,sortable:k,filterable:K}=e.column,T=l.value;let R={[`${T}-cell`]:!0,[`${T}-cell-${w}`]:!!w,[`${T}-cell-filterable`]:!!K,[`${T}-cell-sortable`]:!!k,[`${T}-cell-align-center`]:b||d==="center",[`${T}-cell-align-end`]:!b&&d==="end",[`${T}-cell-ellipsis`]:!!f.value};if(g){const{lastStartKey:O,firstEndKey:F}=o.value;R={...R,[`${T}-fix-start`]:g==="start",[`${T}-fix-start-last`]:O===B,[`${T}-fix-end`]:g==="end",[`${T}-fix-end-first`]:F===B,[`${T}-fix-sticky`]:r.value}}return X(R)}),y=S(()=>{const{fixed:w,colStart:d,colEnd:g}=e.column;if(!w)return;const{starts:b,ends:B}=s.value,T=N((w==="start"?b:B)[w==="start"?d:g]);return{position:"sticky",left:w==="start"?T:void 0,right:w==="end"?T:void 0}}),v=S(()=>i[e.column.key]),p=S(()=>u[e.column.key]||lt),C=w=>{const{key:d,filterable:g}=e.column;c(d,g,w)},x=()=>{const{key:w,sortable:d}=e.column;d&&a(w,d)};return()=>{var F,z,I;const{column:w}=e,{type:d,titleColSpan:g,titleRowSpan:b}=w;if(d==="scroll-bar")return m("th",{class:h.value,style:y.value,colspan:g===1?void 0:g,rowspan:b===1?void 0:b,onClick:x},null);const B=l.value;let k,K;if(d==="selectable")K=m(mn,null,null);else{const{title:E,customTitle:$,sortable:L,filterable:D}=w,q=f.value;K=wn(E,$,n),k=Ae(q,K,E);const j=Bn(L,v,D,p,C);j.length>0?K=m("span",{class:`${B}-cell-triggers`},[m("span",{class:`${B}-cell-title`},[K]),j]):q&&(K=m("span",{class:`${B}-cell-title`},[K]))}const T=(F=t.customAdditional)==null?void 0:F.headCell,R=T?T({column:w}):void 0,O=(I=(z=t.customTag)==null?void 0:z.headCell)!=null?I:"th";return m(O,ee({class:h.value,style:y.value,colSpan:g===1?void 0:g,rowSpan:b===1?void 0:b,title:k},R,{onClick:x}),{default:()=>[K]})}}});function wn(e,t,n){let l=e;return J(t)?l=t({title:e}):U(t)&&n[t]&&(l=n[t]({title:e})),l}function Bn(e,t,n,l,o){const s=[];return e&&s.push(m(bn,{activeOrderBy:t.value,sortable:e},null)),n&&s.push(m(yn,{activeFilterBy:l.value,filterable:n,onUpdateFilterBy:o},null)),s}const kn=W({props:Yt,setup(e){const{props:t,mergedPrefixCls:n}=H(A);return()=>{var a,i,u;const{columns:l}=e,o=(a=t.customAdditional)==null?void 0:a.headRow,s=o?o({columns:l}):void 0,r=(u=(i=t.customTag)==null?void 0:i.headRow)!=null?u:"tr";return m(r,ee({class:`${n.value}-row`},s),{default:()=>[l.filter(c=>c.titleColSpan!==0).map(c=>m(Cn,{key:c.key,column:c},null))]})}}}),ke=W({setup(){const{props:e,mergedRows:t,mergedPrefixCls:n}=H(A);return()=>{var a,i,u;const l=t.value,o=(a=e.customAdditional)==null?void 0:a.head,s=o?o({rows:l}):void 0,r=(u=(i=e.customTag)==null?void 0:i.head)!=null?u:"thead";return m(r,ee({class:`${n.value}-thead`},s),{default:()=>[l.map((c,f)=>m(kn,{key:f,columns:c},null))]})}}}),Kn=W({setup(){const{props:e,slots:t,expandable:n,mergedPrefixCls:l,mergedVirtualItemHeight:o,mergedAutoHeight:s,columnWidths:r,changeColumnWidth:a,flattedData:i,isSticky:u,mergedSticky:c,virtualScrollRef:f,scrollBodyRef:h,scrollContentRef:y,handleScroll:v,pingedStart:p,pingedEnd:C,scrollWidth:x,scrollHeight:w,hasFixed:d,tableLayout:g}=H(A),b=P(),B=P(0);He(me,{mainTableWidth:B,changeColumnWidth:(I,E)=>{rt(b.value)&&a(I,E)}});const K=()=>{const I=V(h);I&&v({currentTarget:I})},T=I=>{const{offsetWidth:E}=I.target;E!==B.value&&(B.value=E)};ce(()=>{K(),_([()=>e.dataSource,x],([,E])=>{E&&K()}),_(r,Re(()=>{var $;(($=V(h))==null?void 0:$.scrollLeft)===0&&K()},16)),ot(b.value,T)}),Q(()=>at(b.value,T));const R=S(()=>{const I=l.value;return X({[`${I}-container`]:!0,[`${I}-ping-start`]:p.value,[`${I}-ping-end`]:C.value,[`${I}-fixed-layout`]:g.value==="fixed",[`${I}-fixed-column`]:d.value,[`${I}-scroll-horizontal`]:x.value,[`${I}-scroll-vertical`]:w.value})}),O=S(()=>{var q;const I=x.value,E=w.value,$=I?"auto":void 0,L=e.virtual?"hidden":E?"scroll":I?"hidden":void 0,D=(q=e.scroll)==null?void 0:q.fullHeight;return{overflowX:$,overflowY:L,[D?"height":"maxHeight"]:E}}),F=S(()=>({tableLayout:g.value,width:x.value,minWidth:x.value?"100%":void 0})),z=(I,E,$)=>{M(e.onScrolledChange,I,E,$.map(L=>L.record))};return()=>{const I=l.value,E=s.value,$=t.default?t.default():[];if(E||w.value||u.value){const{offsetTop:L}=c.value;if(e.headless||$.push(m(qt,{offsetTop:L},{default:()=>[m(ke,null,null)]})),e.virtual&&(e.scroll||E)){const D=({item:G,index:oe})=>Ze(G,oe,t,n.value,I),q=G=>m("table",{ref:y,class:`${I}-table`,style:F.value},[m(se,null,null),m(ie,null,{default:()=>[G]}),!1]),{scroll:j,onScrolledBottom:te}=e;$.push(m(st,{ref:f,style:O.value,dataSource:i.value,fullHeight:j==null?void 0:j.fullHeight,getKey:"rowKey",height:s.value?"100%":j==null?void 0:j.height,itemHeight:o.value,itemRender:D,contentRender:q,virtual:!0,onScroll:v,onScrolledBottom:te,onScrolledChange:z},null))}else $.push(m("div",{ref:h,class:`${I}-content`,style:O.value,onScroll:v},[m("table",{ref:y,class:`${I}-table`,style:F.value},[m(se,null,null),m(ie,null,null),!1])]));u.value&&$.push(m(Xt,null,null))}else $.push(m("div",{ref:h,class:`${I}-content`,style:O.value,onScroll:v},[m("table",{ref:y,class:`${I}-table`,style:F.value},[m(se,null,null),!e.headless&&m(ke,null,null),m(ie,null,null),!1])]));return m("div",{ref:b,class:R.value},[$])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tn(e,t){return e.footer?m("div",{class:`${t}-footer`},[e.footer()]):null}function $n(e,t,n,l){var r,a;let o=null,s=null;if(t!==null){const{position:i}=t,[u,c]=pt(i).split("-"),f=`${l}-pagination ${l}-pagination-${c}`,h=(a=(r=e.pagination)==null?void 0:r.call(e,{total:n.length,...t}))!=null?a:m(bt,ee({class:f,total:n.length},t),null);o=u==="top"?h:null,s=u==="bottom"?h:null}return[o,s]}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ke(e){const{fontSizeSm:t,heightMd:n,heightLg:l,height2xl:o,paddingSizeSm:s,paddingSizeMd:r,paddingSizeLg:a,colorTextTitleSecondary:i,colorEmphasizedContainerBg:u,colorBorder:c,colorIconInfo:f,colorPrimary:h,colorContainerBg:y,colorContainerBgDisabled:v,colorInfoContainerBg:p}=e;return{fontSizeSm:t,fontSizeMd:t,fontSizeLg:t,headRowHeightSm:n,headRowHeightMd:n,headRowHeightLg:n,bodyRowHeightSm:n,bodyRowHeightMd:l,bodyRowHeightLg:o,rowPaddingHorizontalSm:s,rowPaddingHorizontalMd:r,rowPaddingHorizontalLg:a,headColor:i,headBgColor:u,headSeparatorColor:c,headIconColor:f,headIconColorActive:h,headIconBgColorHover:v,bodyRowBgColorHover:p,bodyRowBgColorSelected:y,expandableIconColor:f}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const In=(e,t)=>Ke(e),En={sm:32,md:40,lg:56},Pn=W({name:"IxTable",props:Gt,setup(e,{expose:t,slots:n}){const l=ae("common"),{globalHashId:o,hashId:s,registerToken:r}=ct("table");r(In);const a=S(()=>`${l.prefixCls}-table`),i=ae("locale"),u=ae("table"),c=S(()=>{var $;return($=e.autoHeight)!=null?$:u.autoHeight}),f=S(()=>{var $;return($=e.childrenKey)!=null?$:u.childrenKey}),h=it(e,u),y=S(()=>{var $;return($=e.emptyCell)!=null?$:u.emptyCell}),v=S(()=>{var $;return($=e.size)!=null?$:u.size}),p=S(()=>{var $;return($=e.virtualItemHeight)!=null?$:En[v.value]}),{mergedPagination:C}=Pt(e,u,v),x=jt(e),w=Rt(e,c,x),d=xt(e,n,u,w.scrollBarSizeOnFixedHolder),g=Dt(d.flattedColumns),b=Et(d.flattedColumns),B=It(e,d.flattedColumns),k=Ut(e,d,w,x.isSticky,c),{activeSorters:K}=g,{activeFilters:T}=b,R=$t(e,f,h,K,T,B.expandedRowKeys,C),O=Lt(e,i,d.flattedColumns,R);Wt(e,u,C,K,T,w.scrollTo);const F={props:e,slots:n,config:u,locale:i,mergedPrefixCls:a,mergedEmptyCell:y,mergedVirtualItemHeight:p,mergedAutoHeight:c,...d,...w,...g,...b,...x,tableLayout:k,mergedPagination:C,...B,...R,...O};He(A,F),t({scrollTo:w.scrollTo});const{flattedData:z,filteredData:I}=R,E=S(()=>{const $=a.value,{borderless:L=u.borderless,scroll:D}=e;return X({[o.value]:!!o.value,[s.value]:!!s.value,[$]:!0,[`${$}-auto-height`]:c.value,[`${$}-borderless`]:L,[`${$}-empty`]:z.value.length===0,[`${$}-full-height`]:D==null?void 0:D.fullHeight,[`${$}-${v.value}`]:!0})});return()=>{const $=a.value,L=m(ut,{header:e.header},n),D=Tn(n,$),[q,j]=$n(n,C.value,I.value,$),te=[L],G=[q,m(Kn,null,null),D,j].filter(Boolean),oe=Rn(e.spin);return oe?te.push(m(dt,oe,{default:()=>[G]})):te.push(...G),m("div",{class:E.value},[te])}}});function Rn(e){return mt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const An=Pn,Ln=pe;export{An as I,Ln as a,St as g,Gt as t};
