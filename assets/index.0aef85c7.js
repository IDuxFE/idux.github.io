import{ab as ne,j as P,af as te,ar as le,u as X,ad as fe,l as ve,B as ye,as as he,at as ge,aa as pe,\u0275 as me,au as be,av as Se,aw as xe,p as Ce,q as Ke,G as Ie,H as Ee,ax as Le,ay as we}from"./index.f300137b.js";import{e as i,k as N,b as re,a as Ae,t as Fe,v as T,y as E,a1 as _,i as J,z as Q,w as oe,p as Oe}from"./vendor.6b73f509.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $e(e,t){const[n,l]=ne(void 0),o=i(()=>{const a=n.value;return a!==void 0?t.value.get(a):void 0});return{activeKey:n,activeData:o,setActiveKey:l}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Be(e,t,n,l,o){const a=i(()=>se(e,t.value,n.value,l.value,o.value,e.dataSource)),s=i(()=>{const v=new Map;return Y(v,a.value),v});return{mergedData:a,mergedDataMap:s}}function se(e,t,n,l,o,a,s,v){const{loadChildren:f}=e;return a.map(y=>ce(y,t,n,l,o,!!f,s,v))}function ce(e,t,n,l,o,a,s,v){var S;const f=t(e),y=o&&!N(v)?`${v}/${e[l]}`:e[l],m=e[n],h=m==null?void 0:m.map(u=>ce(u,t,n,l,o,a,f,y));return{children:h,key:f,isLeaf:(S=e.isLeaf)!=null?S:!((h==null?void 0:h.length)||a),label:y,parentKey:s,rawData:e}}function Y(e,t){t.forEach(n=>{const{key:l,children:o}=n;e.set(l,n),o&&Y(e,o)})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ne(e,t,n){if(n){const l=[],o=e.value;t.forEach(a=>{const s=o.get(a);s&&l.push(s.rawData)}),P(n,t,l)}}function Z(e,t){if(!e||!e.children)return[];const n=[];return e.children.forEach(l=>{const{key:o,rawData:a}=l;(!t||!a.disabled)&&(n.push(o),n.push(...Z(l,t)))}),n}function V(e,t,n){const l=[];for(;t&&!N(t.parentKey);){const{parentKey:o,rawData:a}=t;!n||!a.disabled?(l.unshift(o),t=e.get(o)):t=void 0}return l}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pe(e,t,n,l,o,a){const[s,v]=te(e,"expandedKeys",()=>[]),[f,y]=te(e,"loadedKeys",()=>[]),m=re([]),h=async u=>{const{loadChildren:g}=e;if(m.value.includes(u))return;const r=a.value.get(u);if(r&&(!r.children||r.children.length===0)){if(!g||f.value.includes(u))return;m.value.push(u);const p=r.rawData,b=await g(p);m.value.splice(m.value.indexOf(u),1);const L=a.value;if(b.length){const A=n.value,w=se(e,t.value,A,l.value,o.value,b,u,r.label);Y(L,w),r.rawData[A]=b,r.children=w;const K=[...f.value,u];y(K),P(e.onLoaded,K,p)}else return}const I=s.value.indexOf(u)>=0;if(!I){const p=a.value,b=V(p,p.get(u),!1);b.push(u),S(b,!I,r.rawData)}},S=(u,g,c)=>{v(u);const{onExpand:r,onExpandedChange:x}=e;P(r,g,c),Ne(a,u,x)};return{expandedKeys:s,handleExpand:h,loadingKeys:m}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Me(e,t,n,l){const o=De(e,t),a=i(()=>e.multiple||e.strategy==="off"),s=i(()=>{const f=l.value,y=o.value;if(!f||!y)return le;const m=a.value,h=new Set;return n.value.forEach(S=>{const{key:u,rawData:g}=S;h.has(u)||y(g,f)&&((m||S.isLeaf)&&h.add(u),ue(h,S,m))}),[...h]});return{searchedData:i(()=>{const f=n.value;return s.value.map(y=>f.get(y)).filter(Boolean)})}}function De(e,t){return i(()=>{const n=e.searchFn;return Ae(n)?n:n?ke(t.value):!1})}function ke(e){return(t,n)=>{const l=t[e];return l?l.toLowerCase().includes(n.toLowerCase()):!1}}function ue(e,t,n){!t||!t.children||t.children.forEach(l=>{l.rawData.disabled||e.has(l.key)||((n||l.isLeaf)&&e.add(l.key),ue(e,l,n))})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,t,n,l){const o=X("locale"),a=i(()=>{const c=fe(t.value);if(!l.value)return c;if(!e.multiple){const r=c[c.length-1];return N(r)?[]:[r]}return c.map(r=>r[r.length-1]).filter(r=>!N(r))}),s=i(()=>a.value.length>=e.multipleLimit),v=i(()=>s.value?o.select.limitMessage.replace("${0}",`${e.multipleLimit}`):""),f=i(()=>{const c=n.value;return a.value.map(r=>c.get(r)).filter(Boolean)}),y=i(()=>e.multiple&&e.strategy!=="off"),m=i(()=>y.value?Ve(n.value,a.value):a.value),h=i(()=>{if(!y.value)return le;const c=new Set,r=m.value,x=n.value;return r.forEach(I=>{let p=x.get(I);for(;p&&!N(p.parentKey);){const b=p.parentKey,L=x.get(b);L&&!L.rawData.disabled&&!r.includes(b)&&c.add(b),p=L}}),[...c]}),S=c=>{let r;if(!l.value)r=e.multiple?c:c[0];else if(e.multiple){const I=n.value;r=c.map(p=>{const b=V(I,I.get(p),!0);return b.push(p),b})}else{const I=c[0],p=n.value;r=V(p,p.get(I),!0),r.push(I)}const x=Fe(t.value);r!==x&&(t.setValue(r),P(e.onChange,r,x))};return{selectedKeys:a,selectedLimit:s,selectedLimitTitle:v,selectedData:f,selectedWithStrategyKeys:m,indeterminateKeys:h,handleSelect:c=>{const{multiple:r}=e,x=m.value,p=x.indexOf(c)>-1;if(!r){!p&&S([c]);return}const b=n.value,L=b.get(c),A=y.value,w=A?Z(L,!0):[],K=new Set(x);p||w.length>0&&w.every(F=>K.has(F)||h.value.includes(F))?(K.delete(c),A&&(V(b,L,!0).forEach(F=>K.delete(F)),w.forEach(F=>K.delete(F)))):(K.add(c),A&&(de(b,L,K),w.forEach(F=>K.add(F)))),S([..._e(b,K,e.strategy)])},handleClear:c=>{c.stopPropagation(),S([]),P(e.onClear,c)}}}function Ve(e,t){const n=new Set(t);let l;return t.forEach(o=>{const a=e.get(o);if(!a)return;const{parentKey:s}=a;Z(a,!0).forEach(f=>n.add(f)),s&&l!==s&&(de(e,a,n),l=s)}),[...n]}function de(e,t,n){let l=!0;for(;l&&t&&!N(t.parentKey);){const o=t.parentKey,a=e.get(o);a&&!t.rawData.disabled&&(l=a.children.every(s=>s.rawData.disabled||n.has(s.key)),l&&n.add(t.parentKey)),t=a}}function _e(e,t,n){if(n==="parent"){const l=new Set;return t.forEach(o=>{const a=e.get(o);if(a){const{key:s,parentKey:v}=a;(!v||!t.has(v))&&l.add(s)}}),l}if(n==="child"){const l=new Set;return t.forEach(o=>{const a=e.get(o);a&&a.isLeaf&&l.add(a.key)}),l}return t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const z=Symbol("cascaderToken"),Te=T({props:{children:{type:Array,default:void 0},index:{type:Number,required:!0},isLeaf:{type:Boolean,required:!0},label:{type:String,required:!0},parentKey:{type:[String,Number,Symbol],default:void 0},rawData:{type:Object,required:!0}},setup(e){const t=ve(),{props:n,slots:l,mergedPrefixCls:o,mergedExpandIcon:a,mergedLabelKey:s,inputValue:v,activeKey:f,setActiveKey:y,expandedKeys:m,setOverlayOpened:h,loadingKeys:S,selectedKeys:u,selectedLimit:g,selectedLimitTitle:c,indeterminateKeys:r,handleSelect:x,handleExpand:I}=J(z),p=i(()=>t===f.value),b=i(()=>e.rawData.disabled),L=i(()=>m.value.includes(t)),A=i(()=>S.value.includes(t)),w=i(()=>u.value.includes(t)),K=i(()=>r.value.includes(t)),F=i(()=>{const C=`${o.value}-option`;return Q({[C]:!0,[`${C}-leaf`]:e.isLeaf,[`${C}-active`]:p.value,[`${C}-disabled`]:b.value,[`${C}-expanded`]:L.value,[`${C}-loading`]:A.value,[`${C}-selected`]:w.value})}),G=()=>{if(e.isLeaf){if(!w.value&&g.value)return;x(t),h(!1)}else n.strategy==="off"&&x(t),n.expandTrigger==="click"&&I(t)},H=C=>{C.stopPropagation(),x(t)},U=()=>{y(t),!e.isLeaf&&n.expandTrigger==="hover"&&I(t)};return()=>{const{rawData:C,label:D}=e,{multiple:O}=n,$=b.value,B=w.value,M=`${o.value}-option`,k=v.value,R=k?D:C[s.value],q=!($||B)&&c.value||R,j=n.customAdditional?n.customAdditional({data:C,index:e.index}):void 0;return E("div",_({class:F.value,title:q,onClick:$?void 0:G,onMouseenter:$?void 0:U,"aria-label":D,"aria-selected":B},j),[O&&E(ye,{checked:B,disabled:$||!B&&g.value,indeterminate:K.value,onClick:H},null),E("span",{key:"__label",class:`${M}-label`},[ze(l.optionLabel,R,C,k,M)]),!e.isLeaf&&E("span",{key:"__expand-icon",class:`${M}-expand-icon`},[he(l.expandIcon,A.value?"loading":a.value,{key:t,expanded:L.value,data:C})])])}}});function ze(e,t,n,l,o){if(e)return e({label:t,data:n,searchValue:l});if(t&&l){const a=t.toUpperCase().indexOf(l.toUpperCase());if(a>-1){const s=a+l.length,v=t.substring(0,a),f=t.substring(s),y=E("span",{class:`${o}-label-highlight`},[t.substring(a,s)]);return[v,y,f]}}return t}const ae=T({props:{dataSource:{type:Array,required:!0}},setup(e){const{props:t,slots:n,mergedPrefixCls:l}=J(z),o=i(()=>{const a=`${l.value}-option-group`;return Q({[a]:!0,[`${a}-empty`]:e.dataSource.length===0})});return()=>{const{dataSource:a}=e;let s;if(a.length>0){const{overlayHeight:v,overlayItemHeight:f,virtual:y}=t;s=E(pe,{dataSource:a,getKey:"key",height:v,itemHeight:f,itemRender:({item:h,index:S})=>E(Te,_({index:S},h),null),virtual:y},null)}else s=E(ge,{empty:t.empty},n);return E("div",{class:o.value},[s])}}}),Ge=T({setup(){const{props:e,mergedPrefixCls:t,mergedClearIcon:n,mergedData:l,mergedDataMap:o,searchedData:a,expandedKeys:s,inputValue:v,setInputValue:f,updateOverlay:y}=J(z),m=i(()=>{const u=[l.value],g=o.value;return s.value.forEach(c=>{const r=g.get(c);r&&r.children&&u.push(r.children)}),u});oe([()=>m.value.length,v],()=>{y()});const h=u=>{const{value:g}=u.target;f(g),e.searchable&&P(e.onSearch,g)},S=()=>f("");return()=>{const{overlayRender:u}=e,g=v.value,c=t.value,r=[];e.searchable==="overlay"&&r.push(E("div",{key:"__search-wrapper",class:`${c}-overlay-search-wrapper`},[E(me,{clearable:!0,clearIcon:n.value,clearVisible:!!g,size:"sm",suffix:"search",value:g,onClear:S,onInput:h},null)]));const x=g?E(ae,{dataSource:a.value},null):m.value.map((I,p)=>E(ae,{key:p,dataSource:I},null));return r.push(E("div",{key:"__content",class:`${c}-overlay-content`},[x])),E("div",null,[u?u(r):r])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const He={control:{type:[String,Number,Object],default:void 0},value:{type:null,default:void 0},expandedKeys:{type:Array,default:void 0},loadedKeys:{type:Array,default:void 0},open:{type:Boolean,default:void 0},autocomplete:{type:String,default:"off"},autofocus:{type:Boolean,default:!1},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},clearable:{type:Boolean,default:!1},clearIcon:{type:String,default:void 0},customAdditional:{type:Function,default:void 0},dataSource:{type:Array,default:()=>[]},disabled:{type:Boolean,default:!1},empty:{type:[String,Object],default:"simple"},expandIcon:{type:String,default:void 0},expandTrigger:{type:String,default:"click"},fullPath:{type:Boolean,default:void 0},getKey:{type:[String,Function],default:void 0},labelKey:{type:String,default:void 0},loadChildren:{type:Function,default:void 0},maxLabel:{type:[Number,String],default:Number.MAX_SAFE_INTEGER},multiple:{type:Boolean,default:!1},multipleLimit:{type:Number,default:Number.MAX_SAFE_INTEGER},overlayClassName:{type:String,default:void 0},overlayContainer:{type:[String,HTMLElement,Function],default:void 0},overlayMatchWidth:{type:Boolean,default:void 0},overlayRender:{type:Function,default:void 0},placeholder:{type:String,default:void 0},readonly:{type:Boolean,default:!1},searchable:{type:[Boolean,String],default:!1},searchFn:{type:[Boolean,Function],default:!0},size:{type:String,default:void 0},status:String,strategy:{type:String,default:"all"},suffix:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:value":[Function,Array],"onUpdate:expandedKeys":[Function,Array],"onUpdate:loadedKeys":[Function,Array],"onUpdate:open":[Function,Array],onChange:[Function,Array],onClear:[Function,Array],onExpand:[Function,Array],onExpandedChange:[Function,Array],onLoaded:[Function,Array],onSearch:[Function,Array],overlayHeight:{type:Number,default:256},overlayItemHeight:{type:Number,default:32}},Ue=[0,4],qe=T({name:"IxCascader",inheritAttrs:!1,props:He,setup(e,{attrs:t,expose:n,slots:l}){const o=X("common"),a=X("cascader"),s=i(()=>`${o.prefixCls}-cascader`),v=be(e,a,o,s),f=i(()=>{var d;return(d=e.childrenKey)!=null?d:a.childrenKey}),y=i(()=>{var d;return(d=e.clearIcon)!=null?d:a.clearIcon}),m=i(()=>{var d;return(d=e.expandIcon)!=null?d:a.expandIcon}),h=i(()=>{var d;return(d=e.fullPath)!=null?d:a.fullPath}),S=Se(e,a),u=i(()=>{var d;return(d=e.labelKey)!=null?d:a.labelKey}),g=re(),[c,r]=ne(""),x=()=>{var d;return(d=g.value)==null?void 0:d.focus()},I=()=>{var d;return(d=g.value)==null?void 0:d.blur()},p=()=>{var d;e.searchable==="overlay"?r(""):(d=g.value)==null||d.clearInput()};n({focus:x,blur:I});const{overlayRef:b,updateOverlay:L,overlayOpened:A,setOverlayOpened:w}=xe(e,a,g),{accessor:K,control:F}=Ce();Ke(F);const G=Ie(e,a),H=Ee(e,F),{mergedData:U,mergedDataMap:C}=Be(e,S,f,u,h),D=$e(e,C),O=Re(e,K,C,h),{searchedData:$}=Me(e,u,C,c),B=Pe(e,S,f,u,h,C);oe(A,d=>{d&&x(),p()});const M=()=>{e.searchable!=="overlay"&&x()},k=()=>K.markAsBlurred(),R=d=>{x(),O.handleSelect(d)};Oe(z,{props:e,slots:l,config:a,mergedPrefixCls:s,mergedChildrenKey:f,mergedClearIcon:y,mergedExpandIcon:m,mergedFullPath:h,mergedGetKey:S,mergedLabelKey:u,accessor:K,inputValue:c,setInputValue:r,overlayOpened:A,setOverlayOpened:w,updateOverlay:L,mergedData:U,mergedDataMap:C,...D,...O,searchedData:$,...B});const q=i(()=>{const{overlayClassName:d,multiple:W}=e,ee=s.value;return Q({[`${ee}-overlay`]:!0,[`${ee}-overlay-multiple`]:W,[d||""]:!!d})}),j=()=>E(we,_({ref:g,className:s.value,allowInput:!1,autocomplete:e.autocomplete,autofocus:e.autofocus,borderless:e.borderless,clearable:e.clearable,clearIcon:e.clearIcon,config:a,dataSource:O.selectedData.value,disabled:K.disabled,maxLabel:e.maxLabel,multiple:e.multiple,opened:A.value,placeholder:e.placeholder,readonly:e.readonly,searchable:e.searchable,size:G.value,status:H.value,suffix:e.suffix,value:O.selectedKeys.value,onBlur:k,onClear:O.handleClear,onInputValueChange:r,onItemRemove:R,onOpenedChange:w,onResize:L,onSearch:e.onSearch},t),l),ie=()=>E(Ge,{onClick:M},null);return()=>{const d={class:q.value,clickOutside:!0,container:v.value,disabled:K.disabled||e.readonly,offset:Ue,placement:"bottomStart",trigger:"manual",triggerId:t.id,visible:A.value,"onUpdate:visible":w},W={default:j,content:ie};return E(Le,_({ref:b},d),W)}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Xe=qe;export{Xe as I};
