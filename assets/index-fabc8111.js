import{M as Be,N as fe,aN as Qe,am as ke,m as M,L as le,aH as D,aO as ce,o as X,D as ie,a2 as Je,K as oe,a1 as ee,$ as G,a3 as pe,aP as Ze,A as te,j as he,ar as et,X as Ke,W as $e,c as me,aa as tt,ap as lt,E as nt,G as ot,H as st,aQ as at,as as rt,ao as ct,aC as it}from"./index-9308d97a.js";import{b as Ee,f as L,N as ut,T as dt,c as S,m as ve,r as P,w as z,a9 as Te,H as Ie,d as Y,Q as J,y as se,bk as ft,S as ht,x as A,l as H,z as V,A as b,ag as vt,i as Q,a4 as Z,q as Pe,$ as yt,an as gt}from"./vendor-63a43443.js";import{b as Oe}from"./GlobalCodeBox-ae858526.js";import{I as pt}from"./index-279d5455.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const We=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[We]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Re(e,l,t){if(!e||Ee(e)&&e.title===!1)return;if(L(l)||ut(l))return l;const n=Be(l).find(o=>o.type===dt);return n?n.children:t}function mt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Qe("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function bt(e,l,t,n){const o=S(()=>{var B;const{columns:x}=e;return Fe(x&&x.length>0?x:He((B=l.default)==null?void 0:B.call(l)),t)}),{flattedColumns:r,scrollBarColumn:a,flattedColumnsWithScrollBar:s}=xt(o,n),c=Ct(s),u=S(()=>!!e.ellipsis||r.value.some(x=>x.ellipsis)),i=S(()=>r.value.some(x=>x.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y}=wt(r,a),{columnOffsets:v,columnOffsetsWithScrollBar:p}=Bt(d,h),C=S(()=>kt(o.value,a.value));return{flattedColumns:r,scrollBarColumn:a,flattedColumnsWithScrollBar:s,fixedColumnKeys:c,hasEllipsis:u,hasFixed:i,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:y,columnOffsets:v,columnOffsetsWithScrollBar:p,mergedRows:C}}function Fe(e,l){return e.map(t=>St(t,l))}function He(e){const l=[];return Be(e,{key:We}).forEach((t,n)=>{const{props:o,children:r}=t,{key:a=n,editable:s,ellipsis:c,...u}=o||{};u.key=a,u.editable=s||s==="",u.ellipsis=c||c==="";const{default:i,cell:d,title:h,expand:y,icon:v}=r||{};i&&(u.children=He(i())),d&&(u.customCell=d),h&&(u.customTitle=h),y&&(u.customExpand=y),v&&(u.customIcon=v),l.push(u)}),l}function St(e,l){var c,u;const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:r}=l,{align:a=t.align}=e,s=mt(e);if("type"in e){const{type:i}=e;if(i==="expandable"){const{showLine:d=n.showLine,icon:h=n.icon}=e;return{...e,key:s,align:a,icon:h,showLine:d}}if(i==="selectable"){const{multiple:d=!0,showIndex:h=o.showIndex}=e;return{...e,key:s,align:a,multiple:d,showIndex:h}}if(i==="indexable"){const d=(u=(c=e.align)!=null?c:r.align)!=null?u:t.align;return{...r,...e,align:d,key:s}}return{...e,key:s,align:a}}else{const{sortable:i,filterable:d,children:h}=e,y={...e,key:s,align:a};return i&&(y.sortable={...t.sortable,...i}),d&&(y.filterable={...t.filterable,...d}),h!=null&&h.length&&(y.children=Fe(h,l)),y}}function xt(e,l){const t=S(()=>Ae(e.value)),n=S(()=>{const r=l.value;if(r===0)return;const a=t.value,s=a[a.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:s&&s.fixed,width:r}}),o=S(()=>{const r=t.value;if(r.length===0)return r;const a=n.value;return a?[...r,a]:r});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let r=Ae(o);n&&(r=r.map(a=>({fixed:n,...a}))),l.push(...r)}else l.push(t)}),l}function Ct(e){return S(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:r}=n;o==="start"?l=r:o==="end"&&(t||(t=r))}),{lastStartKey:l,firstEndKey:t}})}function wt(e,l){const t=ve({}),n=P(),o=P([]);z(n,Te(s=>{o.value=s?s.split("-").map(Number):[]},16)),Ie(()=>{const s=Object.keys(t),c=e.value;if(s.length!==c.length){n.value=void 0;return}n.value=c.map(u=>t[u.key]).join("-")});const r=S(()=>{const s=o.value;if(s.length===0)return s;const c=l.value;return c?[...s,c.width]:s});return{columnWidths:o,columnWidthsWithScrollBar:r,changeColumnWidth:(s,c)=>{c===!1?delete t[s]:t[s]=c}}}function Bt(e,l){const t=S(()=>be(e.value)),n=S(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,r=0;for(let a=0;a<l;a++){t[a]=o,o+=e[a]||0;const s=l-a-1;n[s]=r,r+=e[s]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(a,s,c){var d;(d=t[c])!=null||(t[c]=[]);let u=s;return a.map(h=>{var x;let y=(x=h.titleColSpan)!=null?x:1,v=!1;const p=h.children;if(p!=null&&p.length){v=!0;const B=n(p,u,c+1);Y(h.titleColSpan)&&(y=B.reduce((f,g)=>f+g))}const C=u+y-1;return t[c].push({...h,titleColSpan:y,colStart:u,colEnd:C,hasChildren:v}),u+=y,y})}const o=l?[...e,l]:e;n(o,0,0);const r=t.length;return t.forEach((a,s)=>{a.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-s)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l,t,n,o,r,a){const s=S(()=>{const p=l.value,C=t.value;return e.dataSource.map((x,B)=>Ne(x,C,p,B,e.dataSource.length))}),c=S(()=>{const p=new Map;return ue(s.value,p),p}),u=S(()=>_e(s.value,o.value,r.value)),i=S(()=>Me(u.value,n.value,r.value)),d=S(()=>{const p=a.value,C=i.value;if(p===null||!p.pageSize)return C;{const{total:x}=p;if(x&&C.length<x)return C;const B=p.pageSize,f=(p.pageIndex-1)*B;return C.slice(f,f+B)}}),h=S(()=>{const p=new Map;return ue(d.value,p),p}),y=S(()=>{const p=r.value;return p.length>0?De(d.value,p,0):d.value});return{isTreeData:S(()=>s.value.some(p=>{var C;return(C=p.children)==null?void 0:C.length})),filteredData:u,flattedData:y,mergedMap:c,paginatedMap:h}}function Ne(e,l,t,n,o,r){const a=l(e),s={record:e,rowKey:a,parentKey:r,hasPrevSibling:n>0,hasNextSibling:n<o-1},c=e[t];return c&&(s.children=c.map((u,i)=>Ne(u,l,t,i,c.length,a))),s}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function Me(e,l,t){const n=l.filter(a=>a.sorter),o=n.length;if(o===0)return e;const r=e.slice();return r.forEach(a=>{t.includes(a.rowKey)&&a.children&&a.children.length>0&&(a.children=Me(a.children,l,t))}),r.sort((a,s)=>{for(let c=0;c<o;c++){const{orderBy:u,sorter:i}=n[c],d=i(a.record,s.record);if(d!==0)return u==="ascend"?d:-d}return 0})}function _e(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const r=n.every(({filter:i,filterBy:d})=>i(d,o.record)),{rowKey:a,children:s}=o,c=t.includes(a);let u=o;if(c&&s&&s.length){const i=_e(s,l,t);i.length!==s.length&&(u={...o,children:i})}return r||c&&u.children&&u.children.length?u:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:r,parentKey:a,record:s,rowKey:c,hasPrevSibling:u,hasNextSibling:i}=o,d=l.includes(c);if(n.push({children:r,parentKey:a,record:s,rowKey:c,level:t,expanded:d,hasPrevSibling:u,hasNextSibling:i}),d&&o.children){const h=De(o.children,l,t+1);n.push(...h)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l){const t=S(()=>l.value.find(s=>"type"in s&&s.type==="expandable")),[n,o]=ke(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:s=>{if(!t.value)return!0;const{disabled:c,customExpand:u}=t.value,{record:i}=s;return c!=null&&c(i)?!0:!(u||s.children&&s.children.length>0)},handleExpandChange:(s,c)=>{const{onChange:u,onExpand:i}=t.value||{},d=[...n.value],h=d.indexOf(s),y=h>=0;y?d.splice(h,1):d.push(s),M(i,!y,c),o(d),M(u,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=S(()=>e.value.filter(r=>r.filterable)),t=ve({}),n=P([]);return z(l,(r,a)=>{r.forEach(s=>{const{key:c,filterable:u}=s,i=u.filterBy;if(i||t[c]===void 0){t[c]=i||[];return}const d=a?a.find(y=>y.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=Se(r,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(r,a,s)=>{const{onChange:c}=a;t[r]=s,n.value=Se(l.value,t),M(c,s,n.value)}}}function Se(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:r,filterBy:a=l[n]}=o;return{key:n,filter:r,filterBy:a}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t){var u,i,d,h,y;const n=le("pagination"),o=S(()=>{const{pagination:v}=e;return v===!1?null:v===!0?{}:v}),r=P((i=(u=o.value)==null?void 0:u.pageIndex)!=null?i:1),a=P((y=(h=(d=o.value)==null?void 0:d.pageSize)!=null?h:l.pagination.pageSize)!=null?y:n.pageSize),s=(v,p)=>{var C;r.value=v,a.value=p,M((C=o.value)==null?void 0:C.onChange,v,p)};return{mergedPagination:S(()=>{var p,C;const v=o.value;return v===null?null:{...l.pagination,size:t.value,...v,pageIndex:(p=v.pageIndex)!=null?p:r.value,pageSize:(C=v.pageSize)!=null?C:a.value,onChange:s}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function It(e,l,{setStickyScrollLeft:t}){const n=P(),o=P(),r=P(),a=P(),s=P();z(n,x=>{x&&(r.value=x.holderRef.value)});const{handleScroll:c,pingedStart:u,pingedEnd:i}=Pt(e,o,r,s,t),d=Ot(e,l,r,a),h=S(()=>{var x;return D((x=e.scroll)==null?void 0:x.width)}),y=S(()=>{var B;let x=D((B=e.scroll)==null?void 0:B.height);return!x&&l.value&&(e.virtual||d.value)&&(x="auto"),x}),v=S(()=>ce(X(r))),p=S(()=>y.value?v.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:r,scrollContentRef:a,scrollFootRef:s,handleScroll:c,scrollTo:x=>{var B;e.virtual?(B=n.value)==null||B.scrollTo(x):typeof x=="number"&&Je({target:X(r),top:x,duration:200})},pingedStart:u,pingedEnd:i,scrollWidth:h,scrollHeight:y,scrollBarSize:v,scrollBarSizeOnFixedHolder:p}}function Pt(e,l,t,n,o){const r=P(!1),a=P(!1);let s;const c=()=>{s&&(clearTimeout(s),s=void 0)};J(()=>c());const u=P(),i=v=>{u.value=v,c(),s=setTimeout(()=>{u.value=void 0,s=void 0},100)},d=(v,p)=>{p&&p.scrollLeft!==v&&(p.scrollLeft=v)},h=v=>{const p=X(t);if(!p)return;const{clientWidth:C,scrollWidth:x}=p;o(v/x*C||0)};return{handleScroll:(v,p)=>{const C=v==null?void 0:v.currentTarget,x=p!=null?p:C.scrollLeft,B=u.value;if((!B||B===C)&&(i(C),d(x,l.value),d(x,X(t)),d(x,n.value),h(x)),C){const{scrollWidth:f,clientWidth:g}=C;r.value=x>0,a.value=x<f-g}(v==null?void 0:v.type)==="scroll"&&M(e.onScroll,v)},pingedStart:r,pingedEnd:a}}function Ot(e,l,t,n){const o=P(!0),r=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let a=[];const s=()=>a.forEach(c=>c());return se(()=>{z([l,()=>e.virtual],([c,u])=>{s(),c&&!u&&(a=[ie(t,r),ie(n,r)])},{immediate:!0})}),J(()=>s()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Wt(e,l,t,n,o,r){const a=S(()=>{var i;return(i=e.scrollToTopOnChange)!=null?i:l.scrollToTopOnChange});let s=[];const c=()=>{s=[z([()=>{var i;return(i=t.value)==null?void 0:i.pageIndex},()=>{var i;return(i=t.value)==null?void 0:i.pageSize}],()=>r(0)),z([o,n],([i,d],[h,y])=>{(!Rt(i,h)||!Ft(d,y))&&r(0)})]},u=()=>{s.forEach(i=>i())};z(a,i=>{u(),i&&c()},{immediate:!0})}function Rt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Ft(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ht(e,l,t,{mergedMap:n,paginatedMap:o}){const r=S(()=>t.value.find(f=>"type"in f&&f.type==="selectable")),[a,s]=ke(e,"selectedRowKeys",()=>[]),c=S(()=>{const{disabled:f}=r.value||{},g=[],m=[];return o.value.forEach((w,k)=>{f!=null&&f(w.record)?m.push(k):g.push(k)}),{enabledRowKeys:g,disabledRowKeys:m}}),u=S(()=>{const f=new Set,g=a.value,{disabledRowKeys:m}=c.value,w=n.value;return g.forEach(k=>{const{parentKey:$}=w.get(k)||{};if(!Y($)){let K=w.get($);if(K&&!g.includes(K.rowKey))for(;K&&!Y(K==null?void 0:K.rowKey);)m.includes(K.rowKey)||f.add(K.rowKey),K=Y(K.parentKey)?void 0:w.get(K.parentKey)}}),[...f]}),i=S(()=>{const f=a.value,{disabledRowKeys:g}=c.value;let m=0;return o.value.forEach((w,k)=>{!g.includes(k)&&f.includes(k)&&m++},0),m}),d=S(()=>{const f=o.value.size,g=c.value.disabledRowKeys.length;return f===0||f===g?!1:f===g+i.value}),h=S(()=>!d.value&&i.value>0),y=new Map,v=f=>{s(f);const g=n.value,{onChange:m}=r.value||{};if(m){const w=[];y.forEach((k,$)=>{f.includes($)||y.delete($)}),f.forEach(k=>{let $=g.get(k);$?y.set(k,$):$=y.get(k),$&&w.push($.record)}),M(m,f,w)}},p=(f,g)=>{const m=n.value,{disabledRowKeys:w}=c.value,{multiple:k,onSelect:$}=r.value||{};let K=[...a.value];const W=K.indexOf(f),R=W>=0;if(k){const F=m.get(f),T=ze(F,w);if(R){K.splice(W,1);const E=At(m,F,w);K=K.filter(I=>!E.includes(I)&&!T.includes(I))}else K.push(f),K.push(...T);Nt(m,F,K,w)}else K=R?[]:[f];M($,!R,g),v(K)},C=()=>{const{enabledRowKeys:f}=c.value,g=new Set(a.value);d.value?f.forEach(m=>g.delete(m)):f.forEach(m=>g.add(m)),v([...g])},x=Mt(r,l),B=_t(r,n,o,a,v);return{selectable:r,selectedRowKeys:a,indeterminateRowKeys:u,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:p,handleHeadSelectChange:C,mergedSelectableMenus:x,handleSelectableMenuClick:B}}function ze(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:r}=o;l.includes(r)||t.push(o.rowKey),t.push(...ze(o,l))}),t}function At(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function Nt(e,l,t,n){let o=!0;for(;o&&l&&!Y(l.parentKey);){const r=e.get(l.parentKey);if(r&&!n.includes(l.parentKey)){o=r.children.every(s=>n.includes(s.rowKey)||t.includes(s.rowKey));const a=t.findIndex(s=>s===l.parentKey);o?a<0&&t.push(l.parentKey):a>-1&&t.splice(a,1)}l=r}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function Mt(e,l){return S(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:r,selectPageInvert:a}=l.table;return t.map(s=>L(s)?s==="all"?{type:"item",key:Le,label:n}:s==="invert"?{type:"item",key:je,label:o}:s==="none"?{type:"item",key:Ue,label:r}:s==="pageInvert"?{type:"item",key:qe,label:a}:{type:"item",key:s,label:s}:s)})}function _t(e,l,t,n,o){const r=()=>{const{disabled:i,onSelectAll:d}=e.value||{},h=[];l.value.forEach((y,v)=>{i!=null&&i(y.record)||h.push(v)}),M(d,h),o(h)},a=()=>{const{disabled:i,onSelectInvert:d}=e.value||{},h=[...n.value];l.value.forEach((y,v)=>{if(i!=null&&i(y.record))return;const p=h.indexOf(v);p>=0?h.splice(p,1):h.push(v)}),o(h),M(d,h)},s=()=>{const{onSelectNone:i}=e.value||{};M(i),o([])},c=()=>{const{disabled:i,onSelectPageInvert:d}=e.value||{},h=[],y=n.value;t.value.forEach((v,p)=>{i!=null&&i(v.record)||y.includes(p)||h.push(p)}),M(d,h),o(h)},u=new Map([[Le,r],[je,a],[Ue,s],[qe,c]]);return i=>{const d=i.key;if(ft(d)&&u.has(d)){u.get(d)();return}const{disabled:h,onMenuClick:y}=e.value||{};if(!y)return;const v=[];t.value.forEach((p,C)=>{h!=null&&h(p.record)||v.push(C)}),M(y,i,v)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=S(()=>e.value.filter(a=>a.sortable)),t=S(()=>l.value.some(a=>a.sortable.multiple!==void 0)),n=ve({}),o=P([]);return z(l,(a,s)=>{a.forEach(c=>{const{key:u,sortable:i}=c,d=i.orderBy;if(d||n[u]===void 0){n[u]=d;return}const h=s?s.find(v=>v.key===u):void 0;(h==null?void 0:h.sortable.orderBy)&&(n[u]=void 0)}),o.value=Ce(a,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(a,s)=>{const{orders:c,onChange:u}=s,i=n[a],d=i?xe(c,i):xe(c);t.value?n[a]=d:Object.keys(n).forEach(h=>{a===h?n[h]=d:n[h]=void 0}),o.value=Ce(l.value,n),M(u,d,o.value)}}}function xe(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:r=0,orderBy:a=l[n],sorter:s}=o;return{key:n,multiple:r,orderBy:a,sorter:s}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=S(()=>!!e.sticky),t=S(()=>{const{sticky:r}=e,{offsetTop:a=0,offsetBottom:s=0,offsetScroll:c=0,container:u=window}=ht(r)?r:{};return{offsetTop:a,offsetBottom:s,offsetScroll:c,container:u}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Lt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},r,a){return S(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||a.value||r.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const N=Symbol("TABLE_TOKEN"),ge=Symbol("tableBodyToken"),ne=A({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:r}=H(N);return()=>{const{isFixedHolder:a}=e,s=a?t.value:l.value;if(s.every(i=>!i.width&&!i.type))return;const c=r.value,u=s.map((i,d)=>{const{key:h,type:y}=i,v=a?n.value[d]:i.width,p=y?V({[`${c}-col-${y}`]:!0,[`${c}-col-with-dropdown`]:y==="selectable"&&o.value.length>0}):void 0;let C;return a?C=v?`width: ${D(v)}`:void 0:C={width:D(v),minWidth:D(i.minWidth),maxWidth:D(i.maxWidth)},b("col",{key:h,class:p,style:C},null)});return b("colgroup",null,[u])}}}),jt=A({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:r,flattedData:a,isSticky:s,columnWidths:c}=H(N);Ut(n,o);const u=S(()=>r.value==="max-content"),i=S(()=>a.value.length>0),d=S(()=>{const v=t.value;return{[`${v}-fixed-holder`]:!0,[`${v}-sticky-holder`]:s.value}}),h=S(()=>{const v=s.value,{offsetTop:p,offsetBottom:C}=e;return{overflow:"hidden",top:v?D(p):void 0,bottom:v?D(C):void 0}}),y=S(()=>({tableLayout:"fixed",visibility:i.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:d.value,style:h.value,ref:n},[b("table",{style:y.value},[(i.value||!u.value)&&b(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function Ut(e,l){const t=n=>{const o=n.deltaX,r=n.currentTarget;if(o){const a=r.scrollLeft+o;l(n,a),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),J(()=>G(e.value,"wheel",t))}const qt=A({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:r}=H(N),a=P(!1),s=P(!1),c=P(0),u=P(0),i=P(0),d=S(()=>{const f=u.value,g=i.value;return g&&f*(f/g)});Ie(()=>{const f=X(l);if(f&&a.value){const{clientWidth:g,scrollWidth:m,scrollLeft:w}=f;r(w/m*g),u.value=g,i.value=m}});const h=S(()=>({height:ce(),width:u.value,bottom:n.value.offsetScroll})),y=S(()=>{const f=e.value;return{[`${f}-sticky-scrollbar-thumb`]:!0,[`${f}-sticky-scrollbar-thumb-active`]:s.value}}),v=S(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),p=()=>s.value=!1,C=f=>{c.value=f.pageX-o.value,s.value=!0,f.preventDefault()},x=f=>{if(!s.value)return;const{buttons:g}=f||window.event;if(g===0){s.value=!1;return}let m=f.pageX-c.value;m<=0&&(m=0);const w=u.value,k=i.value,$=d.value;m+$>=w&&(m=w-$);const K=m/w*(k+2);t(f,K)},B=()=>{const f=X(l),g=pe(f).top,m=g+f.offsetHeight,{container:w,offsetScroll:k}=n.value,$=w===window?document.documentElement.scrollTop+window.innerHeight:pe(w).top+w.clientHeight;m-ce()<=$||g>=$-k?a.value=!1:a.value=!0};return se(()=>{ee(document.body,"mouseup",p),ee(document.body,"mousemove",x),ee(window,"resize",B),z(()=>n.value.container,(f,g)=>{G(g,"scroll",B),ee(f,"scroll",B)},{immediate:!0}),B()}),J(()=>{G(document.body,"mouseup",p),G(document.body,"mousemove",x),G(window,"resize",B),G(n.value.container,"scroll",B)}),()=>!l.value||!a.value||i.value<=u.value||!d.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[b("div",{class:y.value,style:v.value,onMousedown:C},null)])}}),de=A({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:r,scrollBarColumn:a}=H(N),{mainTableWidth:s}=H(ge),c=S(()=>n.value.length);return()=>{let u=l.default();if(e.isEmpty?r.value:o.value){const i=a.value;u=b("div",{class:`${t.value}-fixed-row`,style:{width:D(s.value-(i?i.width:0)),position:"sticky",left:0,overflow:"hidden"}},[u])}return b("tr",null,[b("td",{colSpan:c.value},[u])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Xt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},virtualItemHeight:{type:Number,default:void 0},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Vt={columns:{type:Array,required:!0}},Gt={column:{type:Object,required:!0}},Yt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},hasChildren:{type:Boolean,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Qt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},hasPrevSibling:{type:Boolean,default:void 0},hasNextSibling:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Zt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},el={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},tl=A({props:Jt,setup(e){const l=P();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),J(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[vt(" ")])])}}),ll=A({setup(){const{mergedPrefixCls:e,flattedColumns:l}=H(N),{changeColumnWidth:t}=H(ge);return()=>{const n=l.value.map(o=>{const{key:r}=o;return b(tl,{key:r,cellKey:r,changeColumnWidth:t},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),nl=A({props:Qt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:r,activeOrderByMap:a,fixedColumnKeys:s,columnOffsets:c,isSticky:u,isTreeData:i,expandable:d,selectable:h,mergedPagination:y}=H(N),v=S(()=>a[e.column.key]),p=ol(e),C=S(()=>s.value.lastStartKey===e.column.key),x=S(()=>s.value.firstEndKey===e.column.key),B=S(()=>{const{type:m,ellipsis:w}=e.column;return m||w!=null?w:l.ellipsis}),f=S(()=>{const{fixed:m,align:w}=e.column,k=o.value;let $={[`${k}-cell`]:!0,[`${k}-cell-sorted`]:!!v.value,[`${k}-cell-align-${w}`]:!!w&&w!="start",[`${k}-cell-ellipsis`]:!!B.value};return m&&($={...$,[`${k}-fix-start`]:m==="start",[`${k}-fix-start-last`]:C.value,[`${k}-fix-end`]:m==="end",[`${k}-fix-end-first`]:x.value,[`${k}-fix-sticky`]:u.value}),V($)}),g=S(()=>{const{fixed:m}=e.column;if(!m)return;const{starts:w,ends:k}=c.value,K=D((m==="start"?w:k)[e.colIndex]);return{position:"sticky",left:m==="start"?K:void 0,right:m==="end"?K:void 0}});return()=>{var F,T,E;const{column:m}=e,{type:w}=m;let k,$;if(w==="selectable")k=rl(e,t,h,n,y);else if(w==="indexable")k=Xe(e,t,m,y);else{const I=p.value;if(k=sl(e,t,I),$=Re(B.value,k,I),!w&&(Y(k)||k==="")){const O=t.emptyCell||r.value;k=Q(O)?O({column:m,record:e.record,rowIndex:e.rowIndex}):O}}e.column.fixed&&B.value&&(C.value||x.value)&&(k=b("span",{class:`${o.value}-cell-content`},[k]));const K=(F=l.customAdditional)==null?void 0:F.bodyCell,W=K?K({column:m,record:e.record,rowIndex:e.rowIndex}):void 0,R=(E=(T=l.customTag)==null?void 0:T.bodyCell)!=null?E:"td";return b(R,Z({class:f.value,style:g.value,title:$},W),{default:()=>[w==="expandable"&&al(e,t,d,i,o.value),w==="expandable"&&!Ze(k)&&b("span",{class:`${o.value}-expandable-trigger-gap`},null),k]})}}});function ol(e){return S(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let r=0;r<n.length&&o;r++){const a=n[r];o=o[a]}return o})}function sl(e,l,t){const{record:n,rowIndex:o,column:r}=e,{customCell:a}=r,s=L(a)?l[a]:a;return s?s({value:t,record:n,rowIndex:o}):t}function al(e,l,t,n,o){var m;const{icon:r,customIcon:a,indent:s,showLine:c}=t.value,{record:u,expanded:i,level:d=0,hasPrevSibling:h,hasNextSibling:y}=e,v=d>0,p=n.value&&c;let C;const x=(m=L(a)?l[a]:a)!=null?m:r;Q(x)?C=x({expanded:!!i,record:u}):C=L(x)?b(te,{name:x,rotate:i?90:0},null):x;const B=s?`width: ${D(s)}`:void 0,f={[`${o}-expandable-trigger`]:!0,[`${o}-expandable-trigger-show-line`]:p,[`${o}-expandable-trigger-disabled`]:e.disabled},g=[];for(let w=0;w<d;w++)g.push(b("div",{class:`${o}-expandable-indent`,style:B},null));return[...g,b("span",{class:f,style:B},[b("button",{class:`${o}-expandable-trigger-button`,type:"button",onClick:e.disabled?void 0:e.handleExpend},[C]),p&&[b("span",{class:`${o}-expandable-trigger-line-right`},null),(h||v)&&b("span",{class:`${o}-expandable-trigger-line-top`},null),y&&b("span",{class:`${o}-expandable-trigger-line-bottom`},null)]])].filter(Boolean)}function rl(e,l,t,n,o){const{record:r,rowIndex:a,selected:s,indeterminate:c,disabled:u,isHover:i,handleSelect:d}=e,{showIndex:h,multiple:y,customCell:v}=t.value,p=x=>{x.stopPropagation(),!y&&s&&!u&&d&&d()};if(!s&&!i&&h)return Xe(e,l,n.columnIndexable,o);const C=L(v)?l[v]:v;if(y){const x={checked:s,disabled:u,indeterminate:c,onChange:d,onClick:p};return C?C({...x,record:r,rowIndex:a}):b(he,x,null)}else{const x={checked:s,disabled:u,onChange:d,onClick:p};return C?C({...x,record:r,rowIndex:a}):b(Oe,x,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:r,disabled:a}=e,{customCell:s}=t,{pageIndex:c=1,pageSize:u=0}=n.value||{},i=L(s)?l[s]:s;return i?b("span",{style:a?"cursor: not-allowed":"cursor: pointer"},[i({record:o,rowIndex:r,pageIndex:c,pageSize:u})]):void 0}const cl=A({props:Yt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:r,checkExpandDisabled:a,selectable:s,selectedRowKeys:c,indeterminateRowKeys:u,handleSelectChange:i,currentPageRowKeys:d}=H(N),{expandDisabled:h,handleExpend:y,selectDisabled:v,handleSelect:p,isHover:C,attrs:x}=il(e,o,a,r,s,i,d),B=S(()=>c.value.includes(e.rowKey)),f=S(()=>u.value.includes(e.rowKey)),g=S(()=>{const m=`${t.value}-row`,{level:w,expanded:k}=e;return V({[`${m}`]:!0,[`${m}-level-${w}`]:!!w,[`${m}-selected`]:B.value,[`${m}-expanded`]:k})});return()=>{var $,K,W;const m=($=l.customAdditional)==null?void 0:$.bodyRow,w=m?m({record:e.record,rowIndex:e.rowIndex}):void 0,k=(W=(K=l.customTag)==null?void 0:K.bodyRow)!=null?W:"tr";return b(k,Z({class:g.value},x.value,w),{default:()=>[ul(e,n,h,y,B,f,v,p,C)]})}}});function il(e,l,t,n,o,r,a){const s=S(()=>t(e.rowData)),c=S(()=>{var g;return(g=l.value)==null?void 0:g.trigger}),u=()=>{const{rowKey:g,record:m}=e;n(g,m)},i=S(()=>a.value.disabledRowKeys.includes(e.rowKey)),d=S(()=>{var g;return(g=o.value)==null?void 0:g.trigger}),h=S(()=>{var g;return(g=o.value)==null?void 0:g.showIndex}),y=P(!1),v=()=>{const{rowKey:g,record:m}=e;r(g,m)},p=()=>{c.value==="click"&&u(),d.value==="click"&&v()},C=()=>{c.value==="dblclick"&&u(),d.value==="dblclick"&&v()},x=()=>y.value=!0,B=()=>y.value=!1,f=S(()=>{const g=s.value,m=c.value,w=i.value,k=d.value,$=!g&&m==="click"||!w&&k==="click",K=!g&&m==="dblclick"||!w&&k==="dblclick",W=!w&&h.value;let R="";return $||K?R="pointer":(g&&m||w&&k)&&(R="not-allowed"),{style:R?`cursor: ${R}`:void 0,onClick:$?p:void 0,onDblclick:K?C:void 0,onMouseenter:W?x:void 0,onMouseleave:W?B:void 0}});return{expandDisabled:s,handleExpend:u,selectDisabled:i,handleSelect:v,isHover:y,attrs:f}}function ul(e,l,t,n,o,r,a,s,c){const u=[],{rowIndex:i,record:d,level:h,hasNextSibling:y,hasPrevSibling:v}=e;return l.value.forEach((p,C)=>{const{type:x,colSpan:B,rowSpan:f,key:g}=p,m=B==null?void 0:B(d,i),w=f==null?void 0:f(d,i);if(m===0||w===0)return;const k={colSpan:m===1?void 0:m,rowSpan:w===1?void 0:w,rowIndex:i,colIndex:C,record:d,column:p,level:h,hasNextSibling:y,hasPrevSibling:v,key:g};x==="expandable"?(k.expanded=e.expanded,k.disabled=t.value,k.handleExpend=n):x==="selectable"&&(k.selected=o.value,k.indeterminate=r.value,k.disabled=a.value,k.handleSelect=s,k.isHover=c.value),u.push(b(nl,k,null))}),u}function Ve(e,l,t,n,o){const{children:r,expanded:a,level:s,hasPrevSibling:c,hasNextSibling:u,record:i,rowKey:d}=e,h={key:d,expanded:a,level:s,hasPrevSibling:c,hasNextSibling:u,hasChildren:!!(r!=null&&r.length),record:i,rowData:e,rowIndex:l,rowKey:d},y=b(cl,h,null),v=a&&dl(h,t,n,o);return v?[y,v]:y}function dl(e,l,t,n){const{customExpand:o}=t||{},{record:r,rowIndex:a}=e;let s;return Q(o)?s=o({record:r,rowIndex:a}):L(o)&&l[o]&&(s=l[o]({record:r,rowIndex:a})),s&&b(de,{class:`${n}-expanded-row`},{default:()=>[s]})}const re=A({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:r,flattedData:a,expandable:s,scrollWidth:c,scrollHeight:u,isSticky:i}=H(N),d=S(()=>r.value||c.value||u.value||i.value);return()=>{const h=o.value,y=[];n.alert&&y.push(b(de,{class:`${h}-alert-row`},{default:()=>[n.alert()]}));const v=a.value;return v.length>0?l.default?y.push(...l.default()):v.forEach((p,C)=>{y.push(...fe(Ve(p,C,n,s.value,h)))}):y.push(b(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[b(et,{empty:t.empty},n)]})),b("tbody",{class:`${o.value}-tbody`},[d.value&&b(ll,null,null),y])}}}),fl=A({props:Zt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=H(N),r=S(()=>{var f;return(f=e.filterable.multiple)!=null?f:t.columnBase.filterable.multiple}),a=S(()=>{var f;return(f=e.filterable.footer)!=null?f:t.columnBase.filterable.footer}),s=e.activeFilterBy,[c,u]=oe(()=>s);z(()=>e.activeFilterBy,f=>u(f));const[i,d]=oe(!1),h=f=>{d(f),f||e.onUpdateFilterBy(c.value)},y=()=>{d(!1),e.onUpdateFilterBy(c.value)},v=()=>{u(s)},p=f=>{const g=`${o.value}-filterable-menu-label`,m=r.value?he:Oe;return b("span",{class:g},[b(m,{checked:f.selected,disabled:f.disabled},null),b("span",{class:`${g}-content`},[f.label])])},C=()=>{const f=[],{customMenu:g,menus:m}=e.filterable;return Q(g)?f.push(g({selectedKeys:c.value,setSelectedKeys:u})):L(g)&&l[g]?f.push(l[g]({selectedKeys:c.value,setSelectedKeys:u})):f.push(hl(m,r,c,u,p)),a.value&&f.push(vl(n,o,y,v)),f},x=S(()=>{const f=`${o.value}-filterable-trigger`;return V({[f]:!0,[`${f}-active`]:e.activeFilterBy.length>0})}),B=()=>{const{customTrigger:f}=e.filterable;return Q(f)?f():L(f)&&l[f]?l[f]():b("span",{class:x.value,onClick:g=>g.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const f={visible:i.value,hideOnClick:!a.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return b(Ke,f,{default:B,overlay:C})}}}),hl=(e,l,t,n,o)=>{const r={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return b($e,r,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:r}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),b(me,{size:"xs",onClick:n},{default:()=>[r]})])},yl=A({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:r,handleHeadSelectChange:a,mergedSelectableMenus:s,handleSelectableMenuClick:c}=H(N),u=S(()=>{const C=l.value.size;return C===0||C===n.value.disabledRowKeys.length}),[i,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},y=()=>b($e,{dataSource:s.value,onClick:c},null),v=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:i.value?180:0},null),p=()=>{if(s.value.length!==0)return b(Ke,h,{default:v,overlay:y})};return()=>{const{multiple:C}=t.value;if(C)return b("span",{class:`${e.value}-cell-triggers`},[b(he,{checked:o.value,indeterminate:r.value,disabled:u.value,onChange:a},null),p()])}}}),gl=A({props:el,setup(e){const{locale:l,mergedPrefixCls:t}=H(N);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:r,nextTooltip:a}=o,s=a&&pl(l.table,r,n),c=ml(t,r,n);return s?b(tt,{title:s},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:r,sortDesc:a}=e;return n?n==="ascend"?r:a:o}function ml(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,r=l.includes("ascend")&&b(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),a=l.includes("descend")&&b(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return b("span",{class:`${n}-sortable-trigger`},[r,a])}const bl=A({props:Gt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:r,isSticky:a,handleSort:s,activeOrderByMap:c,activeFilterByMap:u,handleFilter:i}=H(N),d=S(()=>{const{type:B,ellipsis:f}=e.column,g=B||f!=null?f:l.ellipsis;return Ee(g)&&g.head===!1?void 0:g}),h=S(()=>{const{type:B,align:f,fixed:g,hasChildren:m,key:w,sortable:k,filterable:$}=e.column,K=n.value;let W={[`${K}-cell`]:!0,[`${K}-cell-${B}`]:!!B,[`${K}-cell-filterable`]:!!$,[`${K}-cell-sortable`]:!!k,[`${K}-cell-align-center`]:m||f==="center",[`${K}-cell-align-end`]:!m&&f==="end",[`${K}-cell-ellipsis`]:!!d.value};if(g){const{lastStartKey:R,firstEndKey:F}=o.value;W={...W,[`${K}-fix-start`]:g==="start",[`${K}-fix-start-last`]:R===w,[`${K}-fix-end`]:g==="end",[`${K}-fix-end-first`]:F===w,[`${K}-fix-sticky`]:a.value}}return V(W)}),y=S(()=>{const{fixed:B,colStart:f,colEnd:g}=e.column;if(!B)return;const{starts:m,ends:w}=r.value,K=D((B==="start"?m:w)[B==="start"?f:g]);return{position:"sticky",left:B==="start"?K:void 0,right:B==="end"?K:void 0}}),v=S(()=>c[e.column.key]),p=S(()=>u[e.column.key]||lt),C=B=>{const{key:f,filterable:g}=e.column;i(f,g,B)},x=()=>{const{key:B,sortable:f}=e.column;f&&s(B,f)};return()=>{var F,T,E;const{column:B}=e,{type:f,titleColSpan:g,titleRowSpan:m}=B;if(f==="scroll-bar")return b("th",{class:h.value,style:y.value,colspan:g===1?void 0:g,rowspan:m===1?void 0:m,onClick:x},null);const w=n.value;let k,$;if(f==="selectable")$=b(yl,null,null);else{const{title:I,customTitle:O,sortable:U,filterable:q}=B,j=d.value;$=Sl(I,O,t),k=Re(j,$,I);const _=xl(U,v,q,p,C);_.length>0?$=b("span",{class:`${w}-cell-triggers`},[b("span",{class:`${w}-cell-title`},[$]),_]):j&&($=b("span",{class:`${w}-cell-title`},[$]))}const K=(F=l.customAdditional)==null?void 0:F.headCell,W=K?K({column:B}):void 0,R=(E=(T=l.customTag)==null?void 0:T.headCell)!=null?E:"th";return b(R,Z({class:h.value,style:y.value,colSpan:g===1?void 0:g,rowSpan:m===1?void 0:m,title:k},W,{onClick:x}),{default:()=>[$]})}}});function Sl(e,l,t){let n=e;return Q(l)?n=l({title:e}):L(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const r=[];return e&&r.push(b(gl,{activeOrderBy:l.value,sortable:e},null)),t&&r.push(b(fl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),r}const Cl=A({props:Vt,setup(e){const{props:l,mergedPrefixCls:t}=H(N);return()=>{var s,c,u;const{columns:n}=e,o=(s=l.customAdditional)==null?void 0:s.headRow,r=o?o({columns:n}):void 0,a=(u=(c=l.customTag)==null?void 0:c.headRow)!=null?u:"tr";return b(a,Z({class:`${t.value}-row`},r),{default:()=>[n.filter(i=>i.titleColSpan!==0).map(i=>b(bl,{key:i.key,column:i},null))]})}}}),we=A({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=H(N);return()=>{var s,c,u;const n=l.value,o=(s=e.customAdditional)==null?void 0:s.head,r=o?o({rows:n}):void 0,a=(u=(c=e.customTag)==null?void 0:c.head)!=null?u:"thead";return b(a,Z({class:`${t.value}-thead`},r),{default:()=>[n.map((i,d)=>b(Cl,{key:d,columns:i},null))]})}}}),wl=A({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:r,columnWidths:a,changeColumnWidth:s,flattedData:c,isSticky:u,mergedSticky:i,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:y,handleScroll:v,pingedStart:p,pingedEnd:C,scrollWidth:x,scrollHeight:B,hasFixed:f,tableLayout:g}=H(N),m=P(),w=P(0);Pe(ge,{mainTableWidth:w,changeColumnWidth:(E,I)=>{at(m.value)&&s(E,I)}});const $=()=>{const E=X(h);E&&v({currentTarget:E})},K=E=>{const{offsetWidth:I}=E.target;I!==w.value&&(w.value=I)};se(()=>{$(),z([()=>e.dataSource,x],([,I])=>{I&&$()}),z(a,Te(()=>{var O;((O=X(h))==null?void 0:O.scrollLeft)===0&&$()},16)),nt(m.value,K)}),J(()=>ot(m.value,K));const W=S(()=>{const E=n.value;return V({[`${E}-container`]:!0,[`${E}-ping-start`]:p.value,[`${E}-ping-end`]:C.value,[`${E}-fixed-layout`]:g.value==="fixed",[`${E}-fixed-column`]:f.value,[`${E}-scroll-horizontal`]:x.value,[`${E}-scroll-vertical`]:B.value})}),R=S(()=>{var j;const E=x.value,I=B.value,O=E?"auto":void 0,U=e.virtual?"hidden":I?"scroll":E?"hidden":void 0,q=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:O,overflowY:U,[q?"height":"maxHeight"]:I}}),F=S(()=>({tableLayout:g.value,width:x.value,minWidth:x.value?"100%":void 0})),T=(E,I,O)=>{M(e.onScrolledChange,E,I,O.map(U=>U.record))};return()=>{const E=n.value,I=r.value,O=l.default?l.default():[];if(I||B.value||u.value){const{offsetTop:U}=i.value;if(e.headless||O.push(b(jt,{offsetTop:U},{default:()=>[b(we,null,null)]})),e.virtual&&(e.scroll||I)){const q=({item:ae,index:Ye})=>Ve(ae,Ye,l,t.value,E),j=ae=>b("table",{ref:y,class:`${E}-table`,style:F.value},[b(ne,null,null),b(re,null,{default:()=>[ae]}),!1]),{scroll:_,onScrolledBottom:Ge}=e;O.push(b(st,{ref:d,style:R.value,dataSource:c.value,fullHeight:_==null?void 0:_.fullHeight,getKey:"rowKey",height:r.value?"100%":_==null?void 0:_.height,itemHeight:o.value,itemRender:q,contentRender:j,virtual:!0,onScroll:v,onScrolledBottom:Ge,onScrolledChange:T},null))}else O.push(b("div",{ref:h,class:`${E}-content`,style:R.value,onScroll:v},[b("table",{ref:y,class:`${E}-table`,style:F.value},[b(ne,null,null),b(re,null,null),!1])]));u.value&&O.push(b(qt,null,null))}else O.push(b("div",{ref:h,class:`${E}-content`,style:R.value,onScroll:v},[b("table",{ref:y,class:`${E}-table`,style:F.value},[b(ne,null,null),!e.headless&&b(we,null,null),b(re,null,null),!1])]));return b("div",{ref:m,class:W.value},[O])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bl(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t,n){var a,s;let o=null,r=null;if(l!==null){const{position:c}=l,[u,i]=yt(c).split("-"),d=`${n}-pagination ${n}-pagination-${i}`,h=(s=(a=e.pagination)==null?void 0:a.call(e,{total:t.length,...l}))!=null?s:b(pt,Z({class:d,total:t.length},l),null);o=u==="top"?h:null,r=u==="bottom"?h:null}return[o,r]}const Kl={sm:32,md:40,lg:56},$l={sm:40,md:48,lg:56},El=A({name:"IxTable",props:Xt,setup(e,{expose:l,slots:t}){const n=le("common"),o=S(()=>`${n.prefixCls}-table`),r=le("locale"),a=le("table"),s=S(()=>{var T;return(T=e.autoHeight)!=null?T:a.autoHeight}),c=S(()=>{var T;return(T=e.childrenKey)!=null?T:a.childrenKey}),u=rt(e,a),i=S(()=>{var T;return(T=e.emptyCell)!=null?T:a.emptyCell}),d=S(()=>{var T;return(T=e.size)!=null?T:a.size}),h=S(()=>{var T;return(T=e.virtualItemHeight)!=null?T:n.theme==="seer"?Kl[d.value]:$l[d.value]}),{mergedPagination:y}=Tt(e,a,d),v=zt(e),p=It(e,s,v),C=bt(e,t,a,p.scrollBarSizeOnFixedHolder),x=Dt(C.flattedColumns),B=Et(C.flattedColumns),f=$t(e,C.flattedColumns),g=Lt(e,C,p,v.isSticky,s),{activeSorters:m}=x,{activeFilters:w}=B,k=Kt(e,c,u,m,w,f.expandedRowKeys,y),$=Ht(e,r,C.flattedColumns,k);Wt(e,a,y,m,w,p.scrollTo);const K={props:e,slots:t,config:a,locale:r,mergedPrefixCls:o,mergedEmptyCell:i,mergedVirtualItemHeight:h,mergedAutoHeight:s,...C,...p,...x,...B,...v,tableLayout:g,mergedPagination:y,...f,...k,...$};Pe(N,K),l({scrollTo:p.scrollTo});const{flattedData:W,filteredData:R}=k,F=S(()=>{const T=o.value,{borderless:E=a.borderless,scroll:I}=e;return V({[T]:!0,[`${T}-auto-height`]:s.value,[`${T}-borderless`]:E,[`${T}-empty`]:W.value.length===0,[`${T}-full-height`]:I==null?void 0:I.fullHeight,[`${T}-${d.value}`]:!0})});return()=>{const T=o.value,E=b(ct,{header:e.header},t),I=Bl(t,T),[O,U]=kl(t,y.value,R.value,T),q=[E],j=[O,b(wl,null,null),I,U].filter(Boolean),_=Tl(e.spin);return _?q.push(b(it,_,{default:()=>[j]})):q.push(...j),b("div",{class:F.value},[q])}}});function Tl(e){return gt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=El,Fl=ye;export{Rl as I,Fl as a,mt as g,Xt as t};
