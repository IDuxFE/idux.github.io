import{a9 as ke,aa as fe,aH as Je,ac as Be,i as M,u as le,aI as z,aJ as ce,N as X,s as Qe,a2 as ie,a8 as oe,h as ee,o as Y,j as ge,v as te,C as ve,ap as Ze,ak as Ke,aj as Ee,c as me,w as et,an as tt,a3 as lt,a4 as nt,a7 as ot,aK as st,aq as at,am as rt,ax as ct}from"./index-42aa140a.js";import{j as Te,l as N,L as it,T as ut,e as m,r as he,b as I,w as D,a7 as $e,P as Ie,k as G,N as Q,x as se,bi as dt,Q as ft,v as H,z as V,y as b,i as F,ad as vt,a as J,a2 as Z,p as Oe,Z as ht,au as yt}from"./vendor-6c4e542b.js";import{b as Pe}from"./GlobalCodeBox-b1e99eee.js";import{I as pt}from"./index-7bbfbfe9.js";/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Re=Symbol("IxTableColumn"),ye=()=>{};ye.displayName="IxTableColumn";ye[Re]=!0;/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function We(e,l,t){if(!e||Te(e)&&e.title===!1)return;if(N(l)||it(l))return l;const n=ke(l).find(o=>o.type===ut);return n?n.children:t}function gt(e){return"key"in e?e.key:"dataKey"in e?fe(e.dataKey).join("-"):"type"in e?`__IDUX_table_column_key_${e.type}`:Je("__IDUX_table_column_key_")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function mt(e,l,t,n){const o=m(()=>{var g;const{columns:S}=e;return Fe(S&&S.length>0?S:He((g=l.default)==null?void 0:g.call(l)),t)}),{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a}=xt(o,n),c=St(a),i=m(()=>!!e.ellipsis||r.value.some(S=>S.ellipsis)),u=m(()=>r.value.some(S=>S.fixed)),{columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:x}=Ct(r,s),{columnOffsets:f,columnOffsetsWithScrollBar:C}=wt(d,h),w=m(()=>kt(o.value,s.value));return{flattedColumns:r,scrollBarColumn:s,flattedColumnsWithScrollBar:a,fixedColumnKeys:c,hasEllipsis:i,hasFixed:u,columnWidths:d,columnWidthsWithScrollBar:h,changeColumnWidth:x,columnOffsets:f,columnOffsetsWithScrollBar:C,mergedRows:w}}function Fe(e,l){return e.map(t=>bt(t,l))}function He(e){const l=[];return ke(e,{key:Re}).forEach((t,n)=>{const{props:o,children:r}=t,{key:s=n,editable:a,ellipsis:c,...i}=o||{};i.key=s,i.editable=a||a==="",i.ellipsis=c||c==="";const{default:u,cell:d,title:h,expand:x,icon:f}=r||{};u&&(i.children=He(u())),d&&(i.customCell=d),h&&(i.customTitle=h),x&&(i.customExpand=x),f&&(i.customIcon=f),l.push(i)}),l}function bt(e,l){const{columnBase:t,columnExpandable:n,columnSelectable:o,columnIndexable:r}=l,{align:s=t.align}=e,a=gt(e);if("type"in e){const{type:c}=e;if(c==="expandable"){const{icon:i=n.icon}=e;return{...e,key:a,align:s,icon:i}}if(c==="selectable"){const{multiple:i=!0,showIndex:u=o.showIndex}=e;return{...e,key:a,align:s,multiple:i,showIndex:u}}if(c==="indexable"){const i=e.align??r.align??t.align;return{...r,...e,align:i,key:a}}return{...e,key:a,align:s}}else{const{sortable:c,filterable:i,children:u}=e,d={...e,key:a,align:s};return c&&(d.sortable={...t.sortable,...c}),i&&(d.filterable={...t.filterable,...i}),u!=null&&u.length&&(d.children=Fe(u,l)),d}}function xt(e,l){const t=m(()=>Ae(e.value)),n=m(()=>{const r=l.value;if(r===0)return;const s=t.value,a=s[s.length-1];return{key:"__IDUX_table_column_key_scroll-bar",type:"scroll-bar",fixed:a&&a.fixed,width:r}}),o=m(()=>{const r=t.value;if(r.length===0)return r;const s=n.value;return s?[...r,s]:r});return{flattedColumns:t,scrollBarColumn:n,flattedColumnsWithScrollBar:o}}function Ae(e){const l=[];return e.forEach(t=>{const{fixed:n,children:o}=t;if(o!=null&&o.length){let r=Ae(o);n&&(r=r.map(s=>({fixed:n,...s}))),l.push(...r)}else l.push(t)}),l}function St(e){return m(()=>{let l,t;return e.value.forEach(n=>{const{fixed:o,key:r}=n;o==="start"?l=r:o==="end"&&(t||(t=r))}),{lastStartKey:l,firstEndKey:t}})}function Ct(e,l){const t=he({}),n=I(),o=I([]);D(n,$e(a=>{o.value=a?a.split("-").map(Number):[]},16)),Ie(()=>{const a=Object.keys(t),c=e.value;if(a.length!==c.length){n.value=void 0;return}n.value=c.map(i=>t[i.key]).join("-")});const r=m(()=>{const a=o.value;if(a.length===0)return a;const c=l.value;return c?[...a,c.width]:a});return{columnWidths:o,columnWidthsWithScrollBar:r,changeColumnWidth:(a,c)=>{c===!1?delete t[a]:t[a]=c}}}function wt(e,l){const t=m(()=>be(e.value)),n=m(()=>be(l.value));return{columnOffsets:t,columnOffsetsWithScrollBar:n}}function be(e){const l=e.length,t=[],n=[];let o=0,r=0;for(let s=0;s<l;s++){t[s]=o,o+=e[s]||0;const a=l-s-1;n[a]=r,r+=e[a]||0}return{starts:t,ends:n}}function kt(e,l){const t=[];function n(s,a,c){t[c]??(t[c]=[]);let i=a;return s.map(d=>{let h=d.titleColSpan??1,x=!1;const f=d.children;if(f!=null&&f.length){x=!0;const w=n(f,i,c+1);G(d.titleColSpan)&&(h=w.reduce((S,g)=>S+g))}const C=i+h-1;return t[c].push({...d,titleColSpan:h,colStart:i,colEnd:C,hasChildren:x}),i+=h,h})}const o=l?[...e,l]:e;n(o,0,0);const r=t.length;return t.forEach((s,a)=>{s.forEach(c=>{c.hasChildren||(c.titleRowSpan=r-a)})}),t}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Bt(e,l,t,n,o,r,s){const a=m(()=>{const f=l.value,C=t.value;return e.dataSource.map(w=>_e(w,C,f))}),c=m(()=>{const f=new Map;return ue(a.value,f),f}),i=m(()=>ze(a.value,o.value,r.value)),u=m(()=>Me(i.value,n.value,r.value)),d=m(()=>{const f=s.value,C=u.value;if(f===null||!f.pageSize)return C;{const{total:w}=f;if(w&&C.length<w)return C;const S=f.pageSize,g=(f.pageIndex-1)*S;return C.slice(g,g+S)}}),h=m(()=>{const f=new Map;return ue(d.value,f),f}),x=m(()=>{const f=r.value;return f.length>0?De(d.value,f,0):d.value});return{filteredData:i,flattedData:x,mergedMap:c,paginatedMap:h}}function _e(e,l,t,n){const o=l(e),r={record:e,rowKey:o,parentKey:n},s=e[t];return s&&(r.children=s.map(a=>_e(a,l,t,o))),r}function ue(e,l){e.forEach(t=>{const{rowKey:n,children:o}=t;l.set(n,t),o&&ue(o,l)})}function Me(e,l,t){const n=l.filter(s=>s.sorter),o=n.length;if(o===0)return e;const r=e.slice();return r.forEach(s=>{t.includes(s.rowKey)&&s.children&&s.children.length>0&&(s.children=Me(s.children,l,t))}),r.sort((s,a)=>{for(let c=0;c<o;c++){const{orderBy:i,sorter:u}=n[c],d=u(s.record,a.record);if(d!==0)return i==="ascend"?d:-d}return 0})}function ze(e,l,t){const n=l.filter(o=>o.filter);return n.length===0?e:e.map(o=>{const r=n.every(({filter:u,filterBy:d})=>u(d,o.record)),{rowKey:s,children:a}=o,c=t.includes(s);let i=o;if(c&&a&&a.length){const u=ze(a,l,t);u.length!==a.length&&(i={...o,children:u})}return r||c&&i.children&&i.children.length?i:null}).filter(o=>o!==null)}function De(e,l,t){return e.reduce((n,o)=>{const{children:r,parentKey:s,record:a,rowKey:c}=o,i=l.includes(c);if(n.push({children:r,parentKey:s,record:a,rowKey:c,level:t,expanded:i}),i&&o.children){const u=De(o.children,l,t+1);n.push(...u)}return n},[])}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Kt(e,l){const t=m(()=>l.value.find(a=>"type"in a&&a.type==="expandable")),[n,o]=Be(e,"expandedRowKeys",()=>[]);return{expandable:t,expandedRowKeys:n,setExpandedRowKeys:o,checkExpandDisabled:a=>{if(!t.value)return!0;const{disabled:c,customExpand:i}=t.value,{record:u}=a;return c!=null&&c(u)?!0:!(i||a.children&&a.children.length>0)},handleExpandChange:(a,c)=>{const{onChange:i,onExpand:u}=t.value||{},d=[...n.value],h=d.indexOf(a),x=h>=0;x?d.splice(h,1):d.push(a),M(u,!x,c),o(d),M(i,d)}}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Et(e){const l=m(()=>e.value.filter(r=>r.filterable)),t=he({}),n=I([]);return D(l,(r,s)=>{r.forEach(a=>{const{key:c,filterable:i}=a,u=i.filterBy;if(u||t[c]===void 0){t[c]=u||[];return}const d=s?s.find(x=>x.key===c):void 0;(d==null?void 0:d.filterable.filterBy)&&(t[c]=[])}),n.value=xe(r,t)},{immediate:!0}),{activeFilters:n,activeFilterByMap:t,handleFilter:(r,s,a)=>{const{onChange:c}=s;t[r]=a,n.value=xe(l.value,t),M(c,a,n.value)}}}function xe(e,l){return e.map(t=>{const{key:n,filterable:o}=t,{filter:r,filterBy:s=l[n]}=o;return{key:n,filter:r,filterBy:s}}).filter(t=>t.filter&&t.filterBy.length>0)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Tt(e,l,t){var i,u;const n=le("pagination"),o=m(()=>{const{pagination:d}=e;return d===!1?null:d===!0?{}:d}),r=I(((i=o.value)==null?void 0:i.pageIndex)??1),s=I(((u=o.value)==null?void 0:u.pageSize)??l.pagination.pageSize??n.pageSize),a=(d,h)=>{var x;r.value=d,s.value=h,M((x=o.value)==null?void 0:x.onChange,d,h)};return{mergedPagination:m(()=>{const d=o.value;return d===null?null:{...l.pagination,size:t.value,...d,pageIndex:d.pageIndex??r.value,pageSize:d.pageSize??s.value,onChange:a}})}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function $t(e,l,{setStickyScrollLeft:t}){const n=I(),o=I(),r=I(),s=I(),a=I();D(n,S=>{S&&(r.value=S.holderRef.value)});const{handleScroll:c,pingedStart:i,pingedEnd:u}=It(e,o,r,a,t),d=Ot(e,l,r,s),h=m(()=>{var S;return z((S=e.scroll)==null?void 0:S.width)}),x=m(()=>{var g;let S=z((g=e.scroll)==null?void 0:g.height);return!S&&l.value&&(e.virtual||d.value)&&(S="auto"),S}),f=m(()=>ce(X(r))),C=m(()=>x.value?f.value:0);return{virtualScrollRef:n,scrollHeadRef:o,scrollBodyRef:r,scrollContentRef:s,scrollFootRef:a,handleScroll:c,scrollTo:S=>{var g;e.virtual?(g=n.value)==null||g.scrollTo(S):typeof S=="number"&&Qe({target:X(r),top:S,duration:200})},pingedStart:i,pingedEnd:u,scrollWidth:h,scrollHeight:x,scrollBarSize:f,scrollBarSizeOnFixedHolder:C}}function It(e,l,t,n,o){const r=I(!1),s=I(!1);let a;const c=()=>{a&&(clearTimeout(a),a=void 0)};Q(()=>c());const i=I(),u=f=>{i.value=f,c(),a=setTimeout(()=>{i.value=void 0,a=void 0},100)},d=(f,C)=>{C&&C.scrollLeft!==f&&(C.scrollLeft=f)},h=f=>{const C=X(t);if(!C)return;const{clientWidth:w,scrollWidth:S}=C;o(f/S*w||0)};return{handleScroll:(f,C)=>{const w=f==null?void 0:f.currentTarget,S=C??w.scrollLeft,g=i.value;if((!g||g===w)&&(u(w),d(S,l.value),d(S,X(t)),d(S,n.value),h(S)),w){const{scrollWidth:v,clientWidth:y}=w;r.value=S>0,s.value=S<v-y}(f==null?void 0:f.type)==="scroll"&&M(e.onScroll,f)},pingedStart:r,pingedEnd:s}}function Ot(e,l,t,n){const o=I(!0),r=()=>{const c=X(t.value);c?o.value=c.scrollHeight>c.clientHeight:o.value=!1};let s=[];const a=()=>s.forEach(c=>c());return se(()=>{D([l,()=>e.virtual],([c,i])=>{a(),c&&!i&&(s=[ie(t,r),ie(n,r)])},{immediate:!0})}),Q(()=>a()),o}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Pt(e,l,t,n,o,r){const s=m(()=>e.scrollToTopOnChange??l.scrollToTopOnChange);let a=[];const c=()=>{a=[D([()=>{var u;return(u=t.value)==null?void 0:u.pageIndex},()=>{var u;return(u=t.value)==null?void 0:u.pageSize}],()=>r(0)),D([o,n],([u,d],[h,x])=>{(!Rt(u,h)||!Wt(d,x))&&r(0)})]},i=()=>{a.forEach(u=>u())};D(s,u=>{i(),u&&c()},{immediate:!0})}function Rt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.filter===n.filter&&t.filterBy.length===n.filterBy.length&&t.filterBy.every(o=>n.filterBy.includes(o)):!1})}function Wt(e,l){return e.length===l.length&&e.every(t=>{const n=l.find(o=>o.key===t.key);return n?t.sorter===n.sorter&&t.orderBy===n.orderBy&&t.multiple===n.multiple:!1})}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Ft(e,l,t,{mergedMap:n,paginatedMap:o}){const r=m(()=>t.value.find(g=>"type"in g&&g.type==="selectable")),[s,a]=Be(e,"selectedRowKeys",()=>[]),c=m(()=>{const{disabled:g}=r.value||{},v=[],y=[];return o.value.forEach((p,k)=>{g!=null&&g(p.record)?y.push(k):v.push(k)}),{enabledRowKeys:v,disabledRowKeys:y}}),i=m(()=>{const g=new Set,v=s.value,{disabledRowKeys:y}=c.value,p=n.value;return v.forEach(k=>{const{parentKey:K}=p.get(k)||{};if(!G(K)){let B=p.get(K);if(B&&!v.includes(B.rowKey))for(;B&&!G(B==null?void 0:B.rowKey);)y.includes(B.rowKey)||g.add(B.rowKey),B=G(B.parentKey)?void 0:p.get(B.parentKey)}}),[...g]}),u=m(()=>{const g=s.value,{disabledRowKeys:v}=c.value;let y=0;return o.value.forEach((p,k)=>{!v.includes(k)&&g.includes(k)&&y++},0),y}),d=m(()=>{const g=o.value.size,v=c.value.disabledRowKeys.length;return g===0||g===v?!1:g===v+u.value}),h=m(()=>!d.value&&u.value>0),x=g=>{a(g);const v=n.value,{onChange:y}=r.value||{};if(y){const p=[];g.forEach(k=>{const K=v.get(k);K&&p.push(K.record)}),M(y,g,p)}},f=(g,v)=>{const y=n.value,{disabledRowKeys:p}=c.value,{multiple:k,onSelect:K}=r.value||{};let B=[...s.value];const E=B.indexOf(g),R=E>=0;if(k){const O=y.get(g),A=Ne(O,p);if(R){B.splice(E,1);const P=Ht(y,O,p);B=B.filter(T=>!P.includes(T)&&!A.includes(T))}else B.push(g),B.push(...A);At(y,O,B,p)}else B=R?[]:[g];M(K,!R,v),x(B)},C=()=>{const{enabledRowKeys:g}=c.value,v=new Set(s.value);d.value?g.forEach(y=>v.delete(y)):g.forEach(y=>v.add(y)),x([...v])},w=_t(r,l),S=Mt(r,n,o,s,x);return{selectable:r,selectedRowKeys:s,indeterminateRowKeys:i,currentPageRowKeys:c,currentPageAllSelected:d,currentPageSomeSelected:h,handleSelectChange:f,handleHeadSelectChange:C,mergedSelectableMenus:w,handleSelectableMenuClick:S}}function Ne(e,l){const t=[],{children:n}=e||{};return n&&n.forEach(o=>{const{rowKey:r}=o;l.includes(r)||t.push(o.rowKey),t.push(...Ne(o,l))}),t}function Ht(e,l,t){const n=[];for(;l!=null&&l.parentKey;){const{parentKey:o}=l;t.includes(l.parentKey)||n.push(o),l=e.get(o)}return n}function At(e,l,t,n){let o=!0;for(;o&&l&&!G(l.parentKey);){const r=e.get(l.parentKey);if(r&&!n.includes(l.parentKey)){o=r.children.every(a=>n.includes(a.rowKey)||t.includes(a.rowKey));const s=t.findIndex(a=>a===l.parentKey);o?s<0&&t.push(l.parentKey):s>-1&&t.splice(s,1)}l=r}}const Le=Symbol("IDUX_TABLE_KEY_selectable-all"),je=Symbol("IDUX_TABLE_KEY_selectable-invert"),Ue=Symbol("IDUX_TABLE_KEY_selectable-none"),qe=Symbol("IDUX_TABLE_KEY_selectable-pageInvert");function _t(e,l){return m(()=>{const{menus:t}=e.value||{};if(!t||t.length===0)return[];const{selectAll:n,selectInvert:o,selectNone:r,selectPageInvert:s}=l.table;return t.map(a=>N(a)?a==="all"?{type:"item",key:Le,label:n}:a==="invert"?{type:"item",key:je,label:o}:a==="none"?{type:"item",key:Ue,label:r}:a==="pageInvert"?{type:"item",key:qe,label:s}:{type:"item",key:a,label:a}:a)})}function Mt(e,l,t,n,o){const r=()=>{const{disabled:u,onSelectAll:d}=e.value||{},h=[];l.value.forEach((x,f)=>{u!=null&&u(x.record)||h.push(f)}),M(d,h),o(h)},s=()=>{const{disabled:u,onSelectInvert:d}=e.value||{},h=[...n.value];l.value.forEach((x,f)=>{if(u!=null&&u(x.record))return;const C=h.indexOf(f);C>=0?h.splice(C,1):h.push(f)}),o(h),M(d,h)},a=()=>{const{onSelectNone:u}=e.value||{};M(u),o([])},c=()=>{const{disabled:u,onSelectPageInvert:d}=e.value||{},h=[],x=n.value;t.value.forEach((f,C)=>{u!=null&&u(f.record)||x.includes(C)||h.push(C)}),M(d,h),o(h)},i=new Map([[Le,r],[je,s],[Ue,a],[qe,c]]);return u=>{const d=u.key;if(dt(d)&&i.has(d)){i.get(d)();return}const{disabled:h,onMenuClick:x}=e.value||{};if(!x)return;const f=[];t.value.forEach((C,w)=>{h!=null&&h(C.record)||f.push(w)}),M(x,u,f)}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function zt(e){const l=m(()=>e.value.filter(s=>s.sortable)),t=m(()=>l.value.some(s=>s.sortable.multiple!==void 0)),n=he({}),o=I([]);return D(l,(s,a)=>{s.forEach(c=>{const{key:i,sortable:u}=c,d=u.orderBy;if(d||n[i]===void 0){n[i]=d;return}const h=a?a.find(f=>f.key===i):void 0;(h==null?void 0:h.sortable.orderBy)&&(n[i]=void 0)}),o.value=Ce(s,n)},{immediate:!0}),{activeSorters:o,activeOrderByMap:n,handleSort:(s,a)=>{const{orders:c,onChange:i}=a,u=n[s],d=u?Se(c,u):Se(c);t.value?n[s]=d:Object.keys(n).forEach(h=>{s===h?n[h]=d:n[h]=void 0}),o.value=Ce(l.value,n),M(i,d,o.value)}}}function Se(e,l){return l?e[e.indexOf(l)+1]:e[0]}function Ce(e,l){return e.map(t=>{const{key:n,sortable:o}=t,{multiple:r=0,orderBy:s=l[n],sorter:a}=o;return{key:n,multiple:r,orderBy:s,sorter:a}}).filter(t=>t.orderBy).sort((t,n)=>n.multiple-t.multiple)}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Dt(e){const l=m(()=>!!e.sticky),t=m(()=>{const{sticky:r}=e,{offsetTop:s=0,offsetBottom:a=0,offsetScroll:c=0,container:i=window}=ft(r)?r:{};return{offsetTop:s,offsetBottom:a,offsetScroll:c,container:i}}),[n,o]=oe(0);return{isSticky:l,mergedSticky:t,stickyScrollLeft:n,setStickyScrollLeft:o}}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function Nt(e,{hasEllipsis:l,hasFixed:t},{scrollWidth:n,scrollHeight:o},r,s){return m(()=>e.tableLayout?e.tableLayout:n.value&&t.value?n.value==="max-content"?"auto":"fixed":o.value||s.value||r.value||l.value||e.virtual?"fixed":"auto")}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const _=Symbol("TABLE_TOKEN"),pe=Symbol("tableBodyToken"),ne=H({props:{isFixedHolder:Boolean},setup(e){const{flattedColumns:l,flattedColumnsWithScrollBar:t,columnWidthsWithScrollBar:n,mergedSelectableMenus:o,mergedPrefixCls:r}=F(_);return()=>{const{isFixedHolder:s}=e,a=s?t.value:l.value;if(a.every(u=>!u.width&&!u.type))return;const c=r.value,i=a.map((u,d)=>{const{key:h,type:x}=u,f=s?n.value[d]:u.width,C=x?V({[`${c}-col-${x}`]:!0,[`${c}-col-with-dropdown`]:x==="selectable"&&o.value.length>0}):void 0;let w;return s?w=f?`width: ${z(f)}`:void 0:w={width:z(f),minWidth:z(u.minWidth),maxWidth:z(u.maxWidth)},b("col",{key:h,class:C,style:w},null)});return b("colgroup",null,[i])}}}),Lt=H({props:{offsetTop:{type:Number,default:void 0},offsetBottom:{type:Number,default:void 0}},setup(e,{slots:l}){const{mergedPrefixCls:t,scrollHeadRef:n,handleScroll:o,scrollWidth:r,flattedData:s,isSticky:a,columnWidths:c}=F(_);jt(n,o);const i=m(()=>r.value==="max-content"),u=m(()=>s.value.length>0),d=m(()=>{const f=t.value;return{[`${f}-fixed-holder`]:!0,[`${f}-sticky-holder`]:a.value}}),h=m(()=>{const f=a.value,{offsetTop:C,offsetBottom:w}=e;return{overflow:"hidden",top:f?z(C):void 0,bottom:f?z(w):void 0}}),x=m(()=>({tableLayout:"fixed",visibility:u.value&&!c.value.length?"hidden":void 0}));return()=>b("div",{class:d.value,style:h.value,ref:n},[b("table",{style:x.value},[(u.value||!i.value)&&b(ne,{isFixedHolder:!0},null),l.default&&l.default()])])}});function jt(e,l){const t=n=>{const o=n.deltaX,r=n.currentTarget;if(o){const s=r.scrollLeft+o;l(n,s),n.preventDefault()}};se(()=>ee(e.value,"wheel",t,{passive:!0})),Q(()=>Y(e.value,"wheel",t))}const Ut=H({setup(){const{mergedPrefixCls:e,scrollBodyRef:l,handleScroll:t,mergedSticky:n,stickyScrollLeft:o,setStickyScrollLeft:r}=F(_),s=I(!1),a=I(!1),c=I(0),i=I(0),u=I(0),d=m(()=>{const v=i.value,y=u.value;return y&&v*(v/y)});Ie(()=>{const v=X(l);if(v&&s.value){const{clientWidth:y,scrollWidth:p,scrollLeft:k}=v;r(k/p*y),i.value=y,u.value=p}});const h=m(()=>({height:ce(),width:i.value,bottom:n.value.offsetScroll})),x=m(()=>{const v=e.value;return{[`${v}-sticky-scrollbar-thumb`]:!0,[`${v}-sticky-scrollbar-thumb-active`]:a.value}}),f=m(()=>({width:`${d.value}px`,transform:`translate3d(${o.value}px, 0, 0)`})),C=()=>a.value=!1,w=v=>{c.value=v.pageX-o.value,a.value=!0,v.preventDefault()},S=v=>{if(!a.value)return;const{buttons:y}=v||window.event;if(y===0){a.value=!1;return}let p=v.pageX-c.value;p<=0&&(p=0);const k=i.value,K=u.value,B=d.value;p+B>=k&&(p=k-B);const E=p/k*(K+2);t(v,E)},g=()=>{const v=X(l),y=ge(v).top,p=y+v.offsetHeight,{container:k,offsetScroll:K}=n.value,B=k===window?document.documentElement.scrollTop+window.innerHeight:ge(k).top+k.clientHeight;p-ce()<=B||y>=B-K?s.value=!1:s.value=!0};return se(()=>{ee(document.body,"mouseup",C),ee(document.body,"mousemove",S),ee(window,"resize",g),D(()=>n.value.container,(v,y)=>{Y(y,"scroll",g),ee(v,"scroll",g)},{immediate:!0}),g()}),Q(()=>{Y(document.body,"mouseup",C),Y(document.body,"mousemove",S),Y(window,"resize",g),Y(n.value.container,"scroll",g)}),()=>!l.value||!s.value||u.value<=i.value||!d.value?null:b("div",{class:`${e.value}-sticky-scrollbar`,style:h.value},[b("div",{class:x.value,style:f.value,onMousedown:w},null)])}}),de=H({props:{isEmpty:Boolean},setup(e,{slots:l}){const{mergedPrefixCls:t,flattedColumns:n,hasFixed:o,scrollWidth:r,scrollBarColumn:s}=F(_),{mainTableWidth:a}=F(pe),c=m(()=>n.value.length);return()=>{let i=l.default();if(e.isEmpty?r.value:o.value){const u=s.value;i=b("div",{class:`${t.value}-fixed-row`,style:{width:z(a.value-(u?u.width:0)),position:"sticky",left:0,overflow:"hidden"}},[i])}return b("tr",null,[b("td",{colSpan:c.value},[i])])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const qt={expandedRowKeys:{type:Array,default:void 0},selectedRowKeys:{type:Array,default:void 0},autoHeight:{type:Boolean,default:void 0},borderless:{type:Boolean,default:void 0},childrenKey:{type:String,default:void 0},columns:{type:Array,default:()=>[]},customAdditional:{type:Object,default:void 0},customTag:{type:Object,default:void 0},dataSource:{type:Array,default:()=>[]},ellipsis:{type:[Boolean,Object],default:!1},empty:{type:[String,Object],default:"default"},emptyCell:{type:[String,Function],default:void 0},getKey:{type:[String,Function],default:void 0},header:{type:[String,Object],default:void 0},headless:{type:Boolean,default:void 0},pagination:{type:[Boolean,Object],default:!0},scroll:{type:Object,default:void 0},size:{type:String,default:void 0},spin:{type:[Boolean,Object],default:void 0},sticky:{type:[Boolean,Object],default:void 0},scrollToTopOnChange:{type:Boolean,default:void 0},tableLayout:{type:String,default:void 0},virtual:{type:Boolean,default:!1},"onUpdate:expandedRowKeys":[Function,Array],"onUpdate:selectedRowKeys":[Function,Array],onScroll:[Function,Array],onScrolledChange:[Function,Array],onScrolledBottom:[Function,Array]},Xt={columns:{type:Array,required:!0}},Vt={column:{type:Object,required:!0}},Yt={expanded:{type:Boolean,default:void 0},rowIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowData:{type:Object,required:!0},rowKey:{type:[String,Number,Symbol],required:!0}},Gt={column:{type:Object,required:!0},colIndex:{type:Number,required:!0},level:{type:Number,default:void 0},record:{type:Object,required:!0},rowIndex:{type:Number,required:!0},disabled:{type:Boolean,default:void 0},expanded:{type:Boolean,default:void 0},handleExpend:{type:Function,default:void 0},isHover:{type:Boolean,default:void 0},selected:{type:Boolean,default:void 0},indeterminate:{type:Boolean,default:void 0},handleSelect:{type:Function,default:void 0}},Jt={cellKey:{type:[String,Number,Symbol],required:!0},changeColumnWidth:{type:Function,required:!0}},Qt={activeFilterBy:{type:Array,required:!0},filterable:{type:Object,required:!0},onUpdateFilterBy:{type:Function,required:!0}},Zt={activeOrderBy:{type:String,default:void 0},sortable:{type:Object,required:!0}},el=H({props:Jt,setup(e){const l=I();return ie(l,n=>{const{offsetWidth:o}=n.target;e.changeColumnWidth(e.cellKey,o)}),Q(()=>{e.changeColumnWidth(e.cellKey,!1)}),()=>b("td",{ref:l,style:{padding:0,border:0,height:0}},[b("div",{style:{height:0,overflow:"hidden"}},[vt(" ")])])}}),tl=H({setup(){const{mergedPrefixCls:e,flattedColumns:l}=F(_),{changeColumnWidth:t}=F(pe);return()=>{const n=l.value.map(o=>{const{key:r}=o;return b(el,{key:r,cellKey:r,changeColumnWidth:t},null)});return b("tr",{class:`${e.value}-measure-row`,style:{fontSize:0,height:0},"aria-hidden":!0},[n])}}}),ll=H({props:Gt,setup(e){const{props:l,slots:t,config:n,mergedPrefixCls:o,mergedEmptyCell:r,activeOrderByMap:s,fixedColumnKeys:a,columnOffsets:c,isSticky:i,expandable:u,selectable:d,mergedPagination:h}=F(_),x=m(()=>s[e.column.key]),f=nl(e),C=m(()=>a.value.lastStartKey===e.column.key),w=m(()=>a.value.firstEndKey===e.column.key),S=m(()=>{const{type:p,ellipsis:k}=e.column;return p?k:k??l.ellipsis}),g=m(()=>{const{fixed:p,align:k}=e.column,K=o.value;let B={[`${K}-cell`]:!0,[`${K}-cell-sorted`]:!!x.value,[`${K}-cell-align-${k}`]:!!k&&k!="start",[`${K}-cell-ellipsis`]:!!S.value};return p&&(B={...B,[`${K}-fix-start`]:p==="start",[`${K}-fix-start-last`]:C.value,[`${K}-fix-end`]:p==="end",[`${K}-fix-end-first`]:w.value,[`${K}-fix-sticky`]:i.value}),V(B)}),v=m(()=>{const{fixed:p}=e.column;if(!p)return;const{starts:k,ends:K}=c.value,E=z((p==="start"?k:K)[e.colIndex]);return{position:"sticky",left:p==="start"?E:void 0,right:p==="end"?E:void 0}}),y=p=>{p.stopPropagation()};return()=>{var A,P;const{column:p}=e,{type:k}=p;let K,B;if(k==="selectable")K=al(e,t,d,y,n,h);else if(k==="indexable")K=Xe(e,t,p,h);else{const T=f.value;if(K=ol(e,t,T),B=We(S.value,K,T),!k&&(G(K)||K==="")){const $=t.emptyCell||r.value;K=J($)?$({column:p,record:e.record,rowIndex:e.rowIndex}):$}}e.column.fixed&&S.value&&(C.value||w.value)&&(K=b("span",{class:`${o.value}-cell-content`},[K]));const E=(A=l.customAdditional)==null?void 0:A.bodyCell,R=E?E({column:p,record:e.record,rowIndex:e.rowIndex}):void 0,O=((P=l.customTag)==null?void 0:P.bodyCell)??"td";return b(O,Z({class:g.value,style:v.value,title:B},R),{default:()=>[k==="expandable"&&sl(e,t,u,o.value),K]})}}});function nl(e){return m(()=>{const{column:l,record:t}=e,n=fe(l.dataKey);if(n.length<=0)return;let o=t;for(let r=0;r<n.length&&o;r++){const s=n[r];o=o[s]}return o})}function ol(e,l,t){const{record:n,rowIndex:o,column:r}=e,{customCell:s}=r,a=N(s)?l[s]:s;return a?a({value:t,record:n,rowIndex:o}):t}function sl(e,l,t,n){if(e.disabled)return;const{icon:o,customIcon:r,indent:s}=t.value,{record:a,expanded:c,level:i=0}=e,u=s?`margin-left: ${z(i*s)}`:void 0;let d;const h=(N(r)?l[r]:r)??o;return J(h)?d=h({expanded:!!c,record:a}):d=N(h)?b(te,{name:h,rotate:c?90:0},null):h,b("button",{class:`${n}-expandable-trigger`,style:u,type:"button",onClick:e.handleExpend},[d])}function al(e,l,t,n,o,r){const{selected:s,indeterminate:a,disabled:c,isHover:i,handleSelect:u}=e,{showIndex:d,multiple:h,customCell:x,trigger:f}=t.value;if(!s&&!i&&d)return Xe(e,l,o.columnIndexable,r);const C=N(x)?l[x]:x;if(h){const w={checked:s,disabled:c,indeterminate:a},S={...w,onChange:u,onClick:n};return C?C(f?w:S):b(ve,f?w:S,null)}else{const w={checked:s,disabled:c},S={...w,onChange:u,onClick:n};return C?C(S):b(Pe,f?w:S,null)}}function Xe(e,l,t,n){const{record:o,rowIndex:r,disabled:s}=e,{customCell:a}=t,{pageIndex:c=1,pageSize:i=0}=n.value||{},u=N(a)?l[a]:a;return u?b("span",{style:s?"cursor: not-allowed":"cursor: pointer"},[u({record:o,rowIndex:r,pageIndex:c,pageSize:i})]):void 0}const rl=H({props:Yt,setup(e){const{props:l,mergedPrefixCls:t,flattedColumns:n,expandable:o,handleExpandChange:r,checkExpandDisabled:s,selectable:a,selectedRowKeys:c,indeterminateRowKeys:i,handleSelectChange:u,currentPageRowKeys:d}=F(_),{expandDisabled:h,handleExpend:x,selectDisabled:f,handleSelect:C,isHover:w,attrs:S}=cl(e,o,s,r,a,u,d),g=m(()=>c.value.includes(e.rowKey)),v=m(()=>i.value.includes(e.rowKey)),y=m(()=>{const p=`${t.value}-row`,{level:k,expanded:K}=e;return V({[`${p}`]:!0,[`${p}-level-${k}`]:!!k,[`${p}-selected`]:g.value,[`${p}-expanded`]:K})});return()=>{var B,E;const p=(B=l.customAdditional)==null?void 0:B.bodyRow,k=p?p({record:e.record,rowIndex:e.rowIndex}):void 0,K=((E=l.customTag)==null?void 0:E.bodyRow)??"tr";return b(K,Z({class:y.value},S.value,k),{default:()=>[il(e,n,h,x,g,v,f,C,w)]})}}});function cl(e,l,t,n,o,r,s){const a=m(()=>t(e.rowData)),c=m(()=>{var y;return(y=l.value)==null?void 0:y.trigger}),i=()=>{const{rowKey:y,record:p}=e;n(y,p)},u=m(()=>s.value.disabledRowKeys.includes(e.rowKey)),d=m(()=>{var y;return(y=o.value)==null?void 0:y.trigger}),h=m(()=>{var y;return(y=o.value)==null?void 0:y.showIndex}),x=I(!1),f=()=>{const{rowKey:y,record:p}=e;r(y,p)},C=()=>{c.value==="click"&&i(),d.value==="click"&&f()},w=()=>{c.value==="dblclick"&&i(),d.value==="dblclick"&&f()},S=()=>x.value=!0,g=()=>x.value=!1,v=m(()=>{const y=a.value,p=c.value,k=u.value,K=d.value,B=!y&&p==="click"||!k&&K==="click",E=!y&&p==="dblclick"||!k&&K==="dblclick",R=!k&&h.value;let O="";return B||E?O="pointer":(y&&p||k&&K)&&(O="not-allowed"),{style:O?`cursor: ${O}`:void 0,onClick:B?C:void 0,onDblclick:E?w:void 0,onMouseenter:R?S:void 0,onMouseleave:R?g:void 0}});return{expandDisabled:a,handleExpend:i,selectDisabled:u,handleSelect:f,isHover:x,attrs:v}}function il(e,l,t,n,o,r,s,a,c){const i=[],{rowIndex:u,record:d,level:h}=e;return l.value.forEach((x,f)=>{const{type:C,colSpan:w,rowSpan:S,key:g}=x,v=w==null?void 0:w(d,u),y=S==null?void 0:S(d,u);if(v===0||y===0)return;const p={colSpan:v===1?void 0:v,rowSpan:y===1?void 0:y,rowIndex:u,colIndex:f,record:d,column:x,level:h,key:g};C==="expandable"?(p.expanded=e.expanded,p.disabled=t.value,p.handleExpend=n):C==="selectable"&&(p.selected=o.value,p.indeterminate=r.value,p.disabled=s.value,p.handleSelect=a,p.isHover=c.value),i.push(b(ll,p,null))}),i}function Ve(e,l,t,n,o){const{expanded:r,level:s,record:a,rowKey:c}=e,i={key:c,expanded:r,level:s,record:a,rowData:e,rowIndex:l,rowKey:c},u=b(rl,i,null),d=r&&ul(i,t,n,o);return d?[u,d]:u}function ul(e,l,t,n){const{customExpand:o}=t||{},{record:r,rowIndex:s}=e;let a;return J(o)?a=o({record:r,rowIndex:s}):N(o)&&l[o]&&(a=l[o]({record:r,rowIndex:s})),a&&b(de,{class:`${n}-expanded-row`},{default:()=>[a]})}const re=H({setup(e,{slots:l}){const{props:t,slots:n,mergedPrefixCls:o,mergedAutoHeight:r,flattedData:s,expandable:a,scrollWidth:c,scrollHeight:i,isSticky:u}=F(_),d=m(()=>r.value||c.value||i.value||u.value);return()=>{const h=o.value,x=[];n.alert&&x.push(b(de,{class:`${h}-alert-row`},{default:()=>[n.alert()]}));const f=s.value;return f.length>0?l.default?x.push(...l.default()):f.forEach((C,w)=>{x.push(...fe(Ve(C,w,n,a.value,h)))}):x.push(b(de,{class:`${h}-empty-row`,isEmpty:!0},{default:()=>[b(Ze,{empty:t.empty},n)]})),b("tbody",{class:`${o.value}-tbody`},[d.value&&b(tl,null,null),x])}}}),dl=H({props:Qt,setup(e){const{slots:l,config:t,locale:n,mergedPrefixCls:o}=F(_),r=m(()=>e.filterable.multiple??t.columnBase.filterable.multiple),s=m(()=>e.filterable.footer??t.columnBase.filterable.footer),a=e.activeFilterBy,[c,i]=oe(()=>a);D(()=>e.activeFilterBy,v=>i(v));const[u,d]=oe(!1),h=v=>{d(v),v||e.onUpdateFilterBy(c.value)},x=()=>{d(!1),e.onUpdateFilterBy(c.value)},f=()=>{i(a)},C=v=>{const y=`${o.value}-filterable-menu-label`,p=r.value?ve:Pe;return b("span",{class:y},[b(p,{checked:v.selected,disabled:v.disabled},null),b("span",{class:`${y}-content`},[v.label])])},w=()=>{const v=[],{customMenu:y,menus:p}=e.filterable;return J(y)?v.push(y()):N(y)&&l[y]?v.push(l[y]()):v.push(fl(p,r,c,i,C)),s.value&&v.push(vl(n,o,x,f)),v},S=m(()=>{const v=`${o.value}-filterable-trigger`;return V({[v]:!0,[`${v}-active`]:e.activeFilterBy.length>0})}),g=()=>{const{customTrigger:v}=e.filterable;return J(v)?v():N(v)&&l[v]?l[v]():b("span",{class:S.value,onClick:y=>y.stopPropagation()},[b(te,{name:"filter-filled"},null)])};return()=>{const v={visible:u.value,hideOnClick:!s.value,placement:"bottomEnd",trigger:"click","onUpdate:visible":h};return b(Ke,v,{default:g,overlay:w})}}}),fl=(e,l,t,n,o)=>{const r={dataSource:e,multiple:l.value,selectable:!0,selectedKeys:t.value,"onUpdate:selectedKeys":n};return b(Ee,r,{itemLabel:o})},vl=(e,l,t,n)=>{const{filterConfirm:o,filterReset:r}=e.table;return b("div",{class:`${l.value}-filterable-trigger-footer`},[b(me,{mode:"primary",size:"xs",onClick:t},{default:()=>[o]}),b(me,{size:"xs",onClick:n},{default:()=>[r]})])},hl=H({setup(){const{mergedPrefixCls:e,paginatedMap:l,selectable:t,currentPageRowKeys:n,currentPageAllSelected:o,currentPageSomeSelected:r,handleHeadSelectChange:s,mergedSelectableMenus:a,handleSelectableMenuClick:c}=F(_),i=m(()=>{const w=l.value.size;return w===0||w===n.value.disabledRowKeys.length}),[u,d]=oe(!1),h={"onUpdate:visible":d,trigger:"click"},x=()=>b(Ee,{dataSource:a.value,onClick:c},null),f=()=>b(te,{class:`${e.value}-selectable-trigger`,name:"down",rotate:u.value?180:0},null),C=()=>{if(a.value.length!==0)return b(Ke,h,{default:f,overlay:x})};return()=>{const{multiple:w}=t.value;if(w)return b("span",{class:`${e.value}-cell-triggers`},[b(ve,{checked:o.value,indeterminate:r.value,disabled:i.value,onChange:s},null),C()])}}}),yl=H({props:Zt,setup(e){const{locale:l,mergedPrefixCls:t}=F(_);return()=>{const{activeOrderBy:n,sortable:o}=e,{orders:r,nextTooltip:s}=o,a=s&&pl(l.table,r,n),c=gl(t,r,n);return a?b(et,{title:a},{default:()=>[c]}):c}}});function pl(e,l,t){const n=t?l[l.indexOf(t)+1]:l[0],{sortCancel:o,sortAsc:r,sortDesc:s}=e;return n?n==="ascend"?r:s:o}function gl(e,l,t){const n=e.value,o=`${n}-sortable-trigger-active`,r=l.includes("ascend")&&b(te,{name:"caret-up-filled",class:t==="ascend"?o:void 0},null),s=l.includes("descend")&&b(te,{name:"caret-down-filled",class:t==="descend"?o:void 0},null);return b("span",{class:`${n}-sortable-trigger`},[r,s])}const ml=H({props:Vt,setup(e){const{props:l,slots:t,mergedPrefixCls:n,fixedColumnKeys:o,columnOffsetsWithScrollBar:r,isSticky:s,handleSort:a,activeOrderByMap:c,activeFilterByMap:i,handleFilter:u}=F(_),d=m(()=>{const{type:g,ellipsis:v}=e.column,y=g?v:v??l.ellipsis;return Te(y)&&y.head===!1?void 0:y}),h=m(()=>{const{type:g,align:v,fixed:y,hasChildren:p,key:k,sortable:K,filterable:B}=e.column,E=n.value;let R={[`${E}-cell`]:!0,[`${E}-cell-${g}`]:!!g,[`${E}-cell-filterable`]:!!B,[`${E}-cell-sortable`]:!!K,[`${E}-cell-align-center`]:p||v==="center",[`${E}-cell-align-end`]:!p&&v==="end",[`${E}-cell-ellipsis`]:!!d.value};if(y){const{lastStartKey:O,firstEndKey:A}=o.value;R={...R,[`${E}-fix-start`]:y==="start",[`${E}-fix-start-last`]:O===k,[`${E}-fix-end`]:y==="end",[`${E}-fix-end-first`]:A===k,[`${E}-fix-sticky`]:s.value}}return V(R)}),x=m(()=>{const{fixed:g,colStart:v,colEnd:y}=e.column;if(!g)return;const{starts:p,ends:k}=r.value,E=z((g==="start"?p:k)[g==="start"?v:y]);return{position:"sticky",left:g==="start"?E:void 0,right:g==="end"?E:void 0}}),f=m(()=>c[e.column.key]),C=m(()=>i[e.column.key]||tt),w=g=>{const{key:v,filterable:y}=e.column;u(v,y,g)},S=()=>{const{key:g,sortable:v}=e.column;v&&a(g,v)};return()=>{var A,P;const{column:g}=e,{type:v,titleColSpan:y,titleRowSpan:p}=g;if(v==="scroll-bar")return b("th",{class:h.value,style:x.value,colspan:y===1?void 0:y,rowspan:p===1?void 0:p,onClick:S},null);const k=n.value;let K,B;if(v==="selectable")B=b(hl,null,null);else{const{title:T,customTitle:$,sortable:W,filterable:U}=g,L=d.value;B=bl(T,$,t),K=We(L,B,T);const j=xl(W,f,U,C,w);j.length>0?B=b("span",{class:`${k}-cell-triggers`},[b("span",{class:`${k}-cell-title`},[B]),j]):L&&(B=b("span",{class:`${k}-cell-title`},[B]))}const E=(A=l.customAdditional)==null?void 0:A.headCell,R=E?E({column:g}):void 0,O=((P=l.customTag)==null?void 0:P.headCell)??"th";return b(O,Z({class:h.value,style:x.value,colSpan:y===1?void 0:y,rowSpan:p===1?void 0:p,title:K},R,{onClick:S}),{default:()=>[B]})}}});function bl(e,l,t){let n=e;return J(l)?n=l({title:e}):N(l)&&t[l]&&(n=t[l]({title:e})),n}function xl(e,l,t,n,o){const r=[];return e&&r.push(b(yl,{activeOrderBy:l.value,sortable:e},null)),t&&r.push(b(dl,{activeFilterBy:n.value,filterable:t,onUpdateFilterBy:o},null)),r}const Sl=H({props:Xt,setup(e){const{props:l,mergedPrefixCls:t}=F(_);return()=>{var a,c;const{columns:n}=e,o=(a=l.customAdditional)==null?void 0:a.headRow,r=o?o({columns:n}):void 0,s=((c=l.customTag)==null?void 0:c.headRow)??"tr";return b(s,Z({class:`${t.value}-row`},r),{default:()=>[n.filter(i=>i.titleColSpan!==0).map(i=>b(ml,{key:i.key,column:i},null))]})}}}),we=H({setup(){const{props:e,mergedRows:l,mergedPrefixCls:t}=F(_);return()=>{var a,c;const n=l.value,o=(a=e.customAdditional)==null?void 0:a.head,r=o?o({rows:n}):void 0,s=((c=e.customTag)==null?void 0:c.head)??"thead";return b(s,Z({class:`${t.value}-thead`},r),{default:()=>[n.map((i,u)=>b(Sl,{key:u,columns:i},null))]})}}}),Cl=H({setup(){const{props:e,slots:l,expandable:t,mergedPrefixCls:n,mergedVirtualItemHeight:o,mergedAutoHeight:r,columnWidths:s,changeColumnWidth:a,flattedData:c,isSticky:i,mergedSticky:u,virtualScrollRef:d,scrollBodyRef:h,scrollContentRef:x,handleScroll:f,pingedStart:C,pingedEnd:w,scrollWidth:S,scrollHeight:g,hasFixed:v,tableLayout:y}=F(_),p=I(),k=I(0);Oe(pe,{mainTableWidth:k,changeColumnWidth:(T,$)=>{st(p.value)&&a(T,$)}});const B=()=>{const T=X(h);T&&f({currentTarget:T})},E=T=>{const{offsetWidth:$}=T.target;$!==k.value&&(k.value=$)};se(()=>{B(),D([()=>e.dataSource,S],([,$])=>{$&&B()}),D(s,$e(()=>{var W;((W=X(h))==null?void 0:W.scrollLeft)===0&&B()},16)),lt(p.value,E)}),Q(()=>nt(p.value,E));const R=m(()=>{const T=n.value;return V({[`${T}-container`]:!0,[`${T}-ping-start`]:C.value,[`${T}-ping-end`]:w.value,[`${T}-fixed-layout`]:y.value==="fixed",[`${T}-fixed-column`]:v.value,[`${T}-scroll-horizontal`]:S.value,[`${T}-scroll-vertical`]:g.value})}),O=m(()=>{var j;const T=S.value,$=g.value,W=T?"auto":void 0,U=e.virtual?"hidden":$?"scroll":T?"hidden":void 0,L=(j=e.scroll)==null?void 0:j.fullHeight;return{overflowX:W,overflowY:U,[L?"height":"maxHeight"]:$}}),A=m(()=>({tableLayout:y.value,width:S.value,minWidth:S.value?"100%":void 0})),P=(T,$,W)=>{M(e.onScrolledChange,T,$,W.map(U=>U.record))};return()=>{const T=n.value,$=r.value,W=l.default?l.default():[];if($||g.value||i.value){const{offsetTop:U}=u.value;if(e.headless||W.push(b(Lt,{offsetTop:U},{default:()=>[b(we,null,null)]})),e.virtual&&(e.scroll||$)){const L=({item:ae,index:Ge})=>Ve(ae,Ge,l,t.value,T),j=ae=>b("table",{ref:x,class:`${T}-table`,style:A.value},[b(ne,null,null),b(re,null,{default:()=>[ae]}),!1]),{scroll:q,onScrolledBottom:Ye}=e;W.push(b(ot,{ref:d,style:O.value,dataSource:c.value,fullHeight:q==null?void 0:q.fullHeight,getKey:"rowKey",height:r.value?"100%":q==null?void 0:q.height,itemHeight:o.value,itemRender:L,contentRender:j,virtual:!0,onScroll:f,onScrolledBottom:Ye,onScrolledChange:P},null))}else W.push(b("div",{ref:h,class:`${T}-content`,style:O.value,onScroll:f},[b("table",{ref:x,class:`${T}-table`,style:A.value},[b(ne,null,null),b(re,null,null),!1])]));i.value&&W.push(b(Ut,null,null))}else W.push(b("div",{ref:h,class:`${T}-content`,style:O.value,onScroll:f},[b("table",{ref:x,class:`${T}-table`,style:A.value},[b(ne,null,null),!e.headless&&b(we,null,null),b(re,null,null),!1])]));return b("div",{ref:p,class:R.value},[W])}}});/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */function wl(e,l){return e.footer?b("div",{class:`${l}-footer`},[e.footer()]):null}function kl(e,l,t){let n=null,o=null;if(e!==null){const{position:r}=e,[s,a]=ht(r).split("-"),c=`${t}-pagination ${t}-pagination-${a}`,i=b(pt,Z({class:c,total:l.length},e),null);n=s==="top"?i:null,o=s==="bottom"?i:null}return[n,o]}const Bl={sm:32,md:40,lg:56},Kl={sm:40,md:48,lg:56},El=H({name:"IxTable",props:qt,setup(e,{expose:l,slots:t}){const n=le("common"),o=m(()=>`${n.prefixCls}-table`),r=le("locale"),s=le("table"),a=m(()=>e.autoHeight??s.autoHeight),c=m(()=>e.childrenKey??s.childrenKey),i=at(e,s),u=m(()=>e.emptyCell??s.emptyCell),d=m(()=>e.size??s.size),h=m(()=>n.theme==="seer"?Bl[d.value]:Kl[d.value]),{mergedPagination:x}=Tt(e,s,d),f=Dt(e),C=$t(e,a,f),w=mt(e,t,s,C.scrollBarSizeOnFixedHolder),S=zt(w.flattedColumns),g=Et(w.flattedColumns),v=Kt(e,w.flattedColumns),y=Nt(e,w,C,f.isSticky,a),{activeSorters:p}=S,{activeFilters:k}=g,K=Bt(e,c,i,p,k,v.expandedRowKeys,x),B=Ft(e,r,w.flattedColumns,K);Pt(e,s,x,p,k,C.scrollTo);const E={props:e,slots:t,config:s,locale:r,mergedPrefixCls:o,mergedEmptyCell:u,mergedVirtualItemHeight:h,mergedAutoHeight:a,...w,...C,...S,...g,...f,tableLayout:y,mergedPagination:x,...v,...K,...B};Oe(_,E),l({scrollTo:C.scrollTo});const{flattedData:R,filteredData:O}=K,A=m(()=>{const P=o.value,{borderless:T=s.borderless,scroll:$}=e;return V({[P]:!0,[`${P}-auto-height`]:a.value,[`${P}-borderless`]:T,[`${P}-empty`]:R.value.length===0,[`${P}-full-height`]:$==null?void 0:$.fullHeight,[`${P}-${d.value}`]:!0})});return()=>{const P=o.value,T=b(rt,{header:e.header},t),$=wl(t,P),[W,U]=kl(x.value,O.value,P),L=[T],j=[W,b(Cl,null,null),$,U].filter(Boolean),q=Tl(e.spin);return q?L.push(b(ct,q,{default:()=>[j]})):L.push(...j),b("div",{class:A.value},[L])}}});function Tl(e){return yt(e)?{spinning:e}:e}/**
 * @license
 *
 * Use of this source code is governed by an MIT-style license that can be
 * found in the LICENSE file at https://github.com/IDuxFE/idux/blob/main/LICENSE
 */const Rl=El,Wl=ye;export{Rl as I,Wl as a,gt as g,qt as t};
